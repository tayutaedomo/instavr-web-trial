(function(){function t(t){function e(e,n,i,r,o,a){for(;o>=0&&a>o;o+=t){var s=r?r[o]:o;i=n(i,e[s],s,e)}return i}return function(n,i,r,o){i=E(i,o,4);var a=!H(n)&&y.keys(n),s=(a||n).length,c=t>0?0:s-1;return arguments.length<3&&(r=n[a?a[c]:c],c+=t),e(n,i,r,a,c,s)}}function e(t){return function(e,n,i){n=_(n,i);for(var r=x(e),o=t>0?0:r-1;o>=0&&r>o;o+=t)if(n(e[o],o,e))return o;return-1}}function n(t,e,n){return function(i,r,o){var a=0,s=x(i);if("number"==typeof o)t>0?a=o>=0?o:Math.max(o+s,a):s=o>=0?Math.min(o+1,s):o+s+1;else if(n&&o&&s)return o=n(i,r),i[o]===r?o:-1;if(r!==r)return o=e(u.call(i,a,s),y.isNaN),o>=0?o+a:-1;for(o=t>0?a:s-1;o>=0&&s>o;o+=t)if(i[o]===r)return o;return-1}}function i(t,e){var n=P.length,i=t.constructor,r=y.isFunction(i)&&i.prototype||s,o="constructor";for(y.has(t,o)&&!y.contains(e,o)&&e.push(o);n--;)o=P[n],o in t&&t[o]!==r[o]&&!y.contains(e,o)&&e.push(o)}var r=this,o=r._,a=Array.prototype,s=Object.prototype,c=Function.prototype,l=a.push,u=a.slice,h=s.toString,p=s.hasOwnProperty,d=Array.isArray,f=Object.keys,m=c.bind,v=Object.create,g=function(){},y=function(t){return t instanceof y?t:this instanceof y?void(this._wrapped=t):new y(t)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=y),exports._=y):r._=y,y.VERSION="1.8.3";var E=function(t,e,n){if(void 0===e)return t;switch(null==n?3:n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,i){return t.call(e,n,i)};case 3:return function(n,i,r){return t.call(e,n,i,r)};case 4:return function(n,i,r,o){return t.call(e,n,i,r,o)}}return function(){return t.apply(e,arguments)}},_=function(t,e,n){return null==t?y.identity:y.isFunction(t)?E(t,e,n):y.isObject(t)?y.matcher(t):y.property(t)};y.iteratee=function(t,e){return _(t,e,1/0)};var T=function(t,e){return function(n){var i=arguments.length;if(2>i||null==n)return n;for(var r=1;i>r;r++)for(var o=arguments[r],a=t(o),s=a.length,c=0;s>c;c++){var l=a[c];e&&void 0!==n[l]||(n[l]=o[l])}return n}},b=function(t){if(!y.isObject(t))return{};if(v)return v(t);g.prototype=t;var e=new g;return g.prototype=null,e},w=function(t){return function(e){return null==e?void 0:e[t]}},R=Math.pow(2,53)-1,x=w("length"),H=function(t){var e=x(t);return"number"==typeof e&&e>=0&&R>=e};y.each=y.forEach=function(t,e,n){e=E(e,n);var i,r;if(H(t))for(i=0,r=t.length;r>i;i++)e(t[i],i,t);else{var o=y.keys(t);for(i=0,r=o.length;r>i;i++)e(t[o[i]],o[i],t)}return t},y.map=y.collect=function(t,e,n){e=_(e,n);for(var i=!H(t)&&y.keys(t),r=(i||t).length,o=Array(r),a=0;r>a;a++){var s=i?i[a]:a;o[a]=e(t[s],s,t)}return o},y.reduce=y.foldl=y.inject=t(1),y.reduceRight=y.foldr=t(-1),y.find=y.detect=function(t,e,n){var i;return i=H(t)?y.findIndex(t,e,n):y.findKey(t,e,n),void 0!==i&&i!==-1?t[i]:void 0},y.filter=y.select=function(t,e,n){var i=[];return e=_(e,n),y.each(t,function(t,n,r){e(t,n,r)&&i.push(t)}),i},y.reject=function(t,e,n){return y.filter(t,y.negate(_(e)),n)},y.every=y.all=function(t,e,n){e=_(e,n);for(var i=!H(t)&&y.keys(t),r=(i||t).length,o=0;r>o;o++){var a=i?i[o]:o;if(!e(t[a],a,t))return!1}return!0},y.some=y.any=function(t,e,n){e=_(e,n);for(var i=!H(t)&&y.keys(t),r=(i||t).length,o=0;r>o;o++){var a=i?i[o]:o;if(e(t[a],a,t))return!0}return!1},y.contains=y.includes=y.include=function(t,e,n,i){return H(t)||(t=y.values(t)),("number"!=typeof n||i)&&(n=0),y.indexOf(t,e,n)>=0},y.invoke=function(t,e){var n=u.call(arguments,2),i=y.isFunction(e);return y.map(t,function(t){var r=i?e:t[e];return null==r?r:r.apply(t,n)})},y.pluck=function(t,e){return y.map(t,y.property(e))},y.where=function(t,e){return y.filter(t,y.matcher(e))},y.findWhere=function(t,e){return y.find(t,y.matcher(e))},y.max=function(t,e,n){var i,r,o=-1/0,a=-1/0;if(null==e&&null!=t){t=H(t)?t:y.values(t);for(var s=0,c=t.length;c>s;s++)i=t[s],i>o&&(o=i)}else e=_(e,n),y.each(t,function(t,n,i){r=e(t,n,i),(r>a||r===-1/0&&o===-1/0)&&(o=t,a=r)});return o},y.min=function(t,e,n){var i,r,o=1/0,a=1/0;if(null==e&&null!=t){t=H(t)?t:y.values(t);for(var s=0,c=t.length;c>s;s++)i=t[s],o>i&&(o=i)}else e=_(e,n),y.each(t,function(t,n,i){r=e(t,n,i),(a>r||1/0===r&&1/0===o)&&(o=t,a=r)});return o},y.shuffle=function(t){for(var e,n=H(t)?t:y.values(t),i=n.length,r=Array(i),o=0;i>o;o++)e=y.random(0,o),e!==o&&(r[o]=r[e]),r[e]=n[o];return r},y.sample=function(t,e,n){return null==e||n?(H(t)||(t=y.values(t)),t[y.random(t.length-1)]):y.shuffle(t).slice(0,Math.max(0,e))},y.sortBy=function(t,e,n){return e=_(e,n),y.pluck(y.map(t,function(t,n,i){return{value:t,index:n,criteria:e(t,n,i)}}).sort(function(t,e){var n=t.criteria,i=e.criteria;if(n!==i){if(n>i||void 0===n)return 1;if(i>n||void 0===i)return-1}return t.index-e.index}),"value")};var M=function(t){return function(e,n,i){var r={};return n=_(n,i),y.each(e,function(i,o){var a=n(i,o,e);t(r,i,a)}),r}};y.groupBy=M(function(t,e,n){y.has(t,n)?t[n].push(e):t[n]=[e]}),y.indexBy=M(function(t,e,n){t[n]=e}),y.countBy=M(function(t,e,n){y.has(t,n)?t[n]++:t[n]=1}),y.toArray=function(t){return t?y.isArray(t)?u.call(t):H(t)?y.map(t,y.identity):y.values(t):[]},y.size=function(t){return null==t?0:H(t)?t.length:y.keys(t).length},y.partition=function(t,e,n){e=_(e,n);var i=[],r=[];return y.each(t,function(t,n,o){(e(t,n,o)?i:r).push(t)}),[i,r]},y.first=y.head=y.take=function(t,e,n){return null==t?void 0:null==e||n?t[0]:y.initial(t,t.length-e)},y.initial=function(t,e,n){return u.call(t,0,Math.max(0,t.length-(null==e||n?1:e)))},y.last=function(t,e,n){return null==t?void 0:null==e||n?t[t.length-1]:y.rest(t,Math.max(0,t.length-e))},y.rest=y.tail=y.drop=function(t,e,n){return u.call(t,null==e||n?1:e)},y.compact=function(t){return y.filter(t,y.identity)};var S=function(t,e,n,i){for(var r=[],o=0,a=i||0,s=x(t);s>a;a++){var c=t[a];if(H(c)&&(y.isArray(c)||y.isArguments(c))){e||(c=S(c,e,n));var l=0,u=c.length;for(r.length+=u;u>l;)r[o++]=c[l++]}else n||(r[o++]=c)}return r};y.flatten=function(t,e){return S(t,e,!1)},y.without=function(t){return y.difference(t,u.call(arguments,1))},y.uniq=y.unique=function(t,e,n,i){y.isBoolean(e)||(i=n,n=e,e=!1),null!=n&&(n=_(n,i));for(var r=[],o=[],a=0,s=x(t);s>a;a++){var c=t[a],l=n?n(c,a,t):c;e?(a&&o===l||r.push(c),o=l):n?y.contains(o,l)||(o.push(l),r.push(c)):y.contains(r,c)||r.push(c)}return r},y.union=function(){return y.uniq(S(arguments,!0,!0))},y.intersection=function(t){for(var e=[],n=arguments.length,i=0,r=x(t);r>i;i++){var o=t[i];if(!y.contains(e,o)){for(var a=1;n>a&&y.contains(arguments[a],o);a++);a===n&&e.push(o)}}return e},y.difference=function(t){var e=S(arguments,!0,!0,1);return y.filter(t,function(t){return!y.contains(e,t)})},y.zip=function(){return y.unzip(arguments)},y.unzip=function(t){for(var e=t&&y.max(t,x).length||0,n=Array(e),i=0;e>i;i++)n[i]=y.pluck(t,i);return n},y.object=function(t,e){for(var n={},i=0,r=x(t);r>i;i++)e?n[t[i]]=e[i]:n[t[i][0]]=t[i][1];return n},y.findIndex=e(1),y.findLastIndex=e(-1),y.sortedIndex=function(t,e,n,i){n=_(n,i,1);for(var r=n(e),o=0,a=x(t);a>o;){var s=Math.floor((o+a)/2);n(t[s])<r?o=s+1:a=s}return o},y.indexOf=n(1,y.findIndex,y.sortedIndex),y.lastIndexOf=n(-1,y.findLastIndex),y.range=function(t,e,n){null==e&&(e=t||0,t=0),n=n||1;for(var i=Math.max(Math.ceil((e-t)/n),0),r=Array(i),o=0;i>o;o++,t+=n)r[o]=t;return r};var C=function(t,e,n,i,r){if(!(i instanceof e))return t.apply(n,r);var o=b(t.prototype),a=t.apply(o,r);return y.isObject(a)?a:o};y.bind=function(t,e){if(m&&t.bind===m)return m.apply(t,u.call(arguments,1));if(!y.isFunction(t))throw new TypeError("Bind must be called on a function");var n=u.call(arguments,2),i=function(){return C(t,i,e,this,n.concat(u.call(arguments)))};return i},y.partial=function(t){var e=u.call(arguments,1),n=function(){for(var i=0,r=e.length,o=Array(r),a=0;r>a;a++)o[a]=e[a]===y?arguments[i++]:e[a];for(;i<arguments.length;)o.push(arguments[i++]);return C(t,n,this,this,o)};return n},y.bindAll=function(t){var e,n,i=arguments.length;if(1>=i)throw new Error("bindAll must be passed function names");for(e=1;i>e;e++)n=arguments[e],t[n]=y.bind(t[n],t);return t},y.memoize=function(t,e){var n=function(i){var r=n.cache,o=""+(e?e.apply(this,arguments):i);return y.has(r,o)||(r[o]=t.apply(this,arguments)),r[o]};return n.cache={},n},y.delay=function(t,e){var n=u.call(arguments,2);return setTimeout(function(){return t.apply(null,n)},e)},y.defer=y.partial(y.delay,y,1),y.throttle=function(t,e,n){var i,r,o,a=null,s=0;n||(n={});var c=function(){s=n.leading===!1?0:y.now(),a=null,o=t.apply(i,r),a||(i=r=null)};return function(){var l=y.now();s||n.leading!==!1||(s=l);var u=e-(l-s);return i=this,r=arguments,0>=u||u>e?(a&&(clearTimeout(a),a=null),s=l,o=t.apply(i,r),a||(i=r=null)):a||n.trailing===!1||(a=setTimeout(c,u)),o}},y.debounce=function(t,e,n){var i,r,o,a,s,c=function(){var l=y.now()-a;e>l&&l>=0?i=setTimeout(c,e-l):(i=null,n||(s=t.apply(o,r),i||(o=r=null)))};return function(){o=this,r=arguments,a=y.now();var l=n&&!i;return i||(i=setTimeout(c,e)),l&&(s=t.apply(o,r),o=r=null),s}},y.wrap=function(t,e){return y.partial(e,t)},y.negate=function(t){return function(){return!t.apply(this,arguments)}},y.compose=function(){var t=arguments,e=t.length-1;return function(){for(var n=e,i=t[e].apply(this,arguments);n--;)i=t[n].call(this,i);return i}},y.after=function(t,e){return function(){return--t<1?e.apply(this,arguments):void 0}},y.before=function(t,e){var n;return function(){return--t>0&&(n=e.apply(this,arguments)),1>=t&&(e=null),n}},y.once=y.partial(y.before,2);var A=!{toString:null}.propertyIsEnumerable("toString"),P=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];y.keys=function(t){if(!y.isObject(t))return[];if(f)return f(t);var e=[];for(var n in t)y.has(t,n)&&e.push(n);return A&&i(t,e),e},y.allKeys=function(t){if(!y.isObject(t))return[];var e=[];for(var n in t)e.push(n);return A&&i(t,e),e},y.values=function(t){for(var e=y.keys(t),n=e.length,i=Array(n),r=0;n>r;r++)i[r]=t[e[r]];return i},y.mapObject=function(t,e,n){e=_(e,n);for(var i,r=y.keys(t),o=r.length,a={},s=0;o>s;s++)i=r[s],a[i]=e(t[i],i,t);return a},y.pairs=function(t){for(var e=y.keys(t),n=e.length,i=Array(n),r=0;n>r;r++)i[r]=[e[r],t[e[r]]];return i},y.invert=function(t){for(var e={},n=y.keys(t),i=0,r=n.length;r>i;i++)e[t[n[i]]]=n[i];return e},y.functions=y.methods=function(t){var e=[];for(var n in t)y.isFunction(t[n])&&e.push(n);return e.sort()},y.extend=T(y.allKeys),y.extendOwn=y.assign=T(y.keys),y.findKey=function(t,e,n){e=_(e,n);for(var i,r=y.keys(t),o=0,a=r.length;a>o;o++)if(i=r[o],e(t[i],i,t))return i},y.pick=function(t,e,n){var i,r,o={},a=t;if(null==a)return o;y.isFunction(e)?(r=y.allKeys(a),i=E(e,n)):(r=S(arguments,!1,!1,1),i=function(t,e,n){return e in n},a=Object(a));for(var s=0,c=r.length;c>s;s++){var l=r[s],u=a[l];i(u,l,a)&&(o[l]=u)}return o},y.omit=function(t,e,n){if(y.isFunction(e))e=y.negate(e);else{var i=y.map(S(arguments,!1,!1,1),String);e=function(t,e){return!y.contains(i,e)}}return y.pick(t,e,n)},y.defaults=T(y.allKeys,!0),y.create=function(t,e){var n=b(t);return e&&y.extendOwn(n,e),n},y.clone=function(t){return y.isObject(t)?y.isArray(t)?t.slice():y.extend({},t):t},y.tap=function(t,e){return e(t),t},y.isMatch=function(t,e){var n=y.keys(e),i=n.length;if(null==t)return!i;for(var r=Object(t),o=0;i>o;o++){var a=n[o];if(e[a]!==r[a]||!(a in r))return!1}return!0};var L=function(t,e,n,i){if(t===e)return 0!==t||1/t===1/e;if(null==t||null==e)return t===e;t instanceof y&&(t=t._wrapped),e instanceof y&&(e=e._wrapped);var r=h.call(t);if(r!==h.call(e))return!1;switch(r){case"[object RegExp]":case"[object String]":return""+t==""+e;case"[object Number]":return+t!==+t?+e!==+e:0===+t?1/+t===1/e:+t===+e;case"[object Date]":case"[object Boolean]":return+t===+e}var o="[object Array]"===r;if(!o){if("object"!=typeof t||"object"!=typeof e)return!1;var a=t.constructor,s=e.constructor;if(a!==s&&!(y.isFunction(a)&&a instanceof a&&y.isFunction(s)&&s instanceof s)&&"constructor"in t&&"constructor"in e)return!1}n=n||[],i=i||[];for(var c=n.length;c--;)if(n[c]===t)return i[c]===e;if(n.push(t),i.push(e),o){if(c=t.length,c!==e.length)return!1;for(;c--;)if(!L(t[c],e[c],n,i))return!1}else{var l,u=y.keys(t);if(c=u.length,y.keys(e).length!==c)return!1;for(;c--;)if(l=u[c],!y.has(e,l)||!L(t[l],e[l],n,i))return!1}return n.pop(),i.pop(),!0};y.isEqual=function(t,e){return L(t,e)},y.isEmpty=function(t){return null==t||(H(t)&&(y.isArray(t)||y.isString(t)||y.isArguments(t))?0===t.length:0===y.keys(t).length)},y.isElement=function(t){return!(!t||1!==t.nodeType)},y.isArray=d||function(t){return"[object Array]"===h.call(t)},y.isObject=function(t){var e=typeof t;return"function"===e||"object"===e&&!!t},y.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(t){y["is"+t]=function(e){return h.call(e)==="[object "+t+"]"}}),y.isArguments(arguments)||(y.isArguments=function(t){return y.has(t,"callee")}),"function"!=typeof/./&&"object"!=typeof Int8Array&&(y.isFunction=function(t){return"function"==typeof t||!1}),y.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},y.isNaN=function(t){return y.isNumber(t)&&t!==+t},y.isBoolean=function(t){return t===!0||t===!1||"[object Boolean]"===h.call(t)},y.isNull=function(t){return null===t},y.isUndefined=function(t){return void 0===t},y.has=function(t,e){return null!=t&&p.call(t,e)},y.noConflict=function(){return r._=o,this},y.identity=function(t){return t},y.constant=function(t){return function(){return t}},y.noop=function(){},y.property=w,y.propertyOf=function(t){return null==t?function(){}:function(e){return t[e]}},y.matcher=y.matches=function(t){return t=y.extendOwn({},t),function(e){return y.isMatch(e,t)}},y.times=function(t,e,n){var i=Array(Math.max(0,t));e=E(e,n,1);for(var r=0;t>r;r++)i[r]=e(r);return i},y.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))},y.now=Date.now||function(){return(new Date).getTime()};var O={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},j=y.invert(O),k=function(t){var e=function(e){return t[e]},n="(?:"+y.keys(t).join("|")+")",i=RegExp(n),r=RegExp(n,"g");return function(t){return t=null==t?"":""+t,i.test(t)?t.replace(r,e):t}};y.escape=k(O),y.unescape=k(j),y.result=function(t,e,n){var i=null==t?void 0:t[e];return void 0===i&&(i=n),y.isFunction(i)?i.call(t):i};var I=0;y.uniqueId=function(t){var e=++I+"";return t?t+e:e},y.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var D=/(.)^/,B={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},U=/\\|'|\r|\n|\u2028|\u2029/g,N=function(t){return"\\"+B[t]};y.template=function(t,e,n){!e&&n&&(e=n),e=y.defaults({},e,y.templateSettings);var i=RegExp([(e.escape||D).source,(e.interpolate||D).source,(e.evaluate||D).source].join("|")+"|$","g"),r=0,o="__p+='";t.replace(i,function(e,n,i,a,s){return o+=t.slice(r,s).replace(U,N),r=s+e.length,n?o+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":i?o+="'+\n((__t=("+i+"))==null?'':__t)+\n'":a&&(o+="';\n"+a+"\n__p+='"),e}),o+="';\n",e.variable||(o="with(obj||{}){\n"+o+"}\n"),o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{var a=new Function(e.variable||"obj","_",o)}catch(t){throw t.source=o,t}var s=function(t){return a.call(this,t,y)},c=e.variable||"obj";return s.source="function("+c+"){\n"+o+"}",s},y.chain=function(t){var e=y(t);return e._chain=!0,e};var F=function(t,e){return t._chain?y(e).chain():e};y.mixin=function(t){y.each(y.functions(t),function(e){var n=y[e]=t[e];y.prototype[e]=function(){var t=[this._wrapped];return l.apply(t,arguments),F(this,n.apply(y,t))}})},y.mixin(y),y.each(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=a[t];y.prototype[t]=function(){var n=this._wrapped;return e.apply(n,arguments),"shift"!==t&&"splice"!==t||0!==n.length||delete n[0],F(this,n)}}),y.each(["concat","join","slice"],function(t){var e=a[t];y.prototype[t]=function(){return F(this,e.apply(this._wrapped,arguments))}}),y.prototype.value=function(){return this._wrapped},y.prototype.valueOf=y.prototype.toJSON=y.prototype.value,y.prototype.toString=function(){return""+this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],function(){return y})}).call(this),function(t){"use strict";var e,n=function(t,e){"undefined"==typeof e&&(e={}),this.init(t,e)},i=n.prototype,r=["canvas","vml"],o=["oval","spiral","square","rect","roundRect"],a=/^\#([a-fA-F0-9]{6}|[a-fA-F0-9]{3})$/,s=navigator.appVersion.indexOf("MSIE")!==-1&&8===parseFloat(navigator.appVersion.split("MSIE")[1]),c=!!document.createElement("canvas").getContext,l=40,u=!0,h=function(t,e,n){var i,r=document.createElement(t);for(i in n)r[i]=n[i];return"undefined"!=typeof e&&e.appendChild(r),r},p=function(t,e){for(var n in e)t.style[n]=e[n];return t},d=function(t,e){for(var n in e)t.setAttribute(n,e[n]);return t},f=function(t,e,n,i){t.save(),t.translate(e,n),t.rotate(i),t.translate(-e,-n),t.beginPath()};i.init=function(t,i){"boolean"==typeof i.safeVML&&(u=i.safeVML);try{void 0!==document.getElementById(t)?this.mum=document.getElementById(t):this.mum=document.body}catch(t){this.mum=document.body}if(i.id="undefined"!=typeof i.id?i.id:"canvasLoader",this.cont=h("div",this.mum,{id:i.id}),c)e=r[0],this.can=h("canvas",this.cont),this.con=this.can.getContext("2d"),this.cCan=p(h("canvas",this.cont),{display:"none"}),this.cCon=this.cCan.getContext("2d");else{if(e=r[1],"undefined"==typeof n.vmlSheet){document.getElementsByTagName("head")[0].appendChild(h("style")),n.vmlSheet=document.styleSheets[document.styleSheets.length-1];for(var o,a=["group","oval","roundrect","fill"],o=0;o<a.length;++o)n.vmlSheet.addRule(a[o],"behavior:url(#default#VML); position:absolute;")}this.vml=h("group",this.cont)}this.setColor(this.color),this.draw(),p(this.cont,{display:"none"})},i.cont={},i.can={},i.con={},i.cCan={},i.cCon={},i.timer={},i.activeId=0,i.diameter=40,i.setDiameter=function(t){this.diameter=Math.round(Math.abs(t)),this.redraw()},i.getDiameter=function(){return this.diameter},i.cRGB={},i.color="#000000",i.setColor=function(t){this.color=a.test(t)?t:"#000000",this.cRGB=this.getRGB(this.color),this.redraw()},i.getColor=function(){return this.color},i.shape=o[0],i.setShape=function(t){var e;for(e in o)if(t===o[e]){this.shape=t,this.redraw();break}},i.getShape=function(){return this.shape},i.density=40,i.setDensity=function(t){u&&e===r[1]?this.density=Math.round(Math.abs(t))<=l?Math.round(Math.abs(t)):l:this.density=Math.round(Math.abs(t)),this.density>360&&(this.density=360),this.activeId=0,this.redraw()},i.getDensity=function(){return this.density},i.range=1.3,i.setRange=function(t){this.range=Math.abs(t),this.redraw()},i.getRange=function(){return this.range},i.speed=2,i.setSpeed=function(t){this.speed=Math.round(Math.abs(t))},i.getSpeed=function(){return this.speed},i.fps=24,i.setFPS=function(t){this.fps=Math.round(Math.abs(t)),this.reset()},i.getFPS=function(){return this.fps},i.getRGB=function(t){return t="#"===t.charAt(0)?t.substring(1,7):t,{r:parseInt(t.substring(0,2),16),g:parseInt(t.substring(2,4),16),b:parseInt(t.substring(4,6),16)}},i.draw=function(){var t,n,i,a,c,l,u,m,v,g,y,E,_,T=0,b=this.density,w=Math.round(b*this.range),R=0,x=1e3,H=0,M=this.cCon,S=this.diameter,C=.47;if(e===r[0])for(M.clearRect(0,0,x,x),d(this.can,{width:S,height:S}),d(this.cCan,{width:S,height:S});T<b;){switch(v=T<=w?1-(1-R)/w*T:v=R,l=270-360/b*T,u=l/180*Math.PI,M.fillStyle="rgba("+this.cRGB.r+","+this.cRGB.g+","+this.cRGB.b+","+v.toString()+")",this.shape){case o[0]:case o[1]:t=.07*S,a=S*C+Math.cos(u)*(S*C-t)-S*C,c=S*C+Math.sin(u)*(S*C-t)-S*C,M.beginPath(),this.shape===o[1]?M.arc(.5*S+a,.5*S+c,t*v,0,2*Math.PI,!1):M.arc(.5*S+a,.5*S+c,t,0,2*Math.PI,!1);break;case o[2]:t=.12*S,a=Math.cos(u)*(S*C-t)+.5*S,c=Math.sin(u)*(S*C-t)+.5*S,f(M,a,c,u),M.fillRect(a,c-.5*t,t,t);break;case o[3]:case o[4]:n=.3*S,i=.27*n,a=Math.cos(u)*(i+.13*(S-i))+.5*S,c=Math.sin(u)*(i+.13*(S-i))+.5*S,f(M,a,c,u),this.shape===o[3]?M.fillRect(a,c-.5*i,n,i):(m=.55*i,M.moveTo(a+m,c-.5*i),M.lineTo(a+n-m,c-.5*i),M.quadraticCurveTo(a+n,c-.5*i,a+n,c-.5*i+m),M.lineTo(a+n,c-.5*i+i-m),M.quadraticCurveTo(a+n,c-.5*i+i,a+n-m,c-.5*i+i),M.lineTo(a+m,c-.5*i+i),M.quadraticCurveTo(a,c-.5*i+i,a,c-.5*i+i-m),M.lineTo(a,c-.5*i+m),M.quadraticCurveTo(a,c-.5*i,a+m,c-.5*i))}M.closePath(),M.fill(),M.restore(),++T}else{switch(p(this.cont,{width:S,height:S}),p(this.vml,{width:S,height:S}),this.shape){case o[0]:case o[1]:E="oval",t=.14*x;break;case o[2]:E="roundrect",t=.12*x;break;case o[3]:case o[4]:E="roundrect",t=.3*x}for(n=i=t,a=.5*x-i,c=.5*-i;T<b;){switch(v=T<=w?1-(1-R)/w*T:v=R,l=270-360/b*T,this.shape){case o[1]:n=i=t*v,a=.5*x-.5*t-t*v*.5,c=.5*(t-t*v);break;case o[0]:case o[2]:s&&(c=0,this.shape===o[2]&&(a=.5*x-.5*i));break;case o[3]:case o[4]:n=.95*t,i=.28*n,s?(a=0,c=.5*x-.5*i):(a=.5*x-n,c=.5*-i),H=this.shape===o[4]?.6:0}y=d(p(h("group",this.vml),{width:x,height:x,rotation:l}),{coordsize:x+","+x,coordorigin:.5*-x+","+.5*-x}),g=p(h(E,y,{stroked:!1,arcSize:H}),{width:n,height:i,top:c,left:a}),_=h("fill",g,{color:this.color,opacity:v}),++T}}this.tick(!0)},i.clean=function(){if(e===r[0])this.con.clearRect(0,0,1e3,1e3);else{var t=this.vml;if(t.hasChildNodes())for(;t.childNodes.length>=1;)t.removeChild(t.firstChild)}},i.redraw=function(){this.clean(),this.draw()},i.reset=function(){"number"==typeof this.timer&&(this.hide(),this.show())},i.tick=function(t){var n=this.con,i=this.diameter;t||(this.activeId+=360/this.density*this.speed),e===r[0]?(n.clearRect(0,0,i,i),f(n,.5*i,.5*i,this.activeId/180*Math.PI),n.drawImage(this.cCan,0,0,i,i),n.restore()):(this.activeId>=360&&(this.activeId-=360),p(this.vml,{rotation:this.activeId}))},i.show=function(){if("number"!=typeof this.timer){var t=this;this.timer=self.setInterval(function(){t.tick()},Math.round(1e3/this.fps)),p(this.cont,{display:"block"})}},i.hide=function(){"number"==typeof this.timer&&(clearInterval(this.timer),delete this.timer,p(this.cont,{display:"none"}))},i.kill=function(){var t=this.cont;"number"==typeof this.timer&&this.hide(),e===r[0]?(t.removeChild(this.can),t.removeChild(this.cCan)):t.removeChild(this.vml);var n;for(n in this)delete this[n]},t.CanvasLoader=n}(window);var THREE={REVISION:"76"};"function"==typeof define&&define.amd?define("three",THREE):"undefined"!=typeof exports&&"undefined"!=typeof module&&(module.exports=THREE),void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),void 0===Math.sign&&(Math.sign=function(t){return t<0?-1:t>0?1:+t}),void 0===Function.prototype.name&&void 0!==Object.defineProperty&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*(\S*)\s*\(/)[1]}}),void 0===Object.assign&&Object.defineProperty(Object,"assign",{writable:!0,configurable:!0,value:function(t){"use strict";if(void 0===t||null===t)throw new TypeError("Cannot convert first argument to object");for(var e=Object(t),n=1,i=arguments.length;n!==i;++n){var r=arguments[n];if(void 0!==r&&null!==r){r=Object(r);for(var o=Object.keys(r),a=0,s=o.length;a!==s;++a){var c=o[a],l=Object.getOwnPropertyDescriptor(r,c);void 0!==l&&l.enumerable&&(e[c]=r[c])}}}return e}}),THREE.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2},THREE.CullFaceNone=0,THREE.CullFaceBack=1,THREE.CullFaceFront=2,THREE.CullFaceFrontBack=3,THREE.FrontFaceDirectionCW=0,THREE.FrontFaceDirectionCCW=1,THREE.BasicShadowMap=0,THREE.PCFShadowMap=1,THREE.PCFSoftShadowMap=2,THREE.FrontSide=0,THREE.BackSide=1,THREE.DoubleSide=2,THREE.FlatShading=1,THREE.SmoothShading=2,THREE.NoColors=0,THREE.FaceColors=1,THREE.VertexColors=2,THREE.NoBlending=0,THREE.NormalBlending=1,THREE.AdditiveBlending=2,THREE.SubtractiveBlending=3,THREE.MultiplyBlending=4,THREE.CustomBlending=5,THREE.AddEquation=100,THREE.SubtractEquation=101,THREE.ReverseSubtractEquation=102,THREE.MinEquation=103,THREE.MaxEquation=104,THREE.ZeroFactor=200,THREE.OneFactor=201,THREE.SrcColorFactor=202,THREE.OneMinusSrcColorFactor=203,THREE.SrcAlphaFactor=204,THREE.OneMinusSrcAlphaFactor=205,THREE.DstAlphaFactor=206,THREE.OneMinusDstAlphaFactor=207,THREE.DstColorFactor=208,THREE.OneMinusDstColorFactor=209,THREE.SrcAlphaSaturateFactor=210,THREE.NeverDepth=0,THREE.AlwaysDepth=1,THREE.LessDepth=2,THREE.LessEqualDepth=3,THREE.EqualDepth=4,THREE.GreaterEqualDepth=5,THREE.GreaterDepth=6,THREE.NotEqualDepth=7,THREE.MultiplyOperation=0,THREE.MixOperation=1,THREE.AddOperation=2,THREE.NoToneMapping=0,THREE.LinearToneMapping=1,THREE.ReinhardToneMapping=2,THREE.Uncharted2ToneMapping=3,THREE.CineonToneMapping=4,THREE.UVMapping=300,THREE.CubeReflectionMapping=301,THREE.CubeRefractionMapping=302,THREE.EquirectangularReflectionMapping=303,THREE.EquirectangularRefractionMapping=304,THREE.SphericalReflectionMapping=305,THREE.CubeUVReflectionMapping=306,THREE.CubeUVRefractionMapping=307,THREE.RepeatWrapping=1e3,THREE.ClampToEdgeWrapping=1001,THREE.MirroredRepeatWrapping=1002,THREE.NearestFilter=1003,THREE.NearestMipMapNearestFilter=1004,THREE.NearestMipMapLinearFilter=1005,THREE.LinearFilter=1006,THREE.LinearMipMapNearestFilter=1007,THREE.LinearMipMapLinearFilter=1008,THREE.UnsignedByteType=1009,THREE.ByteType=1010,THREE.ShortType=1011,THREE.UnsignedShortType=1012,THREE.IntType=1013,THREE.UnsignedIntType=1014,THREE.FloatType=1015,THREE.HalfFloatType=1025,THREE.UnsignedShort4444Type=1016,THREE.UnsignedShort5551Type=1017,THREE.UnsignedShort565Type=1018,THREE.AlphaFormat=1019,THREE.RGBFormat=1020,THREE.RGBAFormat=1021,THREE.LuminanceFormat=1022,THREE.LuminanceAlphaFormat=1023,THREE.RGBEFormat=THREE.RGBAFormat,THREE.DepthFormat=1026,THREE.RGB_S3TC_DXT1_Format=2001,THREE.RGBA_S3TC_DXT1_Format=2002,THREE.RGBA_S3TC_DXT3_Format=2003,THREE.RGBA_S3TC_DXT5_Format=2004,THREE.RGB_PVRTC_4BPPV1_Format=2100,THREE.RGB_PVRTC_2BPPV1_Format=2101,THREE.RGBA_PVRTC_4BPPV1_Format=2102,THREE.RGBA_PVRTC_2BPPV1_Format=2103,THREE.RGB_ETC1_Format=2151,THREE.LoopOnce=2200,THREE.LoopRepeat=2201,THREE.LoopPingPong=2202,THREE.InterpolateDiscrete=2300,THREE.InterpolateLinear=2301,THREE.InterpolateSmooth=2302,THREE.ZeroCurvatureEnding=2400,THREE.ZeroSlopeEnding=2401,THREE.WrapAroundEnding=2402,THREE.TrianglesDrawMode=0,THREE.TriangleStripDrawMode=1,THREE.TriangleFanDrawMode=2,THREE.LinearEncoding=3e3,THREE.sRGBEncoding=3001,THREE.GammaEncoding=3007,THREE.RGBEEncoding=3002,THREE.LogLuvEncoding=3003,THREE.RGBM7Encoding=3004,THREE.RGBM16Encoding=3005,THREE.RGBDEncoding=3006,THREE.BasicDepthPacking=3200,THREE.RGBADepthPacking=3201,THREE.Color=function(t){return 3===arguments.length?this.fromArray(arguments):this.set(t)},THREE.Color.prototype={constructor:THREE.Color,r:1,g:1,b:1,set:function(t){return t instanceof THREE.Color?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this},setScalar:function(t){this.r=t,this.g=t,this.b=t},setHex:function(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this},setRGB:function(t,e,n){return this.r=t,this.g=e,this.b=n,this},setHSL:function(){function t(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+6*(e-t)*(2/3-n):t}return function(e,n,i){if(e=THREE.Math.euclideanModulo(e,1),n=THREE.Math.clamp(n,0,1),i=THREE.Math.clamp(i,0,1),0===n)this.r=this.g=this.b=i;else{var r=i<=.5?i*(1+n):i+n-i*n,o=2*i-r;this.r=t(o,r,e+1/3),this.g=t(o,r,e),this.b=t(o,r,e-1/3)}return this}}(),setStyle:function(t){function e(e){void 0!==e&&parseFloat(e)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}var n;if(n=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(t)){var i,r=n[1],o=n[2];switch(r){case"rgb":case"rgba":if(i=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o))return this.r=Math.min(255,parseInt(i[1],10))/255,this.g=Math.min(255,parseInt(i[2],10))/255,this.b=Math.min(255,parseInt(i[3],10))/255,e(i[5]),this;if(i=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o))return this.r=Math.min(100,parseInt(i[1],10))/100,this.g=Math.min(100,parseInt(i[2],10))/100,this.b=Math.min(100,parseInt(i[3],10))/100,e(i[5]),this;break;case"hsl":case"hsla":if(i=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o)){var a=parseFloat(i[1])/360,s=parseInt(i[2],10)/100,c=parseInt(i[3],10)/100;return e(i[5]),this.setHSL(a,s,c)}}}else if(n=/^\#([A-Fa-f0-9]+)$/.exec(t)){var l=n[1],u=l.length;if(3===u)return this.r=parseInt(l.charAt(0)+l.charAt(0),16)/255,this.g=parseInt(l.charAt(1)+l.charAt(1),16)/255,this.b=parseInt(l.charAt(2)+l.charAt(2),16)/255,this;if(6===u)return this.r=parseInt(l.charAt(0)+l.charAt(1),16)/255,this.g=parseInt(l.charAt(2)+l.charAt(3),16)/255,this.b=parseInt(l.charAt(4)+l.charAt(5),16)/255,this}if(t&&t.length>0){var l=THREE.ColorKeywords[t];void 0!==l?this.setHex(l):console.warn("THREE.Color: Unknown color "+t)}return this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},copyGammaToLinear:function(t,e){return void 0===e&&(e=2),this.r=Math.pow(t.r,e),this.g=Math.pow(t.g,e),this.b=Math.pow(t.b,e),this},copyLinearToGamma:function(t,e){void 0===e&&(e=2);var n=e>0?1/e:1;return this.r=Math.pow(t.r,n),this.g=Math.pow(t.g,n),this.b=Math.pow(t.b,n),this},convertGammaToLinear:function(){var t=this.r,e=this.g,n=this.b;return this.r=t*t,this.g=e*e,this.b=n*n,this},convertLinearToGamma:function(){return this.r=Math.sqrt(this.r),this.g=Math.sqrt(this.g),this.b=Math.sqrt(this.b),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(t){var e,n,i=t||{h:0,s:0,l:0},r=this.r,o=this.g,a=this.b,s=Math.max(r,o,a),c=Math.min(r,o,a),l=(c+s)/2;if(c===s)e=0,n=0;else{var u=s-c;switch(n=l<=.5?u/(s+c):u/(2-s-c),s){case r:e=(o-a)/u+(o<a?6:0);break;case o:e=(a-r)/u+2;break;case a:e=(r-o)/u+4}e/=6}return i.h=e,i.s=n,i.l=l,i},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(t,e,n){var i=this.getHSL();return i.h+=t,i.s+=e,i.l+=n,this.setHSL(i.h,i.s,i.l),this},add:function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this},addColors:function(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this},addScalar:function(t){return this.r+=t,this.g+=t,this.b+=t,this},multiply:function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this},multiplyScalar:function(t){return this.r*=t,this.g*=t,this.b*=t,this},lerp:function(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this},equals:function(t){return t.r===this.r&&t.g===this.g&&t.b===this.b},fromArray:function(t,e){return void 0===e&&(e=0),this.r=t[e],this.g=t[e+1],this.b=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t}},THREE.ColorKeywords={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,
lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},THREE.Quaternion=function(t,e,n,i){this._x=t||0,this._y=e||0,this._z=n||0,this._w=void 0!==i?i:1},THREE.Quaternion.prototype={constructor:THREE.Quaternion,get x(){return this._x},set x(t){this._x=t,this.onChangeCallback()},get y(){return this._y},set y(t){this._y=t,this.onChangeCallback()},get z(){return this._z},set z(t){this._z=t,this.onChangeCallback()},get w(){return this._w},set w(t){this._w=t,this.onChangeCallback()},set:function(t,e,n,i){return this._x=t,this._y=e,this._z=n,this._w=i,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this.onChangeCallback(),this},setFromEuler:function(t,e){if(t instanceof THREE.Euler==!1)throw new Error("THREE.Quaternion: .setFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var n=Math.cos(t._x/2),i=Math.cos(t._y/2),r=Math.cos(t._z/2),o=Math.sin(t._x/2),a=Math.sin(t._y/2),s=Math.sin(t._z/2),c=t.order;return"XYZ"===c?(this._x=o*i*r+n*a*s,this._y=n*a*r-o*i*s,this._z=n*i*s+o*a*r,this._w=n*i*r-o*a*s):"YXZ"===c?(this._x=o*i*r+n*a*s,this._y=n*a*r-o*i*s,this._z=n*i*s-o*a*r,this._w=n*i*r+o*a*s):"ZXY"===c?(this._x=o*i*r-n*a*s,this._y=n*a*r+o*i*s,this._z=n*i*s+o*a*r,this._w=n*i*r-o*a*s):"ZYX"===c?(this._x=o*i*r-n*a*s,this._y=n*a*r+o*i*s,this._z=n*i*s-o*a*r,this._w=n*i*r+o*a*s):"YZX"===c?(this._x=o*i*r+n*a*s,this._y=n*a*r+o*i*s,this._z=n*i*s-o*a*r,this._w=n*i*r-o*a*s):"XZY"===c&&(this._x=o*i*r-n*a*s,this._y=n*a*r-o*i*s,this._z=n*i*s+o*a*r,this._w=n*i*r+o*a*s),e!==!1&&this.onChangeCallback(),this},setFromAxisAngle:function(t,e){var n=e/2,i=Math.sin(n);return this._x=t.x*i,this._y=t.y*i,this._z=t.z*i,this._w=Math.cos(n),this.onChangeCallback(),this},setFromRotationMatrix:function(t){var e,n=t.elements,i=n[0],r=n[4],o=n[8],a=n[1],s=n[5],c=n[9],l=n[2],u=n[6],h=n[10],p=i+s+h;return p>0?(e=.5/Math.sqrt(p+1),this._w=.25/e,this._x=(u-c)*e,this._y=(o-l)*e,this._z=(a-r)*e):i>s&&i>h?(e=2*Math.sqrt(1+i-s-h),this._w=(u-c)/e,this._x=.25*e,this._y=(r+a)/e,this._z=(o+l)/e):s>h?(e=2*Math.sqrt(1+s-i-h),this._w=(o-l)/e,this._x=(r+a)/e,this._y=.25*e,this._z=(c+u)/e):(e=2*Math.sqrt(1+h-i-s),this._w=(a-r)/e,this._x=(o+l)/e,this._y=(c+u)/e,this._z=.25*e),this.onChangeCallback(),this},setFromUnitVectors:function(){var t,e,n=1e-6;return function(i,r){return void 0===t&&(t=new THREE.Vector3),e=i.dot(r)+1,e<n?(e=0,Math.abs(i.x)>Math.abs(i.z)?t.set(-i.y,i.x,0):t.set(0,-i.z,i.y)):t.crossVectors(i,r),this._x=t.x,this._y=t.y,this._z=t.z,this._w=e,this.normalize(),this}}(),inverse:function(){return this.conjugate().normalize(),this},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this},dot:function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this.onChangeCallback(),this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,e)):this.multiplyQuaternions(this,t)},multiplyQuaternions:function(t,e){var n=t._x,i=t._y,r=t._z,o=t._w,a=e._x,s=e._y,c=e._z,l=e._w;return this._x=n*l+o*a+i*c-r*s,this._y=i*l+o*s+r*a-n*c,this._z=r*l+o*c+n*s-i*a,this._w=o*l-n*a-i*s-r*c,this.onChangeCallback(),this},slerp:function(t,e){if(0===e)return this;if(1===e)return this.copy(t);var n=this._x,i=this._y,r=this._z,o=this._w,a=o*t._w+n*t._x+i*t._y+r*t._z;if(a<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,a=-a):this.copy(t),a>=1)return this._w=o,this._x=n,this._y=i,this._z=r,this;var s=Math.sqrt(1-a*a);if(Math.abs(s)<.001)return this._w=.5*(o+this._w),this._x=.5*(n+this._x),this._y=.5*(i+this._y),this._z=.5*(r+this._z),this;var c=Math.atan2(s,a),l=Math.sin((1-e)*c)/s,u=Math.sin(e*c)/s;return this._w=o*l+this._w*u,this._x=n*l+this._x*u,this._y=i*l+this._y*u,this._z=r*l+this._z*u,this.onChangeCallback(),this},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w},fromArray:function(t,e){return void 0===e&&(e=0),this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this.onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t},onChange:function(t){return this.onChangeCallback=t,this},onChangeCallback:function(){}},Object.assign(THREE.Quaternion,{slerp:function(t,e,n,i){return n.copy(t).slerp(e,i)},slerpFlat:function(t,e,n,i,r,o,a){var s=n[i+0],c=n[i+1],l=n[i+2],u=n[i+3],h=r[o+0],p=r[o+1],d=r[o+2],f=r[o+3];if(u!==f||s!==h||c!==p||l!==d){var m=1-a,v=s*h+c*p+l*d+u*f,g=v>=0?1:-1,y=1-v*v;if(y>Number.EPSILON){var E=Math.sqrt(y),_=Math.atan2(E,v*g);m=Math.sin(m*_)/E,a=Math.sin(a*_)/E}var T=a*g;if(s=s*m+h*T,c=c*m+p*T,l=l*m+d*T,u=u*m+f*T,m===1-a){var b=1/Math.sqrt(s*s+c*c+l*l+u*u);s*=b,c*=b,l*=b,u*=b}}t[e]=s,t[e+1]=c,t[e+2]=l,t[e+3]=u}}),THREE.Vector2=function(t,e){this.x=t||0,this.y=e||0},THREE.Vector2.prototype={constructor:THREE.Vector2,get width(){return this.x},set width(t){this.x=t},get height(){return this.y},set height(t){this.y=t},set:function(t,e){return this.x=t,this.y=e,this},setScalar:function(t){return this.x=t,this.y=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(t){return this.x=t.x,this.y=t.y,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this)},addScalar:function(t){return this.x+=t,this.y+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this)},subScalar:function(t){return this.x-=t,this.y-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this},multiplyScalar:function(t){return isFinite(t)?(this.x*=t,this.y*=t):(this.x=0,this.y=0),this},divide:function(t){return this.x/=t.x,this.y/=t.y,this},divideScalar:function(t){return this.multiplyScalar(1/t)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this},clampScalar:function(){var t,e;return function(n,i){return void 0===t&&(t=new THREE.Vector2,e=new THREE.Vector2),t.set(n,n),e.set(i,i),this.clamp(t,e)}}(),clampLength:function(t,e){var n=this.length();return this.multiplyScalar(Math.max(t,Math.min(e,n))/n),this},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(t){return this.x*t.x+this.y*t.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length())},angle:function(){var t=Math.atan2(this.y,this.x);return t<0&&(t+=2*Math.PI),t},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,n=this.y-t.y;return e*e+n*n},setLength:function(t){return this.multiplyScalar(t/this.length())},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t),this},equals:function(t){return t.x===this.x&&t.y===this.y},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t},fromAttribute:function(t,e,n){return void 0===n&&(n=0),e=e*t.itemSize+n,this.x=t.array[e],this.y=t.array[e+1],this},rotateAround:function(t,e){var n=Math.cos(e),i=Math.sin(e),r=this.x-t.x,o=this.y-t.y;return this.x=r*n-o*i+t.x,this.y=r*i+o*n+t.y,this}},THREE.Vector3=function(t,e,n){this.x=t||0,this.y=e||0,this.z=n||0},THREE.Vector3.prototype={constructor:THREE.Vector3,set:function(t,e,n){return this.x=t,this.y=e,this.z=n,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,e)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},multiplyScalar:function(t){return isFinite(t)?(this.x*=t,this.y*=t,this.z*=t):(this.x=0,this.y=0,this.z=0),this},multiplyVectors:function(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this},applyEuler:function(){var t;return function(e){return e instanceof THREE.Euler==!1&&console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),void 0===t&&(t=new THREE.Quaternion),this.applyQuaternion(t.setFromEuler(e)),this}}(),applyAxisAngle:function(){var t;return function(e,n){return void 0===t&&(t=new THREE.Quaternion),this.applyQuaternion(t.setFromAxisAngle(e,n)),this}}(),applyMatrix3:function(t){var e=this.x,n=this.y,i=this.z,r=t.elements;return this.x=r[0]*e+r[3]*n+r[6]*i,this.y=r[1]*e+r[4]*n+r[7]*i,this.z=r[2]*e+r[5]*n+r[8]*i,this},applyMatrix4:function(t){var e=this.x,n=this.y,i=this.z,r=t.elements;return this.x=r[0]*e+r[4]*n+r[8]*i+r[12],this.y=r[1]*e+r[5]*n+r[9]*i+r[13],this.z=r[2]*e+r[6]*n+r[10]*i+r[14],this},applyProjection:function(t){var e=this.x,n=this.y,i=this.z,r=t.elements,o=1/(r[3]*e+r[7]*n+r[11]*i+r[15]);return this.x=(r[0]*e+r[4]*n+r[8]*i+r[12])*o,this.y=(r[1]*e+r[5]*n+r[9]*i+r[13])*o,this.z=(r[2]*e+r[6]*n+r[10]*i+r[14])*o,this},applyQuaternion:function(t){var e=this.x,n=this.y,i=this.z,r=t.x,o=t.y,a=t.z,s=t.w,c=s*e+o*i-a*n,l=s*n+a*e-r*i,u=s*i+r*n-o*e,h=-r*e-o*n-a*i;return this.x=c*s+h*-r+l*-a-u*-o,this.y=l*s+h*-o+u*-r-c*-a,this.z=u*s+h*-a+c*-o-l*-r,this},project:function(){var t;return function(e){return void 0===t&&(t=new THREE.Matrix4),t.multiplyMatrices(e.projectionMatrix,t.getInverse(e.matrixWorld)),this.applyProjection(t)}}(),unproject:function(){var t;return function(e){return void 0===t&&(t=new THREE.Matrix4),t.multiplyMatrices(e.matrixWorld,t.getInverse(e.projectionMatrix)),this.applyProjection(t)}}(),transformDirection:function(t){var e=this.x,n=this.y,i=this.z,r=t.elements;return this.x=r[0]*e+r[4]*n+r[8]*i,this.y=r[1]*e+r[5]*n+r[9]*i,this.z=r[2]*e+r[6]*n+r[10]*i,this.normalize(),this},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},divideScalar:function(t){return this.multiplyScalar(1/t)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this},clampScalar:function(){var t,e;return function(n,i){return void 0===t&&(t=new THREE.Vector3,e=new THREE.Vector3),t.set(n,n,n),e.set(i,i,i),this.clamp(t,e)}}(),clampLength:function(t,e){var n=this.length();return this.multiplyScalar(Math.max(t,Math.min(e,n))/n),this},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length())},setLength:function(t){return this.multiplyScalar(t/this.length())},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t),this},cross:function(t,e){if(void 0!==e)return console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,e);var n=this.x,i=this.y,r=this.z;return this.x=i*t.z-r*t.y,this.y=r*t.x-n*t.z,this.z=n*t.y-i*t.x,this},crossVectors:function(t,e){var n=t.x,i=t.y,r=t.z,o=e.x,a=e.y,s=e.z;return this.x=i*s-r*a,this.y=r*o-n*s,this.z=n*a-i*o,this},projectOnVector:function(){var t,e;return function(n){return void 0===t&&(t=new THREE.Vector3),t.copy(n).normalize(),e=this.dot(t),this.copy(t).multiplyScalar(e)}}(),projectOnPlane:function(){var t;return function(e){return void 0===t&&(t=new THREE.Vector3),t.copy(this).projectOnVector(e),this.sub(t)}}(),reflect:function(){var t;return function(e){return void 0===t&&(t=new THREE.Vector3),this.sub(t.copy(e).multiplyScalar(2*this.dot(e)))}}(),angleTo:function(t){var e=this.dot(t)/Math.sqrt(this.lengthSq()*t.lengthSq());return Math.acos(THREE.Math.clamp(e,-1,1))},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,n=this.y-t.y,i=this.z-t.z;return e*e+n*n+i*i},setFromSpherical:function(t){var e=Math.sin(t.phi)*t.radius;return this.x=e*Math.sin(t.theta),this.y=Math.cos(t.phi)*t.radius,this.z=e*Math.cos(t.theta),this},setFromMatrixPosition:function(t){return this.setFromMatrixColumn(t,3)},setFromMatrixScale:function(t){var e=this.setFromMatrixColumn(t,0).length(),n=this.setFromMatrixColumn(t,1).length(),i=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=n,this.z=i,this},setFromMatrixColumn:function(t,e){return"number"==typeof t&&(console.warn("THREE.Vector3: setFromMatrixColumn now expects ( matrix, index )."),t=arguments[1],e=arguments[0]),this.fromArray(t.elements,4*e)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t},fromAttribute:function(t,e,n){return void 0===n&&(n=0),e=e*t.itemSize+n,this.x=t.array[e],this.y=t.array[e+1],this.z=t.array[e+2],this}},THREE.Vector4=function(t,e,n,i){this.x=t||0,this.y=e||0,this.z=n||0,this.w=void 0!==i?i:1},THREE.Vector4.prototype={constructor:THREE.Vector4,set:function(t,e,n,i){return this.x=t,this.y=e,this.z=n,this.w=i,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this.w=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setW:function(t){return this.w=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this},multiplyScalar:function(t){return isFinite(t)?(this.x*=t,this.y*=t,this.z*=t,this.w*=t):(this.x=0,this.y=0,this.z=0,this.w=0),this},applyMatrix4:function(t){var e=this.x,n=this.y,i=this.z,r=this.w,o=t.elements;return this.x=o[0]*e+o[4]*n+o[8]*i+o[12]*r,this.y=o[1]*e+o[5]*n+o[9]*i+o[13]*r,this.z=o[2]*e+o[6]*n+o[10]*i+o[14]*r,this.w=o[3]*e+o[7]*n+o[11]*i+o[15]*r,this},divideScalar:function(t){return this.multiplyScalar(1/t)},setAxisAngleFromQuaternion:function(t){this.w=2*Math.acos(t.w);var e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this},setAxisAngleFromRotationMatrix:function(t){var e,n,i,r,o=.01,a=.1,s=t.elements,c=s[0],l=s[4],u=s[8],h=s[1],p=s[5],d=s[9],f=s[2],m=s[6],v=s[10];if(Math.abs(l-h)<o&&Math.abs(u-f)<o&&Math.abs(d-m)<o){if(Math.abs(l+h)<a&&Math.abs(u+f)<a&&Math.abs(d+m)<a&&Math.abs(c+p+v-3)<a)return this.set(1,0,0,0),this;e=Math.PI;var g=(c+1)/2,y=(p+1)/2,E=(v+1)/2,_=(l+h)/4,T=(u+f)/4,b=(d+m)/4;return g>y&&g>E?g<o?(n=0,i=.707106781,r=.707106781):(n=Math.sqrt(g),i=_/n,r=T/n):y>E?y<o?(n=.707106781,i=0,r=.707106781):(i=Math.sqrt(y),n=_/i,r=b/i):E<o?(n=.707106781,i=.707106781,r=0):(r=Math.sqrt(E),n=T/r,i=b/r),this.set(n,i,r,e),this}var w=Math.sqrt((m-d)*(m-d)+(u-f)*(u-f)+(h-l)*(h-l));return Math.abs(w)<.001&&(w=1),this.x=(m-d)/w,this.y=(u-f)/w,this.z=(h-l)/w,this.w=Math.acos((c+p+v-1)/2),this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this},clampScalar:function(){var t,e;return function(n,i){return void 0===t&&(t=new THREE.Vector4,e=new THREE.Vector4),t.set(n,n,n,n),e.set(i,i,i,i),this.clamp(t,e)}}(),floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length())},setLength:function(t){return this.multiplyScalar(t/this.length())},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t),this},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t},fromAttribute:function(t,e,n){return void 0===n&&(n=0),e=e*t.itemSize+n,this.x=t.array[e],this.y=t.array[e+1],this.z=t.array[e+2],this.w=t.array[e+3],this}},THREE.Euler=function(t,e,n,i){this._x=t||0,this._y=e||0,this._z=n||0,this._order=i||THREE.Euler.DefaultOrder},THREE.Euler.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],THREE.Euler.DefaultOrder="XYZ",THREE.Euler.prototype={constructor:THREE.Euler,get x(){return this._x},set x(t){this._x=t,this.onChangeCallback()},get y(){return this._y},set y(t){this._y=t,this.onChangeCallback()},get z(){return this._z},set z(t){this._z=t,this.onChangeCallback()},get order(){return this._order},set order(t){this._order=t,this.onChangeCallback()},set:function(t,e,n,i){return this._x=t,this._y=e,this._z=n,this._order=i||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this.onChangeCallback(),this},setFromRotationMatrix:function(t,e,n){var i=THREE.Math.clamp,r=t.elements,o=r[0],a=r[4],s=r[8],c=r[1],l=r[5],u=r[9],h=r[2],p=r[6],d=r[10];return e=e||this._order,"XYZ"===e?(this._y=Math.asin(i(s,-1,1)),Math.abs(s)<.99999?(this._x=Math.atan2(-u,d),this._z=Math.atan2(-a,o)):(this._x=Math.atan2(p,l),this._z=0)):"YXZ"===e?(this._x=Math.asin(-i(u,-1,1)),Math.abs(u)<.99999?(this._y=Math.atan2(s,d),this._z=Math.atan2(c,l)):(this._y=Math.atan2(-h,o),this._z=0)):"ZXY"===e?(this._x=Math.asin(i(p,-1,1)),Math.abs(p)<.99999?(this._y=Math.atan2(-h,d),this._z=Math.atan2(-a,l)):(this._y=0,this._z=Math.atan2(c,o))):"ZYX"===e?(this._y=Math.asin(-i(h,-1,1)),Math.abs(h)<.99999?(this._x=Math.atan2(p,d),this._z=Math.atan2(c,o)):(this._x=0,this._z=Math.atan2(-a,l))):"YZX"===e?(this._z=Math.asin(i(c,-1,1)),Math.abs(c)<.99999?(this._x=Math.atan2(-u,l),this._y=Math.atan2(-h,o)):(this._x=0,this._y=Math.atan2(s,d))):"XZY"===e?(this._z=Math.asin(-i(a,-1,1)),Math.abs(a)<.99999?(this._x=Math.atan2(p,l),this._y=Math.atan2(s,o)):(this._x=Math.atan2(-u,d),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+e),this._order=e,n!==!1&&this.onChangeCallback(),this},setFromQuaternion:function(){var t;return function(e,n,i){return void 0===t&&(t=new THREE.Matrix4),t.makeRotationFromQuaternion(e),this.setFromRotationMatrix(t,n,i),this}}(),setFromVector3:function(t,e){return this.set(t.x,t.y,t.z,e||this._order)},reorder:function(){var t=new THREE.Quaternion;return function(e){t.setFromEuler(this),this.setFromQuaternion(t,e)}}(),equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order},fromArray:function(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this.onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t},toVector3:function(t){return t?t.set(this._x,this._y,this._z):new THREE.Vector3(this._x,this._y,this._z)},onChange:function(t){return this.onChangeCallback=t,this},onChangeCallback:function(){}},THREE.Line3=function(t,e){this.start=void 0!==t?t:new THREE.Vector3,this.end=void 0!==e?e:new THREE.Vector3},THREE.Line3.prototype={constructor:THREE.Line3,set:function(t,e){return this.start.copy(t),this.end.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.start.copy(t.start),this.end.copy(t.end),this},center:function(t){var e=t||new THREE.Vector3;return e.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(t){var e=t||new THREE.Vector3;return e.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(t,e){var n=e||new THREE.Vector3;return this.delta(n).multiplyScalar(t).add(this.start)},closestPointToPointParameter:function(){var t=new THREE.Vector3,e=new THREE.Vector3;return function(n,i){t.subVectors(n,this.start),e.subVectors(this.end,this.start);var r=e.dot(e),o=e.dot(t),a=o/r;return i&&(a=THREE.Math.clamp(a,0,1)),a}}(),closestPointToPoint:function(t,e,n){var i=this.closestPointToPointParameter(t,e),r=n||new THREE.Vector3;return this.delta(r).multiplyScalar(i).add(this.start)},applyMatrix4:function(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this},equals:function(t){return t.start.equals(this.start)&&t.end.equals(this.end)}},THREE.Box2=function(t,e){this.min=void 0!==t?t:new THREE.Vector2((+(1/0)),(+(1/0))),this.max=void 0!==e?e:new THREE.Vector2((-(1/0)),(-(1/0)))},THREE.Box2.prototype={constructor:THREE.Box2,set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromPoints:function(t){this.makeEmpty();for(var e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:function(){var t=new THREE.Vector2;return function(e,n){var i=t.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=+(1/0),this.max.x=this.max.y=-(1/0),this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},center:function(t){var e=t||new THREE.Vector2;return e.addVectors(this.min,this.max).multiplyScalar(.5)},size:function(t){var e=t||new THREE.Vector2;return e.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y},getParameter:function(t,e){var n=e||new THREE.Vector2;return n.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)},clampPoint:function(t,e){var n=e||new THREE.Vector2;return n.copy(t).clamp(this.min,this.max)},distanceToPoint:function(){var t=new THREE.Vector2;return function(e){var n=t.copy(e).clamp(this.min,this.max);return n.sub(e).length()}}(),intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}},THREE.Box3=function(t,e){this.min=void 0!==t?t:new THREE.Vector3((+(1/0)),(+(1/0)),(+(1/0))),this.max=void 0!==e?e:new THREE.Vector3((-(1/0)),(-(1/0)),(-(1/0)))},THREE.Box3.prototype={constructor:THREE.Box3,set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromArray:function(t){for(var e=+(1/0),n=+(1/0),i=+(1/0),r=-(1/0),o=-(1/0),a=-(1/0),s=0,c=t.length;s<c;s+=3){var l=t[s],u=t[s+1],h=t[s+2];l<e&&(e=l),u<n&&(n=u),h<i&&(i=h),l>r&&(r=l),u>o&&(o=u),h>a&&(a=h)}this.min.set(e,n,i),this.max.set(r,o,a)},setFromPoints:function(t){this.makeEmpty();for(var e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:function(){var t=new THREE.Vector3;return function(e,n){var i=t.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}}(),setFromObject:function(){var t=new THREE.Vector3;return function(e){var n=this;return e.updateMatrixWorld(!0),this.makeEmpty(),e.traverse(function(e){var i=e.geometry;if(void 0!==i)if(i instanceof THREE.Geometry)for(var r=i.vertices,o=0,a=r.length;o<a;o++)t.copy(r[o]),t.applyMatrix4(e.matrixWorld),n.expandByPoint(t);else if(i instanceof THREE.BufferGeometry&&void 0!==i.attributes.position)for(var s=i.attributes.position.array,o=0,a=s.length;o<a;o+=3)t.fromArray(s,o),
t.applyMatrix4(e.matrixWorld),n.expandByPoint(t)}),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=+(1/0),this.max.x=this.max.y=this.max.z=-(1/0),this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},center:function(t){var e=t||new THREE.Vector3;return e.addVectors(this.min,this.max).multiplyScalar(.5)},size:function(t){var e=t||new THREE.Vector3;return e.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z},getParameter:function(t,e){var n=e||new THREE.Vector3;return n.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)},intersectsSphere:function(){var t;return function(e){return void 0===t&&(t=new THREE.Vector3),this.clampPoint(e.center,t),t.distanceToSquared(e.center)<=e.radius*e.radius}}(),intersectsPlane:function(t){var e,n;return t.normal.x>0?(e=t.normal.x*this.min.x,n=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,n=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,n+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,n+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,n+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,n+=t.normal.z*this.min.z),e<=t.constant&&n>=t.constant},clampPoint:function(t,e){var n=e||new THREE.Vector3;return n.copy(t).clamp(this.min,this.max)},distanceToPoint:function(){var t=new THREE.Vector3;return function(e){var n=t.copy(e).clamp(this.min,this.max);return n.sub(e).length()}}(),getBoundingSphere:function(){var t=new THREE.Vector3;return function(e){var n=e||new THREE.Sphere;return n.center=this.center(),n.radius=.5*this.size(t).length(),n}}(),intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},applyMatrix4:function(){var t=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3];return function(e){return this.isEmpty()?this:(t[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),t[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),t[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),t[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),t[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),t[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),t[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),t[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(t),this)}}(),translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}},THREE.Matrix3=function(){this.elements=new Float32Array([1,0,0,0,1,0,0,0,1]),arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")},THREE.Matrix3.prototype={constructor:THREE.Matrix3,set:function(t,e,n,i,r,o,a,s,c){var l=this.elements;return l[0]=t,l[1]=i,l[2]=a,l[3]=e,l[4]=r,l[5]=s,l[6]=n,l[7]=o,l[8]=c,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(t){var e=t.elements;return this.set(e[0],e[3],e[6],e[1],e[4],e[7],e[2],e[5],e[8]),this},setFromMatrix4:function(t){var e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this},applyToVector3Array:function(){var t;return function(e,n,i){void 0===t&&(t=new THREE.Vector3),void 0===n&&(n=0),void 0===i&&(i=e.length);for(var r=0,o=n;r<i;r+=3,o+=3)t.fromArray(e,o),t.applyMatrix3(this),t.toArray(e,o);return e}}(),applyToBuffer:function(){var t;return function(e,n,i){void 0===t&&(t=new THREE.Vector3),void 0===n&&(n=0),void 0===i&&(i=e.length/e.itemSize);for(var r=0,o=n;r<i;r++,o++)t.x=e.getX(o),t.y=e.getY(o),t.z=e.getZ(o),t.applyMatrix3(this),e.setXYZ(t.x,t.y,t.z);return e}}(),multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this},determinant:function(){var t=this.elements,e=t[0],n=t[1],i=t[2],r=t[3],o=t[4],a=t[5],s=t[6],c=t[7],l=t[8];return e*o*l-e*a*c-n*r*l+n*a*s+i*r*c-i*o*s},getInverse:function(t,e){t instanceof THREE.Matrix4&&console.error("THREE.Matrix3.getInverse no longer takes a Matrix4 argument.");var n=t.elements,i=this.elements,r=n[0],o=n[1],a=n[2],s=n[3],c=n[4],l=n[5],u=n[6],h=n[7],p=n[8],d=p*c-l*h,f=l*u-p*s,m=h*s-c*u,v=r*d+o*f+a*m;if(0===v){var g="THREE.Matrix3.getInverse(): can't invert matrix, determinant is 0";if(e)throw new Error(g);return console.warn(g),this.identity()}return i[0]=d,i[1]=a*h-p*o,i[2]=l*o-a*c,i[3]=f,i[4]=p*r-a*u,i[5]=a*s-l*r,i[6]=m,i[7]=o*u-h*r,i[8]=c*r-o*s,this.multiplyScalar(1/v)},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this},flattenToArrayOffset:function(t,e){return console.warn("THREE.Matrix3: .flattenToArrayOffset is deprecated - just use .toArray instead."),this.toArray(t,e)},getNormalMatrix:function(t){return this.setFromMatrix4(t).getInverse(this).transpose()},transposeIntoArray:function(t){var e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this},fromArray:function(t){return this.elements.set(t),this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t}},THREE.Matrix4=function(){this.elements=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")},THREE.Matrix4.prototype={constructor:THREE.Matrix4,set:function(t,e,n,i,r,o,a,s,c,l,u,h,p,d,f,m){var v=this.elements;return v[0]=t,v[4]=e,v[8]=n,v[12]=i,v[1]=r,v[5]=o,v[9]=a,v[13]=s,v[2]=c,v[6]=l,v[10]=u,v[14]=h,v[3]=p,v[7]=d,v[11]=f,v[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new THREE.Matrix4).fromArray(this.elements)},copy:function(t){return this.elements.set(t.elements),this},copyPosition:function(t){var e=this.elements,n=t.elements;return e[12]=n[12],e[13]=n[13],e[14]=n[14],this},extractBasis:function(t,e,n){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this},makeBasis:function(t,e,n){return this.set(t.x,e.x,n.x,0,t.y,e.y,n.y,0,t.z,e.z,n.z,0,0,0,0,1),this},extractRotation:function(){var t;return function(e){void 0===t&&(t=new THREE.Vector3);var n=this.elements,i=e.elements,r=1/t.setFromMatrixColumn(e,0).length(),o=1/t.setFromMatrixColumn(e,1).length(),a=1/t.setFromMatrixColumn(e,2).length();return n[0]=i[0]*r,n[1]=i[1]*r,n[2]=i[2]*r,n[4]=i[4]*o,n[5]=i[5]*o,n[6]=i[6]*o,n[8]=i[8]*a,n[9]=i[9]*a,n[10]=i[10]*a,this}}(),makeRotationFromEuler:function(t){t instanceof THREE.Euler==!1&&console.error("THREE.Matrix: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var e=this.elements,n=t.x,i=t.y,r=t.z,o=Math.cos(n),a=Math.sin(n),s=Math.cos(i),c=Math.sin(i),l=Math.cos(r),u=Math.sin(r);if("XYZ"===t.order){var h=o*l,p=o*u,d=a*l,f=a*u;e[0]=s*l,e[4]=-s*u,e[8]=c,e[1]=p+d*c,e[5]=h-f*c,e[9]=-a*s,e[2]=f-h*c,e[6]=d+p*c,e[10]=o*s}else if("YXZ"===t.order){var m=s*l,v=s*u,g=c*l,y=c*u;e[0]=m+y*a,e[4]=g*a-v,e[8]=o*c,e[1]=o*u,e[5]=o*l,e[9]=-a,e[2]=v*a-g,e[6]=y+m*a,e[10]=o*s}else if("ZXY"===t.order){var m=s*l,v=s*u,g=c*l,y=c*u;e[0]=m-y*a,e[4]=-o*u,e[8]=g+v*a,e[1]=v+g*a,e[5]=o*l,e[9]=y-m*a,e[2]=-o*c,e[6]=a,e[10]=o*s}else if("ZYX"===t.order){var h=o*l,p=o*u,d=a*l,f=a*u;e[0]=s*l,e[4]=d*c-p,e[8]=h*c+f,e[1]=s*u,e[5]=f*c+h,e[9]=p*c-d,e[2]=-c,e[6]=a*s,e[10]=o*s}else if("YZX"===t.order){var E=o*s,_=o*c,T=a*s,b=a*c;e[0]=s*l,e[4]=b-E*u,e[8]=T*u+_,e[1]=u,e[5]=o*l,e[9]=-a*l,e[2]=-c*l,e[6]=_*u+T,e[10]=E-b*u}else if("XZY"===t.order){var E=o*s,_=o*c,T=a*s,b=a*c;e[0]=s*l,e[4]=-u,e[8]=c*l,e[1]=E*u+b,e[5]=o*l,e[9]=_*u-T,e[2]=T*u-_,e[6]=a*l,e[10]=b*u+E}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},makeRotationFromQuaternion:function(t){var e=this.elements,n=t.x,i=t.y,r=t.z,o=t.w,a=n+n,s=i+i,c=r+r,l=n*a,u=n*s,h=n*c,p=i*s,d=i*c,f=r*c,m=o*a,v=o*s,g=o*c;return e[0]=1-(p+f),e[4]=u-g,e[8]=h+v,e[1]=u+g,e[5]=1-(l+f),e[9]=d-m,e[2]=h-v,e[6]=d+m,e[10]=1-(l+p),e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},lookAt:function(){var t,e,n;return function(i,r,o){void 0===t&&(t=new THREE.Vector3),void 0===e&&(e=new THREE.Vector3),void 0===n&&(n=new THREE.Vector3);var a=this.elements;return n.subVectors(i,r).normalize(),0===n.lengthSq()&&(n.z=1),t.crossVectors(o,n).normalize(),0===t.lengthSq()&&(n.x+=1e-4,t.crossVectors(o,n).normalize()),e.crossVectors(n,t),a[0]=t.x,a[4]=e.x,a[8]=n.x,a[1]=t.y,a[5]=e.y,a[9]=n.y,a[2]=t.z,a[6]=e.z,a[10]=n.z,this}}(),multiply:function(t,e){return void 0!==e?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,e)):this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var n=t.elements,i=e.elements,r=this.elements,o=n[0],a=n[4],s=n[8],c=n[12],l=n[1],u=n[5],h=n[9],p=n[13],d=n[2],f=n[6],m=n[10],v=n[14],g=n[3],y=n[7],E=n[11],_=n[15],T=i[0],b=i[4],w=i[8],R=i[12],x=i[1],H=i[5],M=i[9],S=i[13],C=i[2],A=i[6],P=i[10],L=i[14],O=i[3],j=i[7],k=i[11],I=i[15];return r[0]=o*T+a*x+s*C+c*O,r[4]=o*b+a*H+s*A+c*j,r[8]=o*w+a*M+s*P+c*k,r[12]=o*R+a*S+s*L+c*I,r[1]=l*T+u*x+h*C+p*O,r[5]=l*b+u*H+h*A+p*j,r[9]=l*w+u*M+h*P+p*k,r[13]=l*R+u*S+h*L+p*I,r[2]=d*T+f*x+m*C+v*O,r[6]=d*b+f*H+m*A+v*j,r[10]=d*w+f*M+m*P+v*k,r[14]=d*R+f*S+m*L+v*I,r[3]=g*T+y*x+E*C+_*O,r[7]=g*b+y*H+E*A+_*j,r[11]=g*w+y*M+E*P+_*k,r[15]=g*R+y*S+E*L+_*I,this},multiplyToArray:function(t,e,n){var i=this.elements;return this.multiplyMatrices(t,e),n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=i[3],n[4]=i[4],n[5]=i[5],n[6]=i[6],n[7]=i[7],n[8]=i[8],n[9]=i[9],n[10]=i[10],n[11]=i[11],n[12]=i[12],n[13]=i[13],n[14]=i[14],n[15]=i[15],this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this},applyToVector3Array:function(){var t;return function(e,n,i){void 0===t&&(t=new THREE.Vector3),void 0===n&&(n=0),void 0===i&&(i=e.length);for(var r=0,o=n;r<i;r+=3,o+=3)t.fromArray(e,o),t.applyMatrix4(this),t.toArray(e,o);return e}}(),applyToBuffer:function(){var t;return function(e,n,i){void 0===t&&(t=new THREE.Vector3),void 0===n&&(n=0),void 0===i&&(i=e.length/e.itemSize);for(var r=0,o=n;r<i;r++,o++)t.x=e.getX(o),t.y=e.getY(o),t.z=e.getZ(o),t.applyMatrix4(this),e.setXYZ(t.x,t.y,t.z);return e}}(),determinant:function(){var t=this.elements,e=t[0],n=t[4],i=t[8],r=t[12],o=t[1],a=t[5],s=t[9],c=t[13],l=t[2],u=t[6],h=t[10],p=t[14],d=t[3],f=t[7],m=t[11],v=t[15];return d*(+r*s*u-i*c*u-r*a*h+n*c*h+i*a*p-n*s*p)+f*(+e*s*p-e*c*h+r*o*h-i*o*p+i*c*l-r*s*l)+m*(+e*c*u-e*a*p-r*o*u+n*o*p+r*a*l-n*c*l)+v*(-i*a*l-e*s*u+e*a*h+i*o*u-n*o*h+n*s*l)},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this},flattenToArrayOffset:function(t,e){return console.warn("THREE.Matrix3: .flattenToArrayOffset is deprecated - just use .toArray instead."),this.toArray(t,e)},getPosition:function(){var t;return function(){return void 0===t&&(t=new THREE.Vector3),console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),t.setFromMatrixColumn(this,3)}}(),setPosition:function(t){var e=this.elements;return e[12]=t.x,e[13]=t.y,e[14]=t.z,this},getInverse:function(t,e){var n=this.elements,i=t.elements,r=i[0],o=i[1],a=i[2],s=i[3],c=i[4],l=i[5],u=i[6],h=i[7],p=i[8],d=i[9],f=i[10],m=i[11],v=i[12],g=i[13],y=i[14],E=i[15],_=d*y*h-g*f*h+g*u*m-l*y*m-d*u*E+l*f*E,T=v*f*h-p*y*h-v*u*m+c*y*m+p*u*E-c*f*E,b=p*g*h-v*d*h+v*l*m-c*g*m-p*l*E+c*d*E,w=v*d*u-p*g*u-v*l*f+c*g*f+p*l*y-c*d*y,R=r*_+o*T+a*b+s*w;if(0===R){var x="THREE.Matrix4.getInverse(): can't invert matrix, determinant is 0";if(e)throw new Error(x);return console.warn(x),this.identity()}return n[0]=_,n[1]=g*f*s-d*y*s-g*a*m+o*y*m+d*a*E-o*f*E,n[2]=l*y*s-g*u*s+g*a*h-o*y*h-l*a*E+o*u*E,n[3]=d*u*s-l*f*s-d*a*h+o*f*h+l*a*m-o*u*m,n[4]=T,n[5]=p*y*s-v*f*s+v*a*m-r*y*m-p*a*E+r*f*E,n[6]=v*u*s-c*y*s-v*a*h+r*y*h+c*a*E-r*u*E,n[7]=c*f*s-p*u*s+p*a*h-r*f*h-c*a*m+r*u*m,n[8]=b,n[9]=v*d*s-p*g*s-v*o*m+r*g*m+p*o*E-r*d*E,n[10]=c*g*s-v*l*s+v*o*h-r*g*h-c*o*E+r*l*E,n[11]=p*l*s-c*d*s-p*o*h+r*d*h+c*o*m-r*l*m,n[12]=w,n[13]=p*g*a-v*d*a+v*o*f-r*g*f-p*o*y+r*d*y,n[14]=v*l*a-c*g*a-v*o*u+r*g*u+c*o*y-r*l*y,n[15]=c*d*a-p*l*a+p*o*u-r*d*u-c*o*f+r*l*f,this.multiplyScalar(1/R)},scale:function(t){var e=this.elements,n=t.x,i=t.y,r=t.z;return e[0]*=n,e[4]*=i,e[8]*=r,e[1]*=n,e[5]*=i,e[9]*=r,e[2]*=n,e[6]*=i,e[10]*=r,e[3]*=n,e[7]*=i,e[11]*=r,this},getMaxScaleOnAxis:function(){var t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],n=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],i=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,n,i))},makeTranslation:function(t,e,n){return this.set(1,0,0,t,0,1,0,e,0,0,1,n,0,0,0,1),this},makeRotationX:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(1,0,0,0,0,e,-n,0,0,n,e,0,0,0,0,1),this},makeRotationY:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(e,0,n,0,0,1,0,0,-n,0,e,0,0,0,0,1),this},makeRotationZ:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(e,-n,0,0,n,e,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(t,e){var n=Math.cos(e),i=Math.sin(e),r=1-n,o=t.x,a=t.y,s=t.z,c=r*o,l=r*a;return this.set(c*o+n,c*a-i*s,c*s+i*a,0,c*a+i*s,l*a+n,l*s-i*o,0,c*s-i*a,l*s+i*o,r*s*s+n,0,0,0,0,1),this},makeScale:function(t,e,n){return this.set(t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1),this},compose:function(t,e,n){return this.makeRotationFromQuaternion(e),this.scale(n),this.setPosition(t),this},decompose:function(){var t,e;return function(n,i,r){void 0===t&&(t=new THREE.Vector3),void 0===e&&(e=new THREE.Matrix4);var o=this.elements,a=t.set(o[0],o[1],o[2]).length(),s=t.set(o[4],o[5],o[6]).length(),c=t.set(o[8],o[9],o[10]).length(),l=this.determinant();l<0&&(a=-a),n.x=o[12],n.y=o[13],n.z=o[14],e.elements.set(this.elements);var u=1/a,h=1/s,p=1/c;return e.elements[0]*=u,e.elements[1]*=u,e.elements[2]*=u,e.elements[4]*=h,e.elements[5]*=h,e.elements[6]*=h,e.elements[8]*=p,e.elements[9]*=p,e.elements[10]*=p,i.setFromRotationMatrix(e),r.x=a,r.y=s,r.z=c,this}}(),makeFrustum:function(t,e,n,i,r,o){var a=this.elements,s=2*r/(e-t),c=2*r/(i-n),l=(e+t)/(e-t),u=(i+n)/(i-n),h=-(o+r)/(o-r),p=-2*o*r/(o-r);return a[0]=s,a[4]=0,a[8]=l,a[12]=0,a[1]=0,a[5]=c,a[9]=u,a[13]=0,a[2]=0,a[6]=0,a[10]=h,a[14]=p,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this},makePerspective:function(t,e,n,i){var r=n*Math.tan(THREE.Math.DEG2RAD*t*.5),o=-r,a=o*e,s=r*e;return this.makeFrustum(a,s,o,r,n,i)},makeOrthographic:function(t,e,n,i,r,o){var a=this.elements,s=1/(e-t),c=1/(n-i),l=1/(o-r),u=(e+t)*s,h=(n+i)*c,p=(o+r)*l;return a[0]=2*s,a[4]=0,a[8]=0,a[12]=-u,a[1]=0,a[5]=2*c,a[9]=0,a[13]=-h,a[2]=0,a[6]=0,a[10]=-2*l,a[14]=-p,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this},equals:function(t){for(var e=this.elements,n=t.elements,i=0;i<16;i++)if(e[i]!==n[i])return!1;return!0},fromArray:function(t){return this.elements.set(t),this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t[e+9]=n[9],t[e+10]=n[10],t[e+11]=n[11],t[e+12]=n[12],t[e+13]=n[13],t[e+14]=n[14],t[e+15]=n[15],t}},THREE.Ray=function(t,e){this.origin=void 0!==t?t:new THREE.Vector3,this.direction=void 0!==e?e:new THREE.Vector3},THREE.Ray.prototype={constructor:THREE.Ray,set:function(t,e){return this.origin.copy(t),this.direction.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this},at:function(t,e){var n=e||new THREE.Vector3;return n.copy(this.direction).multiplyScalar(t).add(this.origin)},lookAt:function(t){this.direction.copy(t).sub(this.origin).normalize()},recast:function(){var t=new THREE.Vector3;return function(e){return this.origin.copy(this.at(e,t)),this}}(),closestPointToPoint:function(t,e){var n=e||new THREE.Vector3;n.subVectors(t,this.origin);var i=n.dot(this.direction);return i<0?n.copy(this.origin):n.copy(this.direction).multiplyScalar(i).add(this.origin)},distanceToPoint:function(t){return Math.sqrt(this.distanceSqToPoint(t))},distanceSqToPoint:function(){var t=new THREE.Vector3;return function(e){var n=t.subVectors(e,this.origin).dot(this.direction);return n<0?this.origin.distanceToSquared(e):(t.copy(this.direction).multiplyScalar(n).add(this.origin),t.distanceToSquared(e))}}(),distanceSqToSegment:function(){var t=new THREE.Vector3,e=new THREE.Vector3,n=new THREE.Vector3;return function(i,r,o,a){t.copy(i).add(r).multiplyScalar(.5),e.copy(r).sub(i).normalize(),n.copy(this.origin).sub(t);var s,c,l,u,h=.5*i.distanceTo(r),p=-this.direction.dot(e),d=n.dot(this.direction),f=-n.dot(e),m=n.lengthSq(),v=Math.abs(1-p*p);if(v>0)if(s=p*f-d,c=p*d-f,u=h*v,s>=0)if(c>=-u)if(c<=u){var g=1/v;s*=g,c*=g,l=s*(s+p*c+2*d)+c*(p*s+c+2*f)+m}else c=h,s=Math.max(0,-(p*c+d)),l=-s*s+c*(c+2*f)+m;else c=-h,s=Math.max(0,-(p*c+d)),l=-s*s+c*(c+2*f)+m;else c<=-u?(s=Math.max(0,-(-p*h+d)),c=s>0?-h:Math.min(Math.max(-h,-f),h),l=-s*s+c*(c+2*f)+m):c<=u?(s=0,c=Math.min(Math.max(-h,-f),h),l=c*(c+2*f)+m):(s=Math.max(0,-(p*h+d)),c=s>0?h:Math.min(Math.max(-h,-f),h),l=-s*s+c*(c+2*f)+m);else c=p>0?-h:h,s=Math.max(0,-(p*c+d)),l=-s*s+c*(c+2*f)+m;return o&&o.copy(this.direction).multiplyScalar(s).add(this.origin),a&&a.copy(e).multiplyScalar(c).add(t),l}}(),intersectSphere:function(){var t=new THREE.Vector3;return function(e,n){t.subVectors(e.center,this.origin);var i=t.dot(this.direction),r=t.dot(t)-i*i,o=e.radius*e.radius;if(r>o)return null;var a=Math.sqrt(o-r),s=i-a,c=i+a;return s<0&&c<0?null:s<0?this.at(c,n):this.at(s,n)}}(),intersectsSphere:function(t){return this.distanceToPoint(t.center)<=t.radius},distanceToPlane:function(t){var e=t.normal.dot(this.direction);if(0===e)return 0===t.distanceToPoint(this.origin)?0:null;var n=-(this.origin.dot(t.normal)+t.constant)/e;return n>=0?n:null},intersectPlane:function(t,e){var n=this.distanceToPlane(t);return null===n?null:this.at(n,e)},intersectsPlane:function(t){var e=t.distanceToPoint(this.origin);if(0===e)return!0;var n=t.normal.dot(this.direction);return n*e<0},intersectBox:function(t,e){var n,i,r,o,a,s,c=1/this.direction.x,l=1/this.direction.y,u=1/this.direction.z,h=this.origin;return c>=0?(n=(t.min.x-h.x)*c,i=(t.max.x-h.x)*c):(n=(t.max.x-h.x)*c,i=(t.min.x-h.x)*c),l>=0?(r=(t.min.y-h.y)*l,o=(t.max.y-h.y)*l):(r=(t.max.y-h.y)*l,o=(t.min.y-h.y)*l),n>o||r>i?null:((r>n||n!==n)&&(n=r),(o<i||i!==i)&&(i=o),u>=0?(a=(t.min.z-h.z)*u,s=(t.max.z-h.z)*u):(a=(t.max.z-h.z)*u,s=(t.min.z-h.z)*u),n>s||a>i?null:((a>n||n!==n)&&(n=a),(s<i||i!==i)&&(i=s),i<0?null:this.at(n>=0?n:i,e)))},intersectsBox:function(){var t=new THREE.Vector3;return function(e){return null!==this.intersectBox(e,t)}}(),intersectTriangle:function(){var t=new THREE.Vector3,e=new THREE.Vector3,n=new THREE.Vector3,i=new THREE.Vector3;return function(r,o,a,s,c){e.subVectors(o,r),n.subVectors(a,r),i.crossVectors(e,n);var l,u=this.direction.dot(i);if(u>0){if(s)return null;l=1}else{if(!(u<0))return null;l=-1,u=-u}t.subVectors(this.origin,r);var h=l*this.direction.dot(n.crossVectors(t,n));if(h<0)return null;var p=l*this.direction.dot(e.cross(t));if(p<0)return null;if(h+p>u)return null;var d=-l*t.dot(i);return d<0?null:this.at(d/u,c)}}(),applyMatrix4:function(t){return this.direction.add(this.origin).applyMatrix4(t),this.origin.applyMatrix4(t),this.direction.sub(this.origin),this.direction.normalize(),this},equals:function(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}},THREE.Sphere=function(t,e){this.center=void 0!==t?t:new THREE.Vector3,this.radius=void 0!==e?e:0},THREE.Sphere.prototype={constructor:THREE.Sphere,set:function(t,e){return this.center.copy(t),this.radius=e,this},setFromPoints:function(){var t=new THREE.Box3;return function(e,n){var i=this.center;void 0!==n?i.copy(n):t.setFromPoints(e).center(i);for(var r=0,o=0,a=e.length;o<a;o++)r=Math.max(r,i.distanceToSquared(e[o]));return this.radius=Math.sqrt(r),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.center.copy(t.center),this.radius=t.radius,this},empty:function(){return this.radius<=0},containsPoint:function(t){return t.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(t){return t.distanceTo(this.center)-this.radius},intersectsSphere:function(t){var e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e},intersectsBox:function(t){return t.intersectsSphere(this)},intersectsPlane:function(t){return Math.abs(this.center.dot(t.normal)-t.constant)<=this.radius},clampPoint:function(t,e){var n=this.center.distanceToSquared(t),i=e||new THREE.Vector3;return i.copy(t),n>this.radius*this.radius&&(i.sub(this.center).normalize(),i.multiplyScalar(this.radius).add(this.center)),i},getBoundingBox:function(t){var e=t||new THREE.Box3;return e.set(this.center,this.center),e.expandByScalar(this.radius),e},applyMatrix4:function(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this},translate:function(t){return this.center.add(t),this},equals:function(t){return t.center.equals(this.center)&&t.radius===this.radius}},THREE.Frustum=function(t,e,n,i,r,o){this.planes=[void 0!==t?t:new THREE.Plane,void 0!==e?e:new THREE.Plane,void 0!==n?n:new THREE.Plane,void 0!==i?i:new THREE.Plane,void 0!==r?r:new THREE.Plane,void 0!==o?o:new THREE.Plane]},THREE.Frustum.prototype={constructor:THREE.Frustum,set:function(t,e,n,i,r,o){var a=this.planes;return a[0].copy(t),a[1].copy(e),a[2].copy(n),a[3].copy(i),a[4].copy(r),a[5].copy(o),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){for(var e=this.planes,n=0;n<6;n++)e[n].copy(t.planes[n]);return this},setFromMatrix:function(t){var e=this.planes,n=t.elements,i=n[0],r=n[1],o=n[2],a=n[3],s=n[4],c=n[5],l=n[6],u=n[7],h=n[8],p=n[9],d=n[10],f=n[11],m=n[12],v=n[13],g=n[14],y=n[15];return e[0].setComponents(a-i,u-s,f-h,y-m).normalize(),e[1].setComponents(a+i,u+s,f+h,y+m).normalize(),e[2].setComponents(a+r,u+c,f+p,y+v).normalize(),e[3].setComponents(a-r,u-c,f-p,y-v).normalize(),e[4].setComponents(a-o,u-l,f-d,y-g).normalize(),e[5].setComponents(a+o,u+l,f+d,y+g).normalize(),this},intersectsObject:function(){var t=new THREE.Sphere;return function(e){var n=e.geometry;return null===n.boundingSphere&&n.computeBoundingSphere(),t.copy(n.boundingSphere),t.applyMatrix4(e.matrixWorld),this.intersectsSphere(t)}}(),intersectsSphere:function(t){for(var e=this.planes,n=t.center,i=-t.radius,r=0;r<6;r++){var o=e[r].distanceToPoint(n);if(o<i)return!1}return!0},intersectsBox:function(){var t=new THREE.Vector3,e=new THREE.Vector3;return function(n){for(var i=this.planes,r=0;r<6;r++){var o=i[r];t.x=o.normal.x>0?n.min.x:n.max.x,e.x=o.normal.x>0?n.max.x:n.min.x,t.y=o.normal.y>0?n.min.y:n.max.y,e.y=o.normal.y>0?n.max.y:n.min.y,t.z=o.normal.z>0?n.min.z:n.max.z,e.z=o.normal.z>0?n.max.z:n.min.z;var a=o.distanceToPoint(t),s=o.distanceToPoint(e);if(a<0&&s<0)return!1}return!0}}(),containsPoint:function(t){for(var e=this.planes,n=0;n<6;n++)if(e[n].distanceToPoint(t)<0)return!1;return!0}},THREE.Plane=function(t,e){this.normal=void 0!==t?t:new THREE.Vector3(1,0,0),this.constant=void 0!==e?e:0},THREE.Plane.prototype={constructor:THREE.Plane,set:function(t,e){return this.normal.copy(t),this.constant=e,this},setComponents:function(t,e,n,i){return this.normal.set(t,e,n),this.constant=i,this},setFromNormalAndCoplanarPoint:function(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this},setFromCoplanarPoints:function(){var t=new THREE.Vector3,e=new THREE.Vector3;return function(n,i,r){var o=t.subVectors(r,i).cross(e.subVectors(n,i)).normalize();return this.setFromNormalAndCoplanarPoint(o,n),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.normal.copy(t.normal),this.constant=t.constant,this},normalize:function(){var t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(t){return this.normal.dot(t)+this.constant},distanceToSphere:function(t){return this.distanceToPoint(t.center)-t.radius},projectPoint:function(t,e){return this.orthoPoint(t,e).sub(t).negate()},orthoPoint:function(t,e){var n=this.distanceToPoint(t),i=e||new THREE.Vector3;return i.copy(this.normal).multiplyScalar(n)},intersectLine:function(){var t=new THREE.Vector3;return function(e,n){var i=n||new THREE.Vector3,r=e.delta(t),o=this.normal.dot(r);if(0!==o){var a=-(e.start.dot(this.normal)+this.constant)/o;if(!(a<0||a>1))return i.copy(r).multiplyScalar(a).add(e.start)}else if(0===this.distanceToPoint(e.start))return i.copy(e.start)}}(),intersectsLine:function(t){var e=this.distanceToPoint(t.start),n=this.distanceToPoint(t.end);return e<0&&n>0||n<0&&e>0},intersectsBox:function(t){return t.intersectsPlane(this)},intersectsSphere:function(t){return t.intersectsPlane(this)},coplanarPoint:function(t){var e=t||new THREE.Vector3;return e.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var t=new THREE.Vector3,e=new THREE.Matrix3;return function(n,i){var r=this.coplanarPoint(t).applyMatrix4(n),o=i||e.getNormalMatrix(n),a=this.normal.applyMatrix3(o).normalize();return this.constant=-r.dot(a),this}}(),translate:function(t){return this.constant=this.constant-t.dot(this.normal),this},equals:function(t){return t.normal.equals(this.normal)&&t.constant===this.constant}},THREE.Spherical=function(t,e,n){return this.radius=void 0!==t?t:1,this.phi=void 0!==e?e:0,this.theta=void 0!==n?n:0,this},THREE.Spherical.prototype={constructor:THREE.Spherical,set:function(t,e,n){this.radius=t,this.phi=e,this.theta=n},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.radius.copy(t.radius),this.phi.copy(t.phi),this.theta.copy(t.theta),this},makeSafe:function(){var t=1e-6;this.phi=Math.max(t,Math.min(Math.PI-t,this.phi))},setFromVector3:function(t){return this.radius=t.length(),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(t.x,t.z),this.phi=Math.acos(THREE.Math.clamp(t.y/this.radius,-1,1))),this}},THREE.Math={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var t,e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),n=new Array(36),i=0;return function(){for(var r=0;r<36;r++)8===r||13===r||18===r||23===r?n[r]="-":14===r?n[r]="4":(i<=2&&(i=33554432+16777216*Math.random()|0),t=15&i,i>>=4,n[r]=e[19===r?3&t|8:t]);return n.join("")}}(),clamp:function(t,e,n){return Math.max(e,Math.min(n,t))},euclideanModulo:function(t,e){return(t%e+e)%e},mapLinear:function(t,e,n,i,r){return i+(t-e)*(r-i)/(n-e)},smoothstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e),t*t*(3-2*t))},smootherstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e),t*t*t*(t*(6*t-15)+10))},random16:function(){return console.warn("THREE.Math.random16() has been deprecated. Use Math.random() instead."),Math.random()},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},degToRad:function(t){return t*THREE.Math.DEG2RAD},radToDeg:function(t){return t*THREE.Math.RAD2DEG},isPowerOfTwo:function(t){return 0===(t&t-1)&&0!==t},nearestPowerOfTwo:function(t){return Math.pow(2,Math.round(Math.log(t)/Math.LN2))},nextPowerOfTwo:function(t){return t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,t++,t}},THREE.Spline=function(t){function e(t,e,n,i,r,o,a){var s=.5*(n-t),c=.5*(i-e);return(2*(e-n)+s+c)*a+(-3*(e-n)-2*s-c)*o+s*r+e}this.points=t;var n,i,r,o,a,s,c,l,u,h=[],p={x:0,y:0,z:0};this.initFromArray=function(t){this.points=[];for(var e=0;e<t.length;e++)this.points[e]={x:t[e][0],y:t[e][1],z:t[e][2]}},this.getPoint=function(t){return n=(this.points.length-1)*t,i=Math.floor(n),r=n-i,h[0]=0===i?i:i-1,h[1]=i,h[2]=i>this.points.length-2?this.points.length-1:i+1,h[3]=i>this.points.length-3?this.points.length-1:i+2,s=this.points[h[0]],c=this.points[h[1]],l=this.points[h[2]],u=this.points[h[3]],o=r*r,a=r*o,p.x=e(s.x,c.x,l.x,u.x,r,o,a),p.y=e(s.y,c.y,l.y,u.y,r,o,a),p.z=e(s.z,c.z,l.z,u.z,r,o,a),p},this.getControlPointsArray=function(){var t,e,n=this.points.length,i=[];for(t=0;t<n;t++)e=this.points[t],i[t]=[e.x,e.y,e.z];return i},this.getLength=function(t){var e,n,i,r,o=0,a=0,s=0,c=new THREE.Vector3,l=new THREE.Vector3,u=[],h=0;for(u[0]=0,t||(t=100),i=this.points.length*t,c.copy(this.points[0]),e=1;e<i;e++)n=e/i,r=this.getPoint(n),l.copy(r),h+=l.distanceTo(c),c.copy(r),o=(this.points.length-1)*n,a=Math.floor(o),a!==s&&(u[a]=h,s=a);return u[u.length]=h,{chunks:u,total:h}},this.reparametrizeByArcLength=function(t){var e,n,i,r,o,a,s,c,l=[],u=new THREE.Vector3,h=this.getLength();for(l.push(u.copy(this.points[0]).clone()),e=1;e<this.points.length;e++){for(a=h.chunks[e]-h.chunks[e-1],s=Math.ceil(t*a/h.total),r=(e-1)/(this.points.length-1),o=e/(this.points.length-1),n=1;n<s-1;n++)i=r+n*(1/s)*(o-r),c=this.getPoint(i),l.push(u.copy(c).clone());l.push(u.copy(this.points[e]).clone())}this.points=l}},THREE.Triangle=function(t,e,n){this.a=void 0!==t?t:new THREE.Vector3,this.b=void 0!==e?e:new THREE.Vector3,this.c=void 0!==n?n:new THREE.Vector3},THREE.Triangle.normal=function(){var t=new THREE.Vector3;return function(e,n,i,r){var o=r||new THREE.Vector3;o.subVectors(i,n),t.subVectors(e,n),o.cross(t);var a=o.lengthSq();return a>0?o.multiplyScalar(1/Math.sqrt(a)):o.set(0,0,0)}}(),THREE.Triangle.barycoordFromPoint=function(){var t=new THREE.Vector3,e=new THREE.Vector3,n=new THREE.Vector3;return function(i,r,o,a,s){t.subVectors(a,r),e.subVectors(o,r),n.subVectors(i,r);var c=t.dot(t),l=t.dot(e),u=t.dot(n),h=e.dot(e),p=e.dot(n),d=c*h-l*l,f=s||new THREE.Vector3;if(0===d)return f.set(-2,-1,-1);var m=1/d,v=(h*u-l*p)*m,g=(c*p-l*u)*m;return f.set(1-v-g,g,v)}}(),THREE.Triangle.containsPoint=function(){var t=new THREE.Vector3;return function(e,n,i,r){var o=THREE.Triangle.barycoordFromPoint(e,n,i,r,t);return o.x>=0&&o.y>=0&&o.x+o.y<=1}}(),THREE.Triangle.prototype={constructor:THREE.Triangle,set:function(t,e,n){return this.a.copy(t),this.b.copy(e),this.c.copy(n),this},setFromPointsAndIndices:function(t,e,n,i){return this.a.copy(t[e]),this.b.copy(t[n]),this.c.copy(t[i]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this},area:function(){var t=new THREE.Vector3,e=new THREE.Vector3;return function(){return t.subVectors(this.c,this.b),e.subVectors(this.a,this.b),.5*t.cross(e).length()}}(),midpoint:function(t){var e=t||new THREE.Vector3;return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},normal:function(t){
return THREE.Triangle.normal(this.a,this.b,this.c,t)},plane:function(t){var e=t||new THREE.Plane;return e.setFromCoplanarPoints(this.a,this.b,this.c)},barycoordFromPoint:function(t,e){return THREE.Triangle.barycoordFromPoint(t,this.a,this.b,this.c,e)},containsPoint:function(t){return THREE.Triangle.containsPoint(t,this.a,this.b,this.c)},closestPointToPoint:function(){var t,e,n,i;return function(r,o){void 0===t&&(t=new THREE.Plane,e=[new THREE.Line3,new THREE.Line3,new THREE.Line3],n=new THREE.Vector3,i=new THREE.Vector3);var a=o||new THREE.Vector3,s=1/0;if(t.setFromCoplanarPoints(this.a,this.b,this.c),t.projectPoint(r,n),this.containsPoint(n)===!0)a.copy(n);else{e[0].set(this.a,this.b),e[1].set(this.b,this.c),e[2].set(this.c,this.a);for(var c=0;c<e.length;c++){e[c].closestPointToPoint(n,!0,i);var l=n.distanceToSquared(i);l<s&&(s=l,a.copy(i))}}return a}}(),equals:function(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}},THREE.Interpolant=function(t,e,n,i){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==i?i:new e.constructor(n),this.sampleValues=e,this.valueSize=n},THREE.Interpolant.prototype={constructor:THREE.Interpolant,evaluate:function(t){var e=this.parameterPositions,n=this._cachedIndex,i=e[n],r=e[n-1];t:{e:{var o;n:{i:if(!(t<i)){for(var a=n+2;;){if(void 0===i){if(t<r)break i;return n=e.length,this._cachedIndex=n,this.afterEnd_(n-1,t,r)}if(n===a)break;if(r=i,i=e[++n],t<i)break e}o=e.length;break n}{if(t>=r)break t;var s=e[1];t<s&&(n=2,r=s);for(var a=n-2;;){if(void 0===r)return this._cachedIndex=0,this.beforeStart_(0,t,i);if(n===a)break;if(i=r,r=e[--n-1],t>=r)break e}o=n,n=0}}for(;n<o;){var c=n+o>>>1;t<e[c]?o=c:n=c+1}if(i=e[n],r=e[n-1],void 0===r)return this._cachedIndex=0,this.beforeStart_(0,t,i);if(void 0===i)return n=e.length,this._cachedIndex=n,this.afterEnd_(n-1,r,t)}this._cachedIndex=n,this.intervalChanged_(n,r,i)}return this.interpolate_(n,r,t,i)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(t){for(var e=this.resultBuffer,n=this.sampleValues,i=this.valueSize,r=t*i,o=0;o!==i;++o)e[o]=n[r+o];return e},interpolate_:function(t,e,n,i){throw new Error("call to abstract method")},intervalChanged_:function(t,e,n){}},Object.assign(THREE.Interpolant.prototype,{beforeStart_:THREE.Interpolant.prototype.copySampleValue_,afterEnd_:THREE.Interpolant.prototype.copySampleValue_}),THREE.CubicInterpolant=function(t,e,n,i){THREE.Interpolant.call(this,t,e,n,i),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0},THREE.CubicInterpolant.prototype=Object.assign(Object.create(THREE.Interpolant.prototype),{constructor:THREE.CubicInterpolant,DefaultSettings_:{endingStart:THREE.ZeroCurvatureEnding,endingEnd:THREE.ZeroCurvatureEnding},intervalChanged_:function(t,e,n){var i=this.parameterPositions,r=t-2,o=t+1,a=i[r],s=i[o];if(void 0===a)switch(this.getSettings_().endingStart){case THREE.ZeroSlopeEnding:r=t,a=2*e-n;break;case THREE.WrapAroundEnding:r=i.length-2,a=e+i[r]-i[r+1];break;default:r=t,a=n}if(void 0===s)switch(this.getSettings_().endingEnd){case THREE.ZeroSlopeEnding:o=t,s=2*n-e;break;case THREE.WrapAroundEnding:o=1,s=n+i[1]-i[0];break;default:o=t-1,s=e}var c=.5*(n-e),l=this.valueSize;this._weightPrev=c/(e-a),this._weightNext=c/(s-n),this._offsetPrev=r*l,this._offsetNext=o*l},interpolate_:function(t,e,n,i){for(var r=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=t*a,c=s-a,l=this._offsetPrev,u=this._offsetNext,h=this._weightPrev,p=this._weightNext,d=(n-e)/(i-e),f=d*d,m=f*d,v=-h*m+2*h*f-h*d,g=(1+h)*m+(-1.5-2*h)*f+(-.5+h)*d+1,y=(-1-p)*m+(1.5+p)*f+.5*d,E=p*m-p*f,_=0;_!==a;++_)r[_]=v*o[l+_]+g*o[c+_]+y*o[s+_]+E*o[u+_];return r}}),THREE.DiscreteInterpolant=function(t,e,n,i){THREE.Interpolant.call(this,t,e,n,i)},THREE.DiscreteInterpolant.prototype=Object.assign(Object.create(THREE.Interpolant.prototype),{constructor:THREE.DiscreteInterpolant,interpolate_:function(t,e,n,i){return this.copySampleValue_(t-1)}}),THREE.LinearInterpolant=function(t,e,n,i){THREE.Interpolant.call(this,t,e,n,i)},THREE.LinearInterpolant.prototype=Object.assign(Object.create(THREE.Interpolant.prototype),{constructor:THREE.LinearInterpolant,interpolate_:function(t,e,n,i){for(var r=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=t*a,c=s-a,l=(n-e)/(i-e),u=1-l,h=0;h!==a;++h)r[h]=o[c+h]*u+o[s+h]*l;return r}}),THREE.QuaternionLinearInterpolant=function(t,e,n,i){THREE.Interpolant.call(this,t,e,n,i)},THREE.QuaternionLinearInterpolant.prototype=Object.assign(Object.create(THREE.Interpolant.prototype),{constructor:THREE.QuaternionLinearInterpolant,interpolate_:function(t,e,n,i){for(var r=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=t*a,c=(n-e)/(i-e),l=s+a;s!==l;s+=4)THREE.Quaternion.slerpFlat(r,0,o,s-a,o,s,c);return r}}),THREE.Clock=function(t){this.autoStart=void 0===t||t,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1},THREE.Clock.prototype={constructor:THREE.Clock,start:function(){this.startTime=(performance||Date).now(),this.oldTime=this.startTime,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var t=0;if(this.autoStart&&!this.running&&this.start(),this.running){var e=(performance||Date).now();t=(e-this.oldTime)/1e3,this.oldTime=e,this.elapsedTime+=t}return t}},THREE.EventDispatcher=function(){},THREE.EventDispatcher.prototype={constructor:THREE.EventDispatcher,apply:function(t){t.addEventListener=THREE.EventDispatcher.prototype.addEventListener,t.hasEventListener=THREE.EventDispatcher.prototype.hasEventListener,t.removeEventListener=THREE.EventDispatcher.prototype.removeEventListener,t.dispatchEvent=THREE.EventDispatcher.prototype.dispatchEvent},addEventListener:function(t,e){void 0===this._listeners&&(this._listeners={});var n=this._listeners;void 0===n[t]&&(n[t]=[]),n[t].indexOf(e)===-1&&n[t].push(e)},hasEventListener:function(t,e){if(void 0===this._listeners)return!1;var n=this._listeners;return void 0!==n[t]&&n[t].indexOf(e)!==-1},removeEventListener:function(t,e){if(void 0!==this._listeners){var n=this._listeners,i=n[t];if(void 0!==i){var r=i.indexOf(e);r!==-1&&i.splice(r,1)}}},dispatchEvent:function(t){if(void 0!==this._listeners){var e=this._listeners,n=e[t.type];if(void 0!==n){t.target=this;for(var i=[],r=n.length,o=0;o<r;o++)i[o]=n[o];for(var o=0;o<r;o++)i[o].call(this,t)}}}},THREE.Layers=function(){this.mask=1},THREE.Layers.prototype={constructor:THREE.Layers,set:function(t){this.mask=1<<t},enable:function(t){this.mask|=1<<t},toggle:function(t){this.mask^=1<<t},disable:function(t){this.mask&=~(1<<t)},test:function(t){return 0!==(this.mask&t.mask)}},function(t){function e(t,e){return t.distance-e.distance}function n(t,e,i,r){if(t.visible!==!1&&(t.raycast(e,i),r===!0))for(var o=t.children,a=0,s=o.length;a<s;a++)n(o[a],e,i,!0)}t.Raycaster=function(e,n,i,r){this.ray=new t.Ray(e,n),this.near=i||0,this.far=r||1/0,this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})},t.Raycaster.prototype={constructor:t.Raycaster,linePrecision:1,set:function(t,e){this.ray.set(t,e)},setFromCamera:function(e,n){n instanceof t.PerspectiveCamera?(this.ray.origin.setFromMatrixPosition(n.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(n).sub(this.ray.origin).normalize()):n instanceof t.OrthographicCamera?(this.ray.origin.set(e.x,e.y,-1).unproject(n),this.ray.direction.set(0,0,-1).transformDirection(n.matrixWorld)):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(t,i){var r=[];return n(t,this,r,i),r.sort(e),r},intersectObjects:function(t,i){var r=[];if(Array.isArray(t)===!1)return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),r;for(var o=0,a=t.length;o<a;o++)n(t[o],this,r,i);return r.sort(e),r}}}(THREE),THREE.Object3D=function(){function t(){r.setFromEuler(i,!1)}function e(){i.setFromQuaternion(r,void 0,!1)}Object.defineProperty(this,"id",{value:THREE.Object3DIdCount++}),this.uuid=THREE.Math.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=THREE.Object3D.DefaultUp.clone();var n=new THREE.Vector3,i=new THREE.Euler,r=new THREE.Quaternion,o=new THREE.Vector3(1,1,1);i.onChange(t),r.onChange(e),Object.defineProperties(this,{position:{enumerable:!0,value:n},rotation:{enumerable:!0,value:i},quaternion:{enumerable:!0,value:r},scale:{enumerable:!0,value:o},modelViewMatrix:{value:new THREE.Matrix4},normalMatrix:{value:new THREE.Matrix3}}),this.rotationAutoUpdate=!0,this.matrix=new THREE.Matrix4,this.matrixWorld=new THREE.Matrix4,this.matrixAutoUpdate=THREE.Object3D.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new THREE.Layers,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}},THREE.Object3D.DefaultUp=new THREE.Vector3(0,1,0),THREE.Object3D.DefaultMatrixAutoUpdate=!0,THREE.Object3D.prototype={constructor:THREE.Object3D,applyMatrix:function(t){this.matrix.multiplyMatrices(t,this.matrix),this.matrix.decompose(this.position,this.quaternion,this.scale)},setRotationFromAxisAngle:function(t,e){this.quaternion.setFromAxisAngle(t,e)},setRotationFromEuler:function(t){this.quaternion.setFromEuler(t,!0)},setRotationFromMatrix:function(t){this.quaternion.setFromRotationMatrix(t)},setRotationFromQuaternion:function(t){this.quaternion.copy(t)},rotateOnAxis:function(){var t=new THREE.Quaternion;return function(e,n){return t.setFromAxisAngle(e,n),this.quaternion.multiply(t),this}}(),rotateX:function(){var t=new THREE.Vector3(1,0,0);return function(e){return this.rotateOnAxis(t,e)}}(),rotateY:function(){var t=new THREE.Vector3(0,1,0);return function(e){return this.rotateOnAxis(t,e)}}(),rotateZ:function(){var t=new THREE.Vector3(0,0,1);return function(e){return this.rotateOnAxis(t,e)}}(),translateOnAxis:function(){var t=new THREE.Vector3;return function(e,n){return t.copy(e).applyQuaternion(this.quaternion),this.position.add(t.multiplyScalar(n)),this}}(),translateX:function(){var t=new THREE.Vector3(1,0,0);return function(e){return this.translateOnAxis(t,e)}}(),translateY:function(){var t=new THREE.Vector3(0,1,0);return function(e){return this.translateOnAxis(t,e)}}(),translateZ:function(){var t=new THREE.Vector3(0,0,1);return function(e){return this.translateOnAxis(t,e)}}(),localToWorld:function(t){return t.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var t=new THREE.Matrix4;return function(e){return e.applyMatrix4(t.getInverse(this.matrixWorld))}}(),lookAt:function(){var t=new THREE.Matrix4;return function(e){t.lookAt(e,this.position,this.up),this.quaternion.setFromRotationMatrix(t)}}(),add:function(t){if(arguments.length>1){for(var e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t instanceof THREE.Object3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,t.dispatchEvent({type:"added"}),this.children.push(t)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)},remove:function(t){if(arguments.length>1)for(var e=0;e<arguments.length;e++)this.remove(arguments[e]);var n=this.children.indexOf(t);n!==-1&&(t.parent=null,t.dispatchEvent({type:"removed"}),this.children.splice(n,1))},getObjectById:function(t){return this.getObjectByProperty("id",t)},getObjectByName:function(t){return this.getObjectByProperty("name",t)},getObjectByProperty:function(t,e){if(this[t]===e)return this;for(var n=0,i=this.children.length;n<i;n++){var r=this.children[n],o=r.getObjectByProperty(t,e);if(void 0!==o)return o}},getWorldPosition:function(t){var e=t||new THREE.Vector3;return this.updateMatrixWorld(!0),e.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(){var t=new THREE.Vector3,e=new THREE.Vector3;return function(n){var i=n||new THREE.Quaternion;return this.updateMatrixWorld(!0),this.matrixWorld.decompose(t,i,e),i}}(),getWorldRotation:function(){var t=new THREE.Quaternion;return function(e){var n=e||new THREE.Euler;return this.getWorldQuaternion(t),n.setFromQuaternion(t,this.rotation.order,!1)}}(),getWorldScale:function(){var t=new THREE.Vector3,e=new THREE.Quaternion;return function(n){var i=n||new THREE.Vector3;return this.updateMatrixWorld(!0),this.matrixWorld.decompose(t,e,i),i}}(),getWorldDirection:function(){var t=new THREE.Quaternion;return function(e){var n=e||new THREE.Vector3;return this.getWorldQuaternion(t),n.set(0,0,1).applyQuaternion(t)}}(),raycast:function(){},traverse:function(t){t(this);for(var e=this.children,n=0,i=e.length;n<i;n++)e[n].traverse(t)},traverseVisible:function(t){if(this.visible!==!1){t(this);for(var e=this.children,n=0,i=e.length;n<i;n++)e[n].traverseVisible(t)}},traverseAncestors:function(t){var e=this.parent;null!==e&&(t(e),e.traverseAncestors(t))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(t){this.matrixAutoUpdate===!0&&this.updateMatrix(),this.matrixWorldNeedsUpdate!==!0&&t!==!0||(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);for(var e=0,n=this.children.length;e<n;e++)this.children[e].updateMatrixWorld(t)},toJSON:function(t){function e(t){var e=[];for(var n in t){var i=t[n];delete i.metadata,e.push(i)}return e}var n=void 0===t||""===t,i={};n&&(t={geometries:{},materials:{},textures:{},images:{}},i.metadata={version:4.4,type:"Object",generator:"Object3D.toJSON"});var r={};if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),this.castShadow===!0&&(r.castShadow=!0),this.receiveShadow===!0&&(r.receiveShadow=!0),this.visible===!1&&(r.visible=!1),r.matrix=this.matrix.toArray(),void 0!==this.geometry&&(void 0===t.geometries[this.geometry.uuid]&&(t.geometries[this.geometry.uuid]=this.geometry.toJSON(t)),r.geometry=this.geometry.uuid),void 0!==this.material&&(void 0===t.materials[this.material.uuid]&&(t.materials[this.material.uuid]=this.material.toJSON(t)),r.material=this.material.uuid),this.children.length>0){r.children=[];for(var o=0;o<this.children.length;o++)r.children.push(this.children[o].toJSON(t).object)}if(n){var a=e(t.geometries),s=e(t.materials),c=e(t.textures),l=e(t.images);a.length>0&&(i.geometries=a),s.length>0&&(i.materials=s),c.length>0&&(i.textures=c),l.length>0&&(i.images=l)}return i.object=r,i},clone:function(t){return(new this.constructor).copy(this,t)},copy:function(t,e){if(void 0===e&&(e=!0),this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.rotationAutoUpdate=t.rotationAutoUpdate,this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),e===!0)for(var n=0;n<t.children.length;n++){var i=t.children[n];this.add(i.clone())}return this}},THREE.EventDispatcher.prototype.apply(THREE.Object3D.prototype),THREE.Object3DIdCount=0,THREE.Face3=function(t,e,n,i,r,o){this.a=t,this.b=e,this.c=n,this.normal=i instanceof THREE.Vector3?i:new THREE.Vector3,this.vertexNormals=Array.isArray(i)?i:[],this.color=r instanceof THREE.Color?r:new THREE.Color,this.vertexColors=Array.isArray(r)?r:[],this.materialIndex=void 0!==o?o:0},THREE.Face3.prototype={constructor:THREE.Face3,clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.a=t.a,this.b=t.b,this.c=t.c,this.normal.copy(t.normal),this.color.copy(t.color),this.materialIndex=t.materialIndex;for(var e=0,n=t.vertexNormals.length;e<n;e++)this.vertexNormals[e]=t.vertexNormals[e].clone();for(var e=0,n=t.vertexColors.length;e<n;e++)this.vertexColors[e]=t.vertexColors[e].clone();return this}},THREE.BufferAttribute=function(t,e,n){this.uuid=THREE.Math.generateUUID(),this.array=t,this.itemSize=e,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0,this.normalized=n===!0},THREE.BufferAttribute.prototype={constructor:THREE.BufferAttribute,get count(){return this.array.length/this.itemSize},set needsUpdate(t){t===!0&&this.version++},setDynamic:function(t){return this.dynamic=t,this},copy:function(t){return this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.dynamic=t.dynamic,this},copyAt:function(t,e,n){t*=this.itemSize,n*=e.itemSize;for(var i=0,r=this.itemSize;i<r;i++)this.array[t+i]=e.array[n+i];return this},copyArray:function(t){return this.array.set(t),this},copyColorsArray:function(t){for(var e=this.array,n=0,i=0,r=t.length;i<r;i++){var o=t[i];void 0===o&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",i),o=new THREE.Color),e[n++]=o.r,e[n++]=o.g,e[n++]=o.b}return this},copyIndicesArray:function(t){for(var e=this.array,n=0,i=0,r=t.length;i<r;i++){var o=t[i];e[n++]=o.a,e[n++]=o.b,e[n++]=o.c}return this},copyVector2sArray:function(t){for(var e=this.array,n=0,i=0,r=t.length;i<r;i++){var o=t[i];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",i),o=new THREE.Vector2),e[n++]=o.x,e[n++]=o.y}return this},copyVector3sArray:function(t){for(var e=this.array,n=0,i=0,r=t.length;i<r;i++){var o=t[i];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",i),o=new THREE.Vector3),e[n++]=o.x,e[n++]=o.y,e[n++]=o.z}return this},copyVector4sArray:function(t){for(var e=this.array,n=0,i=0,r=t.length;i<r;i++){var o=t[i];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",i),o=new THREE.Vector4),e[n++]=o.x,e[n++]=o.y,e[n++]=o.z,e[n++]=o.w}return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},getX:function(t){return this.array[t*this.itemSize]},setX:function(t,e){return this.array[t*this.itemSize]=e,this},getY:function(t){return this.array[t*this.itemSize+1]},setY:function(t,e){return this.array[t*this.itemSize+1]=e,this},getZ:function(t){return this.array[t*this.itemSize+2]},setZ:function(t,e){return this.array[t*this.itemSize+2]=e,this},getW:function(t){return this.array[t*this.itemSize+3]},setW:function(t,e){return this.array[t*this.itemSize+3]=e,this},setXY:function(t,e,n){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this},setXYZ:function(t,e,n,i){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=i,this},setXYZW:function(t,e,n,i,r){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=i,this.array[t+3]=r,this},clone:function(){return(new this.constructor).copy(this)}},THREE.Int8Attribute=function(t,e){return new THREE.BufferAttribute(new Int8Array(t),e)},THREE.Uint8Attribute=function(t,e){return new THREE.BufferAttribute(new Uint8Array(t),e)};THREE.Uint8ClampedAttribute=function(t,e){return new THREE.BufferAttribute(new Uint8ClampedArray(t),e)};THREE.Int16Attribute=function(t,e){return new THREE.BufferAttribute(new Int16Array(t),e)},THREE.Uint16Attribute=function(t,e){return new THREE.BufferAttribute(new Uint16Array(t),e)},THREE.Int32Attribute=function(t,e){return new THREE.BufferAttribute(new Int32Array(t),e)},THREE.Uint32Attribute=function(t,e){return new THREE.BufferAttribute(new Uint32Array(t),e)},THREE.Float32Attribute=function(t,e){return new THREE.BufferAttribute(new Float32Array(t),e)},THREE.Float64Attribute=function(t,e){return new THREE.BufferAttribute(new Float64Array(t),e)},THREE.DynamicBufferAttribute=function(t,e){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setDynamic( true ) instead."),new THREE.BufferAttribute(t,e).setDynamic(!0)},THREE.InstancedBufferAttribute=function(t,e,n){THREE.BufferAttribute.call(this,t,e),this.meshPerAttribute=n||1},THREE.InstancedBufferAttribute.prototype=Object.create(THREE.BufferAttribute.prototype),THREE.InstancedBufferAttribute.prototype.constructor=THREE.InstancedBufferAttribute,THREE.InstancedBufferAttribute.prototype.copy=function(t){return THREE.BufferAttribute.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this},THREE.InterleavedBuffer=function(t,e){this.uuid=THREE.Math.generateUUID(),this.array=t,this.stride=e,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0},THREE.InterleavedBuffer.prototype={constructor:THREE.InterleavedBuffer,get length(){return this.array.length},get count(){return this.array.length/this.stride},set needsUpdate(t){t===!0&&this.version++},setDynamic:function(t){return this.dynamic=t,this},copy:function(t){return this.array=new t.array.constructor(t.array),this.stride=t.stride,this.dynamic=t.dynamic,this},copyAt:function(t,e,n){t*=this.stride,n*=e.stride;for(var i=0,r=this.stride;i<r;i++)this.array[t+i]=e.array[n+i];return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},clone:function(){return(new this.constructor).copy(this)}},THREE.InstancedInterleavedBuffer=function(t,e,n){THREE.InterleavedBuffer.call(this,t,e),this.meshPerAttribute=n||1},THREE.InstancedInterleavedBuffer.prototype=Object.create(THREE.InterleavedBuffer.prototype),THREE.InstancedInterleavedBuffer.prototype.constructor=THREE.InstancedInterleavedBuffer,THREE.InstancedInterleavedBuffer.prototype.copy=function(t){return THREE.InterleavedBuffer.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this},THREE.InterleavedBufferAttribute=function(t,e,n){this.uuid=THREE.Math.generateUUID(),this.data=t,this.itemSize=e,this.offset=n},THREE.InterleavedBufferAttribute.prototype={constructor:THREE.InterleavedBufferAttribute,get length(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Please use .count."),this.array.length},get count(){return this.data.count},setX:function(t,e){return this.data.array[t*this.data.stride+this.offset]=e,this},setY:function(t,e){return this.data.array[t*this.data.stride+this.offset+1]=e,this},setZ:function(t,e){return this.data.array[t*this.data.stride+this.offset+2]=e,this},setW:function(t,e){return this.data.array[t*this.data.stride+this.offset+3]=e,this},getX:function(t){return this.data.array[t*this.data.stride+this.offset]},getY:function(t){return this.data.array[t*this.data.stride+this.offset+1]},getZ:function(t){return this.data.array[t*this.data.stride+this.offset+2]},getW:function(t){return this.data.array[t*this.data.stride+this.offset+3]},setXY:function(t,e,n){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this},setXYZ:function(t,e,n,i){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=i,this},setXYZW:function(t,e,n,i,r){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=i,this.data.array[t+3]=r,this}},THREE.Geometry=function(){Object.defineProperty(this,"id",{value:THREE.GeometryIdCount++}),this.uuid=THREE.Math.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.elementsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1},THREE.Geometry.prototype={constructor:THREE.Geometry,applyMatrix:function(t){for(var e=(new THREE.Matrix3).getNormalMatrix(t),n=0,i=this.vertices.length;n<i;n++){var r=this.vertices[n];r.applyMatrix4(t)}for(var n=0,i=this.faces.length;n<i;n++){var o=this.faces[n];o.normal.applyMatrix3(e).normalize();for(var a=0,s=o.vertexNormals.length;a<s;a++)o.vertexNormals[a].applyMatrix3(e).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(){var t;return function(e){return void 0===t&&(t=new THREE.Matrix4),t.makeRotationX(e),this.applyMatrix(t),this}}(),rotateY:function(){var t;return function(e){return void 0===t&&(t=new THREE.Matrix4),t.makeRotationY(e),this.applyMatrix(t),this}}(),rotateZ:function(){var t;return function(e){return void 0===t&&(t=new THREE.Matrix4),t.makeRotationZ(e),this.applyMatrix(t),this}}(),translate:function(){var t;return function(e,n,i){return void 0===t&&(t=new THREE.Matrix4),t.makeTranslation(e,n,i),this.applyMatrix(t),this}}(),scale:function(){var t;return function(e,n,i){return void 0===t&&(t=new THREE.Matrix4),t.makeScale(e,n,i),this.applyMatrix(t),this}}(),lookAt:function(){var t;return function(e){void 0===t&&(t=new THREE.Object3D),t.lookAt(e),t.updateMatrix(),this.applyMatrix(t.matrix)}}(),fromBufferGeometry:function(t){function e(t,e,i,r){var o=void 0!==a?[u[t].clone(),u[e].clone(),u[i].clone()]:[],d=void 0!==s?[n.colors[t].clone(),n.colors[e].clone(),n.colors[i].clone()]:[],f=new THREE.Face3(t,e,i,o,d,r);n.faces.push(f),void 0!==c&&n.faceVertexUvs[0].push([h[t].clone(),h[e].clone(),h[i].clone()]),void 0!==l&&n.faceVertexUvs[1].push([p[t].clone(),p[e].clone(),p[i].clone()])}var n=this,i=null!==t.index?t.index.array:void 0,r=t.attributes,o=r.position.array,a=void 0!==r.normal?r.normal.array:void 0,s=void 0!==r.color?r.color.array:void 0,c=void 0!==r.uv?r.uv.array:void 0,l=void 0!==r.uv2?r.uv2.array:void 0;void 0!==l&&(this.faceVertexUvs[1]=[]);for(var u=[],h=[],p=[],d=0,f=0;d<o.length;d+=3,f+=2)n.vertices.push(new THREE.Vector3(o[d],o[d+1],o[d+2])),void 0!==a&&u.push(new THREE.Vector3(a[d],a[d+1],a[d+2])),void 0!==s&&n.colors.push(new THREE.Color(s[d],s[d+1],s[d+2])),void 0!==c&&h.push(new THREE.Vector2(c[f],c[f+1])),void 0!==l&&p.push(new THREE.Vector2(l[f],l[f+1]));if(void 0!==i){var m=t.groups;if(m.length>0)for(var d=0;d<m.length;d++)for(var v=m[d],g=v.start,y=v.count,f=g,E=g+y;f<E;f+=3)e(i[f],i[f+1],i[f+2],v.materialIndex);else for(var d=0;d<i.length;d+=3)e(i[d],i[d+1],i[d+2])}else for(var d=0;d<o.length/3;d+=3)e(d,d+1,d+2);return this.computeFaceNormals(),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),this},center:function(){this.computeBoundingBox();var t=this.boundingBox.center().negate();return this.translate(t.x,t.y,t.z),t},normalize:function(){this.computeBoundingSphere();var t=this.boundingSphere.center,e=this.boundingSphere.radius,n=0===e?1:1/e,i=new THREE.Matrix4;return i.set(n,0,0,-n*t.x,0,n,0,-n*t.y,0,0,n,-n*t.z,0,0,0,1),this.applyMatrix(i),this},computeFaceNormals:function(){for(var t=new THREE.Vector3,e=new THREE.Vector3,n=0,i=this.faces.length;n<i;n++){var r=this.faces[n],o=this.vertices[r.a],a=this.vertices[r.b],s=this.vertices[r.c];t.subVectors(s,a),e.subVectors(o,a),t.cross(e),t.normalize(),r.normal.copy(t)}},computeVertexNormals:function(t){void 0===t&&(t=!0);var e,n,i,r,o,a;for(a=new Array(this.vertices.length),e=0,n=this.vertices.length;e<n;e++)a[e]=new THREE.Vector3;if(t){var s,c,l,u=new THREE.Vector3,h=new THREE.Vector3;for(i=0,r=this.faces.length;i<r;i++)o=this.faces[i],s=this.vertices[o.a],c=this.vertices[o.b],l=this.vertices[o.c],u.subVectors(l,c),h.subVectors(s,c),u.cross(h),a[o.a].add(u),a[o.b].add(u),a[o.c].add(u)}else for(i=0,r=this.faces.length;i<r;i++)o=this.faces[i],a[o.a].add(o.normal),a[o.b].add(o.normal),a[o.c].add(o.normal);for(e=0,n=this.vertices.length;e<n;e++)a[e].normalize();for(i=0,r=this.faces.length;i<r;i++){o=this.faces[i];var p=o.vertexNormals;3===p.length?(p[0].copy(a[o.a]),p[1].copy(a[o.b]),p[2].copy(a[o.c])):(p[0]=a[o.a].clone(),p[1]=a[o.b].clone(),p[2]=a[o.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var t,e,n,i,r;for(n=0,i=this.faces.length;n<i;n++)for(r=this.faces[n],r.__originalFaceNormal?r.__originalFaceNormal.copy(r.normal):r.__originalFaceNormal=r.normal.clone(),r.__originalVertexNormals||(r.__originalVertexNormals=[]),t=0,e=r.vertexNormals.length;t<e;t++)r.__originalVertexNormals[t]?r.__originalVertexNormals[t].copy(r.vertexNormals[t]):r.__originalVertexNormals[t]=r.vertexNormals[t].clone();var o=new THREE.Geometry;for(o.faces=this.faces,t=0,e=this.morphTargets.length;t<e;t++){if(!this.morphNormals[t]){this.morphNormals[t]={},this.morphNormals[t].faceNormals=[],this.morphNormals[t].vertexNormals=[];var a,s,c=this.morphNormals[t].faceNormals,l=this.morphNormals[t].vertexNormals;for(n=0,i=this.faces.length;n<i;n++)a=new THREE.Vector3,s={a:new THREE.Vector3,b:new THREE.Vector3,c:new THREE.Vector3},c.push(a),l.push(s)}var u=this.morphNormals[t];o.vertices=this.morphTargets[t].vertices,o.computeFaceNormals(),o.computeVertexNormals();var a,s;for(n=0,i=this.faces.length;n<i;n++)r=this.faces[n],a=u.faceNormals[n],s=u.vertexNormals[n],a.copy(r.normal),s.a.copy(r.vertexNormals[0]),s.b.copy(r.vertexNormals[1]),s.c.copy(r.vertexNormals[2])}for(n=0,i=this.faces.length;n<i;n++)r=this.faces[n],r.normal=r.__originalFaceNormal,r.vertexNormals=r.__originalVertexNormals},computeTangents:function(){console.warn("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){for(var t=0,e=this.vertices,n=0,i=e.length;n<i;n++)n>0&&(t+=e[n].distanceTo(e[n-1])),this.lineDistances[n]=t},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new THREE.Box3),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new THREE.Sphere),this.boundingSphere.setFromPoints(this.vertices)},merge:function(t,e,n){if(t instanceof THREE.Geometry==!1)return void console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",t);var i,r=this.vertices.length,o=this.vertices,a=t.vertices,s=this.faces,c=t.faces,l=this.faceVertexUvs[0],u=t.faceVertexUvs[0];void 0===n&&(n=0),void 0!==e&&(i=(new THREE.Matrix3).getNormalMatrix(e));for(var h=0,p=a.length;h<p;h++){var d=a[h],f=d.clone();void 0!==e&&f.applyMatrix4(e),o.push(f)}for(h=0,p=c.length;h<p;h++){var m,v,g,y=c[h],E=y.vertexNormals,_=y.vertexColors;m=new THREE.Face3(y.a+r,y.b+r,y.c+r),m.normal.copy(y.normal),void 0!==i&&m.normal.applyMatrix3(i).normalize();for(var T=0,b=E.length;T<b;T++)v=E[T].clone(),void 0!==i&&v.applyMatrix3(i).normalize(),m.vertexNormals.push(v);m.color.copy(y.color);for(var T=0,b=_.length;T<b;T++)g=_[T],m.vertexColors.push(g.clone());m.materialIndex=y.materialIndex+n,s.push(m)}for(h=0,p=u.length;h<p;h++){var w=u[h],R=[];if(void 0!==w){for(var T=0,b=w.length;T<b;T++)R.push(w[T].clone());l.push(R)}}},mergeMesh:function(t){return t instanceof THREE.Mesh==!1?void console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",t):(t.matrixAutoUpdate&&t.updateMatrix(),void this.merge(t.geometry,t.matrix))},mergeVertices:function(){var t,e,n,i,r,o,a,s,c={},l=[],u=[],h=4,p=Math.pow(10,h);for(n=0,i=this.vertices.length;n<i;n++)t=this.vertices[n],e=Math.round(t.x*p)+"_"+Math.round(t.y*p)+"_"+Math.round(t.z*p),void 0===c[e]?(c[e]=n,l.push(this.vertices[n]),u[n]=l.length-1):u[n]=u[c[e]];var d=[];for(n=0,i=this.faces.length;n<i;n++){r=this.faces[n],r.a=u[r.a],r.b=u[r.b],r.c=u[r.c],o=[r.a,r.b,r.c];for(var f=-1,m=0;m<3;m++)if(o[m]===o[(m+1)%3]){f=m,d.push(n);break}}for(n=d.length-1;n>=0;n--){var v=d[n];for(this.faces.splice(v,1),a=0,s=this.faceVertexUvs.length;a<s;a++)this.faceVertexUvs[a].splice(v,1)}var g=this.vertices.length-l.length;return this.vertices=l,g},sortFacesByMaterialIndex:function(){function t(t,e){return t.materialIndex-e.materialIndex}for(var e=this.faces,n=e.length,i=0;i<n;i++)e[i]._id=i;
e.sort(t);var r,o,a=this.faceVertexUvs[0],s=this.faceVertexUvs[1];a&&a.length===n&&(r=[]),s&&s.length===n&&(o=[]);for(var i=0;i<n;i++){var c=e[i]._id;r&&r.push(a[c]),o&&o.push(s[c])}r&&(this.faceVertexUvs[0]=r),o&&(this.faceVertexUvs[1]=o)},toJSON:function(){function t(t,e,n){return n?t|1<<e:t&~(1<<e)}function e(t){var e=t.x.toString()+t.y.toString()+t.z.toString();return void 0!==p[e]?p[e]:(p[e]=h.length/3,h.push(t.x,t.y,t.z),p[e])}function n(t){var e=t.r.toString()+t.g.toString()+t.b.toString();return void 0!==f[e]?f[e]:(f[e]=d.length,d.push(t.getHex()),f[e])}function i(t){var e=t.x.toString()+t.y.toString();return void 0!==v[e]?v[e]:(v[e]=m.length/2,m.push(t.x,t.y),v[e])}var r={metadata:{version:4.4,type:"Geometry",generator:"Geometry.toJSON"}};if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),void 0!==this.parameters){var o=this.parameters;for(var a in o)void 0!==o[a]&&(r[a]=o[a]);return r}for(var s=[],c=0;c<this.vertices.length;c++){var l=this.vertices[c];s.push(l.x,l.y,l.z)}for(var u=[],h=[],p={},d=[],f={},m=[],v={},c=0;c<this.faces.length;c++){var g=this.faces[c],y=!0,E=!1,_=void 0!==this.faceVertexUvs[0][c],T=g.normal.length()>0,b=g.vertexNormals.length>0,w=1!==g.color.r||1!==g.color.g||1!==g.color.b,R=g.vertexColors.length>0,x=0;if(x=t(x,0,0),x=t(x,1,y),x=t(x,2,E),x=t(x,3,_),x=t(x,4,T),x=t(x,5,b),x=t(x,6,w),x=t(x,7,R),u.push(x),u.push(g.a,g.b,g.c),u.push(g.materialIndex),_){var H=this.faceVertexUvs[0][c];u.push(i(H[0]),i(H[1]),i(H[2]))}if(T&&u.push(e(g.normal)),b){var M=g.vertexNormals;u.push(e(M[0]),e(M[1]),e(M[2]))}if(w&&u.push(n(g.color)),R){var S=g.vertexColors;u.push(n(S[0]),n(S[1]),n(S[2]))}}return r.data={},r.data.vertices=s,r.data.normals=h,d.length>0&&(r.data.colors=d),m.length>0&&(r.data.uvs=[m]),r.data.faces=u,r},clone:function(){return(new THREE.Geometry).copy(this)},copy:function(t){this.vertices=[],this.faces=[],this.faceVertexUvs=[[]];for(var e=t.vertices,n=0,i=e.length;n<i;n++)this.vertices.push(e[n].clone());for(var r=t.faces,n=0,i=r.length;n<i;n++)this.faces.push(r[n].clone());for(var n=0,i=t.faceVertexUvs.length;n<i;n++){var o=t.faceVertexUvs[n];void 0===this.faceVertexUvs[n]&&(this.faceVertexUvs[n]=[]);for(var a=0,s=o.length;a<s;a++){for(var c=o[a],l=[],u=0,h=c.length;u<h;u++){var p=c[u];l.push(p.clone())}this.faceVertexUvs[n].push(l)}}return this},dispose:function(){this.dispatchEvent({type:"dispose"})}},THREE.EventDispatcher.prototype.apply(THREE.Geometry.prototype),THREE.GeometryIdCount=0,THREE.DirectGeometry=function(){Object.defineProperty(this,"id",{value:THREE.GeometryIdCount++}),this.uuid=THREE.Math.generateUUID(),this.name="",this.type="DirectGeometry",this.indices=[],this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1},THREE.DirectGeometry.prototype={constructor:THREE.DirectGeometry,computeBoundingBox:THREE.Geometry.prototype.computeBoundingBox,computeBoundingSphere:THREE.Geometry.prototype.computeBoundingSphere,computeFaceNormals:function(){console.warn("THREE.DirectGeometry: computeFaceNormals() is not a method of this type of geometry.")},computeVertexNormals:function(){console.warn("THREE.DirectGeometry: computeVertexNormals() is not a method of this type of geometry.")},computeGroups:function(t){for(var e,n,i=[],r=t.faces,o=0;o<r.length;o++){var a=r[o];a.materialIndex!==n&&(n=a.materialIndex,void 0!==e&&(e.count=3*o-e.start,i.push(e)),e={start:3*o,materialIndex:n})}void 0!==e&&(e.count=3*o-e.start,i.push(e)),this.groups=i},fromGeometry:function(t){var e,n=t.faces,i=t.vertices,r=t.faceVertexUvs,o=r[0]&&r[0].length>0,a=r[1]&&r[1].length>0,s=t.morphTargets,c=s.length;if(c>0){e=[];for(var l=0;l<c;l++)e[l]=[];this.morphTargets.position=e}var u,h=t.morphNormals,p=h.length;if(p>0){u=[];for(var l=0;l<p;l++)u[l]=[];this.morphTargets.normal=u}for(var d=t.skinIndices,f=t.skinWeights,m=d.length===i.length,v=f.length===i.length,l=0;l<n.length;l++){var g=n[l];this.vertices.push(i[g.a],i[g.b],i[g.c]);var y=g.vertexNormals;if(3===y.length)this.normals.push(y[0],y[1],y[2]);else{var E=g.normal;this.normals.push(E,E,E)}var _=g.vertexColors;if(3===_.length)this.colors.push(_[0],_[1],_[2]);else{var T=g.color;this.colors.push(T,T,T)}if(o===!0){var b=r[0][l];void 0!==b?this.uvs.push(b[0],b[1],b[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",l),this.uvs.push(new THREE.Vector2,new THREE.Vector2,new THREE.Vector2))}if(a===!0){var b=r[1][l];void 0!==b?this.uvs2.push(b[0],b[1],b[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",l),this.uvs2.push(new THREE.Vector2,new THREE.Vector2,new THREE.Vector2))}for(var w=0;w<c;w++){var R=s[w].vertices;e[w].push(R[g.a],R[g.b],R[g.c])}for(var w=0;w<p;w++){var x=h[w].vertexNormals[l];u[w].push(x.a,x.b,x.c)}m&&this.skinIndices.push(d[g.a],d[g.b],d[g.c]),v&&this.skinWeights.push(f[g.a],f[g.b],f[g.c])}return this.computeGroups(t),this.verticesNeedUpdate=t.verticesNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}},THREE.EventDispatcher.prototype.apply(THREE.DirectGeometry.prototype),THREE.BufferGeometry=function(){Object.defineProperty(this,"id",{value:THREE.GeometryIdCount++}),this.uuid=THREE.Math.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0}},THREE.BufferGeometry.prototype={constructor:THREE.BufferGeometry,getIndex:function(){return this.index},setIndex:function(t){this.index=t},addAttribute:function(t,e){return e instanceof THREE.BufferAttribute==!1&&e instanceof THREE.InterleavedBufferAttribute==!1?(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),void this.addAttribute(t,new THREE.BufferAttribute(arguments[1],arguments[2]))):"index"===t?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),void this.setIndex(e)):(this.attributes[t]=e,this)},getAttribute:function(t){return this.attributes[t]},removeAttribute:function(t){return delete this.attributes[t],this},addGroup:function(t,e,n){this.groups.push({start:t,count:e,materialIndex:void 0!==n?n:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(t,e){this.drawRange.start=t,this.drawRange.count=e},applyMatrix:function(t){var e=this.attributes.position;void 0!==e&&(t.applyToVector3Array(e.array),e.needsUpdate=!0);var n=this.attributes.normal;if(void 0!==n){var i=(new THREE.Matrix3).getNormalMatrix(t);i.applyToVector3Array(n.array),n.needsUpdate=!0}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(){var t;return function(e){return void 0===t&&(t=new THREE.Matrix4),t.makeRotationX(e),this.applyMatrix(t),this}}(),rotateY:function(){var t;return function(e){return void 0===t&&(t=new THREE.Matrix4),t.makeRotationY(e),this.applyMatrix(t),this}}(),rotateZ:function(){var t;return function(e){return void 0===t&&(t=new THREE.Matrix4),t.makeRotationZ(e),this.applyMatrix(t),this}}(),translate:function(){var t;return function(e,n,i){return void 0===t&&(t=new THREE.Matrix4),t.makeTranslation(e,n,i),this.applyMatrix(t),this}}(),scale:function(){var t;return function(e,n,i){return void 0===t&&(t=new THREE.Matrix4),t.makeScale(e,n,i),this.applyMatrix(t),this}}(),lookAt:function(){var t;return function(e){void 0===t&&(t=new THREE.Object3D),t.lookAt(e),t.updateMatrix(),this.applyMatrix(t.matrix)}}(),center:function(){this.computeBoundingBox();var t=this.boundingBox.center().negate();return this.translate(t.x,t.y,t.z),t},setFromObject:function(t){var e=t.geometry;if(t instanceof THREE.Points||t instanceof THREE.Line){var n=new THREE.Float32Attribute(3*e.vertices.length,3),i=new THREE.Float32Attribute(3*e.colors.length,3);if(this.addAttribute("position",n.copyVector3sArray(e.vertices)),this.addAttribute("color",i.copyColorsArray(e.colors)),e.lineDistances&&e.lineDistances.length===e.vertices.length){var r=new THREE.Float32Attribute(e.lineDistances.length,1);this.addAttribute("lineDistance",r.copyArray(e.lineDistances))}null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone())}else t instanceof THREE.Mesh&&e instanceof THREE.Geometry&&this.fromGeometry(e);return this},updateFromObject:function(t){var e=t.geometry;if(t instanceof THREE.Mesh){var n=e.__directGeometry;if(void 0===n)return this.fromGeometry(e);n.verticesNeedUpdate=e.verticesNeedUpdate,n.normalsNeedUpdate=e.normalsNeedUpdate,n.colorsNeedUpdate=e.colorsNeedUpdate,n.uvsNeedUpdate=e.uvsNeedUpdate,n.groupsNeedUpdate=e.groupsNeedUpdate,e.verticesNeedUpdate=!1,e.normalsNeedUpdate=!1,e.colorsNeedUpdate=!1,e.uvsNeedUpdate=!1,e.groupsNeedUpdate=!1,e=n}if(e.verticesNeedUpdate===!0){var i=this.attributes.position;void 0!==i&&(i.copyVector3sArray(e.vertices),i.needsUpdate=!0),e.verticesNeedUpdate=!1}if(e.normalsNeedUpdate===!0){var i=this.attributes.normal;void 0!==i&&(i.copyVector3sArray(e.normals),i.needsUpdate=!0),e.normalsNeedUpdate=!1}if(e.colorsNeedUpdate===!0){var i=this.attributes.color;void 0!==i&&(i.copyColorsArray(e.colors),i.needsUpdate=!0),e.colorsNeedUpdate=!1}if(e.uvsNeedUpdate){var i=this.attributes.uv;void 0!==i&&(i.copyVector2sArray(e.uvs),i.needsUpdate=!0),e.uvsNeedUpdate=!1}if(e.lineDistancesNeedUpdate){var i=this.attributes.lineDistance;void 0!==i&&(i.copyArray(e.lineDistances),i.needsUpdate=!0),e.lineDistancesNeedUpdate=!1}return e.groupsNeedUpdate&&(e.computeGroups(t.geometry),this.groups=e.groups,e.groupsNeedUpdate=!1),this},fromGeometry:function(t){return t.__directGeometry=(new THREE.DirectGeometry).fromGeometry(t),this.fromDirectGeometry(t.__directGeometry)},fromDirectGeometry:function(t){var e=new Float32Array(3*t.vertices.length);if(this.addAttribute("position",new THREE.BufferAttribute(e,3).copyVector3sArray(t.vertices)),t.normals.length>0){var n=new Float32Array(3*t.normals.length);this.addAttribute("normal",new THREE.BufferAttribute(n,3).copyVector3sArray(t.normals))}if(t.colors.length>0){var i=new Float32Array(3*t.colors.length);this.addAttribute("color",new THREE.BufferAttribute(i,3).copyColorsArray(t.colors))}if(t.uvs.length>0){var r=new Float32Array(2*t.uvs.length);this.addAttribute("uv",new THREE.BufferAttribute(r,2).copyVector2sArray(t.uvs))}if(t.uvs2.length>0){var o=new Float32Array(2*t.uvs2.length);this.addAttribute("uv2",new THREE.BufferAttribute(o,2).copyVector2sArray(t.uvs2))}if(t.indices.length>0){var a=t.vertices.length>65535?Uint32Array:Uint16Array,s=new a(3*t.indices.length);this.setIndex(new THREE.BufferAttribute(s,1).copyIndicesArray(t.indices))}this.groups=t.groups;for(var c in t.morphTargets){for(var l=[],u=t.morphTargets[c],h=0,p=u.length;h<p;h++){var d=u[h],f=new THREE.Float32Attribute(3*d.length,3);l.push(f.copyVector3sArray(d))}this.morphAttributes[c]=l}if(t.skinIndices.length>0){var m=new THREE.Float32Attribute(4*t.skinIndices.length,4);this.addAttribute("skinIndex",m.copyVector4sArray(t.skinIndices))}if(t.skinWeights.length>0){var v=new THREE.Float32Attribute(4*t.skinWeights.length,4);this.addAttribute("skinWeight",v.copyVector4sArray(t.skinWeights))}return null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new THREE.Box3);var t=this.attributes.position.array;void 0!==t?this.boundingBox.setFromArray(t):this.boundingBox.makeEmpty(),(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){var t=new THREE.Box3,e=new THREE.Vector3;return function(){null===this.boundingSphere&&(this.boundingSphere=new THREE.Sphere);var n=this.attributes.position.array;if(n){var i=this.boundingSphere.center;t.setFromArray(n),t.center(i);for(var r=0,o=0,a=n.length;o<a;o+=3)e.fromArray(n,o),r=Math.max(r,i.distanceToSquared(e));this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}}(),computeFaceNormals:function(){},computeVertexNormals:function(){var t=this.index,e=this.attributes,n=this.groups;if(e.position){var i=e.position.array;if(void 0===e.normal)this.addAttribute("normal",new THREE.BufferAttribute(new Float32Array(i.length),3));else for(var r=e.normal.array,o=0,a=r.length;o<a;o++)r[o]=0;var s,c,l,u=e.normal.array,h=new THREE.Vector3,p=new THREE.Vector3,d=new THREE.Vector3,f=new THREE.Vector3,m=new THREE.Vector3;if(t){var v=t.array;0===n.length&&this.addGroup(0,v.length);for(var g=0,y=n.length;g<y;++g)for(var E=n[g],_=E.start,T=E.count,o=_,a=_+T;o<a;o+=3)s=3*v[o+0],c=3*v[o+1],l=3*v[o+2],h.fromArray(i,s),p.fromArray(i,c),d.fromArray(i,l),f.subVectors(d,p),m.subVectors(h,p),f.cross(m),u[s]+=f.x,u[s+1]+=f.y,u[s+2]+=f.z,u[c]+=f.x,u[c+1]+=f.y,u[c+2]+=f.z,u[l]+=f.x,u[l+1]+=f.y,u[l+2]+=f.z}else for(var o=0,a=i.length;o<a;o+=9)h.fromArray(i,o),p.fromArray(i,o+3),d.fromArray(i,o+6),f.subVectors(d,p),m.subVectors(h,p),f.cross(m),u[o]=f.x,u[o+1]=f.y,u[o+2]=f.z,u[o+3]=f.x,u[o+4]=f.y,u[o+5]=f.z,u[o+6]=f.x,u[o+7]=f.y,u[o+8]=f.z;this.normalizeNormals(),e.normal.needsUpdate=!0}},merge:function(t,e){if(t instanceof THREE.BufferGeometry==!1)return void console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",t);void 0===e&&(e=0);var n=this.attributes;for(var i in n)if(void 0!==t.attributes[i])for(var r=n[i],o=r.array,a=t.attributes[i],s=a.array,c=a.itemSize,l=0,u=c*e;l<s.length;l++,u++)o[u]=s[l];return this},normalizeNormals:function(){for(var t,e,n,i,r=this.attributes.normal.array,o=0,a=r.length;o<a;o+=3)t=r[o],e=r[o+1],n=r[o+2],i=1/Math.sqrt(t*t+e*e+n*n),r[o]*=i,r[o+1]*=i,r[o+2]*=i},toNonIndexed:function(){if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var t=new THREE.BufferGeometry,e=this.index.array,n=this.attributes;for(var i in n){for(var r=n[i],o=r.array,a=r.itemSize,s=new o.constructor(e.length*a),c=0,l=0,u=0,h=e.length;u<h;u++){c=e[u]*a;for(var p=0;p<a;p++)s[l++]=o[c++]}t.addAttribute(i,new THREE.BufferAttribute(s,a))}return t},toJSON:function(){var t={metadata:{version:4.4,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),void 0!==this.parameters){var e=this.parameters;for(var n in e)void 0!==e[n]&&(t[n]=e[n]);return t}t.data={attributes:{}};var i=this.index;if(null!==i){var r=Array.prototype.slice.call(i.array);t.data.index={type:i.array.constructor.name,array:r}}var o=this.attributes;for(var n in o){var a=o[n],r=Array.prototype.slice.call(a.array);t.data.attributes[n]={itemSize:a.itemSize,type:a.array.constructor.name,array:r,normalized:a.normalized}}var s=this.groups;s.length>0&&(t.data.groups=JSON.parse(JSON.stringify(s)));var c=this.boundingSphere;return null!==c&&(t.data.boundingSphere={center:c.center.toArray(),radius:c.radius}),t},clone:function(){return(new THREE.BufferGeometry).copy(this)},copy:function(t){var e=t.index;null!==e&&this.setIndex(e.clone());var n=t.attributes;for(var i in n){var r=n[i];this.addAttribute(i,r.clone())}for(var o=t.groups,a=0,s=o.length;a<s;a++){var c=o[a];this.addGroup(c.start,c.count,c.materialIndex)}return this},dispose:function(){this.dispatchEvent({type:"dispose"})}},THREE.EventDispatcher.prototype.apply(THREE.BufferGeometry.prototype),THREE.BufferGeometry.MaxIndex=65535,THREE.InstancedBufferGeometry=function(){THREE.BufferGeometry.call(this),this.type="InstancedBufferGeometry",this.maxInstancedCount=void 0},THREE.InstancedBufferGeometry.prototype=Object.create(THREE.BufferGeometry.prototype),THREE.InstancedBufferGeometry.prototype.constructor=THREE.InstancedBufferGeometry,THREE.InstancedBufferGeometry.prototype.addGroup=function(t,e,n){this.groups.push({start:t,count:e,instances:n})},THREE.InstancedBufferGeometry.prototype.copy=function(t){var e=t.index;null!==e&&this.setIndex(e.clone());var n=t.attributes;for(var i in n){var r=n[i];this.addAttribute(i,r.clone())}for(var o=t.groups,a=0,s=o.length;a<s;a++){var c=o[a];this.addGroup(c.start,c.count,c.instances)}return this},THREE.EventDispatcher.prototype.apply(THREE.InstancedBufferGeometry.prototype),THREE.Uniform=function(t){"string"==typeof t&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),t=arguments[1]),this.value=t,this.dynamic=!1},THREE.Uniform.prototype={constructor:THREE.Uniform,onUpdate:function(t){return this.dynamic=!0,this.onUpdateCallback=t,this}},THREE.AnimationClip=function(t,e,n){this.name=t||THREE.Math.generateUUID(),this.tracks=n,this.duration=void 0!==e?e:-1,this.duration<0&&this.resetDuration(),this.trim(),this.optimize()},THREE.AnimationClip.prototype={constructor:THREE.AnimationClip,resetDuration:function(){for(var t=this.tracks,e=0,n=0,i=t.length;n!==i;++n){var r=this.tracks[n];e=Math.max(e,r.times[r.times.length-1])}this.duration=e},trim:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this},optimize:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this}},Object.assign(THREE.AnimationClip,{parse:function(t){for(var e=[],n=t.tracks,i=1/(t.fps||1),r=0,o=n.length;r!==o;++r)e.push(THREE.KeyframeTrack.parse(n[r]).scale(i));return new THREE.AnimationClip(t.name,t.duration,e)},toJSON:function(t){for(var e=[],n=t.tracks,i={name:t.name,duration:t.duration,tracks:e},r=0,o=n.length;r!==o;++r)e.push(THREE.KeyframeTrack.toJSON(n[r]));return i},CreateFromMorphTargetSequence:function(t,e,n,i){for(var r=e.length,o=[],a=0;a<r;a++){var s=[],c=[];s.push((a+r-1)%r,a,(a+1)%r),c.push(0,1,0);var l=THREE.AnimationUtils.getKeyframeOrder(s);s=THREE.AnimationUtils.sortedArray(s,1,l),c=THREE.AnimationUtils.sortedArray(c,1,l),i||0!==s[0]||(s.push(r),c.push(c[0])),o.push(new THREE.NumberKeyframeTrack(".morphTargetInfluences["+e[a].name+"]",s,c).scale(1/n))}return new THREE.AnimationClip(t,(-1),o)},findByName:function(t,e){for(var n=0;n<t.length;n++)if(t[n].name===e)return t[n];return null},CreateClipsFromMorphTargetSequences:function(t,e,n){for(var i={},r=/^([\w-]*?)([\d]+)$/,o=0,a=t.length;o<a;o++){var s=t[o],c=s.name.match(r);if(c&&c.length>1){var l=c[1],u=i[l];u||(i[l]=u=[]),u.push(s)}}var h=[];for(var l in i)h.push(THREE.AnimationClip.CreateFromMorphTargetSequence(l,i[l],e,n));return h},parseAnimation:function(t,e,n){if(!t)return console.error("  no animation in JSONLoader data"),null;for(var i=function(t,e,n,i,r){if(0!==n.length){var o=[],a=[];THREE.AnimationUtils.flattenJSON(n,o,a,i),0!==o.length&&r.push(new t(e,o,a))}},r=[],o=t.name||"default",a=t.length||-1,s=t.fps||30,c=t.hierarchy||[],l=0;l<c.length;l++){var u=c[l].keys;if(u&&0!=u.length)if(u[0].morphTargets){for(var h={},p=0;p<u.length;p++)if(u[p].morphTargets)for(var d=0;d<u[p].morphTargets.length;d++)h[u[p].morphTargets[d]]=-1;for(var f in h){for(var m=[],v=[],d=0;d!==u[p].morphTargets.length;++d){var g=u[p];m.push(g.time),v.push(g.morphTarget===f?1:0)}r.push(new THREE.NumberKeyframeTrack(".morphTargetInfluence["+f+"]",m,v))}a=h.length*(s||1)}else{var y=".bones["+e[l].name+"]";i(THREE.VectorKeyframeTrack,y+".position",u,"pos",r),i(THREE.QuaternionKeyframeTrack,y+".quaternion",u,"rot",r),i(THREE.VectorKeyframeTrack,y+".scale",u,"scl",r)}}if(0===r.length)return null;var E=new THREE.AnimationClip(o,a,r);return E}}),THREE.AnimationMixer=function(t){this._root=t,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1},THREE.AnimationMixer.prototype={constructor:THREE.AnimationMixer,clipAction:function(t,e){var n,i=e||this._root,r=i.uuid,o="string"==typeof t?t:t.name,a=t!==o?t:null,s=this._actionsByClip[o];if(void 0!==s){var c=s.actionByRoot[r];if(void 0!==c)return c;if(n=s.knownActions[0],a=n._clip,t!==o&&t!==a)throw new Error("Different clips with the same name detected!")}if(null===a)return null;var l=new THREE.AnimationMixer._Action(this,a,e);return this._bindAction(l,n),this._addInactiveAction(l,o,r),l},existingAction:function(t,e){var n=e||this._root,i=n.uuid,r="string"==typeof t?t:t.name,o=this._actionsByClip[r];return void 0!==o?o.actionByRoot[i]||null:null},stopAllAction:function(){var t=this._actions,e=this._nActiveActions,n=this._bindings,i=this._nActiveBindings;this._nActiveActions=0,this._nActiveBindings=0;for(var r=0;r!==e;++r)t[r].reset();for(var r=0;r!==i;++r)n[r].useCount=0;return this},update:function(t){t*=this.timeScale;for(var e=this._actions,n=this._nActiveActions,i=this.time+=t,r=Math.sign(t),o=this._accuIndex^=1,a=0;a!==n;++a){var s=e[a];s.enabled&&s._update(i,t,r,o)}for(var c=this._bindings,l=this._nActiveBindings,a=0;a!==l;++a)c[a].apply(o);return this},getRoot:function(){return this._root},uncacheClip:function(t){var e=this._actions,n=t.name,i=this._actionsByClip,r=i[n];if(void 0!==r){for(var o=r.knownActions,a=0,s=o.length;a!==s;++a){var c=o[a];this._deactivateAction(c);var l=c._cacheIndex,u=e[e.length-1];c._cacheIndex=null,c._byClipCacheIndex=null,u._cacheIndex=l,e[l]=u,e.pop(),this._removeInactiveBindingsForAction(c)}delete i[n]}},uncacheRoot:function(t){var e=t.uuid,n=this._actionsByClip;for(var i in n){var r=n[i].actionByRoot,o=r[e];void 0!==o&&(this._deactivateAction(o),this._removeInactiveAction(o))}var a=this._bindingsByRootAndName,s=a[e];if(void 0!==s)for(var c in s){var l=s[c];l.restoreOriginalState(),this._removeInactiveBinding(l)}},uncacheAction:function(t,e){var n=this.existingAction(t,e);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}},THREE.EventDispatcher.prototype.apply(THREE.AnimationMixer.prototype),THREE.AnimationMixer._Action=function(t,e,n){this._mixer=t,this._clip=e,this._localRoot=n||null;for(var i=e.tracks,r=i.length,o=new Array(r),a={endingStart:THREE.ZeroCurvatureEnding,endingEnd:THREE.ZeroCurvatureEnding},s=0;s!==r;++s){var c=i[s].createInterpolant(null);o[s]=c,c.settings=a}this._interpolantSettings=a,this._interpolants=o,this._propertyBindings=new Array(r),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=THREE.LoopRepeat,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0},THREE.AnimationMixer._Action.prototype={constructor:THREE.AnimationMixer._Action,play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){this._startTime;return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(t){return this._startTime=t,this},setLoop:function(t,e){return this.loop=t,this.repetitions=e,this},setEffectiveWeight:function(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(t){return this._scheduleFading(t,0,1)},fadeOut:function(t){return this._scheduleFading(t,1,0)},crossFadeFrom:function(t,e,n){this._mixer;if(t.fadeOut(e),this.fadeIn(e),n){var i=this._clip.duration,r=t._clip.duration,o=r/i,a=i/r;t.warp(1,o,e),this.warp(a,1,e)}return this},crossFadeTo:function(t,e,n){return t.crossFadeFrom(this,e,n)},stopFading:function(){var t=this._weightInterpolant;return null!==t&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},setEffectiveTimeScale:function(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(t){return this.timeScale=this._clip.duration/t,this.stopWarping()},syncWith:function(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()},halt:function(t){return this.warp(this._currentTimeScale,0,t)},warp:function(t,e,n){var i=this._mixer,r=i.time,o=this._timeScaleInterpolant,a=this.timeScale;null===o&&(o=i._lendControlInterpolant(),this._timeScaleInterpolant=o);var s=o.parameterPositions,c=o.sampleValues;return s[0]=r,s[1]=r+n,c[0]=t/a,c[1]=e/a,this},stopWarping:function(){var t=this._timeScaleInterpolant;return null!==t&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(t,e,n,i){var r=this._startTime;if(null!==r){var o=(t-r)*n;if(o<0||0===n)return;this._startTime=null,e=n*o}e*=this._updateTimeScale(t);var a=this._updateTime(e),s=this._updateWeight(t);if(s>0)for(var c=this._interpolants,l=this._propertyBindings,u=0,h=c.length;u!==h;++u)c[u].evaluate(a),l[u].accumulate(i,s)},_updateWeight:function(t){var e=0;if(this.enabled){e=this.weight;var n=this._weightInterpolant;if(null!==n){var i=n.evaluate(t)[0];e*=i,t>n.parameterPositions[1]&&(this.stopFading(),0===i&&(this.enabled=!1))}}return this._effectiveWeight=e,e},_updateTimeScale:function(t){var e=0;if(!this.paused){e=this.timeScale;var n=this._timeScaleInterpolant;if(null!==n){var i=n.evaluate(t)[0];e*=i,t>n.parameterPositions[1]&&(this.stopWarping(),0===e?this.pause=!0:this.timeScale=e)}}return this._effectiveTimeScale=e,e},_updateTime:function(t){var e=this.time+t;if(0===t)return e;var n=this._clip.duration,i=this.loop,r=this._loopCount,o=!1;switch(i){case THREE.LoopOnce:if(r===-1&&(this.loopCount=0,this._setEndings(!0,!0,!1)),e>=n)e=n;else{if(!(e<0))break;e=0}this.clampWhenFinished?this.pause=!0:this.enabled=!1,this._mixer.dispatchEvent({type:"finished",action:this,direction:t<0?-1:1});break;case THREE.LoopPingPong:o=!0;case THREE.LoopRepeat:if(r===-1&&(t>0?(r=0,this._setEndings(!0,0===this.repetitions,o)):this._setEndings(0===this.repetitions,!0,o)),e>=n||e<0){var a=Math.floor(e/n);e-=n*a,r+=Math.abs(a);var s=this.repetitions-r;if(s<0){this.clampWhenFinished?this.paused=!0:this.enabled=!1,e=t>0?n:0,this._mixer.dispatchEvent({type:"finished",action:this,direction:t>0?1:-1});break}if(0===s){var c=t<0;this._setEndings(c,!c,o)}else this._setEndings(!1,!1,o);this._loopCount=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}if(i===THREE.LoopPingPong&&1===(1&r))return this.time=e,n-e}return this.time=e,e},_setEndings:function(t,e,n){var i=this._interpolantSettings;n?(i.endingStart=THREE.ZeroSlopeEnding,i.endingEnd=THREE.ZeroSlopeEnding):(t?i.endingStart=this.zeroSlopeAtStart?THREE.ZeroSlopeEnding:THREE.ZeroCurvatureEnding:i.endingStart=THREE.WrapAroundEnding,e?i.endingEnd=this.zeroSlopeAtEnd?THREE.ZeroSlopeEnding:THREE.ZeroCurvatureEnding:i.endingEnd=THREE.WrapAroundEnding)},_scheduleFading:function(t,e,n){var i=this._mixer,r=i.time,o=this._weightInterpolant;null===o&&(o=i._lendControlInterpolant(),this._weightInterpolant=o);var a=o.parameterPositions,s=o.sampleValues;return a[0]=r,s[0]=e,a[1]=r+t,s[1]=n,this}},Object.assign(THREE.AnimationMixer.prototype,{_bindAction:function(t,e){var n=t._localRoot||this._root,i=t._clip.tracks,r=i.length,o=t._propertyBindings,a=t._interpolants,s=n.uuid,c=this._bindingsByRootAndName,l=c[s];void 0===l&&(l={},c[s]=l);for(var u=0;u!==r;++u){var h=i[u],p=h.name,d=l[p];if(void 0!==d)o[u]=d;else{if(d=o[u],void 0!==d){null===d._cacheIndex&&(++d.referenceCount,this._addInactiveBinding(d,s,p));continue}var f=e&&e._propertyBindings[u].binding.parsedPath;d=new THREE.PropertyMixer(THREE.PropertyBinding.create(n,p,f),h.ValueTypeName,h.getValueSize()),++d.referenceCount,this._addInactiveBinding(d,s,p),o[u]=d}a[u].resultBuffer=d.buffer}},_activateAction:function(t){if(!this._isActiveAction(t)){if(null===t._cacheIndex){var e=(t._localRoot||this._root).uuid,n=t._clip.name,i=this._actionsByClip[n];this._bindAction(t,i&&i.knownActions[0]),this._addInactiveAction(t,n,e)}for(var r=t._propertyBindings,o=0,a=r.length;o!==a;++o){var s=r[o];0===s.useCount++&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(t)}},_deactivateAction:function(t){if(this._isActiveAction(t)){for(var e=t._propertyBindings,n=0,i=e.length;n!==i;++n){var r=e[n];0===--r.useCount&&(r.restoreOriginalState(),this._takeBackBinding(r))}this._takeBackAction(t)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}},_isActiveAction:function(t){var e=t._cacheIndex;return null!==e&&e<this._nActiveActions},_addInactiveAction:function(t,e,n){var i=this._actions,r=this._actionsByClip,o=r[e];if(void 0===o)o={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,r[e]=o;else{var a=o.knownActions;t._byClipCacheIndex=a.length,a.push(t)}t._cacheIndex=i.length,i.push(t),o.actionByRoot[n]=t},_removeInactiveAction:function(t){var e=this._actions,n=e[e.length-1],i=t._cacheIndex;n._cacheIndex=i,e[i]=n,e.pop(),t._cacheIndex=null;var r=t._clip.name,o=this._actionsByClip,a=o[r],s=a.knownActions,c=s[s.length-1],l=t._byClipCacheIndex;c._byClipCacheIndex=l,s[l]=c,s.pop(),t._byClipCacheIndex=null;var u=a.actionByRoot,h=(e._localRoot||this._root).uuid;delete u[h],0===s.length&&delete o[r],this._removeInactiveBindingsForAction(t)},_removeInactiveBindingsForAction:function(t){for(var e=t._propertyBindings,n=0,i=e.length;n!==i;++n){var r=e[n];0===--r.referenceCount&&this._removeInactiveBinding(r)}},_lendAction:function(t){var e=this._actions,n=t._cacheIndex,i=this._nActiveActions++,r=e[i];t._cacheIndex=i,e[i]=t,r._cacheIndex=n,e[n]=r},_takeBackAction:function(t){var e=this._actions,n=t._cacheIndex,i=--this._nActiveActions,r=e[i];t._cacheIndex=i,e[i]=t,r._cacheIndex=n,e[n]=r},_addInactiveBinding:function(t,e,n){var i=this._bindingsByRootAndName,r=i[e],o=this._bindings;void 0===r&&(r={},i[e]=r),r[n]=t,t._cacheIndex=o.length,o.push(t)},_removeInactiveBinding:function(t){var e=this._bindings,n=t.binding,i=n.rootNode.uuid,r=n.path,o=this._bindingsByRootAndName,a=o[i],s=e[e.length-1],c=t._cacheIndex;s._cacheIndex=c,e[c]=s,e.pop(),delete a[r];t:{for(var l in a)break t;delete o[i]}},_lendBinding:function(t){var e=this._bindings,n=t._cacheIndex,i=this._nActiveBindings++,r=e[i];t._cacheIndex=i,e[i]=t,r._cacheIndex=n,e[n]=r},_takeBackBinding:function(t){var e=this._bindings,n=t._cacheIndex,i=--this._nActiveBindings,r=e[i];t._cacheIndex=i,e[i]=t,r._cacheIndex=n,e[n]=r},_lendControlInterpolant:function(){var t=this._controlInterpolants,e=this._nActiveControlInterpolants++,n=t[e];return void 0===n&&(n=new THREE.LinearInterpolant(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),n.__cacheIndex=e,t[e]=n),n},_takeBackControlInterpolant:function(t){var e=this._controlInterpolants,n=t.__cacheIndex,i=--this._nActiveControlInterpolants,r=e[i];
t.__cacheIndex=i,e[i]=t,r.__cacheIndex=n,e[n]=r},_controlInterpolantsResultBuffer:new Float32Array(1)}),THREE.AnimationObjectGroup=function(t){this.uuid=THREE.Math.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var e={};this._indicesByUUID=e;for(var n=0,i=arguments.length;n!==i;++n)e[arguments[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var r=this;this.stats={objects:{get total(){return r._objects.length},get inUse(){return this.total-r.nCachedObjects_}},get bindingsPerObject(){return r._bindings.length}}},THREE.AnimationObjectGroup.prototype={constructor:THREE.AnimationObjectGroup,add:function(t){for(var e=this._objects,n=e.length,i=this.nCachedObjects_,r=this._indicesByUUID,o=this._paths,a=this._parsedPaths,s=this._bindings,c=s.length,l=0,u=arguments.length;l!==u;++l){var h=arguments[l],p=h.uuid,d=r[p];if(void 0===d){d=n++,r[p]=d,e.push(h);for(var f=0,m=c;f!==m;++f)s[f].push(new THREE.PropertyBinding(h,o[f],a[f]))}else if(d<i){var v=e[d],g=--i,y=e[g];r[y.uuid]=d,e[d]=y,r[p]=g,e[g]=h;for(var f=0,m=c;f!==m;++f){var E=s[f],_=E[g],T=E[d];E[d]=_,void 0===T&&(T=new THREE.PropertyBinding(h,o[f],a[f])),E[g]=T}}else e[d]!==v&&console.error("Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes...")}this.nCachedObjects_=i},remove:function(t){for(var e=this._objects,n=(e.length,this.nCachedObjects_),i=this._indicesByUUID,r=this._bindings,o=r.length,a=0,s=arguments.length;a!==s;++a){var c=arguments[a],l=c.uuid,u=i[l];if(void 0!==u&&u>=n){var h=n++,p=e[h];i[p.uuid]=u,e[u]=p,i[l]=h,e[h]=c;for(var d=0,f=o;d!==f;++d){var m=r[d],v=m[h],g=m[u];m[u]=v,m[h]=g}}}this.nCachedObjects_=n},uncache:function(t){for(var e=this._objects,n=e.length,i=this.nCachedObjects_,r=this._indicesByUUID,o=this._bindings,a=o.length,s=0,c=arguments.length;s!==c;++s){var l=arguments[s],u=l.uuid,h=r[u];if(void 0!==h)if(delete r[u],h<i){var p=--i,d=e[p],f=--n,m=e[f];r[d.uuid]=h,e[h]=d,r[m.uuid]=p,e[p]=m,e.pop();for(var v=0,g=a;v!==g;++v){var y=o[v],E=y[p],_=y[f];y[h]=E,y[p]=_,y.pop()}}else{var f=--n,m=e[f];r[m.uuid]=h,e[h]=m,e.pop();for(var v=0,g=a;v!==g;++v){var y=o[v];y[h]=y[f],y.pop()}}}this.nCachedObjects_=i},subscribe_:function(t,e){var n=this._bindingsIndicesByPath,i=n[t],r=this._bindings;if(void 0!==i)return r[i];var o=this._paths,a=this._parsedPaths,s=this._objects,c=s.length,l=this.nCachedObjects_,u=new Array(c);i=r.length,n[t]=i,o.push(t),a.push(e),r.push(u);for(var h=l,p=s.length;h!==p;++h){var d=s[h];u[h]=new THREE.PropertyBinding(d,t,e)}return u},unsubscribe_:function(t){var e=this._bindingsIndicesByPath,n=e[t];if(void 0!==n){var i=this._paths,r=this._parsedPaths,o=this._bindings,a=o.length-1,s=o[a],c=t[a];e[c]=n,o[n]=s,o.pop(),r[n]=r[a],r.pop(),i[n]=i[a],i.pop()}}},THREE.AnimationUtils={arraySlice:function(t,e,n){return THREE.AnimationUtils.isTypedArray(t)?new t.constructor(t.subarray(e,n)):t.slice(e,n)},convertArray:function(t,e,n){return!t||!n&&t.constructor===e?t:"number"==typeof e.BYTES_PER_ELEMENT?new e(t):Array.prototype.slice.call(t)},isTypedArray:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)},getKeyframeOrder:function(t){function e(e,n){return t[e]-t[n]}for(var n=t.length,i=new Array(n),r=0;r!==n;++r)i[r]=r;return i.sort(e),i},sortedArray:function(t,e,n){for(var i=t.length,r=new t.constructor(i),o=0,a=0;a!==i;++o)for(var s=n[o]*e,c=0;c!==e;++c)r[a++]=t[s+c];return r},flattenJSON:function(t,e,n,i){for(var r=1,o=t[0];void 0!==o&&void 0===o[i];)o=t[r++];if(void 0!==o){var a=o[i];if(void 0!==a)if(Array.isArray(a)){do a=o[i],void 0!==a&&(e.push(o.time),n.push.apply(n,a)),o=t[r++];while(void 0!==o)}else if(void 0!==a.toArray){do a=o[i],void 0!==a&&(e.push(o.time),a.toArray(n,n.length)),o=t[r++];while(void 0!==o)}else do a=o[i],void 0!==a&&(e.push(o.time),n.push(a)),o=t[r++];while(void 0!==o)}}},THREE.KeyframeTrack=function(t,e,n,i){if(void 0===t)throw new Error("track name is undefined");if(void 0===e||0===e.length)throw new Error("no keyframes in track named "+t);this.name=t,this.times=THREE.AnimationUtils.convertArray(e,this.TimeBufferType),this.values=THREE.AnimationUtils.convertArray(n,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation),this.validate(),this.optimize()},THREE.KeyframeTrack.prototype={constructor:THREE.KeyframeTrack,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:THREE.InterpolateLinear,InterpolantFactoryMethodDiscrete:function(t){return new THREE.DiscreteInterpolant(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodLinear:function(t){return new THREE.LinearInterpolant(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:function(t){return new THREE.CubicInterpolant(this.times,this.values,this.getValueSize(),t)},setInterpolation:function(t){var e=void 0;switch(t){case THREE.InterpolateDiscrete:e=this.InterpolantFactoryMethodDiscrete;break;case THREE.InterpolateLinear:e=this.InterpolantFactoryMethodLinear;break;case THREE.InterpolateSmooth:e=this.InterpolantFactoryMethodSmooth}if(void 0===e){var n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(t===this.DefaultInterpolation)throw new Error(n);this.setInterpolation(this.DefaultInterpolation)}return void console.warn(n)}this.createInterpolant=e},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return THREE.InterpolateDiscrete;case this.InterpolantFactoryMethodLinear:return THREE.InterpolateLinear;case this.InterpolantFactoryMethodSmooth:return THREE.InterpolateSmooth}},getValueSize:function(){return this.values.length/this.times.length},shift:function(t){if(0!==t)for(var e=this.times,n=0,i=e.length;n!==i;++n)e[n]+=t;return this},scale:function(t){if(1!==t)for(var e=this.times,n=0,i=e.length;n!==i;++n)e[n]*=t;return this},trim:function(t,e){for(var n=this.times,i=n.length,r=0,o=i-1;r!==i&&n[r]<t;)++r;for(;o!==-1&&n[o]>e;)--o;if(++o,0!==r||o!==i){r>=o&&(o=Math.max(o,1),r=o-1);var a=this.getValueSize();this.times=THREE.AnimationUtils.arraySlice(n,r,o),this.values=THREE.AnimationUtils.arraySlice(this.values,r*a,o*a)}return this},validate:function(){var t=!0,e=this.getValueSize();e-Math.floor(e)!==0&&(console.error("invalid value size in track",this),t=!1);var n=this.times,i=this.values,r=n.length;0===r&&(console.error("track is empty",this),t=!1);for(var o=null,a=0;a!==r;a++){var s=n[a];if("number"==typeof s&&isNaN(s)){console.error("time is not a valid number",this,a,s),t=!1;break}if(null!==o&&o>s){console.error("out of order keys",this,a,s,o),t=!1;break}o=s}if(void 0!==i&&THREE.AnimationUtils.isTypedArray(i))for(var a=0,c=i.length;a!==c;++a){var l=i[a];if(isNaN(l)){console.error("value is not a valid number",this,a,l),t=!1;break}}return t},optimize:function(){for(var t=this.times,e=this.values,n=this.getValueSize(),i=1,r=1,o=t.length-1;r<=o;++r){var a=!1,s=t[r],c=t[r+1];if(s!==c&&(1!==r||s!==s[0]))for(var l=r*n,u=l-n,h=l+n,p=0;p!==n;++p){var d=e[l+p];if(d!==e[u+p]||d!==e[h+p]){a=!0;break}}if(a){if(r!==i){t[i]=t[r];for(var f=r*n,m=i*n,p=0;p!==n;++p)e[m+p]=e[f+p]}++i}}return i!==t.length&&(this.times=THREE.AnimationUtils.arraySlice(t,0,i),this.values=THREE.AnimationUtils.arraySlice(e,0,i*n)),this}},Object.assign(THREE.KeyframeTrack,{parse:function(t){if(void 0===t.type)throw new Error("track type undefined, can not parse");var e=THREE.KeyframeTrack._getTrackTypeForValueTypeName(t.type);if(void 0===t.times){console.warn("legacy JSON format detected, converting");var n=[],i=[];THREE.AnimationUtils.flattenJSON(t.keys,n,i,"value"),t.times=n,t.values=i}return void 0!==e.parse?e.parse(t):new e(t.name,t.times,t.values,t.interpolation)},toJSON:function(t){var e,n=t.constructor;if(void 0!==n.toJSON)e=n.toJSON(t);else{e={name:t.name,times:THREE.AnimationUtils.convertArray(t.times,Array),values:THREE.AnimationUtils.convertArray(t.values,Array)};var i=t.getInterpolation();i!==t.DefaultInterpolation&&(e.interpolation=i)}return e.type=t.ValueTypeName,e},_getTrackTypeForValueTypeName:function(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return THREE.NumberKeyframeTrack;case"vector":case"vector2":case"vector3":case"vector4":return THREE.VectorKeyframeTrack;case"color":return THREE.ColorKeyframeTrack;case"quaternion":return THREE.QuaternionKeyframeTrack;case"bool":case"boolean":return THREE.BooleanKeyframeTrack;case"string":return THREE.StringKeyframeTrack}throw new Error("Unsupported typeName: "+t)}}),THREE.PropertyBinding=function(t,e,n){this.path=e,this.parsedPath=n||THREE.PropertyBinding.parseTrackName(e),this.node=THREE.PropertyBinding.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t},THREE.PropertyBinding.prototype={constructor:THREE.PropertyBinding,getValue:function(t,e){this.bind(),this.getValue(t,e)},setValue:function(t,e){this.bind(),this.setValue(t,e)},bind:function(){var t=this.node,e=this.parsedPath,n=e.objectName,i=e.propertyName,r=e.propertyIndex;if(t||(t=THREE.PropertyBinding.findNode(this.rootNode,e.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.error("  trying to update node for track: "+this.path+" but it wasn't found.");if(n){var o=e.objectIndex;switch(n){case"materials":if(!t.material)return void console.error("  can not bind to material as node does not have a material",this);if(!t.material.materials)return void console.error("  can not bind to material.materials as node.material does not have a materials array",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("  can not bind to bones as node does not have a skeleton",this);t=t.skeleton.bones;for(var a=0;a<t.length;a++)if(t[a].name===o){o=a;break}break;default:if(void 0===t[n])return void console.error("  can not bind to objectName of node, undefined",this);t=t[n]}if(void 0!==o){if(void 0===t[o])return void console.error("  trying to bind to objectIndex of objectName, but is undefined:",this,t);t=t[o]}}var s=t[i];if(!s){var c=e.nodeName;return void console.error("  trying to update property for track: "+c+"."+i+" but it wasn't found.",t)}var l=this.Versioning.None;void 0!==t.needsUpdate?(l=this.Versioning.NeedsUpdate,this.targetObject=t):void 0!==t.matrixWorldNeedsUpdate&&(l=this.Versioning.MatrixWorldNeedsUpdate,this.targetObject=t);var u=this.BindingType.Direct;if(void 0!==r){if("morphTargetInfluences"===i){if(!t.geometry)return void console.error("  can not bind to morphTargetInfluences becasuse node does not have a geometry",this);if(!t.geometry.morphTargets)return void console.error("  can not bind to morphTargetInfluences becasuse node does not have a geometry.morphTargets",this);for(var a=0;a<this.node.geometry.morphTargets.length;a++)if(t.geometry.morphTargets[a].name===r){r=a;break}}u=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=r}else void 0!==s.fromArray&&void 0!==s.toArray?(u=this.BindingType.HasFromToArray,this.resolvedProperty=s):void 0!==s.length?(u=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=i;this.getValue=this.GetterByBindingType[u],this.setValue=this.SetterByBindingTypeAndVersioning[u][l]},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}},Object.assign(THREE.PropertyBinding.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},_getValue_unbound:THREE.PropertyBinding.prototype.getValue,_setValue_unbound:THREE.PropertyBinding.prototype.setValue,BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(t,e){t[e]=this.node[this.propertyName]},function(t,e){for(var n=this.resolvedProperty,i=0,r=n.length;i!==r;++i)t[e++]=n[i]},function(t,e){t[e]=this.resolvedProperty[this.propertyIndex]},function(t,e){this.resolvedProperty.toArray(t,e)}],SetterByBindingTypeAndVersioning:[[function(t,e){this.node[this.propertyName]=t[e]},function(t,e){this.node[this.propertyName]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.node[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){for(var n=this.resolvedProperty,i=0,r=n.length;i!==r;++i)n[i]=t[e++]},function(t,e){for(var n=this.resolvedProperty,i=0,r=n.length;i!==r;++i)n[i]=t[e++];this.targetObject.needsUpdate=!0},function(t,e){for(var n=this.resolvedProperty,i=0,r=n.length;i!==r;++i)n[i]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty[this.propertyIndex]=t[e]},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty.fromArray(t,e)},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}]]}),THREE.PropertyBinding.Composite=function(t,e,n){var i=n||THREE.PropertyBinding.parseTrackName(e);this._targetGroup=t,this._bindings=t.subscribe_(e,i)},THREE.PropertyBinding.Composite.prototype={constructor:THREE.PropertyBinding.Composite,getValue:function(t,e){this.bind();var n=this._targetGroup.nCachedObjects_,i=this._bindings[n];void 0!==i&&i.getValue(t,e)},setValue:function(t,e){for(var n=this._bindings,i=this._targetGroup.nCachedObjects_,r=n.length;i!==r;++i)n[i].setValue(t,e)},bind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].bind()},unbind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].unbind()}},THREE.PropertyBinding.create=function(t,e,n){return t instanceof THREE.AnimationObjectGroup?new THREE.PropertyBinding.Composite(t,e,n):new THREE.PropertyBinding(t,e,n)},THREE.PropertyBinding.parseTrackName=function(t){var e=/^(([\w]+\/)*)([\w-\d]+)?(\.([\w]+)(\[([\w\d\[\]\_.:\- ]+)\])?)?(\.([\w.]+)(\[([\w\d\[\]\_. ]+)\])?)$/,n=e.exec(t);if(!n)throw new Error("cannot parse trackName at all: "+t);n.index===e.lastIndex&&e.lastIndex++;var i={nodeName:n[3],objectName:n[5],objectIndex:n[7],propertyName:n[9],propertyIndex:n[11]};if(null===i.propertyName||0===i.propertyName.length)throw new Error("can not parse propertyName from trackName: "+t);return i},THREE.PropertyBinding.findNode=function(t,e){if(!e||""===e||"root"===e||"."===e||e===-1||e===t.name||e===t.uuid)return t;if(t.skeleton){var n=function(t){for(var n=0;n<t.bones.length;n++){var i=t.bones[n];if(i.name===e)return i}return null},i=n(t.skeleton);if(i)return i}if(t.children){var r=function(t){for(var n=0;n<t.length;n++){var i=t[n];if(i.name===e||i.uuid===e)return i;var o=r(i.children);if(o)return o}return null},o=r(t.children);if(o)return o}return null},THREE.PropertyMixer=function(t,e,n){this.binding=t,this.valueSize=n;var i,r=Float64Array;switch(e){case"quaternion":i=this._slerp;break;case"string":case"bool":r=Array,i=this._select;break;default:i=this._lerp}this.buffer=new r(4*n),this._mixBufferRegion=i,this.cumulativeWeight=0,this.useCount=0,this.referenceCount=0},THREE.PropertyMixer.prototype={constructor:THREE.PropertyMixer,accumulate:function(t,e){var n=this.buffer,i=this.valueSize,r=t*i+i,o=this.cumulativeWeight;if(0===o){for(var a=0;a!==i;++a)n[r+a]=n[a];o=e}else{o+=e;var s=e/o;this._mixBufferRegion(n,r,0,s,i)}this.cumulativeWeight=o},apply:function(t){var e=this.valueSize,n=this.buffer,i=t*e+e,r=this.cumulativeWeight,o=this.binding;if(this.cumulativeWeight=0,r<1){var a=3*e;this._mixBufferRegion(n,i,a,1-r,e)}for(var s=e,c=e+e;s!==c;++s)if(n[s]!==n[s+e]){o.setValue(n,i);break}},saveOriginalState:function(){var t=this.binding,e=this.buffer,n=this.valueSize,i=3*n;t.getValue(e,i);for(var r=n,o=i;r!==o;++r)e[r]=e[i+r%n];this.cumulativeWeight=0},restoreOriginalState:function(){var t=3*this.valueSize;this.binding.setValue(this.buffer,t)},_select:function(t,e,n,i,r){if(i>=.5)for(var o=0;o!==r;++o)t[e+o]=t[n+o]},_slerp:function(t,e,n,i,r){THREE.Quaternion.slerpFlat(t,e,t,e,t,n,i)},_lerp:function(t,e,n,i,r){for(var o=1-i,a=0;a!==r;++a){var s=e+a;t[s]=t[s]*o+t[n+a]*i}}},THREE.BooleanKeyframeTrack=function(t,e,n){THREE.KeyframeTrack.call(this,t,e,n)},THREE.BooleanKeyframeTrack.prototype=Object.assign(Object.create(THREE.KeyframeTrack.prototype),{constructor:THREE.BooleanKeyframeTrack,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:THREE.InterpolateDiscrete,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),THREE.ColorKeyframeTrack=function(t,e,n,i){THREE.KeyframeTrack.call(this,t,e,n,i)},THREE.ColorKeyframeTrack.prototype=Object.assign(Object.create(THREE.KeyframeTrack.prototype),{constructor:THREE.ColorKeyframeTrack,ValueTypeName:"color"}),THREE.NumberKeyframeTrack=function(t,e,n,i){THREE.KeyframeTrack.call(this,t,e,n,i)},THREE.NumberKeyframeTrack.prototype=Object.assign(Object.create(THREE.KeyframeTrack.prototype),{constructor:THREE.NumberKeyframeTrack,ValueTypeName:"number"}),THREE.QuaternionKeyframeTrack=function(t,e,n,i){THREE.KeyframeTrack.call(this,t,e,n,i)},THREE.QuaternionKeyframeTrack.prototype=Object.assign(Object.create(THREE.KeyframeTrack.prototype),{constructor:THREE.QuaternionKeyframeTrack,ValueTypeName:"quaternion",DefaultInterpolation:THREE.InterpolateLinear,InterpolantFactoryMethodLinear:function(t){return new THREE.QuaternionLinearInterpolant(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:void 0}),THREE.StringKeyframeTrack=function(t,e,n,i){THREE.KeyframeTrack.call(this,t,e,n,i)},THREE.StringKeyframeTrack.prototype=Object.assign(Object.create(THREE.KeyframeTrack.prototype),{constructor:THREE.StringKeyframeTrack,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:THREE.InterpolateDiscrete,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),THREE.VectorKeyframeTrack=function(t,e,n,i){THREE.KeyframeTrack.call(this,t,e,n,i)},THREE.VectorKeyframeTrack.prototype=Object.assign(Object.create(THREE.KeyframeTrack.prototype),{constructor:THREE.VectorKeyframeTrack,ValueTypeName:"vector"}),THREE.Audio=function(t){THREE.Object3D.call(this),this.type="Audio",this.context=t.context,this.source=this.context.createBufferSource(),this.source.onended=this.onEnded.bind(this),this.gain=this.context.createGain(),this.gain.connect(t.getInput()),this.autoplay=!1,this.startTime=0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this.filter=null},THREE.Audio.prototype=Object.create(THREE.Object3D.prototype),THREE.Audio.prototype.constructor=THREE.Audio,THREE.Audio.prototype.getOutput=function(){return this.gain},THREE.Audio.prototype.setNodeSource=function(t){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=t,this.connect(),this},THREE.Audio.prototype.setBuffer=function(t){var e=this;return e.source.buffer=t,e.sourceType="buffer",e.autoplay&&e.play(),this},THREE.Audio.prototype.play=function(){if(this.isPlaying===!0)return void console.warn("THREE.Audio: Audio is already playing.");if(this.hasPlaybackControl===!1)return void console.warn("THREE.Audio: this Audio has no playback control.");var t=this.context.createBufferSource();t.buffer=this.source.buffer,t.loop=this.source.loop,t.onended=this.source.onended,t.start(0,this.startTime),t.playbackRate.value=this.playbackRate,this.isPlaying=!0,this.source=t,this.connect()},THREE.Audio.prototype.pause=function(){return this.hasPlaybackControl===!1?void console.warn("THREE.Audio: this Audio has no playback control."):(this.source.stop(),void(this.startTime=this.context.currentTime))},THREE.Audio.prototype.stop=function(){return this.hasPlaybackControl===!1?void console.warn("THREE.Audio: this Audio has no playback control."):(this.source.stop(),void(this.startTime=0))},THREE.Audio.prototype.connect=function(){null!==this.filter?(this.source.connect(this.filter),this.filter.connect(this.getOutput())):this.source.connect(this.getOutput())},THREE.Audio.prototype.disconnect=function(){null!==this.filter?(this.source.disconnect(this.filter),this.filter.disconnect(this.getOutput())):this.source.disconnect(this.getOutput())},THREE.Audio.prototype.getFilter=function(){return this.filter},THREE.Audio.prototype.setFilter=function(t){void 0===t&&(t=null),this.isPlaying===!0?(this.disconnect(),this.filter=t,this.connect()):this.filter=t},THREE.Audio.prototype.setPlaybackRate=function(t){return this.hasPlaybackControl===!1?void console.warn("THREE.Audio: this Audio has no playback control."):(this.playbackRate=t,void(this.isPlaying===!0&&(this.source.playbackRate.value=this.playbackRate)))},THREE.Audio.prototype.getPlaybackRate=function(){return this.playbackRate},THREE.Audio.prototype.onEnded=function(){this.isPlaying=!1},THREE.Audio.prototype.setLoop=function(t){return this.hasPlaybackControl===!1?void console.warn("THREE.Audio: this Audio has no playback control."):void(this.source.loop=t)},THREE.Audio.prototype.getLoop=function(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.source.loop},THREE.Audio.prototype.setVolume=function(t){this.gain.gain.value=t},THREE.Audio.prototype.getVolume=function(){return this.gain.gain.value},THREE.AudioAnalyser=function(t,e){this.analyser=t.context.createAnalyser(),this.analyser.fftSize=void 0!==e?e:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),t.getOutput().connect(this.analyser)},THREE.AudioAnalyser.prototype={constructor:THREE.AudioAnalyser,getData:function(){return this.analyser.getByteFrequencyData(this.data),this.data}},Object.defineProperty(THREE,"AudioContext",{get:function(){var t;return function(){return void 0===t&&(t=new(window.AudioContext||window.webkitAudioContext)),t}}()}),THREE.PositionalAudio=function(t){THREE.Audio.call(this,t),this.panner=this.context.createPanner(),this.panner.connect(this.gain)},THREE.PositionalAudio.prototype=Object.create(THREE.Audio.prototype),THREE.PositionalAudio.prototype.constructor=THREE.PositionalAudio,THREE.PositionalAudio.prototype.getOutput=function(){return this.panner},THREE.PositionalAudio.prototype.setRefDistance=function(t){this.panner.refDistance=t},THREE.PositionalAudio.prototype.getRefDistance=function(){return this.panner.refDistance},THREE.PositionalAudio.prototype.setRolloffFactor=function(t){this.panner.rolloffFactor=t},THREE.PositionalAudio.prototype.getRolloffFactor=function(){return this.panner.rolloffFactor},THREE.PositionalAudio.prototype.setDistanceModel=function(t){this.panner.distanceModel=t},THREE.PositionalAudio.prototype.getDistanceModel=function(){return this.panner.distanceModel},THREE.PositionalAudio.prototype.setMaxDistance=function(t){this.panner.maxDistance=t},THREE.PositionalAudio.prototype.getMaxDistance=function(){return this.panner.maxDistance},THREE.PositionalAudio.prototype.updateMatrixWorld=function(){var t=new THREE.Vector3;return function(e){THREE.Object3D.prototype.updateMatrixWorld.call(this,e),t.setFromMatrixPosition(this.matrixWorld),this.panner.setPosition(t.x,t.y,t.z)}}(),THREE.AudioListener=function(){THREE.Object3D.call(this),this.type="AudioListener",this.context=THREE.AudioContext,this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null},THREE.AudioListener.prototype=Object.create(THREE.Object3D.prototype),THREE.AudioListener.prototype.constructor=THREE.AudioListener,THREE.AudioListener.prototype.getInput=function(){return this.gain},THREE.AudioListener.prototype.removeFilter=function(){null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null)},THREE.AudioListener.prototype.setFilter=function(t){null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=t,this.gain.connect(this.filter),this.filter.connect(this.context.destination)},THREE.AudioListener.prototype.getFilter=function(){return this.filter},THREE.AudioListener.prototype.setMasterVolume=function(t){this.gain.gain.value=t},THREE.AudioListener.prototype.getMasterVolume=function(){return this.gain.gain.value},THREE.AudioListener.prototype.updateMatrixWorld=function(){var t=new THREE.Vector3,e=new THREE.Quaternion,n=new THREE.Vector3,i=new THREE.Vector3;return function(r){THREE.Object3D.prototype.updateMatrixWorld.call(this,r);var o=this.context.listener,a=this.up;this.matrixWorld.decompose(t,e,n),i.set(0,0,-1).applyQuaternion(e),o.setPosition(t.x,t.y,t.z),o.setOrientation(i.x,i.y,i.z,a.x,a.y,a.z)}}(),THREE.Camera=function(){THREE.Object3D.call(this),this.type="Camera",this.matrixWorldInverse=new THREE.Matrix4,this.projectionMatrix=new THREE.Matrix4},THREE.Camera.prototype=Object.create(THREE.Object3D.prototype),THREE.Camera.prototype.constructor=THREE.Camera,THREE.Camera.prototype.getWorldDirection=function(){var t=new THREE.Quaternion;return function(e){var n=e||new THREE.Vector3;return this.getWorldQuaternion(t),n.set(0,0,-1).applyQuaternion(t)}}(),THREE.Camera.prototype.lookAt=function(){var t=new THREE.Matrix4;return function(e){t.lookAt(this.position,e,this.up),this.quaternion.setFromRotationMatrix(t)}}(),THREE.Camera.prototype.clone=function(){return(new this.constructor).copy(this)},THREE.Camera.prototype.copy=function(t){return THREE.Object3D.prototype.copy.call(this,t),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this},THREE.CubeCamera=function(t,e,n){THREE.Object3D.call(this),this.type="CubeCamera";var i=90,r=1,o=new THREE.PerspectiveCamera(i,r,t,e);o.up.set(0,-1,0),o.lookAt(new THREE.Vector3(1,0,0)),this.add(o);var a=new THREE.PerspectiveCamera(i,r,t,e);a.up.set(0,-1,0),a.lookAt(new THREE.Vector3((-1),0,0)),this.add(a);var s=new THREE.PerspectiveCamera(i,r,t,e);s.up.set(0,0,1),s.lookAt(new THREE.Vector3(0,1,0)),this.add(s);var c=new THREE.PerspectiveCamera(i,r,t,e);c.up.set(0,0,-1),c.lookAt(new THREE.Vector3(0,(-1),0)),this.add(c);var l=new THREE.PerspectiveCamera(i,r,t,e);l.up.set(0,-1,0),l.lookAt(new THREE.Vector3(0,0,1)),this.add(l);var u=new THREE.PerspectiveCamera(i,r,t,e);u.up.set(0,-1,0),u.lookAt(new THREE.Vector3(0,0,(-1))),this.add(u);var h={format:THREE.RGBFormat,magFilter:THREE.LinearFilter,minFilter:THREE.LinearFilter};this.renderTarget=new THREE.WebGLRenderTargetCube(n,n,h),this.updateCubeMap=function(t,e){null===this.parent&&this.updateMatrixWorld();var n=this.renderTarget,i=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,n.activeCubeFace=0,t.render(e,o,n),n.activeCubeFace=1,t.render(e,a,n),n.activeCubeFace=2,t.render(e,s,n),n.activeCubeFace=3,t.render(e,c,n),n.activeCubeFace=4,t.render(e,l,n),n.texture.generateMipmaps=i,n.activeCubeFace=5,t.render(e,u,n),t.setRenderTarget(null)}},THREE.CubeCamera.prototype=Object.create(THREE.Object3D.prototype),THREE.CubeCamera.prototype.constructor=THREE.CubeCamera,THREE.OrthographicCamera=function(t,e,n,i,r,o){THREE.Camera.call(this),this.type="OrthographicCamera",this.zoom=1,this.left=t,this.right=e,this.top=n,this.bottom=i,this.near=void 0!==r?r:.1,this.far=void 0!==o?o:2e3,this.updateProjectionMatrix()},THREE.OrthographicCamera.prototype=Object.create(THREE.Camera.prototype),THREE.OrthographicCamera.prototype.constructor=THREE.OrthographicCamera,THREE.OrthographicCamera.prototype.updateProjectionMatrix=function(){var t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,i=(this.top+this.bottom)/2;this.projectionMatrix.makeOrthographic(n-t,n+t,i+e,i-e,this.near,this.far)},THREE.OrthographicCamera.prototype.copy=function(t){return THREE.Camera.prototype.copy.call(this,t),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this},THREE.OrthographicCamera.prototype.toJSON=function(t){var e=THREE.Object3D.prototype.toJSON.call(this,t);return e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,e},THREE.PerspectiveCamera=function(t,e,n,i){THREE.Camera.call(this),this.type="PerspectiveCamera",this.fov=void 0!==t?t:50,this.zoom=1,this.near=void 0!==n?n:.1,this.far=void 0!==i?i:2e3,this.focus=10,this.aspect=void 0!==e?e:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()},THREE.PerspectiveCamera.prototype=Object.create(THREE.Camera.prototype),THREE.PerspectiveCamera.prototype.constructor=THREE.PerspectiveCamera,THREE.PerspectiveCamera.prototype.setLens=function(t,e){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==e&&(this.filmGauge=e),this.setFocalLength(t)},THREE.PerspectiveCamera.prototype.setFocalLength=function(t){var e=.5*this.getFilmHeight()/t;this.fov=2*THREE.Math.RAD2DEG*Math.atan(e),this.updateProjectionMatrix()},THREE.PerspectiveCamera.prototype.getFocalLength=function(){var t=Math.tan(.5*THREE.Math.DEG2RAD*this.fov);return.5*this.getFilmHeight()/t},THREE.PerspectiveCamera.prototype.getEffectiveFOV=function(){return 2*THREE.Math.RAD2DEG*Math.atan(Math.tan(.5*THREE.Math.DEG2RAD*this.fov)/this.zoom)},THREE.PerspectiveCamera.prototype.getFilmWidth=function(){return this.filmGauge*Math.min(this.aspect,1)},THREE.PerspectiveCamera.prototype.getFilmHeight=function(){return this.filmGauge/Math.max(this.aspect,1)},THREE.PerspectiveCamera.prototype.setViewOffset=function(t,e,n,i,r,o){this.aspect=t/e,this.view={fullWidth:t,fullHeight:e,offsetX:n,offsetY:i,width:r,height:o},this.updateProjectionMatrix()},THREE.PerspectiveCamera.prototype.updateProjectionMatrix=function(){var t=this.near,e=t*Math.tan(.5*THREE.Math.DEG2RAD*this.fov)/this.zoom,n=2*e,i=this.aspect*n,r=-.5*i,o=this.view;if(null!==o){var a=o.fullWidth,s=o.fullHeight;r+=o.offsetX*i/a,e-=o.offsetY*n/s,i*=o.width/a,n*=o.height/s}var c=this.filmOffset;0!==c&&(r+=t*c/this.getFilmWidth()),this.projectionMatrix.makeFrustum(r,r+i,e-n,e,t,this.far)},THREE.PerspectiveCamera.prototype.copy=function(t){return THREE.Camera.prototype.copy.call(this,t),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=null===t.view?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this},THREE.PerspectiveCamera.prototype.toJSON=function(t){var e=THREE.Object3D.prototype.toJSON.call(this,t);return e.object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,null!==this.view&&(e.object.view=Object.assign({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e},THREE.StereoCamera=function(){this.type="StereoCamera",this.aspect=1,this.cameraL=new THREE.PerspectiveCamera,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new THREE.PerspectiveCamera,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1},THREE.StereoCamera.prototype={constructor:THREE.StereoCamera,update:function(){var t,e,n,i,r,o=new THREE.Matrix4,a=new THREE.Matrix4;return function(s){var c=t!==s.focus||e!==s.fov||n!==s.aspect*this.aspect||i!==s.near||r!==s.far;if(c){t=s.focus,e=s.fov,n=s.aspect*this.aspect,i=s.near,r=s.far;var l,u,h=s.projectionMatrix.clone(),p=.032,d=p*i/t,f=i*Math.tan(THREE.Math.DEG2RAD*e*.5);a.elements[12]=-p,o.elements[12]=p,l=-f*n+d,u=f*n+d,h.elements[0]=2*i/(u-l),h.elements[8]=(u+l)/(u-l),this.cameraL.projectionMatrix.copy(h),l=-f*n-d,u=f*n-d,h.elements[0]=2*i/(u-l),h.elements[8]=(u+l)/(u-l),this.cameraR.projectionMatrix.copy(h)}this.cameraL.matrixWorld.copy(s.matrixWorld).multiply(a),
this.cameraR.matrixWorld.copy(s.matrixWorld).multiply(o)}}()},THREE.Light=function(t,e){THREE.Object3D.call(this),this.type="Light",this.color=new THREE.Color(t),this.intensity=void 0!==e?e:1,this.receiveShadow=void 0},THREE.Light.prototype=Object.create(THREE.Object3D.prototype),THREE.Light.prototype.constructor=THREE.Light,THREE.Light.prototype.copy=function(t){return THREE.Object3D.prototype.copy.call(this,t),this.color.copy(t.color),this.intensity=t.intensity,this},THREE.Light.prototype.toJSON=function(t){var e=THREE.Object3D.prototype.toJSON.call(this,t);return e.object.color=this.color.getHex(),e.object.intensity=this.intensity,void 0!==this.groundColor&&(e.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(e.object.distance=this.distance),void 0!==this.angle&&(e.object.angle=this.angle),void 0!==this.decay&&(e.object.decay=this.decay),void 0!==this.penumbra&&(e.object.penumbra=this.penumbra),e},THREE.LightShadow=function(t){this.camera=t,this.bias=0,this.radius=1,this.mapSize=new THREE.Vector2(512,512),this.map=null,this.matrix=new THREE.Matrix4},THREE.LightShadow.prototype={constructor:THREE.LightShadow,copy:function(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this},clone:function(){return(new this.constructor).copy(this)}},THREE.AmbientLight=function(t,e){THREE.Light.call(this,t,e),this.type="AmbientLight",this.castShadow=void 0},THREE.AmbientLight.prototype=Object.create(THREE.Light.prototype),THREE.AmbientLight.prototype.constructor=THREE.AmbientLight,THREE.DirectionalLight=function(t,e){THREE.Light.call(this,t,e),this.type="DirectionalLight",this.position.set(0,1,0),this.updateMatrix(),this.target=new THREE.Object3D,this.shadow=new THREE.DirectionalLightShadow},THREE.DirectionalLight.prototype=Object.create(THREE.Light.prototype),THREE.DirectionalLight.prototype.constructor=THREE.DirectionalLight,THREE.DirectionalLight.prototype.copy=function(t){return THREE.Light.prototype.copy.call(this,t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this},THREE.DirectionalLightShadow=function(t){THREE.LightShadow.call(this,new THREE.OrthographicCamera((-5),5,5,(-5),.5,500))},THREE.DirectionalLightShadow.prototype=Object.create(THREE.LightShadow.prototype),THREE.DirectionalLightShadow.prototype.constructor=THREE.DirectionalLightShadow,THREE.HemisphereLight=function(t,e,n){THREE.Light.call(this,t,n),this.type="HemisphereLight",this.castShadow=void 0,this.position.set(0,1,0),this.updateMatrix(),this.groundColor=new THREE.Color(e)},THREE.HemisphereLight.prototype=Object.create(THREE.Light.prototype),THREE.HemisphereLight.prototype.constructor=THREE.HemisphereLight,THREE.HemisphereLight.prototype.copy=function(t){return THREE.Light.prototype.copy.call(this,t),this.groundColor.copy(t.groundColor),this},THREE.PointLight=function(t,e,n,i){THREE.Light.call(this,t,e),this.type="PointLight",this.distance=void 0!==n?n:0,this.decay=void 0!==i?i:1,this.shadow=new THREE.LightShadow(new THREE.PerspectiveCamera(90,1,.5,500))},THREE.PointLight.prototype=Object.create(THREE.Light.prototype),THREE.PointLight.prototype.constructor=THREE.PointLight,Object.defineProperty(THREE.PointLight.prototype,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(t){this.intensity=t/(4*Math.PI)}}),THREE.PointLight.prototype.copy=function(t){return THREE.Light.prototype.copy.call(this,t),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this},THREE.SpotLight=function(t,e,n,i,r,o){THREE.Light.call(this,t,e),this.type="SpotLight",this.position.set(0,1,0),this.updateMatrix(),this.target=new THREE.Object3D,this.distance=void 0!==n?n:0,this.angle=void 0!==i?i:Math.PI/3,this.penumbra=void 0!==r?r:0,this.decay=void 0!==o?o:1,this.shadow=new THREE.SpotLightShadow},THREE.SpotLight.prototype=Object.create(THREE.Light.prototype),THREE.SpotLight.prototype.constructor=THREE.SpotLight,Object.defineProperty(THREE.SpotLight.prototype,"power",{get:function(){return this.intensity*Math.PI},set:function(t){this.intensity=t/Math.PI}}),THREE.SpotLight.prototype.copy=function(t){return THREE.Light.prototype.copy.call(this,t),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this},THREE.SpotLightShadow=function(){THREE.LightShadow.call(this,new THREE.PerspectiveCamera(50,1,.5,500))},THREE.SpotLightShadow.prototype=Object.create(THREE.LightShadow.prototype),THREE.SpotLightShadow.prototype.constructor=THREE.SpotLightShadow,THREE.SpotLightShadow.prototype.update=function(t){var e=2*THREE.Math.RAD2DEG*t.angle,n=this.mapSize.width/this.mapSize.height,i=t.distance||500,r=this.camera;e===r.fov&&n===r.aspect&&i===r.far||(r.fov=e,r.aspect=n,r.far=i,r.updateProjectionMatrix())},THREE.AudioLoader=function(t){this.manager=void 0!==t?t:THREE.DefaultLoadingManager},THREE.AudioLoader.prototype={constructor:THREE.AudioLoader,load:function(t,e,n,i){var r=new THREE.XHRLoader(this.manager);r.setResponseType("arraybuffer"),r.load(t,function(t){var n=THREE.AudioContext;n.decodeAudioData(t,function(t){e(t)})},n,i)}},THREE.Cache={enabled:!1,files:{},add:function(t,e){this.enabled!==!1&&(this.files[t]=e)},get:function(t){if(this.enabled!==!1)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}},THREE.Loader=function(){this.onLoadStart=function(){},this.onLoadProgress=function(){},this.onLoadComplete=function(){}},THREE.Loader.prototype={constructor:THREE.Loader,crossOrigin:"anonymous",extractUrlBase:function(t){var e=t.split("/");return 1===e.length?"./":(e.pop(),e.join("/")+"/")},initMaterials:function(t,e,n){for(var i=[],r=0;r<t.length;++r)i[r]=this.createMaterial(t[r],e,n);return i},createMaterial:function(){var t,e,n;return function(i,r,o){function a(t,n,i,a,c){var l,u=r+t,h=THREE.Loader.Handlers.get(u);null!==h?l=h.load(u):(e.setCrossOrigin(o),l=e.load(u)),void 0!==n&&(l.repeat.fromArray(n),1!==n[0]&&(l.wrapS=THREE.RepeatWrapping),1!==n[1]&&(l.wrapT=THREE.RepeatWrapping)),void 0!==i&&l.offset.fromArray(i),void 0!==a&&("repeat"===a[0]&&(l.wrapS=THREE.RepeatWrapping),"mirror"===a[0]&&(l.wrapS=THREE.MirroredRepeatWrapping),"repeat"===a[1]&&(l.wrapT=THREE.RepeatWrapping),"mirror"===a[1]&&(l.wrapT=THREE.MirroredRepeatWrapping)),void 0!==c&&(l.anisotropy=c);var p=THREE.Math.generateUUID();return s[p]=l,p}void 0===t&&(t=new THREE.Color),void 0===e&&(e=new THREE.TextureLoader),void 0===n&&(n=new THREE.MaterialLoader);var s={},c={uuid:THREE.Math.generateUUID(),type:"MeshLambertMaterial"};for(var l in i){var u=i[l];switch(l){case"DbgColor":case"DbgIndex":case"opticalDensity":case"illumination":break;case"DbgName":c.name=u;break;case"blending":c.blending=THREE[u];break;case"colorAmbient":case"mapAmbient":console.warn("THREE.Loader.createMaterial:",l,"is no longer supported.");break;case"colorDiffuse":c.color=t.fromArray(u).getHex();break;case"colorSpecular":c.specular=t.fromArray(u).getHex();break;case"colorEmissive":c.emissive=t.fromArray(u).getHex();break;case"specularCoef":c.shininess=u;break;case"shading":"basic"===u.toLowerCase()&&(c.type="MeshBasicMaterial"),"phong"===u.toLowerCase()&&(c.type="MeshPhongMaterial");break;case"mapDiffuse":c.map=a(u,i.mapDiffuseRepeat,i.mapDiffuseOffset,i.mapDiffuseWrap,i.mapDiffuseAnisotropy);break;case"mapDiffuseRepeat":case"mapDiffuseOffset":case"mapDiffuseWrap":case"mapDiffuseAnisotropy":break;case"mapLight":c.lightMap=a(u,i.mapLightRepeat,i.mapLightOffset,i.mapLightWrap,i.mapLightAnisotropy);break;case"mapLightRepeat":case"mapLightOffset":case"mapLightWrap":case"mapLightAnisotropy":break;case"mapAO":c.aoMap=a(u,i.mapAORepeat,i.mapAOOffset,i.mapAOWrap,i.mapAOAnisotropy);break;case"mapAORepeat":case"mapAOOffset":case"mapAOWrap":case"mapAOAnisotropy":break;case"mapBump":c.bumpMap=a(u,i.mapBumpRepeat,i.mapBumpOffset,i.mapBumpWrap,i.mapBumpAnisotropy);break;case"mapBumpScale":c.bumpScale=u;break;case"mapBumpRepeat":case"mapBumpOffset":case"mapBumpWrap":case"mapBumpAnisotropy":break;case"mapNormal":c.normalMap=a(u,i.mapNormalRepeat,i.mapNormalOffset,i.mapNormalWrap,i.mapNormalAnisotropy);break;case"mapNormalFactor":c.normalScale=[u,u];break;case"mapNormalRepeat":case"mapNormalOffset":case"mapNormalWrap":case"mapNormalAnisotropy":break;case"mapSpecular":c.specularMap=a(u,i.mapSpecularRepeat,i.mapSpecularOffset,i.mapSpecularWrap,i.mapSpecularAnisotropy);break;case"mapSpecularRepeat":case"mapSpecularOffset":case"mapSpecularWrap":case"mapSpecularAnisotropy":break;case"mapAlpha":c.alphaMap=a(u,i.mapAlphaRepeat,i.mapAlphaOffset,i.mapAlphaWrap,i.mapAlphaAnisotropy);break;case"mapAlphaRepeat":case"mapAlphaOffset":case"mapAlphaWrap":case"mapAlphaAnisotropy":break;case"flipSided":c.side=THREE.BackSide;break;case"doubleSided":c.side=THREE.DoubleSide;break;case"transparency":console.warn("THREE.Loader.createMaterial: transparency has been renamed to opacity"),c.opacity=u;break;case"depthTest":case"depthWrite":case"colorWrite":case"opacity":case"reflectivity":case"transparent":case"visible":case"wireframe":c[l]=u;break;case"vertexColors":u===!0&&(c.vertexColors=THREE.VertexColors),"face"===u&&(c.vertexColors=THREE.FaceColors);break;default:console.error("THREE.Loader.createMaterial: Unsupported",l,u)}}return"MeshBasicMaterial"===c.type&&delete c.emissive,"MeshPhongMaterial"!==c.type&&delete c.specular,c.opacity<1&&(c.transparent=!0),n.setTextures(s),n.parse(c)}}()},THREE.Loader.Handlers={handlers:[],add:function(t,e){this.handlers.push(t,e)},get:function(t){for(var e=this.handlers,n=0,i=e.length;n<i;n+=2){var r=e[n],o=e[n+1];if(r.test(t))return o}return null}},THREE.XHRLoader=function(t){this.manager=void 0!==t?t:THREE.DefaultLoadingManager},THREE.XHRLoader.prototype={constructor:THREE.XHRLoader,load:function(t,e,n,i){void 0!==this.path&&(t=this.path+t);var r=this,o=THREE.Cache.get(t);if(void 0!==o)return e&&setTimeout(function(){e(o)},0),o;var a=new XMLHttpRequest;return a.overrideMimeType("text/plain"),a.open("GET",t,!0),a.addEventListener("load",function(n){var o=n.target.response;THREE.Cache.add(t,o),200===this.status?(e&&e(o),r.manager.itemEnd(t)):0===this.status?(console.warn("THREE.XHRLoader: HTTP Status 0 received."),e&&e(o),r.manager.itemEnd(t)):(i&&i(n),r.manager.itemError(t))},!1),void 0!==n&&a.addEventListener("progress",function(t){n(t)},!1),a.addEventListener("error",function(e){i&&i(e),r.manager.itemError(t)},!1),void 0!==this.responseType&&(a.responseType=this.responseType),void 0!==this.withCredentials&&(a.withCredentials=this.withCredentials),a.send(null),r.manager.itemStart(t),a},setPath:function(t){this.path=t},setResponseType:function(t){this.responseType=t},setWithCredentials:function(t){this.withCredentials=t}},THREE.FontLoader=function(t){this.manager=void 0!==t?t:THREE.DefaultLoadingManager},THREE.FontLoader.prototype={constructor:THREE.FontLoader,load:function(t,e,n,i){var r=new THREE.XHRLoader(this.manager);r.load(t,function(t){e(new THREE.Font(JSON.parse(t.substring(65,t.length-2))))},n,i)}},THREE.ImageLoader=function(t){this.manager=void 0!==t?t:THREE.DefaultLoadingManager},THREE.ImageLoader.prototype={constructor:THREE.ImageLoader,load:function(t,e,n,i){void 0!==this.path&&(t=this.path+t),console.log("ImageLoader: "+t);var r=this,o=THREE.Cache.get(t);if(void 0!==o)return console.log("ImageLoader: image use cache"),r.manager.itemStart(t),e?setTimeout(function(){e(o),r.manager.itemEnd(t)},0):r.manager.itemEnd(t),o;var a=document.createElement("img");return a.crossOrigin="anonymous",a.addEventListener("load",function(n){console.log("ImageLoader: image loadeded"),THREE.Cache.add(t,this),e&&e(this),r.manager.itemEnd(t)},!1),void 0!==n&&a.addEventListener("progress",function(t){n(t)},!1),a.addEventListener("error",function(e){i&&i(e),r.manager.itemError(t)},!1),r.manager.itemStart(t),a.src=t,a},setCrossOrigin:function(t){this.crossOrigin=t},setPath:function(t){this.path=t}},THREE.JSONLoader=function(t){"boolean"==typeof t&&(console.warn("THREE.JSONLoader: showStatus parameter has been removed from constructor."),t=void 0),this.manager=void 0!==t?t:THREE.DefaultLoadingManager,this.withCredentials=!1};THREE.JSONLoader.prototype={constructor:THREE.JSONLoader,get statusDomElement(){return void 0===this._statusDomElement&&(this._statusDomElement=document.createElement("div")),console.warn("THREE.JSONLoader: .statusDomElement has been removed."),this._statusDomElement},load:function(t,e,n,i){var r=this,o=this.texturePath&&"string"==typeof this.texturePath?this.texturePath:THREE.Loader.prototype.extractUrlBase(t),a=new THREE.XHRLoader(this.manager);a.setWithCredentials(this.withCredentials),a.load(t,function(n){var i=JSON.parse(n),a=i.metadata;if(void 0!==a){var s=a.type;if(void 0!==s){if("object"===s.toLowerCase())return void console.error("THREE.JSONLoader: "+t+" should be loaded with THREE.ObjectLoader instead.");if("scene"===s.toLowerCase())return void console.error("THREE.JSONLoader: "+t+" should be loaded with THREE.SceneLoader instead.")}}var c=r.parse(i,o);e(c.geometry,c.materials)},n,i)},setTexturePath:function(t){this.texturePath=t},parse:function(t,e){function n(e){function n(t,e){return t&1<<e}var i,r,o,s,c,l,u,h,p,d,f,m,v,g,y,E,_,T,b,w,R,x,H,M,S,C,A,P=t.faces,L=t.vertices,O=t.normals,j=t.colors,k=0;if(void 0!==t.uvs){for(i=0;i<t.uvs.length;i++)t.uvs[i].length&&k++;for(i=0;i<k;i++)a.faceVertexUvs[i]=[]}for(s=0,c=L.length;s<c;)T=new THREE.Vector3,T.x=L[s++]*e,T.y=L[s++]*e,T.z=L[s++]*e,a.vertices.push(T);for(s=0,c=P.length;s<c;)if(d=P[s++],f=n(d,0),m=n(d,1),v=n(d,3),g=n(d,4),y=n(d,5),E=n(d,6),_=n(d,7),f){if(w=new THREE.Face3,w.a=P[s],w.b=P[s+1],w.c=P[s+3],R=new THREE.Face3,R.a=P[s+1],R.b=P[s+2],R.c=P[s+3],s+=4,m&&(p=P[s++],w.materialIndex=p,R.materialIndex=p),o=a.faces.length,v)for(i=0;i<k;i++)for(M=t.uvs[i],a.faceVertexUvs[i][o]=[],a.faceVertexUvs[i][o+1]=[],r=0;r<4;r++)h=P[s++],C=M[2*h],A=M[2*h+1],S=new THREE.Vector2(C,A),2!==r&&a.faceVertexUvs[i][o].push(S),0!==r&&a.faceVertexUvs[i][o+1].push(S);if(g&&(u=3*P[s++],w.normal.set(O[u++],O[u++],O[u]),R.normal.copy(w.normal)),y)for(i=0;i<4;i++)u=3*P[s++],H=new THREE.Vector3(O[u++],O[u++],O[u]),2!==i&&w.vertexNormals.push(H),0!==i&&R.vertexNormals.push(H);if(E&&(l=P[s++],x=j[l],w.color.setHex(x),R.color.setHex(x)),_)for(i=0;i<4;i++)l=P[s++],x=j[l],2!==i&&w.vertexColors.push(new THREE.Color(x)),0!==i&&R.vertexColors.push(new THREE.Color(x));a.faces.push(w),a.faces.push(R)}else{if(b=new THREE.Face3,b.a=P[s++],b.b=P[s++],b.c=P[s++],m&&(p=P[s++],b.materialIndex=p),o=a.faces.length,v)for(i=0;i<k;i++)for(M=t.uvs[i],a.faceVertexUvs[i][o]=[],r=0;r<3;r++)h=P[s++],C=M[2*h],A=M[2*h+1],S=new THREE.Vector2(C,A),a.faceVertexUvs[i][o].push(S);if(g&&(u=3*P[s++],b.normal.set(O[u++],O[u++],O[u])),y)for(i=0;i<3;i++)u=3*P[s++],H=new THREE.Vector3(O[u++],O[u++],O[u]),b.vertexNormals.push(H);if(E&&(l=P[s++],b.color.setHex(j[l])),_)for(i=0;i<3;i++)l=P[s++],b.vertexColors.push(new THREE.Color(j[l]));a.faces.push(b)}}function i(){var e=void 0!==t.influencesPerVertex?t.influencesPerVertex:2;if(t.skinWeights)for(var n=0,i=t.skinWeights.length;n<i;n+=e){var r=t.skinWeights[n],o=e>1?t.skinWeights[n+1]:0,s=e>2?t.skinWeights[n+2]:0,c=e>3?t.skinWeights[n+3]:0;a.skinWeights.push(new THREE.Vector4(r,o,s,c))}if(t.skinIndices)for(var n=0,i=t.skinIndices.length;n<i;n+=e){var l=t.skinIndices[n],u=e>1?t.skinIndices[n+1]:0,h=e>2?t.skinIndices[n+2]:0,p=e>3?t.skinIndices[n+3]:0;a.skinIndices.push(new THREE.Vector4(l,u,h,p))}a.bones=t.bones,a.bones&&a.bones.length>0&&(a.skinWeights.length!==a.skinIndices.length||a.skinIndices.length!==a.vertices.length)&&console.warn("When skinning, number of vertices ("+a.vertices.length+"), skinIndices ("+a.skinIndices.length+"), and skinWeights ("+a.skinWeights.length+") should match.")}function r(e){if(void 0!==t.morphTargets)for(var n=0,i=t.morphTargets.length;n<i;n++){a.morphTargets[n]={},a.morphTargets[n].name=t.morphTargets[n].name,a.morphTargets[n].vertices=[];for(var r=a.morphTargets[n].vertices,o=t.morphTargets[n].vertices,s=0,c=o.length;s<c;s+=3){var l=new THREE.Vector3;l.x=o[s]*e,l.y=o[s+1]*e,l.z=o[s+2]*e,r.push(l)}}if(void 0!==t.morphColors&&t.morphColors.length>0){console.warn('THREE.JSONLoader: "morphColors" no longer supported. Using them as face colors.');for(var u=a.faces,h=t.morphColors[0].colors,n=0,i=u.length;n<i;n++)u[n].color.fromArray(h,3*n)}}function o(){var e=[],n=[];void 0!==t.animation&&n.push(t.animation),void 0!==t.animations&&(t.animations.length?n=n.concat(t.animations):n.push(t.animations));for(var i=0;i<n.length;i++){var r=THREE.AnimationClip.parseAnimation(n[i],a.bones);r&&e.push(r)}if(a.morphTargets){var o=THREE.AnimationClip.CreateClipsFromMorphTargetSequences(a.morphTargets,10);e=e.concat(o)}e.length>0&&(a.animations=e)}var a=new THREE.Geometry,s=void 0!==t.scale?1/t.scale:1;if(n(s),i(),r(s),o(),a.computeFaceNormals(),a.computeBoundingSphere(),void 0===t.materials||0===t.materials.length)return{geometry:a};var c=THREE.Loader.prototype.initMaterials(t.materials,e,this.crossOrigin);return{geometry:a,materials:c}}};THREE.LoadingManager=function(t,e,n){var i=this,r=!1,o=0,a=0;this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=n,this.itemStart=function(t){a++,r===!1&&void 0!==i.onStart&&i.onStart(t,o,a),r=!0},this.itemEnd=function(t){o++,void 0!==i.onProgress&&i.onProgress(t,o,a),o===a&&(r=!1,void 0!==i.onLoad&&i.onLoad())},this.itemError=function(t){void 0!==i.onError&&i.onError(t)}},THREE.DefaultLoadingManager=new THREE.LoadingManager,THREE.BufferGeometryLoader=function(t){this.manager=void 0!==t?t:THREE.DefaultLoadingManager},THREE.BufferGeometryLoader.prototype={constructor:THREE.BufferGeometryLoader,load:function(t,e,n,i){var r=this,o=new THREE.XHRLoader(r.manager);o.load(t,function(t){e(r.parse(JSON.parse(t)))},n,i)},parse:function(t){var e=new THREE.BufferGeometry,n=t.data.index,i={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:Uint8ClampedArray,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};if(void 0!==n){var r=new i[n.type](n.array);e.setIndex(new THREE.BufferAttribute(r,1))}var o=t.data.attributes;for(var a in o){var s=o[a],r=new i[s.type](s.array);e.addAttribute(a,new THREE.BufferAttribute(r,s.itemSize,s.normalized))}var c=t.data.groups||t.data.drawcalls||t.data.offsets;if(void 0!==c)for(var l=0,u=c.length;l!==u;++l){var h=c[l];e.addGroup(h.start,h.count,h.materialIndex)}var p=t.data.boundingSphere;if(void 0!==p){var d=new THREE.Vector3;void 0!==p.center&&d.fromArray(p.center),e.boundingSphere=new THREE.Sphere(d,p.radius)}return e}},THREE.MaterialLoader=function(t){this.manager=void 0!==t?t:THREE.DefaultLoadingManager,this.textures={}},THREE.MaterialLoader.prototype={constructor:THREE.MaterialLoader,load:function(t,e,n,i){var r=this,o=new THREE.XHRLoader(r.manager);o.load(t,function(t){e(r.parse(JSON.parse(t)))},n,i)},setTextures:function(t){this.textures=t},getTexture:function(t){var e=this.textures;return void 0===e[t]&&console.warn("THREE.MaterialLoader: Undefined texture",t),e[t]},parse:function(t){var e=new THREE[t.type];if(void 0!==t.uuid&&(e.uuid=t.uuid),void 0!==t.name&&(e.name=t.name),void 0!==t.color&&e.color.setHex(t.color),void 0!==t.roughness&&(e.roughness=t.roughness),void 0!==t.metalness&&(e.metalness=t.metalness),void 0!==t.emissive&&e.emissive.setHex(t.emissive),void 0!==t.specular&&e.specular.setHex(t.specular),void 0!==t.shininess&&(e.shininess=t.shininess),void 0!==t.uniforms&&(e.uniforms=t.uniforms),void 0!==t.vertexShader&&(e.vertexShader=t.vertexShader),void 0!==t.fragmentShader&&(e.fragmentShader=t.fragmentShader),void 0!==t.vertexColors&&(e.vertexColors=t.vertexColors),void 0!==t.shading&&(e.shading=t.shading),void 0!==t.blending&&(e.blending=t.blending),void 0!==t.side&&(e.side=t.side),void 0!==t.opacity&&(e.opacity=t.opacity),void 0!==t.transparent&&(e.transparent=t.transparent),void 0!==t.alphaTest&&(e.alphaTest=t.alphaTest),void 0!==t.depthTest&&(e.depthTest=t.depthTest),void 0!==t.depthWrite&&(e.depthWrite=t.depthWrite),void 0!==t.colorWrite&&(e.colorWrite=t.colorWrite),void 0!==t.wireframe&&(e.wireframe=t.wireframe),void 0!==t.wireframeLinewidth&&(e.wireframeLinewidth=t.wireframeLinewidth),void 0!==t.size&&(e.size=t.size),void 0!==t.sizeAttenuation&&(e.sizeAttenuation=t.sizeAttenuation),void 0!==t.map&&(e.map=this.getTexture(t.map)),void 0!==t.alphaMap&&(e.alphaMap=this.getTexture(t.alphaMap),e.transparent=!0),void 0!==t.bumpMap&&(e.bumpMap=this.getTexture(t.bumpMap)),void 0!==t.bumpScale&&(e.bumpScale=t.bumpScale),void 0!==t.normalMap&&(e.normalMap=this.getTexture(t.normalMap)),void 0!==t.normalScale){var n=t.normalScale;Array.isArray(n)===!1&&(n=[n,n]),e.normalScale=(new THREE.Vector2).fromArray(n)}if(void 0!==t.displacementMap&&(e.displacementMap=this.getTexture(t.displacementMap)),void 0!==t.displacementScale&&(e.displacementScale=t.displacementScale),void 0!==t.displacementBias&&(e.displacementBias=t.displacementBias),void 0!==t.roughnessMap&&(e.roughnessMap=this.getTexture(t.roughnessMap)),void 0!==t.metalnessMap&&(e.metalnessMap=this.getTexture(t.metalnessMap)),void 0!==t.emissiveMap&&(e.emissiveMap=this.getTexture(t.emissiveMap)),void 0!==t.emissiveIntensity&&(e.emissiveIntensity=t.emissiveIntensity),void 0!==t.specularMap&&(e.specularMap=this.getTexture(t.specularMap)),void 0!==t.envMap&&(e.envMap=this.getTexture(t.envMap),e.combine=THREE.MultiplyOperation),t.reflectivity&&(e.reflectivity=t.reflectivity),void 0!==t.lightMap&&(e.lightMap=this.getTexture(t.lightMap)),void 0!==t.lightMapIntensity&&(e.lightMapIntensity=t.lightMapIntensity),void 0!==t.aoMap&&(e.aoMap=this.getTexture(t.aoMap)),void 0!==t.aoMapIntensity&&(e.aoMapIntensity=t.aoMapIntensity),void 0!==t.materials)for(var i=0,r=t.materials.length;i<r;i++)e.materials.push(this.parse(t.materials[i]));return e}},THREE.ObjectLoader=function(t){this.manager=void 0!==t?t:THREE.DefaultLoadingManager,this.texturePath=""},THREE.ObjectLoader.prototype={constructor:THREE.ObjectLoader,load:function(t,e,n,i){""===this.texturePath&&(this.texturePath=t.substring(0,t.lastIndexOf("/")+1));var r=this,o=new THREE.XHRLoader(r.manager);o.load(t,function(t){r.parse(JSON.parse(t),e)},n,i)},setTexturePath:function(t){this.texturePath=t},setCrossOrigin:function(t){this.crossOrigin=t},parse:function(t,e){var n=this.parseGeometries(t.geometries),i=this.parseImages(t.images,function(){void 0!==e&&e(a)}),r=this.parseTextures(t.textures,i),o=this.parseMaterials(t.materials,r),a=this.parseObject(t.object,n,o);return t.animations&&(a.animations=this.parseAnimations(t.animations)),void 0!==t.images&&0!==t.images.length||void 0!==e&&e(a),a},parseGeometries:function(t){var e={};if(void 0!==t)for(var n=new THREE.JSONLoader,i=new THREE.BufferGeometryLoader,r=0,o=t.length;r<o;r++){var a,s=t[r];switch(s.type){case"PlaneGeometry":case"PlaneBufferGeometry":a=new THREE[s.type](s.width,s.height,s.widthSegments,s.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":a=new THREE[s.type](s.width,s.height,s.depth,s.widthSegments,s.heightSegments,s.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":a=new THREE[s.type](s.radius,s.segments,s.thetaStart,s.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":a=new THREE[s.type](s.radiusTop,s.radiusBottom,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":a=new THREE[s.type](s.radius,s.widthSegments,s.heightSegments,s.phiStart,s.phiLength,s.thetaStart,s.thetaLength);break;case"DodecahedronGeometry":a=new THREE.DodecahedronGeometry(s.radius,s.detail);break;case"IcosahedronGeometry":a=new THREE.IcosahedronGeometry(s.radius,s.detail);break;case"OctahedronGeometry":a=new THREE.OctahedronGeometry(s.radius,s.detail);break;case"TetrahedronGeometry":a=new THREE.TetrahedronGeometry(s.radius,s.detail);break;case"RingGeometry":case"RingBufferGeometry":a=new THREE[s.type](s.innerRadius,s.outerRadius,s.thetaSegments,s.phiSegments,s.thetaStart,s.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":a=new THREE[s.type](s.radius,s.tube,s.radialSegments,s.tubularSegments,s.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":a=new THREE[s.type](s.radius,s.tube,s.tubularSegments,s.radialSegments,s.p,s.q);break;case"LatheGeometry":case"LatheBufferGeometry":a=new THREE[s.type](s.points,s.segments,s.phiStart,s.phiLength);break;case"BufferGeometry":a=i.parse(s);break;case"Geometry":a=n.parse(s.data,this.texturePath).geometry;break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+s.type+'"');continue}a.uuid=s.uuid,void 0!==s.name&&(a.name=s.name),e[s.uuid]=a}return e},parseMaterials:function(t,e){var n={};if(void 0!==t){var i=new THREE.MaterialLoader;i.setTextures(e);for(var r=0,o=t.length;r<o;r++){var a=i.parse(t[r]);n[a.uuid]=a}}return n},parseAnimations:function(t){for(var e=[],n=0;n<t.length;n++){var i=THREE.AnimationClip.parse(t[n]);e.push(i)}return e},parseImages:function(t,e){function n(t){return i.manager.itemStart(t),a.load(t,function(){i.manager.itemEnd(t)})}var i=this,r={};if(void 0!==t&&t.length>0){var o=new THREE.LoadingManager(e),a=new THREE.ImageLoader(o);a.setCrossOrigin(this.crossOrigin);for(var s=0,c=t.length;s<c;s++){var l=t[s],u=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(l.url)?l.url:i.texturePath+l.url;r[l.uuid]=n(u)}}return r},parseTextures:function(t,e){function n(t){return"number"==typeof t?t:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",t),THREE[t])}var i={};if(void 0!==t)for(var r=0,o=t.length;r<o;r++){var a=t[r];void 0===a.image&&console.warn('THREE.ObjectLoader: No "image" specified for',a.uuid),void 0===e[a.image]&&console.warn("THREE.ObjectLoader: Undefined image",a.image);var s=new THREE.Texture(e[a.image]);s.needsUpdate=!0,s.uuid=a.uuid,void 0!==a.name&&(s.name=a.name),void 0!==a.mapping&&(s.mapping=n(a.mapping)),void 0!==a.offset&&(s.offset=new THREE.Vector2(a.offset[0],a.offset[1])),void 0!==a.repeat&&(s.repeat=new THREE.Vector2(a.repeat[0],a.repeat[1])),void 0!==a.minFilter&&(s.minFilter=n(a.minFilter)),void 0!==a.magFilter&&(s.magFilter=n(a.magFilter)),void 0!==a.anisotropy&&(s.anisotropy=a.anisotropy),Array.isArray(a.wrap)&&(s.wrapS=n(a.wrap[0]),s.wrapT=n(a.wrap[1])),i[a.uuid]=s}return i},parseObject:function(){var t=new THREE.Matrix4;return function(e,n,i){function r(t){return void 0===n[t]&&console.warn("THREE.ObjectLoader: Undefined geometry",t),n[t]}function o(t){if(void 0!==t)return void 0===i[t]&&console.warn("THREE.ObjectLoader: Undefined material",t),i[t]}var a;switch(e.type){case"Scene":a=new THREE.Scene;break;case"PerspectiveCamera":a=new THREE.PerspectiveCamera(e.fov,e.aspect,e.near,e.far),void 0!==e.focus&&(a.focus=e.focus),void 0!==e.zoom&&(a.zoom=e.zoom),void 0!==e.filmGauge&&(a.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(a.filmOffset=e.filmOffset),void 0!==e.view&&(a.view=Object.assign({},e.view));break;case"OrthographicCamera":a=new THREE.OrthographicCamera(e.left,e.right,e.top,e.bottom,e.near,e.far);break;case"AmbientLight":a=new THREE.AmbientLight(e.color,e.intensity);break;case"DirectionalLight":a=new THREE.DirectionalLight(e.color,e.intensity);break;case"PointLight":a=new THREE.PointLight(e.color,e.intensity,e.distance,e.decay);break;case"SpotLight":a=new THREE.SpotLight(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":a=new THREE.HemisphereLight(e.color,e.groundColor,e.intensity);break;case"Mesh":var s=r(e.geometry),c=o(e.material);a=s.bones&&s.bones.length>0?new THREE.SkinnedMesh(s,c):new THREE.Mesh(s,c);break;case"LOD":a=new THREE.LOD;break;case"Line":a=new THREE.Line(r(e.geometry),o(e.material),e.mode);break;case"PointCloud":case"Points":a=new THREE.Points(r(e.geometry),o(e.material));break;case"Sprite":a=new THREE.Sprite(o(e.material));break;case"Group":a=new THREE.Group;break;default:a=new THREE.Object3D}if(a.uuid=e.uuid,void 0!==e.name&&(a.name=e.name),void 0!==e.matrix?(t.fromArray(e.matrix),t.decompose(a.position,a.quaternion,a.scale)):(void 0!==e.position&&a.position.fromArray(e.position),void 0!==e.rotation&&a.rotation.fromArray(e.rotation),void 0!==e.scale&&a.scale.fromArray(e.scale)),void 0!==e.castShadow&&(a.castShadow=e.castShadow),void 0!==e.receiveShadow&&(a.receiveShadow=e.receiveShadow),void 0!==e.visible&&(a.visible=e.visible),void 0!==e.userData&&(a.userData=e.userData),void 0!==e.children)for(var l in e.children)a.add(this.parseObject(e.children[l],n,i));if("LOD"===e.type)for(var u=e.levels,h=0;h<u.length;h++){var p=u[h],l=a.getObjectByProperty("uuid",p.object);void 0!==l&&a.addLevel(l,p.distance)}return a}}()},THREE.TextureLoader=function(t){this.manager=void 0!==t?t:THREE.DefaultLoadingManager},THREE.TextureLoader.prototype={constructor:THREE.TextureLoader,load:function(t,e,n,i){var r=new THREE.Texture,o=new THREE.ImageLoader(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(t,function(t){r.image=t,r.needsUpdate=!0,void 0!==e&&e(r)},n,i),r},setCrossOrigin:function(t){this.crossOrigin=t},setPath:function(t){this.path=t}},THREE.CubeTextureLoader=function(t){this.manager=void 0!==t?t:THREE.DefaultLoadingManager},THREE.CubeTextureLoader.prototype={constructor:THREE.CubeTextureLoader,load:function(t,e,n,i){function r(n){a.load(t[n],function(t){o.images[n]=t,s++,6===s&&(o.needsUpdate=!0,e&&e(o))},void 0,i)}var o=new THREE.CubeTexture,a=new THREE.ImageLoader(this.manager);a.setCrossOrigin(this.crossOrigin),a.setPath(this.path);for(var s=0,c=0;c<t.length;++c)r(c);return o},setCrossOrigin:function(t){this.crossOrigin=t},setPath:function(t){this.path=t}},THREE.DataTextureLoader=THREE.BinaryTextureLoader=function(t){this.manager=void 0!==t?t:THREE.DefaultLoadingManager,this._parser=null},THREE.BinaryTextureLoader.prototype={constructor:THREE.BinaryTextureLoader,load:function(t,e,n,i){var r=this,o=new THREE.DataTexture,a=new THREE.XHRLoader(this.manager);return a.setResponseType("arraybuffer"),a.load(t,function(t){var n=r._parser(t);n&&(void 0!==n.image?o.image=n.image:void 0!==n.data&&(o.image.width=n.width,o.image.height=n.height,o.image.data=n.data),o.wrapS=void 0!==n.wrapS?n.wrapS:THREE.ClampToEdgeWrapping,o.wrapT=void 0!==n.wrapT?n.wrapT:THREE.ClampToEdgeWrapping,o.magFilter=void 0!==n.magFilter?n.magFilter:THREE.LinearFilter,o.minFilter=void 0!==n.minFilter?n.minFilter:THREE.LinearMipMapLinearFilter,o.anisotropy=void 0!==n.anisotropy?n.anisotropy:1,void 0!==n.format&&(o.format=n.format),void 0!==n.type&&(o.type=n.type),void 0!==n.mipmaps&&(o.mipmaps=n.mipmaps),1===n.mipmapCount&&(o.minFilter=THREE.LinearFilter),o.needsUpdate=!0,e&&e(o,n))},n,i),o}},THREE.CompressedTextureLoader=function(t){this.manager=void 0!==t?t:THREE.DefaultLoadingManager,this._parser=null},THREE.CompressedTextureLoader.prototype={constructor:THREE.CompressedTextureLoader,load:function(t,e,n,i){function r(r){c.load(t[r],function(t){var n=o._parser(t,!0);a[r]={width:n.width,height:n.height,format:n.format,mipmaps:n.mipmaps},l+=1,6===l&&(1===n.mipmapCount&&(s.minFilter=THREE.LinearFilter),s.format=n.format,s.needsUpdate=!0,e&&e(s))},n,i)}var o=this,a=[],s=new THREE.CompressedTexture;s.image=a;var c=new THREE.XHRLoader(this.manager);if(c.setPath(this.path),c.setResponseType("arraybuffer"),Array.isArray(t))for(var l=0,u=0,h=t.length;u<h;++u)r(u);else c.load(t,function(t){var n=o._parser(t,!0);if(n.isCubemap)for(var i=n.mipmaps.length/n.mipmapCount,r=0;r<i;r++){a[r]={mipmaps:[]};for(var c=0;c<n.mipmapCount;c++)a[r].mipmaps.push(n.mipmaps[r*n.mipmapCount+c]),a[r].format=n.format,a[r].width=n.width,a[r].height=n.height}else s.image.width=n.width,s.image.height=n.height,s.mipmaps=n.mipmaps;1===n.mipmapCount&&(s.minFilter=THREE.LinearFilter),s.format=n.format,s.needsUpdate=!0,e&&e(s)},n,i);return s},setPath:function(t){this.path=t}},THREE.Material=function(){Object.defineProperty(this,"id",{value:THREE.MaterialIdCount++}),this.uuid=THREE.Math.generateUUID(),
this.name="",this.type="Material",this.side=THREE.FrontSide,this.opacity=1,this.transparent=!1,this.blending=THREE.NormalBlending,this.blendSrc=THREE.SrcAlphaFactor,this.blendDst=THREE.OneMinusSrcAlphaFactor,this.blendEquation=THREE.AddEquation,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=THREE.LessEqualDepth,this.depthTest=!0,this.depthWrite=!0,this.clippingPlanes=null,this.clipShadows=!1,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.alphaTest=0,this.premultipliedAlpha=!1,this.overdraw=0,this.visible=!0,this._needsUpdate=!0},THREE.Material.prototype={constructor:THREE.Material,get needsUpdate(){return this._needsUpdate},set needsUpdate(t){t===!0&&this.update(),this._needsUpdate=t},setValues:function(t){if(void 0!==t)for(var e in t){var n=t[e];if(void 0!==n){var i=this[e];void 0!==i?i instanceof THREE.Color?i.set(n):i instanceof THREE.Vector3&&n instanceof THREE.Vector3?i.copy(n):"overdraw"===e?this[e]=Number(n):this[e]=n:console.warn("THREE."+this.type+": '"+e+"' is not a property of this material.")}else console.warn("THREE.Material: '"+e+"' parameter is undefined.")}},toJSON:function(t){function e(t){var e=[];for(var n in t){var i=t[n];delete i.metadata,e.push(i)}return e}var n=void 0===t;n&&(t={textures:{},images:{}});var i={metadata:{version:4.4,type:"Material",generator:"Material.toJSON"}};if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),this.color instanceof THREE.Color&&(i.color=this.color.getHex()),.5!==this.roughness&&(i.roughness=this.roughness),.5!==this.metalness&&(i.metalness=this.metalness),this.emissive instanceof THREE.Color&&(i.emissive=this.emissive.getHex()),this.specular instanceof THREE.Color&&(i.specular=this.specular.getHex()),void 0!==this.shininess&&(i.shininess=this.shininess),this.map instanceof THREE.Texture&&(i.map=this.map.toJSON(t).uuid),this.alphaMap instanceof THREE.Texture&&(i.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap instanceof THREE.Texture&&(i.lightMap=this.lightMap.toJSON(t).uuid),this.bumpMap instanceof THREE.Texture&&(i.bumpMap=this.bumpMap.toJSON(t).uuid,i.bumpScale=this.bumpScale),this.normalMap instanceof THREE.Texture&&(i.normalMap=this.normalMap.toJSON(t).uuid,i.normalScale=this.normalScale.toArray()),this.displacementMap instanceof THREE.Texture&&(i.displacementMap=this.displacementMap.toJSON(t).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap instanceof THREE.Texture&&(i.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap instanceof THREE.Texture&&(i.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap instanceof THREE.Texture&&(i.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap instanceof THREE.Texture&&(i.specularMap=this.specularMap.toJSON(t).uuid),this.envMap instanceof THREE.Texture&&(i.envMap=this.envMap.toJSON(t).uuid,i.reflectivity=this.reflectivity),void 0!==this.size&&(i.size=this.size),void 0!==this.sizeAttenuation&&(i.sizeAttenuation=this.sizeAttenuation),void 0!==this.vertexColors&&this.vertexColors!==THREE.NoColors&&(i.vertexColors=this.vertexColors),void 0!==this.shading&&this.shading!==THREE.SmoothShading&&(i.shading=this.shading),void 0!==this.blending&&this.blending!==THREE.NormalBlending&&(i.blending=this.blending),void 0!==this.side&&this.side!==THREE.FrontSide&&(i.side=this.side),this.opacity<1&&(i.opacity=this.opacity),this.transparent===!0&&(i.transparent=this.transparent),this.alphaTest>0&&(i.alphaTest=this.alphaTest),this.premultipliedAlpha===!0&&(i.premultipliedAlpha=this.premultipliedAlpha),this.wireframe===!0&&(i.wireframe=this.wireframe),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),n){var r=e(t.textures),o=e(t.images);r.length>0&&(i.textures=r),o.length>0&&(i.images=o)}return i},clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.name=t.name,this.side=t.side,this.opacity=t.opacity,this.transparent=t.transparent,this.blending=t.blending,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.alphaTest=t.alphaTest,this.premultipliedAlpha=t.premultipliedAlpha,this.overdraw=t.overdraw,this.visible=t.visible,this.clipShadows=t.clipShadows;var e=t.clippingPlanes,n=null;if(null!==e){var i=e.length;n=new Array(i);for(var r=0;r!==i;++r)n[r]=e[r].clone()}return this.clippingPlanes=n,this},update:function(){this.dispatchEvent({type:"update"})},dispose:function(){this.dispatchEvent({type:"dispose"})}},THREE.EventDispatcher.prototype.apply(THREE.Material.prototype),THREE.MaterialIdCount=0,THREE.LineBasicMaterial=function(t){THREE.Material.call(this),this.type="LineBasicMaterial",this.color=new THREE.Color(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.blending=THREE.NormalBlending,this.vertexColors=THREE.NoColors,this.fog=!0,this.setValues(t)},THREE.LineBasicMaterial.prototype=Object.create(THREE.Material.prototype),THREE.LineBasicMaterial.prototype.constructor=THREE.LineBasicMaterial,THREE.LineBasicMaterial.prototype.copy=function(t){return THREE.Material.prototype.copy.call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this.vertexColors=t.vertexColors,this.fog=t.fog,this},THREE.LineDashedMaterial=function(t){THREE.Material.call(this),this.type="LineDashedMaterial",this.color=new THREE.Color(16777215),this.linewidth=1,this.scale=1,this.dashSize=3,this.gapSize=1,this.blending=THREE.NormalBlending,this.vertexColors=THREE.NoColors,this.fog=!0,this.setValues(t)},THREE.LineDashedMaterial.prototype=Object.create(THREE.Material.prototype),THREE.LineDashedMaterial.prototype.constructor=THREE.LineDashedMaterial,THREE.LineDashedMaterial.prototype.copy=function(t){return THREE.Material.prototype.copy.call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this.vertexColors=t.vertexColors,this.fog=t.fog,this},THREE.MeshBasicMaterial=function(t){THREE.Material.call(this),this.type="MeshBasicMaterial",this.color=new THREE.Color(16777215),this.map=null,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=THREE.MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.shading=THREE.SmoothShading,this.blending=THREE.NormalBlending,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.vertexColors=THREE.NoColors,this.skinning=!1,this.morphTargets=!1,this.setValues(t)},THREE.MeshBasicMaterial.prototype=Object.create(THREE.Material.prototype),THREE.MeshBasicMaterial.prototype.constructor=THREE.MeshBasicMaterial,THREE.MeshBasicMaterial.prototype.copy=function(t){return THREE.Material.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.fog=t.fog,this.shading=t.shading,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.vertexColors=t.vertexColors,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this},THREE.MeshDepthMaterial=function(t){THREE.Material.call(this),this.type="MeshDepthMaterial",this.depthPacking=THREE.BasicDepthPacking,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(t)},THREE.MeshDepthMaterial.prototype=Object.create(THREE.Material.prototype),THREE.MeshDepthMaterial.prototype.constructor=THREE.MeshDepthMaterial,THREE.MeshDepthMaterial.prototype.copy=function(t){return THREE.Material.prototype.copy.call(this,t),this.depthPacking=t.depthPacking,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this},THREE.MeshLambertMaterial=function(t){THREE.Material.call(this),this.type="MeshLambertMaterial",this.color=new THREE.Color(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new THREE.Color(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=THREE.MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.blending=THREE.NormalBlending,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.vertexColors=THREE.NoColors,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)},THREE.MeshLambertMaterial.prototype=Object.create(THREE.Material.prototype),THREE.MeshLambertMaterial.prototype.constructor=THREE.MeshLambertMaterial,THREE.MeshLambertMaterial.prototype.copy=function(t){return THREE.Material.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.fog=t.fog,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.vertexColors=t.vertexColors,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},THREE.MeshNormalMaterial=function(t){THREE.Material.call(this,t),this.type="MeshNormalMaterial",this.wireframe=!1,this.wireframeLinewidth=1,this.morphTargets=!1,this.setValues(t)},THREE.MeshNormalMaterial.prototype=Object.create(THREE.Material.prototype),THREE.MeshNormalMaterial.prototype.constructor=THREE.MeshNormalMaterial,THREE.MeshNormalMaterial.prototype.copy=function(t){return THREE.Material.prototype.copy.call(this,t),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this},THREE.MeshPhongMaterial=function(t){THREE.Material.call(this),this.type="MeshPhongMaterial",this.color=new THREE.Color(16777215),this.specular=new THREE.Color(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new THREE.Color(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new THREE.Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=THREE.MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.shading=THREE.SmoothShading,this.blending=THREE.NormalBlending,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.vertexColors=THREE.NoColors,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)},THREE.MeshPhongMaterial.prototype=Object.create(THREE.Material.prototype),THREE.MeshPhongMaterial.prototype.constructor=THREE.MeshPhongMaterial,THREE.MeshPhongMaterial.prototype.copy=function(t){return THREE.Material.prototype.copy.call(this,t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.fog=t.fog,this.shading=t.shading,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.vertexColors=t.vertexColors,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},THREE.MeshStandardMaterial=function(t){THREE.Material.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new THREE.Color(16777215),this.roughness=.5,this.metalness=.5,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new THREE.Color(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new THREE.Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.fog=!0,this.shading=THREE.SmoothShading,this.blending=THREE.NormalBlending,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.vertexColors=THREE.NoColors,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)},THREE.MeshStandardMaterial.prototype=Object.create(THREE.Material.prototype),THREE.MeshStandardMaterial.prototype.constructor=THREE.MeshStandardMaterial,THREE.MeshStandardMaterial.prototype.copy=function(t){return THREE.Material.prototype.copy.call(this,t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.refractionRatio=t.refractionRatio,this.fog=t.fog,this.shading=t.shading,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.vertexColors=t.vertexColors,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},THREE.MeshPhysicalMaterial=function(t){THREE.MeshStandardMaterial.call(this),this.defines={PHYSICAL:""},this.type="MeshPhysicalMaterial",this.reflectivity=.5,this.setValues(t)},THREE.MeshPhysicalMaterial.prototype=Object.create(THREE.MeshStandardMaterial.prototype),THREE.MeshPhysicalMaterial.prototype.constructor=THREE.MeshPhysicalMaterial,THREE.MeshPhysicalMaterial.prototype.copy=function(t){return THREE.MeshStandardMaterial.prototype.copy.call(this,t),this.defines={PHYSICAL:""},this.reflectivity=t.reflectivity,this},THREE.MultiMaterial=function(t){this.uuid=THREE.Math.generateUUID(),this.type="MultiMaterial",this.materials=t instanceof Array?t:[],this.visible=!0},THREE.MultiMaterial.prototype={constructor:THREE.MultiMaterial,toJSON:function(t){for(var e={metadata:{version:4.2,type:"material",generator:"MaterialExporter"},uuid:this.uuid,type:this.type,materials:[]},n=this.materials,i=0,r=n.length;i<r;i++){var o=n[i].toJSON(t);delete o.metadata,e.materials.push(o)}return e.visible=this.visible,e},clone:function(){for(var t=new this.constructor,e=0;e<this.materials.length;e++)t.materials.push(this.materials[e].clone());return t.visible=this.visible,t}},THREE.PointsMaterial=function(t){THREE.Material.call(this),this.type="PointsMaterial",this.color=new THREE.Color(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.blending=THREE.NormalBlending,this.vertexColors=THREE.NoColors,this.fog=!0,this.setValues(t)},THREE.PointsMaterial.prototype=Object.create(THREE.Material.prototype),THREE.PointsMaterial.prototype.constructor=THREE.PointsMaterial,THREE.PointsMaterial.prototype.copy=function(t){return THREE.Material.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this.vertexColors=t.vertexColors,this.fog=t.fog,this},THREE.ShaderMaterial=function(t){THREE.Material.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.shading=THREE.SmoothShading,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.vertexColors=THREE.NoColors,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,void 0!==t&&(void 0!==t.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(t))},THREE.ShaderMaterial.prototype=Object.create(THREE.Material.prototype),THREE.ShaderMaterial.prototype.constructor=THREE.ShaderMaterial,THREE.ShaderMaterial.prototype.copy=function(t){return THREE.Material.prototype.copy.call(this,t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=THREE.UniformsUtils.clone(t.uniforms),this.defines=t.defines,this.shading=t.shading,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.fog=t.fog,this.lights=t.lights,this.clipping=t.clipping,this.vertexColors=t.vertexColors,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.extensions=t.extensions,this},THREE.ShaderMaterial.prototype.toJSON=function(t){var e=THREE.Material.prototype.toJSON.call(this,t);return e.uniforms=this.uniforms,e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader,e},THREE.RawShaderMaterial=function(t){THREE.ShaderMaterial.call(this,t),this.type="RawShaderMaterial"},THREE.RawShaderMaterial.prototype=Object.create(THREE.ShaderMaterial.prototype),THREE.RawShaderMaterial.prototype.constructor=THREE.RawShaderMaterial,THREE.SpriteMaterial=function(t){THREE.Material.call(this),this.type="SpriteMaterial",this.color=new THREE.Color(16777215),this.map=null,this.rotation=0,this.fog=!1,this.setValues(t)},THREE.SpriteMaterial.prototype=Object.create(THREE.Material.prototype),THREE.SpriteMaterial.prototype.constructor=THREE.SpriteMaterial,THREE.SpriteMaterial.prototype.copy=function(t){return THREE.Material.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.rotation=t.rotation,this.fog=t.fog,this},THREE.Texture=function(t,e,n,i,r,o,a,s,c,l){Object.defineProperty(this,"id",{value:THREE.TextureIdCount++}),this.uuid=THREE.Math.generateUUID(),this.name="",this.sourceFile="",this.image=void 0!==t?t:THREE.Texture.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==e?e:THREE.Texture.DEFAULT_MAPPING,this.wrapS=void 0!==n?n:THREE.ClampToEdgeWrapping,this.wrapT=void 0!==i?i:THREE.ClampToEdgeWrapping,this.magFilter=void 0!==r?r:THREE.LinearFilter,this.minFilter=void 0!==o?o:THREE.LinearMipMapLinearFilter,this.anisotropy=void 0!==c?c:1,this.format=void 0!==a?a:THREE.RGBAFormat,this.type=void 0!==s?s:THREE.UnsignedByteType,this.offset=new THREE.Vector2(0,0),this.repeat=new THREE.Vector2(1,1),this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==l?l:THREE.LinearEncoding,this.version=0,this.onUpdate=null},THREE.Texture.DEFAULT_IMAGE=void 0,THREE.Texture.DEFAULT_MAPPING=THREE.UVMapping,THREE.Texture.prototype={constructor:THREE.Texture,set needsUpdate(t){t===!0&&this.version++},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this},toJSON:function(t){function e(t){var e;return void 0!==t.toDataURL?e=t:(e=document.createElement("canvas"),e.width=t.width,e.height=t.height,e.getContext("2d").drawImage(t,0,0,t.width,t.height)),e.width>2048||e.height>2048?e.toDataURL("image/jpeg",.6):e.toDataURL("image/png")}if(void 0!==t.textures[this.uuid])return t.textures[this.uuid];var n={metadata:{version:4.4,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],wrap:[this.wrapS,this.wrapT],minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy};if(void 0!==this.image){var i=this.image;void 0===i.uuid&&(i.uuid=THREE.Math.generateUUID()),void 0===t.images[i.uuid]&&(t.images[i.uuid]={uuid:i.uuid,url:e(i)}),n.image=i.uuid}return t.textures[this.uuid]=n,n},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(t){if(this.mapping===THREE.UVMapping){if(t.multiply(this.repeat),t.add(this.offset),t.x<0||t.x>1)switch(this.wrapS){case THREE.RepeatWrapping:t.x=t.x-Math.floor(t.x);break;case THREE.ClampToEdgeWrapping:t.x=t.x<0?0:1;break;case THREE.MirroredRepeatWrapping:1===Math.abs(Math.floor(t.x)%2)?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case THREE.RepeatWrapping:t.y=t.y-Math.floor(t.y);break;case THREE.ClampToEdgeWrapping:t.y=t.y<0?0:1;break;case THREE.MirroredRepeatWrapping:1===Math.abs(Math.floor(t.y)%2)?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y)}this.flipY&&(t.y=1-t.y)}}},THREE.EventDispatcher.prototype.apply(THREE.Texture.prototype),THREE.TextureIdCount=0,THREE.DepthTexture=function(t,e,n,i,r,o,a,s,c){THREE.Texture.call(this,null,i,r,o,a,s,THREE.DepthFormat,n,c),this.image={width:t,height:e},this.type=void 0!==n?n:THREE.UnsignedShortType,this.magFilter=void 0!==a?a:THREE.NearestFilter,this.minFilter=void 0!==s?s:THREE.NearestFilter,this.flipY=!1,this.generateMipmaps=!1},THREE.DepthTexture.prototype=Object.create(THREE.Texture.prototype),THREE.DepthTexture.prototype.constructor=THREE.DepthTexture,THREE.CanvasTexture=function(t,e,n,i,r,o,a,s,c){THREE.Texture.call(this,t,e,n,i,r,o,a,s,c),this.needsUpdate=!0},THREE.CanvasTexture.prototype=Object.create(THREE.Texture.prototype),THREE.CanvasTexture.prototype.constructor=THREE.CanvasTexture,THREE.CubeTexture=function(t,e,n,i,r,o,a,s,c,l){t=void 0!==t?t:[],e=void 0!==e?e:THREE.CubeReflectionMapping,THREE.Texture.call(this,t,e,n,i,r,o,a,s,c,l),this.flipY=!1},THREE.CubeTexture.prototype=Object.create(THREE.Texture.prototype),THREE.CubeTexture.prototype.constructor=THREE.CubeTexture,Object.defineProperty(THREE.CubeTexture.prototype,"images",{get:function(){return this.image},set:function(t){this.image=t}}),THREE.CompressedTexture=function(t,e,n,i,r,o,a,s,c,l,u,h){THREE.Texture.call(this,null,o,a,s,c,l,i,r,u,h),this.image={width:e,height:n},this.mipmaps=t,this.flipY=!1,this.generateMipmaps=!1},THREE.CompressedTexture.prototype=Object.create(THREE.Texture.prototype),THREE.CompressedTexture.prototype.constructor=THREE.CompressedTexture,THREE.DataTexture=function(t,e,n,i,r,o,a,s,c,l,u,h){THREE.Texture.call(this,null,o,a,s,c,l,i,r,u,h),this.image={data:t,width:e,height:n},this.magFilter=void 0!==c?c:THREE.NearestFilter,this.minFilter=void 0!==l?l:THREE.NearestFilter,this.flipY=!1,this.generateMipmaps=!1},THREE.DataTexture.prototype=Object.create(THREE.Texture.prototype),THREE.DataTexture.prototype.constructor=THREE.DataTexture,THREE.VideoTexture=function(t,e,n,i,r,o,a,s,c){function l(){requestAnimationFrame(l),t.readyState>=t.HAVE_CURRENT_DATA&&(u.needsUpdate=!0)}THREE.Texture.call(this,t,e,n,i,r,o,a,s,c),this.generateMipmaps=!1;var u=this;l()},THREE.VideoTexture.prototype=Object.create(THREE.Texture.prototype),THREE.VideoTexture.prototype.constructor=THREE.VideoTexture,THREE.Group=function(){THREE.Object3D.call(this),this.type="Group"},THREE.Group.prototype=Object.create(THREE.Object3D.prototype),THREE.Group.prototype.constructor=THREE.Group,THREE.Points=function(t,e){THREE.Object3D.call(this),this.type="Points",this.geometry=void 0!==t?t:new THREE.Geometry,this.material=void 0!==e?e:new THREE.PointsMaterial({color:16777215*Math.random()})},THREE.Points.prototype=Object.create(THREE.Object3D.prototype),THREE.Points.prototype.constructor=THREE.Points,THREE.Points.prototype.raycast=function(){var t=new THREE.Matrix4,e=new THREE.Ray,n=new THREE.Sphere;return function(i,r){function o(t,n){var o=e.distanceSqToPoint(t);if(o<h){var s=e.closestPointToPoint(t);s.applyMatrix4(c);var l=i.ray.origin.distanceTo(s);if(l<i.near||l>i.far)return;r.push({distance:l,distanceToRay:Math.sqrt(o),point:s.clone(),index:n,face:null,object:a})}}var a=this,s=this.geometry,c=this.matrixWorld,l=i.params.Points.threshold;if(null===s.boundingSphere&&s.computeBoundingSphere(),n.copy(s.boundingSphere),n.applyMatrix4(c),i.ray.intersectsSphere(n)!==!1){t.getInverse(c),e.copy(i.ray).applyMatrix4(t);var u=l/((this.scale.x+this.scale.y+this.scale.z)/3),h=u*u,p=new THREE.Vector3;if(s instanceof THREE.BufferGeometry){var d=s.index,f=s.attributes,m=f.position.array;if(null!==d)for(var v=d.array,g=0,y=v.length;g<y;g++){var E=v[g];p.fromArray(m,3*E),o(p,E)}else for(var g=0,_=m.length/3;g<_;g++)p.fromArray(m,3*g),o(p,g)}else for(var T=s.vertices,g=0,_=T.length;g<_;g++)o(T[g],g)}}}(),THREE.Points.prototype.clone=function(){return new this.constructor(this.geometry,this.material).copy(this)},THREE.Line=function(t,e,n){return 1===n?(console.warn("THREE.Line: parameter THREE.LinePieces no longer supported. Created THREE.LineSegments instead."),new THREE.LineSegments(t,e)):(THREE.Object3D.call(this),this.type="Line",this.geometry=void 0!==t?t:new THREE.Geometry,void(this.material=void 0!==e?e:new THREE.LineBasicMaterial({color:16777215*Math.random()})))},THREE.Line.prototype=Object.create(THREE.Object3D.prototype),THREE.Line.prototype.constructor=THREE.Line,THREE.Line.prototype.raycast=function(){var t=new THREE.Matrix4,e=new THREE.Ray,n=new THREE.Sphere;return function(i,r){var o=i.linePrecision,a=o*o,s=this.geometry,c=this.matrixWorld;if(null===s.boundingSphere&&s.computeBoundingSphere(),n.copy(s.boundingSphere),n.applyMatrix4(c),i.ray.intersectsSphere(n)!==!1){t.getInverse(c),e.copy(i.ray).applyMatrix4(t);var l=new THREE.Vector3,u=new THREE.Vector3,h=new THREE.Vector3,p=new THREE.Vector3,d=this instanceof THREE.LineSegments?2:1;if(s instanceof THREE.BufferGeometry){var f=s.index,m=s.attributes,v=m.position.array;if(null!==f)for(var g=f.array,y=0,E=g.length-1;y<E;y+=d){var _=g[y],T=g[y+1];l.fromArray(v,3*_),u.fromArray(v,3*T);var b=e.distanceSqToSegment(l,u,p,h);if(!(b>a)){p.applyMatrix4(this.matrixWorld);var w=i.ray.origin.distanceTo(p);w<i.near||w>i.far||r.push({distance:w,point:h.clone().applyMatrix4(this.matrixWorld),index:y,face:null,faceIndex:null,object:this})}}else for(var y=0,E=v.length/3-1;y<E;y+=d){l.fromArray(v,3*y),u.fromArray(v,3*y+3);var b=e.distanceSqToSegment(l,u,p,h);if(!(b>a)){p.applyMatrix4(this.matrixWorld);var w=i.ray.origin.distanceTo(p);w<i.near||w>i.far||r.push({distance:w,point:h.clone().applyMatrix4(this.matrixWorld),index:y,face:null,faceIndex:null,object:this})}}}else if(s instanceof THREE.Geometry)for(var R=s.vertices,x=R.length,y=0;y<x-1;y+=d){var b=e.distanceSqToSegment(R[y],R[y+1],p,h);if(!(b>a)){p.applyMatrix4(this.matrixWorld);var w=i.ray.origin.distanceTo(p);w<i.near||w>i.far||r.push({distance:w,point:h.clone().applyMatrix4(this.matrixWorld),index:y,face:null,faceIndex:null,object:this})}}}}}(),THREE.Line.prototype.clone=function(){return new this.constructor(this.geometry,this.material).copy(this)},THREE.LineStrip=0,THREE.LinePieces=1,THREE.LineSegments=function(t,e){THREE.Line.call(this,t,e),this.type="LineSegments"},THREE.LineSegments.prototype=Object.create(THREE.Line.prototype),THREE.LineSegments.prototype.constructor=THREE.LineSegments,THREE.Mesh=function(t,e){THREE.Object3D.call(this),this.type="Mesh",this.geometry=void 0!==t?t:new THREE.Geometry,this.material=void 0!==e?e:new THREE.MeshBasicMaterial({color:16777215*Math.random()}),this.drawMode=THREE.TrianglesDrawMode,this.updateMorphTargets()},THREE.Mesh.prototype=Object.create(THREE.Object3D.prototype),THREE.Mesh.prototype.constructor=THREE.Mesh,THREE.Mesh.prototype.setDrawMode=function(t){this.drawMode=t},THREE.Mesh.prototype.updateMorphTargets=function(){if(void 0!==this.geometry.morphTargets&&this.geometry.morphTargets.length>0){this.morphTargetBase=-1,this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var t=0,e=this.geometry.morphTargets.length;t<e;t++)this.morphTargetInfluences.push(0),this.morphTargetDictionary[this.geometry.morphTargets[t].name]=t}},THREE.Mesh.prototype.getMorphTargetIndexByName=function(t){return void 0!==this.morphTargetDictionary[t]?this.morphTargetDictionary[t]:(console.warn("THREE.Mesh.getMorphTargetIndexByName: morph target "+t+" does not exist. Returning 0."),0)},THREE.Mesh.prototype.raycast=function(){function t(t,e,n,i,r,o,a){return THREE.Triangle.barycoordFromPoint(t,e,n,i,m),r.multiplyScalar(m.x),o.multiplyScalar(m.y),a.multiplyScalar(m.z),r.add(o).add(a),r.clone()}function e(t,e,n,i,r,o,a){var s,c=t.material;if(s=c.side===THREE.BackSide?n.intersectTriangle(o,r,i,!0,a):n.intersectTriangle(i,r,o,c.side!==THREE.DoubleSide,a),null===s)return null;g.copy(a),g.applyMatrix4(t.matrixWorld);var l=e.ray.origin.distanceTo(g);return l<e.near||l>e.far?null:{distance:l,point:g.clone(),object:t}}function n(n,i,r,o,l,u,h,m){a.fromArray(o,3*u),s.fromArray(o,3*h),c.fromArray(o,3*m);var g=e(n,i,r,a,s,c,v);return g&&(l&&(p.fromArray(l,2*u),d.fromArray(l,2*h),f.fromArray(l,2*m),g.uv=t(v,a,s,c,p,d,f)),g.face=new THREE.Face3(u,h,m,THREE.Triangle.normal(a,s,c)),g.faceIndex=u),g}var i=new THREE.Matrix4,r=new THREE.Ray,o=new THREE.Sphere,a=new THREE.Vector3,s=new THREE.Vector3,c=new THREE.Vector3,l=new THREE.Vector3,u=new THREE.Vector3,h=new THREE.Vector3,p=new THREE.Vector2,d=new THREE.Vector2,f=new THREE.Vector2,m=new THREE.Vector3,v=new THREE.Vector3,g=new THREE.Vector3;return function(m,g){var y=this.geometry,E=this.material,_=this.matrixWorld;if(void 0!==E&&(null===y.boundingSphere&&y.computeBoundingSphere(),o.copy(y.boundingSphere),o.applyMatrix4(_),m.ray.intersectsSphere(o)!==!1&&(i.getInverse(_),r.copy(m.ray).applyMatrix4(i),null===y.boundingBox||r.intersectsBox(y.boundingBox)!==!1))){var T,b;if(y instanceof THREE.BufferGeometry){var w,R,x,H=y.index,M=y.attributes,S=M.position.array;if(void 0!==M.uv&&(T=M.uv.array),
null!==H)for(var C=H.array,A=0,P=C.length;A<P;A+=3)w=C[A],R=C[A+1],x=C[A+2],b=n(this,m,r,S,T,w,R,x),b&&(b.faceIndex=Math.floor(A/3),g.push(b));else for(var A=0,P=S.length;A<P;A+=9)w=A/3,R=w+1,x=w+2,b=n(this,m,r,S,T,w,R,x),b&&(b.index=w,g.push(b))}else if(y instanceof THREE.Geometry){var L,O,j,k=E instanceof THREE.MultiMaterial,I=k===!0?E.materials:null,D=y.vertices,B=y.faces,U=y.faceVertexUvs[0];U.length>0&&(T=U);for(var N=0,F=B.length;N<F;N++){var V=B[N],G=k===!0?I[V.materialIndex]:E;if(void 0!==G){if(L=D[V.a],O=D[V.b],j=D[V.c],G.morphTargets===!0){var z=y.morphTargets,W=this.morphTargetInfluences;a.set(0,0,0),s.set(0,0,0),c.set(0,0,0);for(var X=0,q=z.length;X<q;X++){var Y=W[X];if(0!==Y){var Z=z[X].vertices;a.addScaledVector(l.subVectors(Z[V.a],L),Y),s.addScaledVector(u.subVectors(Z[V.b],O),Y),c.addScaledVector(h.subVectors(Z[V.c],j),Y)}}a.add(L),s.add(O),c.add(j),L=a,O=s,j=c}if(b=e(this,m,r,L,O,j,v)){if(T){var K=T[N];p.copy(K[0]),d.copy(K[1]),f.copy(K[2]),b.uv=t(v,L,O,j,p,d,f)}b.face=V,b.faceIndex=N,g.push(b)}}}}}}}(),THREE.Mesh.prototype.clone=function(){return new this.constructor(this.geometry,this.material).copy(this)},THREE.Bone=function(t){THREE.Object3D.call(this),this.type="Bone",this.skin=t},THREE.Bone.prototype=Object.create(THREE.Object3D.prototype),THREE.Bone.prototype.constructor=THREE.Bone,THREE.Bone.prototype.copy=function(t){return THREE.Object3D.prototype.copy.call(this,t),this.skin=t.skin,this},THREE.Skeleton=function(t,e,n){if(this.useVertexTexture=void 0===n||n,this.identityMatrix=new THREE.Matrix4,t=t||[],this.bones=t.slice(0),this.useVertexTexture){var i=Math.sqrt(4*this.bones.length);i=THREE.Math.nextPowerOfTwo(Math.ceil(i)),i=Math.max(i,4),this.boneTextureWidth=i,this.boneTextureHeight=i,this.boneMatrices=new Float32Array(this.boneTextureWidth*this.boneTextureHeight*4),this.boneTexture=new THREE.DataTexture(this.boneMatrices,this.boneTextureWidth,this.boneTextureHeight,THREE.RGBAFormat,THREE.FloatType)}else this.boneMatrices=new Float32Array(16*this.bones.length);if(void 0===e)this.calculateInverses();else if(this.bones.length===e.length)this.boneInverses=e.slice(0);else{console.warn("THREE.Skeleton bonInverses is the wrong length."),this.boneInverses=[];for(var r=0,o=this.bones.length;r<o;r++)this.boneInverses.push(new THREE.Matrix4)}},THREE.Skeleton.prototype.calculateInverses=function(){this.boneInverses=[];for(var t=0,e=this.bones.length;t<e;t++){var n=new THREE.Matrix4;this.bones[t]&&n.getInverse(this.bones[t].matrixWorld),this.boneInverses.push(n)}},THREE.Skeleton.prototype.pose=function(){for(var t,e=0,n=this.bones.length;e<n;e++)t=this.bones[e],t&&t.matrixWorld.getInverse(this.boneInverses[e]);for(var e=0,n=this.bones.length;e<n;e++)t=this.bones[e],t&&(t.parent?(t.matrix.getInverse(t.parent.matrixWorld),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale))},THREE.Skeleton.prototype.update=function(){var t=new THREE.Matrix4;return function(){for(var e=0,n=this.bones.length;e<n;e++){var i=this.bones[e]?this.bones[e].matrixWorld:this.identityMatrix;t.multiplyMatrices(i,this.boneInverses[e]),t.toArray(this.boneMatrices,16*e)}this.useVertexTexture&&(this.boneTexture.needsUpdate=!0)}}(),THREE.Skeleton.prototype.clone=function(){return new THREE.Skeleton(this.bones,this.boneInverses,this.useVertexTexture)},THREE.SkinnedMesh=function(t,e,n){THREE.Mesh.call(this,t,e),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new THREE.Matrix4,this.bindMatrixInverse=new THREE.Matrix4;var i=[];if(this.geometry&&void 0!==this.geometry.bones){for(var r,o,a=0,s=this.geometry.bones.length;a<s;++a)o=this.geometry.bones[a],r=new THREE.Bone(this),i.push(r),r.name=o.name,r.position.fromArray(o.pos),r.quaternion.fromArray(o.rotq),void 0!==o.scl&&r.scale.fromArray(o.scl);for(var a=0,s=this.geometry.bones.length;a<s;++a)o=this.geometry.bones[a],o.parent!==-1&&null!==o.parent&&void 0!==i[o.parent]?i[o.parent].add(i[a]):this.add(i[a])}this.normalizeSkinWeights(),this.updateMatrixWorld(!0),this.bind(new THREE.Skeleton(i,(void 0),n),this.matrixWorld)},THREE.SkinnedMesh.prototype=Object.create(THREE.Mesh.prototype),THREE.SkinnedMesh.prototype.constructor=THREE.SkinnedMesh,THREE.SkinnedMesh.prototype.bind=function(t,e){this.skeleton=t,void 0===e&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.getInverse(e)},THREE.SkinnedMesh.prototype.pose=function(){this.skeleton.pose()},THREE.SkinnedMesh.prototype.normalizeSkinWeights=function(){if(this.geometry instanceof THREE.Geometry)for(var t=0;t<this.geometry.skinWeights.length;t++){var e=this.geometry.skinWeights[t],n=1/e.lengthManhattan();n!==1/0?e.multiplyScalar(n):e.set(1,0,0,0)}else if(this.geometry instanceof THREE.BufferGeometry)for(var i=new THREE.Vector4,r=this.geometry.attributes.skinWeight,t=0;t<r.count;t++){i.x=r.getX(t),i.y=r.getY(t),i.z=r.getZ(t),i.w=r.getW(t);var n=1/i.lengthManhattan();n!==1/0?i.multiplyScalar(n):i.set(1,0,0,0),r.setXYZW(t,i.x,i.y,i.z,i.w)}},THREE.SkinnedMesh.prototype.updateMatrixWorld=function(t){THREE.Mesh.prototype.updateMatrixWorld.call(this,!0),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh unrecognized bindMode: "+this.bindMode)},THREE.SkinnedMesh.prototype.clone=function(){return new this.constructor(this.geometry,this.material,this.useVertexTexture).copy(this)},THREE.LOD=function(){THREE.Object3D.call(this),this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}})},THREE.LOD.prototype=Object.create(THREE.Object3D.prototype),THREE.LOD.prototype.constructor=THREE.LOD,THREE.LOD.prototype.addLevel=function(t,e){void 0===e&&(e=0),e=Math.abs(e);for(var n=this.levels,i=0;i<n.length&&!(e<n[i].distance);i++);n.splice(i,0,{distance:e,object:t}),this.add(t)},THREE.LOD.prototype.getObjectForDistance=function(t){for(var e=this.levels,n=1,i=e.length;n<i&&!(t<e[n].distance);n++);return e[n-1].object},THREE.LOD.prototype.raycast=function(){var t=new THREE.Vector3;return function(e,n){t.setFromMatrixPosition(this.matrixWorld);var i=e.ray.origin.distanceTo(t);this.getObjectForDistance(i).raycast(e,n)}}(),THREE.LOD.prototype.update=function(){var t=new THREE.Vector3,e=new THREE.Vector3;return function(n){var i=this.levels;if(i.length>1){t.setFromMatrixPosition(n.matrixWorld),e.setFromMatrixPosition(this.matrixWorld);var r=t.distanceTo(e);i[0].object.visible=!0;for(var o=1,a=i.length;o<a&&r>=i[o].distance;o++)i[o-1].object.visible=!1,i[o].object.visible=!0;for(;o<a;o++)i[o].object.visible=!1}}}(),THREE.LOD.prototype.copy=function(t){THREE.Object3D.prototype.copy.call(this,t,!1);for(var e=t.levels,n=0,i=e.length;n<i;n++){var r=e[n];this.addLevel(r.object.clone(),r.distance)}return this},THREE.LOD.prototype.toJSON=function(t){var e=THREE.Object3D.prototype.toJSON.call(this,t);e.object.levels=[];for(var n=this.levels,i=0,r=n.length;i<r;i++){var o=n[i];e.object.levels.push({object:o.object.uuid,distance:o.distance})}return e},THREE.Sprite=function(){var t=new Uint16Array([0,1,2,0,2,3]),e=new Float32Array([-.5,-.5,0,.5,-.5,0,.5,.5,0,-.5,.5,0]),n=new Float32Array([0,0,1,0,1,1,0,1]),i=new THREE.BufferGeometry;return i.setIndex(new THREE.BufferAttribute(t,1)),i.addAttribute("position",new THREE.BufferAttribute(e,3)),i.addAttribute("uv",new THREE.BufferAttribute(n,2)),function(t){THREE.Object3D.call(this),this.type="Sprite",this.geometry=i,this.material=void 0!==t?t:new THREE.SpriteMaterial}}(),THREE.Sprite.prototype=Object.create(THREE.Object3D.prototype),THREE.Sprite.prototype.constructor=THREE.Sprite,THREE.Sprite.prototype.raycast=function(){var t=new THREE.Vector3;return function(e,n){t.setFromMatrixPosition(this.matrixWorld);var i=e.ray.distanceSqToPoint(t),r=this.scale.x*this.scale.y/4;i>r||n.push({distance:Math.sqrt(i),point:this.position,face:null,object:this})}}(),THREE.Sprite.prototype.clone=function(){return new this.constructor(this.material).copy(this)},THREE.Particle=THREE.Sprite,THREE.LensFlare=function(t,e,n,i,r){THREE.Object3D.call(this),this.lensFlares=[],this.positionScreen=new THREE.Vector3,this.customUpdateCallback=void 0,void 0!==t&&this.add(t,e,n,i,r)},THREE.LensFlare.prototype=Object.create(THREE.Object3D.prototype),THREE.LensFlare.prototype.constructor=THREE.LensFlare,THREE.LensFlare.prototype.add=function(t,e,n,i,r,o){void 0===e&&(e=-1),void 0===n&&(n=0),void 0===o&&(o=1),void 0===r&&(r=new THREE.Color(16777215)),void 0===i&&(i=THREE.NormalBlending),n=Math.min(n,Math.max(0,n)),this.lensFlares.push({texture:t,size:e,distance:n,x:0,y:0,z:0,scale:1,rotation:0,opacity:o,color:r,blending:i})},THREE.LensFlare.prototype.updateLensFlares=function(){var t,e,n=this.lensFlares.length,i=2*-this.positionScreen.x,r=2*-this.positionScreen.y;for(t=0;t<n;t++)e=this.lensFlares[t],e.x=this.positionScreen.x+i*e.distance,e.y=this.positionScreen.y+r*e.distance,e.wantedRotation=e.x*Math.PI*.25,e.rotation+=.25*(e.wantedRotation-e.rotation)},THREE.LensFlare.prototype.copy=function(t){THREE.Object3D.prototype.copy.call(this,t),this.positionScreen.copy(t.positionScreen),this.customUpdateCallback=t.customUpdateCallback;for(var e=0,n=t.lensFlares.length;e<n;e++)this.lensFlares.push(t.lensFlares[e]);return this},THREE.Scene=function(){THREE.Object3D.call(this),this.type="Scene",this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0},THREE.Scene.prototype=Object.create(THREE.Object3D.prototype),THREE.Scene.prototype.constructor=THREE.Scene,THREE.Scene.prototype.copy=function(t,e){return THREE.Object3D.prototype.copy.call(this,t,e),null!==t.fog&&(this.fog=t.fog.clone()),null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this},THREE.Fog=function(t,e,n){this.name="",this.color=new THREE.Color(t),this.near=void 0!==e?e:1,this.far=void 0!==n?n:1e3},THREE.Fog.prototype.clone=function(){return new THREE.Fog(this.color.getHex(),this.near,this.far)},THREE.FogExp2=function(t,e){this.name="",this.color=new THREE.Color(t),this.density=void 0!==e?e:25e-5},THREE.FogExp2.prototype.clone=function(){return new THREE.FogExp2(this.color.getHex(),this.density)},THREE.ShaderChunk={},THREE.ShaderChunk.alphamap_fragment="#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif\n",THREE.ShaderChunk.alphamap_pars_fragment="#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif\n",THREE.ShaderChunk.alphatest_fragment="#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif\n",THREE.ShaderChunk.aomap_fragment="#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif\n",THREE.ShaderChunk.aomap_pars_fragment="#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",THREE.ShaderChunk.begin_vertex="\nvec3 transformed = vec3( position );\n",THREE.ShaderChunk.beginnormal_vertex="\nvec3 objectNormal = vec3( normal );\n",THREE.ShaderChunk.bsdfs="bool testLightInRange( const in float lightDistance, const in float cutoffDistance ) {\n\treturn any( bvec2( cutoffDistance == 0.0, lightDistance < cutoffDistance ) );\n}\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t\tif( decayExponent > 0.0 ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\t\tfloat maxDistanceCutoffFactor = pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t\treturn distanceFalloff * maxDistanceCutoffFactor;\n#else\n\t\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n#endif\n\t\t}\n\t\treturn 1.0;\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec3 BRDF_Specular_GGX_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 AB = vec2( -1.04, 1.04 ) * a004 + r.zw;\n\treturn specularColor * AB.x + AB.y;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n",THREE.ShaderChunk.bumpmap_pars_fragment="#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = dFdx( surf_pos );\n\t\tvec3 vSigmaY = dFdy( surf_pos );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif\n",THREE.ShaderChunk.clipping_planes_fragment="#if NUM_CLIPPING_PLANES > 0\n\tfor ( int i = 0; i < NUM_CLIPPING_PLANES; ++ i ) {\n\t\tvec4 plane = clippingPlanes[ i ];\n\t\tif ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\n\t}\n#endif\n",THREE.ShaderChunk.clipping_planes_pars_fragment="#if NUM_CLIPPING_PLANES > 0\n\t#if ! defined( PHYSICAL ) && ! defined( PHONG )\n\t\tvarying vec3 vViewPosition;\n\t#endif\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif\n",THREE.ShaderChunk.clipping_planes_pars_vertex="#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvarying vec3 vViewPosition;\n#endif\n",THREE.ShaderChunk.clipping_planes_vertex="#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n",THREE.ShaderChunk.color_fragment="#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",THREE.ShaderChunk.color_pars_fragment="#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif\n",THREE.ShaderChunk.color_pars_vertex="#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",THREE.ShaderChunk.color_vertex="#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",THREE.ShaderChunk.common="#define PI 3.14159265359\n#define PI2 6.28318530718\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\n",THREE.ShaderChunk.cube_uv_reflection_fragment="#ifdef ENVMAP_TYPE_CUBE_UV\nconst float cubeUV_textureSize = 1024.0;\nint getFaceFromDirection(vec3 direction) {\n\tvec3 absDirection = abs(direction);\n\tint face = -1;\n\tif( absDirection.x > absDirection.z ) {\n\t\tif(absDirection.x > absDirection.y )\n\t\t\tface = direction.x > 0.0 ? 0 : 3;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\telse {\n\t\tif(absDirection.z > absDirection.y )\n\t\t\tface = direction.z > 0.0 ? 2 : 5;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\treturn face;\n}\nfloat cubeUV_maxLods1 = log2(cubeUV_textureSize*0.25) - 1.0;\nfloat cubeUV_rangeClamp = exp2((6.0 - 1.0) * 2.0);\nvec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {\n\tfloat scale = exp2(cubeUV_maxLods1 - roughnessLevel);\n\tfloat dxRoughness = dFdx(roughness);\n\tfloat dyRoughness = dFdy(roughness);\n\tvec3 dx = dFdx( vec * scale * dxRoughness );\n\tvec3 dy = dFdy( vec * scale * dyRoughness );\n\tfloat d = max( dot( dx, dx ), dot( dy, dy ) );\n\td = clamp(d, 1.0, cubeUV_rangeClamp);\n\tfloat mipLevel = 0.5 * log2(d);\n\treturn vec2(floor(mipLevel), fract(mipLevel));\n}\nfloat cubeUV_maxLods2 = log2(cubeUV_textureSize*0.25) - 2.0;\nconst float cubeUV_rcpTextureSize = 1.0 / cubeUV_textureSize;\nvec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {\n\tmipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;\n\tfloat a = 16.0 * cubeUV_rcpTextureSize;\n\tvec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );\n\tvec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;\n\tfloat powScale = exp2_packed.x * exp2_packed.y;\n\tfloat scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;\n\tfloat mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;\n\tbool bRes = mipLevel == 0.0;\n\tscale =  bRes && (scale < a) ? a : scale;\n\tvec3 r;\n\tvec2 offset;\n\tint face = getFaceFromDirection(direction);\n\tfloat rcpPowScale = 1.0 / powScale;\n\tif( face == 0) {\n\t\tr = vec3(direction.x, -direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ?  a : offset.y;\n\t}\n\telse if( face == 1) {\n\t\tr = vec3(direction.y, direction.x, direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ?  a : offset.y;\n\t}\n\telse if( face == 2) {\n\t\tr = vec3(direction.z, direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ?  a : offset.y;\n\t}\n\telse if( face == 3) {\n\t\tr = vec3(direction.x, direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ?  0.0 : offset.y;\n\t}\n\telse if( face == 4) {\n\t\tr = vec3(direction.y, direction.x, -direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ?  0.0 : offset.y;\n\t}\n\telse {\n\t\tr = vec3(direction.z, -direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ?  0.0 : offset.y;\n\t}\n\tr = normalize(r);\n\tfloat texelOffset = 0.5 * cubeUV_rcpTextureSize;\n\tvec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;\n\tvec2 base = offset + vec2( texelOffset );\n\treturn base + s * ( scale - 2.0 * texelOffset );\n}\nfloat cubeUV_maxLods3 = log2(cubeUV_textureSize*0.25) - 3.0;\nvec4 textureCubeUV(vec3 reflectedDirection, float roughness ) {\n\tfloat roughnessVal = roughness* cubeUV_maxLods3;\n\tfloat r1 = floor(roughnessVal);\n\tfloat r2 = r1 + 1.0;\n\tfloat t = fract(roughnessVal);\n\tvec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);\n\tfloat s = mipInfo.y;\n\tfloat level0 = mipInfo.x;\n\tfloat level1 = level0 + 1.0;\n\tlevel1 = level1 > 5.0 ? 5.0 : level1;\n\tlevel0 += min( floor( s + 0.5 ), 5.0 );\n\tvec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);\n\tvec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));\n\tvec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);\n\tvec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));\n\tvec4 result = mix(color10, color20, t);\n\treturn vec4(result.rgb, 1.0);\n}\n#endif\n",THREE.ShaderChunk.defaultnormal_vertex="#ifdef FLIP_SIDED\n\tobjectNormal = -objectNormal;\n#endif\nvec3 transformedNormal = normalMatrix * objectNormal;\n",THREE.ShaderChunk.displacementmap_vertex="#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normal * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\n#endif\n",THREE.ShaderChunk.displacementmap_pars_vertex="#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif\n",THREE.ShaderChunk.emissivemap_fragment="#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif\n",THREE.ShaderChunk.emissivemap_pars_fragment="#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif\n",THREE.ShaderChunk.encodings_pars_fragment="\nvec4 LinearToLinear( in vec4 value ) {\n  return value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n  return vec4( pow( value.xyz, vec3( gammaFactor ) ), value.w );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n  return vec4( pow( value.xyz, vec3( 1.0 / gammaFactor ) ), value.w );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n  return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n  return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n  return vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n  float maxComponent = max( max( value.r, value.g ), value.b );\n  float fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n  return vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n  return vec4( value.xyz * value.w * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n  float maxRGB = max( value.x, max( value.g, value.b ) );\n  float M      = clamp( maxRGB / maxRange, 0.0, 1.0 );\n  M            = ceil( M * 255.0 ) / 255.0;\n  return vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n    return vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n    float maxRGB = max( value.x, max( value.g, value.b ) );\n    float D      = max( maxRange / maxRGB, 1.0 );\n    D            = min( floor( D ) / 255.0, 1.0 );\n    return vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n  vec3 Xp_Y_XYZp = value.rgb * cLogLuvM;\n  Xp_Y_XYZp = max(Xp_Y_XYZp, vec3(1e-6, 1e-6, 1e-6));\n  vec4 vResult;\n  vResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n  float Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n  vResult.w = fract(Le);\n  vResult.z = (Le - (floor(vResult.w*255.0))/255.0)/255.0;\n  return vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n  float Le = value.z * 255.0 + value.w;\n  vec3 Xp_Y_XYZp;\n  Xp_Y_XYZp.y = exp2((Le - 127.0) / 2.0);\n  Xp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n  Xp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n  vec3 vRGB = Xp_Y_XYZp.rgb * cLogLuvInverseM;\n  return vec4( max(vRGB, 0.0), 1.0 );\n}\n",THREE.ShaderChunk.encodings_fragment="  gl_FragColor = linearToOutputTexel( gl_FragColor );\n",THREE.ShaderChunk.envmap_fragment="#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tfloat flipNormal = ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#else\n\t\tfloat flipNormal = 1.0;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\tsampleUV.y = saturate( flipNormal * reflectVec.y * 0.5 + 0.5 );\n\t\tsampleUV.x = atan( flipNormal * reflectVec.z, flipNormal * reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\tvec3 reflectView = flipNormal * normalize((viewMatrix * vec4( reflectVec, 0.0 )).xyz + vec3(0.0,0.0,1.0));\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#endif\n\tenvColor = envMapTexelToLinear( envColor );\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif\n",THREE.ShaderChunk.envmap_pars_fragment="#if defined( USE_ENVMAP ) || defined( PHYSICAL )\n\tuniform float reflectivity;\n\tuniform float envMapIntenstiy;\n#endif\n#ifdef USE_ENVMAP\n\t#if ! defined( PHYSICAL ) && ( defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) )\n\t\tvarying vec3 vWorldPosition;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\tuniform float flipEnvMap;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( PHYSICAL )\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif\n";THREE.ShaderChunk.envmap_pars_vertex="#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif\n";THREE.ShaderChunk.envmap_vertex="#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif\n",THREE.ShaderChunk.fog_fragment="#ifdef USE_FOG\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tfloat depth = gl_FragDepthEXT / gl_FragCoord.w;\n\t#else\n\t\tfloat depth = gl_FragCoord.z / gl_FragCoord.w;\n\t#endif\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * depth * depth * LOG2 ) );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, depth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif\n",THREE.ShaderChunk.fog_pars_fragment="#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",THREE.ShaderChunk.lightmap_fragment="#ifdef USE_LIGHTMAP\n\treflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n#endif\n",THREE.ShaderChunk.lightmap_pars_fragment="#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",THREE.ShaderChunk.lights_lambert_vertex="vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_DIR_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvLightFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n#endif\n",
THREE.ShaderChunk.lights_pars="uniform vec3 ambientLightColor;\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tif ( testLightInRange( lightDistance, pointLight.distance ) ) {\n\t\t\tdirectLight.color = pointLight.color;\n\t\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( all( bvec2( angleCos > spotLight.coneCos, testLightInRange( lightDistance, spotLight.distance ) ) ) ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif\n#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tfloat flipNormal = ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#else\n\t\t\tfloat flipNormal = 1.0;\n\t\t#endif\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = flipNormal * vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryVec = flipNormal * vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( queryVec, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar - 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\n\t\t#endif\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tfloat flipNormal = ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#else\n\t\t\tfloat flipNormal = 1.0;\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryReflectVec = flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\tvec4 envMapColor = textureCubeUV(queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent));\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = saturate( flipNormal * reflectVec.y * 0.5 + 0.5 );\n\t\t\tsampleUV.x = atan( flipNormal * reflectVec.z, flipNormal * reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = flipNormal * normalize((viewMatrix * vec4( reflectVec, 0.0 )).xyz + vec3(0.0,0.0,1.0));\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif\n",THREE.ShaderChunk.lights_phong_fragment="BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;\n",THREE.ShaderChunk.lights_phong_pars_fragment="varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)\n",THREE.ShaderChunk.lights_physical_fragment="PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\n#ifdef STANDARD\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.16 * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n#endif\n",THREE.ShaderChunk.lights_physical_pars_fragment="struct PhysicalMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n\t#ifndef STANDARD\n\t#endif\n};\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_GGX( directLight, geometry, material.specularColor, material.specularRoughness );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectSpecular += radiance * BRDF_Specular_GGX_Environment( geometry, material.specularColor, material.specularRoughness );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\n#define Material_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.specularRoughness )\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}\n",THREE.ShaderChunk.lights_template="\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = normalize( vViewPosition );\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#ifdef USE_LIGHTMAP\n\t\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t \tirradiance += getLightProbeIndirectIrradiance( geometry, 8 );\n\t#endif\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tvec3 radiance = getLightProbeIndirectRadiance( geometry, Material_BlinnShininessExponent( material ), 8 );\n\tRE_IndirectSpecular( radiance, geometry, material, reflectedLight );\n#endif\n",THREE.ShaderChunk.logdepthbuf_fragment="#if defined(USE_LOGDEPTHBUF) && defined(USE_LOGDEPTHBUF_EXT)\n\tgl_FragDepthEXT = log2(vFragDepth) * logDepthBufFC * 0.5;\n#endif",THREE.ShaderChunk.logdepthbuf_pars_fragment="#ifdef USE_LOGDEPTHBUF\n\tuniform float logDepthBufFC;\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n#endif\n",THREE.ShaderChunk.logdepthbuf_pars_vertex="#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n\tuniform float logDepthBufFC;\n#endif",THREE.ShaderChunk.logdepthbuf_vertex="#ifdef USE_LOGDEPTHBUF\n\tgl_Position.z = log2(max( EPSILON, gl_Position.w + 1.0 )) * logDepthBufFC;\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t#else\n\t\tgl_Position.z = (gl_Position.z - 1.0) * gl_Position.w;\n\t#endif\n#endif\n",THREE.ShaderChunk.map_fragment="#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif\n",THREE.ShaderChunk.map_pars_fragment="#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n",THREE.ShaderChunk.map_particle_fragment="#ifdef USE_MAP\n\tvec4 mapTexel = texture2D( map, vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y ) * offsetRepeat.zw + offsetRepeat.xy );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n",THREE.ShaderChunk.map_particle_pars_fragment="#ifdef USE_MAP\n\tuniform vec4 offsetRepeat;\n\tuniform sampler2D map;\n#endif\n",THREE.ShaderChunk.metalnessmap_fragment="float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.r;\n#endif\n",THREE.ShaderChunk.metalnessmap_pars_fragment="#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",THREE.ShaderChunk.morphnormal_vertex="#ifdef USE_MORPHNORMALS\n\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n#endif\n",THREE.ShaderChunk.morphtarget_pars_vertex="#ifdef USE_MORPHTARGETS\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",THREE.ShaderChunk.morphtarget_vertex="#ifdef USE_MORPHTARGETS\n\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\t#endif\n#endif\n",THREE.ShaderChunk.normal_fragment="#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( -1.0 + 2.0 * float( gl_FrontFacing ) );\n\t#endif\n#endif\n#ifdef USE_NORMALMAP\n\tnormal = perturbNormal2Arb( -vViewPosition, normal );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif\n",THREE.ShaderChunk.normalmap_pars_fragment="#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 S = normalize( q0 * st1.t - q1 * st0.t );\n\t\tvec3 T = normalize( -q0 * st1.s + q1 * st0.s );\n\t\tvec3 N = normalize( surf_norm );\n\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\tmapN.xy = normalScale * mapN.xy;\n\t\tmat3 tsn = mat3( S, T, N );\n\t\treturn normalize( tsn * mapN );\n\t}\n#endif\n",THREE.ShaderChunk.packing="vec3 packNormalToRGB( const in vec3 normal ) {\n  return normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n  return 1.0 - 2.0 * rgb.xyz;\n}\nvec4 packDepthToRGBA( const in float value ) {\n\tconst vec4 bit_shift = vec4( 256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0 );\n\tconst vec4 bit_mask = vec4( 0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0 );\n\tvec4 res = mod( value * bit_shift * vec4( 255 ), vec4( 256 ) ) / vec4( 255 );\n\tres -= res.xxyz * bit_mask;\n\treturn res;\n}\nfloat unpackRGBAToDepth( const in vec4 rgba ) {\n\tconst vec4 bitSh = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );\n\treturn dot( rgba, bitSh );\n}\nfloat viewZToOrthoDepth( const in float viewZ, const in float near, const in float far ) {\n  return ( viewZ + near ) / ( near - far );\n}\nfloat OrthoDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n  return linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n  return (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n  return ( near * far ) / ( ( far - near ) * invClipZ - far );\n}\n",THREE.ShaderChunk.premultiplied_alpha_fragment="#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif\n",THREE.ShaderChunk.project_vertex="#ifdef USE_SKINNING\n\tvec4 mvPosition = modelViewMatrix * skinned;\n#else\n\tvec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\n#endif\ngl_Position = projectionMatrix * mvPosition;\n",THREE.ShaderChunk.roughnessmap_fragment="float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.r;\n#endif\n",THREE.ShaderChunk.roughnessmap_pars_fragment="#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",THREE.ShaderChunk.shadowmap_pars_fragment="#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\n\t\tconst vec2 offset = vec2( 0.0, 1.0 );\n\t\tvec2 texelSize = vec2( 1.0 ) / size;\n\t\tvec2 centroidUV = floor( uv * size + 0.5 ) / size;\n\t\tfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\n\t\tfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\n\t\tfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\n\t\tfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\n\t\tvec2 f = fract( uv * size + 0.5 );\n\t\tfloat a = mix( lb, lt, f.y );\n\t\tfloat b = mix( rb, rt, f.y );\n\t\tfloat c = mix( a, b, f.x );\n\t\treturn c;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\treturn (\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn 1.0;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\tfloat dp = ( length( lightToPosition ) - shadowBias ) / 1000.0;\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif\n",THREE.ShaderChunk.shadowmap_pars_vertex="#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n#endif\n",THREE.ShaderChunk.shadowmap_vertex="#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n#endif\n",THREE.ShaderChunk.shadowmask_pars_fragment="float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tDirectionalLight directionalLight;\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tshadow *= bool( directionalLight.shadow ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tSpotLight spotLight;\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tshadow *= bool( spotLight.shadow ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tPointLight pointLight;\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tshadow *= bool( pointLight.shadow ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#endif\n\treturn shadow;\n}\n",THREE.ShaderChunk.skinbase_vertex="#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",THREE.ShaderChunk.skinning_pars_vertex="#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform sampler2D boneTexture;\n\t\tuniform int boneTextureWidth;\n\t\tuniform int boneTextureHeight;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureWidth ) );\n\t\t\tfloat y = floor( j / float( boneTextureWidth ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureWidth );\n\t\t\tfloat dy = 1.0 / float( boneTextureHeight );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif\n",THREE.ShaderChunk.skinning_vertex="#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\tskinned  = bindMatrixInverse * skinned;\n#endif\n",THREE.ShaderChunk.skinnormal_vertex="#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n#endif\n",
THREE.ShaderChunk.specularmap_fragment="float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",THREE.ShaderChunk.specularmap_pars_fragment="#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",THREE.ShaderChunk.tonemapping_fragment="#if defined( TONE_MAPPING )\n  gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif\n",THREE.ShaderChunk.tonemapping_pars_fragment="#define saturate(a) clamp( a, 0.0, 1.0 )\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n  return toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n  color *= toneMappingExposure;\n  return saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n  color *= toneMappingExposure;\n  return saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n  color *= toneMappingExposure;\n  color = max( vec3( 0.0 ), color - 0.004 );\n  return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\n",THREE.ShaderChunk.uv2_pars_fragment="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",THREE.ShaderChunk.uv2_pars_vertex="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n#endif",THREE.ShaderChunk.uv2_vertex="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = uv2;\n#endif",THREE.ShaderChunk.uv_pars_fragment="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n#endif",THREE.ShaderChunk.uv_pars_vertex="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n\tuniform vec4 offsetRepeat;\n#endif\n",THREE.ShaderChunk.uv_vertex="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvUv = uv * offsetRepeat.zw + offsetRepeat.xy;\n#endif",THREE.ShaderChunk.worldpos_vertex="#if defined( USE_ENVMAP ) || defined( PHONG ) || defined( PHYSICAL ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )\n\t#ifdef USE_SKINNING\n\t\tvec4 worldPosition = modelMatrix * skinned;\n\t#else\n\t\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n\t#endif\n#endif\n",THREE.UniformsUtils={merge:function(t){for(var e={},n=0;n<t.length;n++){var i=this.clone(t[n]);for(var r in i)e[r]=i[r]}return e},clone:function(t){var e={};for(var n in t){e[n]={};for(var i in t[n]){var r=t[n][i];r instanceof THREE.Color||r instanceof THREE.Vector2||r instanceof THREE.Vector3||r instanceof THREE.Vector4||r instanceof THREE.Matrix3||r instanceof THREE.Matrix4||r instanceof THREE.Texture?e[n][i]=r.clone():Array.isArray(r)?e[n][i]=r.slice():e[n][i]=r}}return e}},THREE.UniformsLib={common:{diffuse:{type:"c",value:new THREE.Color(15658734)},opacity:{type:"1f",value:1},map:{type:"t",value:null},offsetRepeat:{type:"v4",value:new THREE.Vector4(0,0,1,1)},specularMap:{type:"t",value:null},alphaMap:{type:"t",value:null},envMap:{type:"t",value:null},flipEnvMap:{type:"1f",value:-1},reflectivity:{type:"1f",value:1},refractionRatio:{type:"1f",value:.98}},aomap:{aoMap:{type:"t",value:null},aoMapIntensity:{type:"1f",value:1}},lightmap:{lightMap:{type:"t",value:null},lightMapIntensity:{type:"1f",value:1}},emissivemap:{emissiveMap:{type:"t",value:null}},bumpmap:{bumpMap:{type:"t",value:null},bumpScale:{type:"1f",value:1}},normalmap:{normalMap:{type:"t",value:null},normalScale:{type:"v2",value:new THREE.Vector2(1,1)}},displacementmap:{displacementMap:{type:"t",value:null},displacementScale:{type:"1f",value:1},displacementBias:{type:"1f",value:0}},roughnessmap:{roughnessMap:{type:"t",value:null}},metalnessmap:{metalnessMap:{type:"t",value:null}},fog:{fogDensity:{type:"1f",value:25e-5},fogNear:{type:"1f",value:1},fogFar:{type:"1f",value:2e3},fogColor:{type:"c",value:new THREE.Color(16777215)}},lights:{ambientLightColor:{type:"3fv",value:[]},directionalLights:{type:"sa",value:[],properties:{direction:{type:"v3"},color:{type:"c"},shadow:{type:"1i"},shadowBias:{type:"1f"},shadowRadius:{type:"1f"},shadowMapSize:{type:"v2"}}},directionalShadowMap:{type:"tv",value:[]},directionalShadowMatrix:{type:"m4v",value:[]},spotLights:{type:"sa",value:[],properties:{color:{type:"c"},position:{type:"v3"},direction:{type:"v3"},distance:{type:"1f"},coneCos:{type:"1f"},penumbraCos:{type:"1f"},decay:{type:"1f"},shadow:{type:"1i"},shadowBias:{type:"1f"},shadowRadius:{type:"1f"},shadowMapSize:{type:"v2"}}},spotShadowMap:{type:"tv",value:[]},spotShadowMatrix:{type:"m4v",value:[]},pointLights:{type:"sa",value:[],properties:{color:{type:"c"},position:{type:"v3"},decay:{type:"1f"},distance:{type:"1f"},shadow:{type:"1i"},shadowBias:{type:"1f"},shadowRadius:{type:"1f"},shadowMapSize:{type:"v2"}}},pointShadowMap:{type:"tv",value:[]},pointShadowMatrix:{type:"m4v",value:[]},hemisphereLights:{type:"sa",value:[],properties:{direction:{type:"v3"},skyColor:{type:"c"},groundColor:{type:"c"}}}},points:{diffuse:{type:"c",value:new THREE.Color(15658734)},opacity:{type:"1f",value:1},size:{type:"1f",value:1},scale:{type:"1f",value:1},map:{type:"t",value:null},offsetRepeat:{type:"v4",value:new THREE.Vector4(0,0,1,1)}}},THREE.ShaderChunk.cube_frag="uniform samplerCube tCube;\nuniform float tFlip;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\n\t#include <logdepthbuf_fragment>\n}\n",THREE.ShaderChunk.cube_vert="varying vec3 vWorldPosition;\n#include <common>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n",THREE.ShaderChunk.depth_frag="#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( gl_FragCoord.z ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( gl_FragCoord.z );\n\t#endif\n}\n",THREE.ShaderChunk.depth_vert="#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#include <begin_vertex>\n\t#include <displacementmap_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n",THREE.ShaderChunk.distanceRGBA_frag="uniform vec3 lightPos;\nvarying vec4 vWorldPosition;\n#include <common>\n#include <packing>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tgl_FragColor = packDepthToRGBA( length( vWorldPosition.xyz - lightPos.xyz ) / 1000.0 );\n}\n",THREE.ShaderChunk.distanceRGBA_vert="varying vec4 vWorldPosition;\n#include <common>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <skinbase_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition;\n}\n",THREE.ShaderChunk.equirect_frag="uniform sampler2D tEquirect;\nuniform float tFlip;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 direction = normalize( vWorldPosition );\n\tvec2 sampleUV;\n\tsampleUV.y = saturate( tFlip * direction.y * -0.5 + 0.5 );\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <logdepthbuf_fragment>\n}\n",THREE.ShaderChunk.equirect_vert="varying vec3 vWorldPosition;\n#include <common>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n",THREE.ShaderChunk.linedashed_frag="uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",THREE.ShaderChunk.linedashed_vert="uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\tvLineDistance = scale * lineDistance;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n",THREE.ShaderChunk.meshbasic_frag="uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight;\n\treflectedLight.directDiffuse = vec3( 0.0 );\n\treflectedLight.directSpecular = vec3( 0.0 );\n\treflectedLight.indirectDiffuse = diffuseColor.rgb;\n\treflectedLight.indirectSpecular = vec3( 0.0 );\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",THREE.ShaderChunk.meshbasic_vert="#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n}\n",THREE.ShaderChunk.meshlambert_frag="uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",THREE.ShaderChunk.meshlambert_vert="#define LAMBERT\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars>\n#include <color_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n}\n",THREE.ShaderChunk.meshphong_frag="#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_template>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",THREE.ShaderChunk.meshphong_vert="#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <displacementmap_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n}\n",THREE.ShaderChunk.meshphysical_frag="#define PHYSICAL\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\nuniform float envMapIntensity;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <lights_pars>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_template>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",THREE.ShaderChunk.meshphysical_vert="#define PHYSICAL\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <displacementmap_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n}\n",THREE.ShaderChunk.normal_frag="uniform float opacity;\nvarying vec3 vNormal;\n#include <common>\n#include <packing>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tgl_FragColor = vec4( packNormalToRGB( vNormal ), opacity );\n\t#include <logdepthbuf_fragment>\n}\n",THREE.ShaderChunk.normal_vert="varying vec3 vNormal;\n#include <common>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvNormal = normalize( normalMatrix * normal );\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n",THREE.ShaderChunk.points_frag="uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",THREE.ShaderChunk.points_vert="uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#ifdef USE_SIZEATTENUATION\n\t\tgl_PointSize = size * ( scale / - mvPosition.z );\n\t#else\n\t\tgl_PointSize = size;\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n}\n",THREE.ShaderLib={basic:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.aomap,THREE.UniformsLib.fog]),vertexShader:THREE.ShaderChunk.meshbasic_vert,fragmentShader:THREE.ShaderChunk.meshbasic_frag},lambert:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.aomap,THREE.UniformsLib.lightmap,THREE.UniformsLib.emissivemap,THREE.UniformsLib.fog,THREE.UniformsLib.lights,{emissive:{type:"c",value:new THREE.Color(0)}}]),vertexShader:THREE.ShaderChunk.meshlambert_vert,fragmentShader:THREE.ShaderChunk.meshlambert_frag},phong:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.aomap,THREE.UniformsLib.lightmap,THREE.UniformsLib.emissivemap,THREE.UniformsLib.bumpmap,THREE.UniformsLib.normalmap,THREE.UniformsLib.displacementmap,THREE.UniformsLib.fog,THREE.UniformsLib.lights,{emissive:{type:"c",value:new THREE.Color(0)},specular:{type:"c",value:new THREE.Color(1118481)},shininess:{type:"1f",value:30}}]),vertexShader:THREE.ShaderChunk.meshphong_vert,fragmentShader:THREE.ShaderChunk.meshphong_frag},standard:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.aomap,THREE.UniformsLib.lightmap,THREE.UniformsLib.emissivemap,THREE.UniformsLib.bumpmap,THREE.UniformsLib.normalmap,THREE.UniformsLib.displacementmap,THREE.UniformsLib.roughnessmap,THREE.UniformsLib.metalnessmap,THREE.UniformsLib.fog,THREE.UniformsLib.lights,{emissive:{type:"c",value:new THREE.Color(0)},roughness:{type:"1f",value:.5},metalness:{type:"1f",value:0},envMapIntensity:{type:"1f",value:1}}]),vertexShader:THREE.ShaderChunk.meshphysical_vert,fragmentShader:THREE.ShaderChunk.meshphysical_frag},points:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.points,THREE.UniformsLib.fog]),vertexShader:THREE.ShaderChunk.points_vert,fragmentShader:THREE.ShaderChunk.points_frag},dashed:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.fog,{scale:{type:"1f",value:1},dashSize:{type:"1f",value:1},totalSize:{type:"1f",value:2}}]),vertexShader:THREE.ShaderChunk.linedashed_vert,fragmentShader:THREE.ShaderChunk.linedashed_frag},depth:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.displacementmap]),vertexShader:THREE.ShaderChunk.depth_vert,fragmentShader:THREE.ShaderChunk.depth_frag},normal:{uniforms:{opacity:{type:"1f",value:1}},vertexShader:THREE.ShaderChunk.normal_vert,fragmentShader:THREE.ShaderChunk.normal_frag},cube:{uniforms:{tCube:{type:"t",value:null},tFlip:{type:"1f",value:-1}},vertexShader:THREE.ShaderChunk.cube_vert,fragmentShader:THREE.ShaderChunk.cube_frag},equirect:{uniforms:{tEquirect:{type:"t",value:null},tFlip:{type:"1f",value:-1}},vertexShader:THREE.ShaderChunk.equirect_vert,fragmentShader:THREE.ShaderChunk.equirect_frag},distanceRGBA:{uniforms:{lightPos:{type:"v3",value:new THREE.Vector3}},vertexShader:THREE.ShaderChunk.distanceRGBA_vert,fragmentShader:THREE.ShaderChunk.distanceRGBA_frag}},THREE.ShaderLib.physical={uniforms:THREE.UniformsUtils.merge([THREE.ShaderLib.standard.uniforms,{}]),vertexShader:THREE.ShaderChunk.meshphysical_vert,fragmentShader:THREE.ShaderChunk.meshphysical_frag},THREE.WebGLRenderer=function(t){function e(){return null===wt?It:1}function n(t,e,n,i){ht===!0&&(t*=i,e*=i,n*=i),se.clearColor(t,e,n,i)}function i(){se.init(),se.scissor(St.copy(Dt).multiplyScalar(It)),se.viewport(At.copy(Ut).multiplyScalar(It)),n(Lt.r,Lt.g,Lt.b,Ot)}function r(){bt=null,Mt=null,Ht="",xt=-1,se.reset()}function o(t){t.preventDefault(),r(),i(),ce.clear()}function a(t){var e=t.target;e.removeEventListener("dispose",a),l(e),te.textures--}function s(t){var e=t.target;e.removeEventListener("dispose",s),u(e),te.textures--}function c(t){var e=t.target;e.removeEventListener("dispose",c),h(e)}function l(t){var e=ce.get(t);if(t.image&&e.__image__webglTextureCube)ne.deleteTexture(e.__image__webglTextureCube);else{if(void 0===e.__webglInit)return;ne.deleteTexture(e.__webglTexture)}ce.delete(t)}function u(t){var e=ce.get(t),n=ce.get(t.texture);if(t){if(void 0!==n.__webglTexture&&ne.deleteTexture(n.__webglTexture),t.depthTexture&&t.depthTexture.dispose(),t instanceof THREE.WebGLRenderTargetCube)for(var i=0;i<6;i++)ne.deleteFramebuffer(e.__webglFramebuffer[i]),e.__webglDepthbuffer&&ne.deleteRenderbuffer(e.__webglDepthbuffer[i]);else ne.deleteFramebuffer(e.__webglFramebuffer),e.__webglDepthbuffer&&ne.deleteRenderbuffer(e.__webglDepthbuffer);ce.delete(t.texture),ce.delete(t)}}function h(t){p(t),ce.delete(t)}function p(t){var e=ce.get(t).program;t.program=void 0,void 0!==e&&ue.releaseProgram(e)}function d(t,e,n,i){var r;if(n instanceof THREE.InstancedBufferGeometry&&(r=oe.get("ANGLE_instanced_arrays"),null===r))return void console.error("THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");void 0===i&&(i=0),se.initAttributes();var o=n.attributes,a=e.getAttributes(),s=t.defaultAttributeValues;for(var c in a){var l=a[c];if(l>=0){var u=o[c];if(void 0!==u){var h=ne.FLOAT,p=u.array,d=u.normalized;p instanceof Float32Array?h=ne.FLOAT:p instanceof Float64Array?console.warn("Unsupported data buffer format: Float64Array"):p instanceof Uint16Array?h=ne.UNSIGNED_SHORT:p instanceof Int16Array?h=ne.SHORT:p instanceof Uint32Array?h=ne.UNSIGNED_INT:p instanceof Int32Array?h=ne.INT:p instanceof Int8Array?h=ne.BYTE:p instanceof Uint8Array&&(h=ne.UNSIGNED_BYTE);var f=u.itemSize,m=le.getAttributeBuffer(u);if(u instanceof THREE.InterleavedBufferAttribute){var v=u.data,g=v.stride,y=u.offset;v instanceof THREE.InstancedInterleavedBuffer?(se.enableAttributeAndDivisor(l,v.meshPerAttribute,r),void 0===n.maxInstancedCount&&(n.maxInstancedCount=v.meshPerAttribute*v.count)):se.enableAttribute(l),ne.bindBuffer(ne.ARRAY_BUFFER,m),ne.vertexAttribPointer(l,f,h,d,g*v.array.BYTES_PER_ELEMENT,(i*g+y)*v.array.BYTES_PER_ELEMENT)}else u instanceof THREE.InstancedBufferAttribute?(se.enableAttributeAndDivisor(l,u.meshPerAttribute,r),void 0===n.maxInstancedCount&&(n.maxInstancedCount=u.meshPerAttribute*u.count)):se.enableAttribute(l),ne.bindBuffer(ne.ARRAY_BUFFER,m),ne.vertexAttribPointer(l,f,h,d,0,i*f*u.array.BYTES_PER_ELEMENT)}else if(void 0!==s){var E=s[c];if(void 0!==E)switch(E.length){case 2:ne.vertexAttrib2fv(l,E);break;case 3:ne.vertexAttrib3fv(l,E);break;case 4:ne.vertexAttrib4fv(l,E);break;default:ne.vertexAttrib1fv(l,E)}}}}se.disableUnusedAttributes()}function f(t,e){return Math.abs(e[0])-Math.abs(t[0])}function m(t,e){return t.object.renderOrder!==e.object.renderOrder?t.object.renderOrder-e.object.renderOrder:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function v(t,e){return t.object.renderOrder!==e.object.renderOrder?t.object.renderOrder-e.object.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function g(t,e,n,i,r){var o,a;n.transparent?(o=vt,a=++gt):(o=ft,a=++mt);var s=o[a];void 0!==s?(s.id=t.id,s.object=t,s.geometry=e,s.material=n,s.z=$t.z,s.group=r):(s={id:t.id,object:t,geometry:e,material:n,
z:$t.z,group:r},o.push(s))}function y(t){var e=t.geometry;null===e.boundingSphere&&e.computeBoundingSphere();var n=Zt.copy(e.boundingSphere).applyMatrix4(t.matrixWorld);if(!Nt.intersectsSphere(n))return!1;if(0===zt)return!0;var i=Tt.clippingPlanes,r=n.center,o=-n.radius,a=0;do if(i[a].distanceToPoint(r)<o)return!1;while(++a!==zt);return!0}function E(t,e){if(t.visible!==!1){if(t.layers.test(e.layers))if(t instanceof THREE.Light)dt.push(t);else if(t instanceof THREE.Sprite)t.frustumCulled!==!1&&y(t)!==!0||Et.push(t);else if(t instanceof THREE.LensFlare)_t.push(t);else if(t instanceof THREE.ImmediateRenderObject)Tt.sortObjects===!0&&($t.setFromMatrixPosition(t.matrixWorld),$t.applyProjection(Qt)),g(t,null,t.material,$t.z,null);else if((t instanceof THREE.Mesh||t instanceof THREE.Line||t instanceof THREE.Points)&&(t instanceof THREE.SkinnedMesh&&t.skeleton.update(),t.frustumCulled===!1||y(t)===!0)){var n=t.material;if(n.visible===!0){Tt.sortObjects===!0&&($t.setFromMatrixPosition(t.matrixWorld),$t.applyProjection(Qt));var i=le.update(t);if(n instanceof THREE.MultiMaterial)for(var r=i.groups,o=n.materials,a=0,s=r.length;a<s;a++){var c=r[a],l=o[c.materialIndex];l.visible===!0&&g(t,i,l,$t.z,c)}else g(t,i,n,$t.z,null)}}for(var u=t.children,a=0,s=u.length;a<s;a++)E(u[a],e)}}function _(t,e,n,i){for(var r=0,o=t.length;r<o;r++){var a=t[r],s=a.object,c=a.geometry,l=void 0===i?a.material:i,u=a.group;if(s.modelViewMatrix.multiplyMatrices(e.matrixWorldInverse,s.matrixWorld),s.normalMatrix.getNormalMatrix(s.modelViewMatrix),s instanceof THREE.ImmediateRenderObject){b(l);var h=R(e,n,l,s);Ht="",s.render(function(t){Tt.renderBufferImmediate(t,h,l)})}else Tt.renderBufferDirect(e,n,c,l,s,u)}}function T(t,e,n){var i=ce.get(t),r=ue.getParameters(t,Jt,e,zt,n),o=ue.getProgramCode(t,r),a=i.program,s=!0;if(void 0===a)t.addEventListener("dispose",c);else if(a.code!==o)p(t);else{if(void 0!==r.shaderID)return;s=!1}if(s){if(r.shaderID){var l=THREE.ShaderLib[r.shaderID];i.__webglShader={name:t.type,uniforms:THREE.UniformsUtils.clone(l.uniforms),vertexShader:l.vertexShader,fragmentShader:l.fragmentShader}}else i.__webglShader={name:t.type,uniforms:t.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader};t.__webglShader=i.__webglShader,a=ue.acquireProgram(t,r,o),i.program=a,t.program=a}var u=a.getAttributes();if(t.morphTargets){t.numSupportedMorphTargets=0;for(var h=0;h<Tt.maxMorphTargets;h++)u["morphTarget"+h]>=0&&t.numSupportedMorphTargets++}if(t.morphNormals){t.numSupportedMorphNormals=0;for(var h=0;h<Tt.maxMorphNormals;h++)u["morphNormal"+h]>=0&&t.numSupportedMorphNormals++}var d=i.__webglShader.uniforms;(t instanceof THREE.ShaderMaterial||t instanceof THREE.RawShaderMaterial)&&t.clipping!==!0||(i.numClippingPlanes=zt,d.clippingPlanes=Wt),(t instanceof THREE.MeshPhongMaterial||t instanceof THREE.MeshLambertMaterial||t instanceof THREE.MeshStandardMaterial||t.lights)&&(i.lightsHash=Jt.hash,d.ambientLightColor.value=Jt.ambient,d.directionalLights.value=Jt.directional,d.spotLights.value=Jt.spot,d.pointLights.value=Jt.point,d.hemisphereLights.value=Jt.hemi,d.directionalShadowMap.value=Jt.directionalShadowMap,d.directionalShadowMatrix.value=Jt.directionalShadowMatrix,d.spotShadowMap.value=Jt.spotShadowMap,d.spotShadowMatrix.value=Jt.spotShadowMatrix,d.pointShadowMap.value=Jt.pointShadowMap,d.pointShadowMatrix.value=Jt.pointShadowMatrix);var f=i.program.getUniforms(),m=THREE.WebGLUniforms.seqWithValue(f.seq,d);i.uniformsList=m,i.dynamicUniforms=THREE.WebGLUniforms.splitDynamic(m,d)}function b(t){w(t),t.transparent===!0?se.setBlending(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.premultipliedAlpha):se.setBlending(THREE.NoBlending),se.setDepthFunc(t.depthFunc),se.setDepthTest(t.depthTest),se.setDepthWrite(t.depthWrite),se.setColorWrite(t.colorWrite),se.setPolygonOffset(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits)}function w(t){t.side!==THREE.DoubleSide?se.enable(ne.CULL_FACE):se.disable(ne.CULL_FACE),se.setFlipSided(t.side===THREE.BackSide)}function R(t,e,n,i){Pt=0;var r=ce.get(n);if(Ft){if(Vt||t!==Mt){var o=t===Mt&&n.id===xt;N(n.clippingPlanes,n.clipShadows,t,r,o)}void 0!==r.numClippingPlanes&&r.numClippingPlanes!==zt&&(n.needsUpdate=!0)}void 0===r.program&&(n.needsUpdate=!0),void 0!==r.lightsHash&&r.lightsHash!==Jt.hash&&(n.needsUpdate=!0),n.needsUpdate&&(T(n,e,i),n.needsUpdate=!1);var a=!1,s=!1,c=!1,l=r.program,u=l.getUniforms(),h=r.__webglShader.uniforms;if(l.id!==bt&&(ne.useProgram(l.program),bt=l.id,a=!0,s=!0,c=!0),n.id!==xt&&(xt=n.id,s=!0),a||t!==Mt){if(u.set(ne,t,"projectionMatrix"),ae.logarithmicDepthBuffer&&u.setValue(ne,"logDepthBufFC",2/(Math.log(t.far+1)/Math.LN2)),t!==Mt&&(Mt=t,s=!0,c=!0),n instanceof THREE.ShaderMaterial||n instanceof THREE.MeshPhongMaterial||n instanceof THREE.MeshStandardMaterial||n.envMap){var p=u.map.cameraPosition;void 0!==p&&p.setValue(ne,$t.setFromMatrixPosition(t.matrixWorld))}(n instanceof THREE.MeshPhongMaterial||n instanceof THREE.MeshLambertMaterial||n instanceof THREE.MeshBasicMaterial||n instanceof THREE.MeshStandardMaterial||n instanceof THREE.ShaderMaterial||n.skinning)&&u.setValue(ne,"viewMatrix",t.matrixWorldInverse),u.set(ne,Tt,"toneMappingExposure"),u.set(ne,Tt,"toneMappingWhitePoint")}if(n.skinning){u.setOptional(ne,i,"bindMatrix"),u.setOptional(ne,i,"bindMatrixInverse");var d=i.skeleton;d&&(ae.floatVertexTextures&&d.useVertexTexture?(u.set(ne,d,"boneTexture"),u.set(ne,d,"boneTextureWidth"),u.set(ne,d,"boneTextureHeight")):u.setOptional(ne,d,"boneMatrices"))}s&&((n instanceof THREE.MeshPhongMaterial||n instanceof THREE.MeshLambertMaterial||n instanceof THREE.MeshStandardMaterial||n.lights)&&j(h,c),e&&n.fog&&C(h,e),(n instanceof THREE.MeshBasicMaterial||n instanceof THREE.MeshLambertMaterial||n instanceof THREE.MeshPhongMaterial||n instanceof THREE.MeshStandardMaterial||n instanceof THREE.MeshDepthMaterial)&&x(h,n),n instanceof THREE.LineBasicMaterial?H(h,n):n instanceof THREE.LineDashedMaterial?(H(h,n),M(h,n)):n instanceof THREE.PointsMaterial?S(h,n):n instanceof THREE.MeshLambertMaterial?A(h,n):n instanceof THREE.MeshPhongMaterial?P(h,n):n instanceof THREE.MeshPhysicalMaterial?O(h,n):n instanceof THREE.MeshStandardMaterial?L(h,n):n instanceof THREE.MeshDepthMaterial?n.displacementMap&&(h.displacementMap.value=n.displacementMap,h.displacementScale.value=n.displacementScale,h.displacementBias.value=n.displacementBias):n instanceof THREE.MeshNormalMaterial&&(h.opacity.value=n.opacity),THREE.WebGLUniforms.upload(ne,r.uniformsList,h,Tt)),u.set(ne,i,"modelViewMatrix"),u.set(ne,i,"normalMatrix"),u.setValue(ne,"modelMatrix",i.matrixWorld);var f=r.dynamicUniforms;return null!==f&&(THREE.WebGLUniforms.evalDynamic(f,h,i,t),THREE.WebGLUniforms.upload(ne,f,h,Tt)),l}function x(t,e){t.opacity.value=e.opacity,t.diffuse.value=e.color,e.emissive&&t.emissive.value.copy(e.emissive).multiplyScalar(e.emissiveIntensity),t.map.value=e.map,t.specularMap.value=e.specularMap,t.alphaMap.value=e.alphaMap,e.aoMap&&(t.aoMap.value=e.aoMap,t.aoMapIntensity.value=e.aoMapIntensity);var n;if(e.map?n=e.map:e.specularMap?n=e.specularMap:e.displacementMap?n=e.displacementMap:e.normalMap?n=e.normalMap:e.bumpMap?n=e.bumpMap:e.roughnessMap?n=e.roughnessMap:e.metalnessMap?n=e.metalnessMap:e.alphaMap?n=e.alphaMap:e.emissiveMap&&(n=e.emissiveMap),void 0!==n){n instanceof THREE.WebGLRenderTarget&&(n=n.texture);var i=n.offset,r=n.repeat;t.offsetRepeat.value.set(i.x,i.y,r.x,r.y)}t.envMap.value=e.envMap,t.flipEnvMap.value=e.envMap instanceof THREE.WebGLRenderTargetCube?1:-1,t.reflectivity.value=e.reflectivity,t.refractionRatio.value=e.refractionRatio}function H(t,e){t.diffuse.value=e.color,t.opacity.value=e.opacity}function M(t,e){t.dashSize.value=e.dashSize,t.totalSize.value=e.dashSize+e.gapSize,t.scale.value=e.scale}function S(t,e){if(t.diffuse.value=e.color,t.opacity.value=e.opacity,t.size.value=e.size*It,t.scale.value=.5*ot.clientHeight,t.map.value=e.map,null!==e.map){var n=e.map.offset,i=e.map.repeat;t.offsetRepeat.value.set(n.x,n.y,i.x,i.y)}}function C(t,e){t.fogColor.value=e.color,e instanceof THREE.Fog?(t.fogNear.value=e.near,t.fogFar.value=e.far):e instanceof THREE.FogExp2&&(t.fogDensity.value=e.density)}function A(t,e){e.lightMap&&(t.lightMap.value=e.lightMap,t.lightMapIntensity.value=e.lightMapIntensity),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap)}function P(t,e){t.specular.value=e.specular,t.shininess.value=Math.max(e.shininess,1e-4),e.lightMap&&(t.lightMap.value=e.lightMap,t.lightMapIntensity.value=e.lightMapIntensity),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale)),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}function L(t,e){t.roughness.value=e.roughness,t.metalness.value=e.metalness,e.roughnessMap&&(t.roughnessMap.value=e.roughnessMap),e.metalnessMap&&(t.metalnessMap.value=e.metalnessMap),e.lightMap&&(t.lightMap.value=e.lightMap,t.lightMapIntensity.value=e.lightMapIntensity),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale)),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias),e.envMap&&(t.envMapIntensity.value=e.envMapIntensity)}function O(t,e){L(t,e)}function j(t,e){t.ambientLightColor.needsUpdate=e,t.directionalLights.needsUpdate=e,t.pointLights.needsUpdate=e,t.spotLights.needsUpdate=e,t.hemisphereLights.needsUpdate=e}function k(t){for(var e=0,n=0,i=t.length;n<i;n++){var r=t[n];r.castShadow&&(Jt.shadows[e++]=r)}Jt.shadows.length=e}function I(t,e){var n,i,r,o,a,s,c=0,l=0,u=0,h=e.matrixWorldInverse,p=0,d=0,f=0,m=0;for(n=0,i=t.length;n<i;n++)if(r=t[n],o=r.color,a=r.intensity,s=r.distance,r instanceof THREE.AmbientLight)c+=o.r*a,l+=o.g*a,u+=o.b*a;else if(r instanceof THREE.DirectionalLight){var v=he.get(r);v.color.copy(r.color).multiplyScalar(r.intensity),v.direction.setFromMatrixPosition(r.matrixWorld),$t.setFromMatrixPosition(r.target.matrixWorld),v.direction.sub($t),v.direction.transformDirection(h),v.shadow=r.castShadow,r.castShadow&&(v.shadowBias=r.shadow.bias,v.shadowRadius=r.shadow.radius,v.shadowMapSize=r.shadow.mapSize),Jt.directionalShadowMap[p]=r.shadow.map,Jt.directionalShadowMatrix[p]=r.shadow.matrix,Jt.directional[p++]=v}else if(r instanceof THREE.SpotLight){var v=he.get(r);v.position.setFromMatrixPosition(r.matrixWorld),v.position.applyMatrix4(h),v.color.copy(o).multiplyScalar(a),v.distance=s,v.direction.setFromMatrixPosition(r.matrixWorld),$t.setFromMatrixPosition(r.target.matrixWorld),v.direction.sub($t),v.direction.transformDirection(h),v.coneCos=Math.cos(r.angle),v.penumbraCos=Math.cos(r.angle*(1-r.penumbra)),v.decay=0===r.distance?0:r.decay,v.shadow=r.castShadow,r.castShadow&&(v.shadowBias=r.shadow.bias,v.shadowRadius=r.shadow.radius,v.shadowMapSize=r.shadow.mapSize),Jt.spotShadowMap[f]=r.shadow.map,Jt.spotShadowMatrix[f]=r.shadow.matrix,Jt.spot[f++]=v}else if(r instanceof THREE.PointLight){var v=he.get(r);v.position.setFromMatrixPosition(r.matrixWorld),v.position.applyMatrix4(h),v.color.copy(r.color).multiplyScalar(r.intensity),v.distance=r.distance,v.decay=0===r.distance?0:r.decay,v.shadow=r.castShadow,r.castShadow&&(v.shadowBias=r.shadow.bias,v.shadowRadius=r.shadow.radius,v.shadowMapSize=r.shadow.mapSize),Jt.pointShadowMap[d]=r.shadow.map,void 0===Jt.pointShadowMatrix[d]&&(Jt.pointShadowMatrix[d]=new THREE.Matrix4),$t.setFromMatrixPosition(r.matrixWorld).negate(),Jt.pointShadowMatrix[d].identity().setPosition($t),Jt.point[d++]=v}else if(r instanceof THREE.HemisphereLight){var v=he.get(r);v.direction.setFromMatrixPosition(r.matrixWorld),v.direction.transformDirection(h),v.direction.normalize(),v.skyColor.copy(r.color).multiplyScalar(a),v.groundColor.copy(r.groundColor).multiplyScalar(a),Jt.hemi[m++]=v}Jt.ambient[0]=c,Jt.ambient[1]=l,Jt.ambient[2]=u,Jt.directional.length=p,Jt.spot.length=f,Jt.point.length=d,Jt.hemi.length=m,Jt.hash=p+","+d+","+f+","+m+","+Jt.shadows.length}function D(t,e){Ft=0!==Tt.clippingPlanes.length||Tt.localClippingEnabled||0!==qt||Vt,Vt=Tt.localClippingEnabled,Xt=B(t,e,0),qt=null!==t?t.length:0}function B(t,e,n,i){var r=null!==t?t.length:0,o=null;if(0!==r){if(o=Wt.value,i!==!0||null===o){var a=n+4*r,s=e.matrixWorldInverse,c=Yt.getNormalMatrix(s);(null===o||o.length<a)&&(o=new Float32Array(a));for(var l=0,u=n;l!==r;++l,u+=4){var h=Kt.copy(t[l]).applyMatrix4(s,c);h.normal.toArray(o,u),o[u+3]=h.constant}}Wt.value=o,Wt.needsUpdate=!0}return zt=r,o}function U(){Wt.value!==Xt&&(Wt.value=Xt,Wt.needsUpdate=qt>0),zt=qt}function N(t,e,n,i,r){if(!Vt||null===t||0===t.length||Gt&&!e)Gt?B(null):U();else{var o=Gt?0:qt,a=4*o,s=i.clippingState||null;Wt.value=s,s=B(t,n,a,r);for(var c=0;c!==a;++c)s[c]=Xt[c];i.clippingState=s,zt+=o}}function F(){var t=Pt;return t>=ae.maxTextures&&console.warn("WebGLRenderer: trying to use "+t+" texture units while this GPU supports only "+ae.maxTextures),Pt+=1,t}function V(t,e,n){var i;if(n?(ne.texParameteri(t,ne.TEXTURE_WRAP_S,rt(e.wrapS)),ne.texParameteri(t,ne.TEXTURE_WRAP_T,rt(e.wrapT)),ne.texParameteri(t,ne.TEXTURE_MAG_FILTER,rt(e.magFilter)),ne.texParameteri(t,ne.TEXTURE_MIN_FILTER,rt(e.minFilter))):(ne.texParameteri(t,ne.TEXTURE_WRAP_S,ne.CLAMP_TO_EDGE),ne.texParameteri(t,ne.TEXTURE_WRAP_T,ne.CLAMP_TO_EDGE),e.wrapS===THREE.ClampToEdgeWrapping&&e.wrapT===THREE.ClampToEdgeWrapping||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping.",e),ne.texParameteri(t,ne.TEXTURE_MAG_FILTER,it(e.magFilter)),ne.texParameteri(t,ne.TEXTURE_MIN_FILTER,it(e.minFilter)),e.minFilter!==THREE.NearestFilter&&e.minFilter!==THREE.LinearFilter&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.",e)),i=oe.get("EXT_texture_filter_anisotropic")){if(e.type===THREE.FloatType&&null===oe.get("OES_texture_float_linear"))return;if(e.type===THREE.HalfFloatType&&null===oe.get("OES_texture_half_float_linear"))return;(e.anisotropy>1||ce.get(e).__currentAnisotropy)&&(ne.texParameterf(t,i.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(e.anisotropy,Tt.getMaxAnisotropy())),ce.get(e).__currentAnisotropy=e.anisotropy)}}function G(t,e,n){void 0===t.__webglInit&&(t.__webglInit=!0,e.addEventListener("dispose",a),t.__webglTexture=ne.createTexture(),te.textures++),se.activeTexture(ne.TEXTURE0+n),se.bindTexture(ne.TEXTURE_2D,t.__webglTexture),ne.pixelStorei(ne.UNPACK_FLIP_Y_WEBGL,e.flipY),ne.pixelStorei(ne.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.premultiplyAlpha),ne.pixelStorei(ne.UNPACK_ALIGNMENT,e.unpackAlignment);var i=W(e.image,ae.maxTextureSize);q(e)&&X(i)===!1&&(i=Y(i));var r=X(i),o=rt(e.format),s=rt(e.type);V(ne.TEXTURE_2D,e,r);var c,l=e.mipmaps;if(e instanceof THREE.DepthTexture){var u=ne.DEPTH_COMPONENT;if(e.type===THREE.FloatType){if(!re)throw new Error("Float Depth Texture only supported in WebGL2.0");u=ne.DEPTH_COMPONENT32F}else re&&(u=ne.DEPTH_COMPONENT16);se.texImage2D(ne.TEXTURE_2D,0,u,i.width,i.height,0,o,s,null)}else if(e instanceof THREE.DataTexture)if(l.length>0&&r){for(var h=0,p=l.length;h<p;h++)c=l[h],se.texImage2D(ne.TEXTURE_2D,h,o,c.width,c.height,0,o,s,c.data);e.generateMipmaps=!1}else se.texImage2D(ne.TEXTURE_2D,0,o,i.width,i.height,0,o,s,i.data);else if(e instanceof THREE.CompressedTexture)for(var h=0,p=l.length;h<p;h++)c=l[h],e.format!==THREE.RGBAFormat&&e.format!==THREE.RGBFormat?se.getCompressedTextureFormats().indexOf(o)>-1?se.compressedTexImage2D(ne.TEXTURE_2D,h,o,c.width,c.height,0,c.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):se.texImage2D(ne.TEXTURE_2D,h,o,c.width,c.height,0,o,s,c.data);else if(l.length>0&&r){for(var h=0,p=l.length;h<p;h++)c=l[h],se.texImage2D(ne.TEXTURE_2D,h,o,o,s,c);e.generateMipmaps=!1}else se.texImage2D(ne.TEXTURE_2D,0,o,o,s,i);e.generateMipmaps&&r&&ne.generateMipmap(ne.TEXTURE_2D),t.__version=e.version,e.onUpdate&&e.onUpdate(e)}function z(t,e){t instanceof THREE.WebGLRenderTarget&&(t=t.texture);var n=ce.get(t);if(t.version>0&&n.__version!==t.version){var i=t.image;return void 0===i?void console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined",t):i.complete===!1?void console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete",t):void G(n,t,e)}se.activeTexture(ne.TEXTURE0+e),se.bindTexture(ne.TEXTURE_2D,n.__webglTexture)}function W(t,e){if(t.width>e||t.height>e){var n=e/Math.max(t.width,t.height),i=document.createElement("canvas");i.width=Math.floor(t.width*n),i.height=Math.floor(t.height*n);var r=i.getContext("2d");return r.drawImage(t,0,0,t.width,t.height,0,0,i.width,i.height),console.warn("THREE.WebGLRenderer: image is too big ("+t.width+"x"+t.height+"). Resized to "+i.width+"x"+i.height,t),i}return t}function X(t){return THREE.Math.isPowerOfTwo(t.width)&&THREE.Math.isPowerOfTwo(t.height)}function q(t){return t.wrapS!==THREE.ClampToEdgeWrapping||t.wrapT!==THREE.ClampToEdgeWrapping||t.minFilter!==THREE.NearestFilter&&t.minFilter!==THREE.LinearFilter}function Y(t){if(t instanceof HTMLImageElement||t instanceof HTMLCanvasElement){var e=document.createElement("canvas");e.width=THREE.Math.nearestPowerOfTwo(t.width),e.height=THREE.Math.nearestPowerOfTwo(t.height);var n=e.getContext("2d");return n.drawImage(t,0,0,e.width,e.height),console.warn("THREE.WebGLRenderer: image is not power of two ("+t.width+"x"+t.height+"). Resized to "+e.width+"x"+e.height,t),e}return t}function Z(t,e){var n=ce.get(t);if(6===t.image.length)if(t.version>0&&n.__version!==t.version){n.__image__webglTextureCube||(t.addEventListener("dispose",a),n.__image__webglTextureCube=ne.createTexture(),te.textures++),se.activeTexture(ne.TEXTURE0+e),se.bindTexture(ne.TEXTURE_CUBE_MAP,n.__image__webglTextureCube),ne.pixelStorei(ne.UNPACK_FLIP_Y_WEBGL,t.flipY);for(var i=t instanceof THREE.CompressedTexture,r=t.image[0]instanceof THREE.DataTexture,o=[],s=0;s<6;s++)!Tt.autoScaleCubemaps||i||r?o[s]=r?t.image[s].image:t.image[s]:o[s]=W(t.image[s],ae.maxCubemapSize);var c=o[0],l=X(c),u=rt(t.format),h=rt(t.type);V(ne.TEXTURE_CUBE_MAP,t,l);for(var s=0;s<6;s++)if(i)for(var p,d=o[s].mipmaps,f=0,m=d.length;f<m;f++)p=d[f],t.format!==THREE.RGBAFormat&&t.format!==THREE.RGBFormat?se.getCompressedTextureFormats().indexOf(u)>-1?se.compressedTexImage2D(ne.TEXTURE_CUBE_MAP_POSITIVE_X+s,f,u,p.width,p.height,0,p.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setCubeTexture()"):se.texImage2D(ne.TEXTURE_CUBE_MAP_POSITIVE_X+s,f,u,p.width,p.height,0,u,h,p.data);else r?se.texImage2D(ne.TEXTURE_CUBE_MAP_POSITIVE_X+s,0,u,o[s].width,o[s].height,0,u,h,o[s].data):se.texImage2D(ne.TEXTURE_CUBE_MAP_POSITIVE_X+s,0,u,u,h,o[s]);t.generateMipmaps&&l&&ne.generateMipmap(ne.TEXTURE_CUBE_MAP),n.__version=t.version,t.onUpdate&&t.onUpdate(t)}else se.activeTexture(ne.TEXTURE0+e),se.bindTexture(ne.TEXTURE_CUBE_MAP,n.__image__webglTextureCube)}function K(t,e){se.activeTexture(ne.TEXTURE0+e),se.bindTexture(ne.TEXTURE_CUBE_MAP,ce.get(t).__webglTexture)}function Q(t,e,n,i){var r=rt(e.texture.format),o=rt(e.texture.type);se.texImage2D(i,0,r,e.width,e.height,0,r,o,null),ne.bindFramebuffer(ne.FRAMEBUFFER,t),ne.framebufferTexture2D(ne.FRAMEBUFFER,n,i,ce.get(e.texture).__webglTexture,0),ne.bindFramebuffer(ne.FRAMEBUFFER,null)}function $(t,e){ne.bindRenderbuffer(ne.RENDERBUFFER,t),e.depthBuffer&&!e.stencilBuffer?(ne.renderbufferStorage(ne.RENDERBUFFER,ne.DEPTH_COMPONENT16,e.width,e.height),ne.framebufferRenderbuffer(ne.FRAMEBUFFER,ne.DEPTH_ATTACHMENT,ne.RENDERBUFFER,t)):e.depthBuffer&&e.stencilBuffer?(ne.renderbufferStorage(ne.RENDERBUFFER,ne.DEPTH_STENCIL,e.width,e.height),ne.framebufferRenderbuffer(ne.FRAMEBUFFER,ne.DEPTH_STENCIL_ATTACHMENT,ne.RENDERBUFFER,t)):ne.renderbufferStorage(ne.RENDERBUFFER,ne.RGBA4,e.width,e.height),ne.bindRenderbuffer(ne.RENDERBUFFER,null)}function J(t,e){var n=e instanceof THREE.WebGLRenderTargetCube;if(n)throw new Error("Depth Texture with cube render targets is not supported!");if(ne.bindFramebuffer(ne.FRAMEBUFFER,t),!(e.depthTexture instanceof THREE.DepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");ce.get(e.depthTexture).__webglTexture&&e.depthTexture.image.width===e.width&&e.depthTexture.image.height===e.height||(e.depthTexture.image.width=e.width,e.depthTexture.image.height=e.height,e.depthTexture.needsUpdate=!0),Tt.setTexture(e.depthTexture,0);var i=ce.get(e.depthTexture).__webglTexture;ne.framebufferTexture2D(ne.FRAMEBUFFER,ne.DEPTH_ATTACHMENT,ne.TEXTURE_2D,i,0)}function tt(t){var e=ce.get(t),n=t instanceof THREE.WebGLRenderTargetCube;if(t.depthTexture){if(n)throw new Error("target.depthTexture not supported in Cube render targets");J(e.__webglFramebuffer,t)}else if(n){e.__webglDepthbuffer=[];for(var i=0;i<6;i++)ne.bindFramebuffer(ne.FRAMEBUFFER,e.__webglFramebuffer[i]),e.__webglDepthbuffer[i]=ne.createRenderbuffer(),$(e.__webglDepthbuffer[i],t)}else ne.bindFramebuffer(ne.FRAMEBUFFER,e.__webglFramebuffer),e.__webglDepthbuffer=ne.createRenderbuffer(),$(e.__webglDepthbuffer,t);ne.bindFramebuffer(ne.FRAMEBUFFER,null)}function et(t){var e=ce.get(t),n=ce.get(t.texture);t.addEventListener("dispose",s),n.__webglTexture=ne.createTexture(),te.textures++;var i=t instanceof THREE.WebGLRenderTargetCube,r=THREE.Math.isPowerOfTwo(t.width)&&THREE.Math.isPowerOfTwo(t.height);if(i){e.__webglFramebuffer=[];for(var o=0;o<6;o++)e.__webglFramebuffer[o]=ne.createFramebuffer()}else e.__webglFramebuffer=ne.createFramebuffer();if(i){se.bindTexture(ne.TEXTURE_CUBE_MAP,n.__webglTexture),V(ne.TEXTURE_CUBE_MAP,t.texture,r);for(var o=0;o<6;o++)Q(e.__webglFramebuffer[o],t,ne.COLOR_ATTACHMENT0,ne.TEXTURE_CUBE_MAP_POSITIVE_X+o);t.texture.generateMipmaps&&r&&ne.generateMipmap(ne.TEXTURE_CUBE_MAP),se.bindTexture(ne.TEXTURE_CUBE_MAP,null)}else se.bindTexture(ne.TEXTURE_2D,n.__webglTexture),V(ne.TEXTURE_2D,t.texture,r),Q(e.__webglFramebuffer,t,ne.COLOR_ATTACHMENT0,ne.TEXTURE_2D),t.texture.generateMipmaps&&r&&ne.generateMipmap(ne.TEXTURE_2D),se.bindTexture(ne.TEXTURE_2D,null);t.depthBuffer&&tt(t)}function nt(t){var e=t instanceof THREE.WebGLRenderTargetCube?ne.TEXTURE_CUBE_MAP:ne.TEXTURE_2D,n=ce.get(t.texture).__webglTexture;se.bindTexture(e,n),ne.generateMipmap(e),se.bindTexture(e,null)}function it(t){return t===THREE.NearestFilter||t===THREE.NearestMipMapNearestFilter||t===THREE.NearestMipMapLinearFilter?ne.NEAREST:ne.LINEAR}function rt(t){var e;if(t===THREE.RepeatWrapping)return ne.REPEAT;if(t===THREE.ClampToEdgeWrapping)return ne.CLAMP_TO_EDGE;if(t===THREE.MirroredRepeatWrapping)return ne.MIRRORED_REPEAT;if(t===THREE.NearestFilter)return ne.NEAREST;if(t===THREE.NearestMipMapNearestFilter)return ne.NEAREST_MIPMAP_NEAREST;if(t===THREE.NearestMipMapLinearFilter)return ne.NEAREST_MIPMAP_LINEAR;if(t===THREE.LinearFilter)return ne.LINEAR;if(t===THREE.LinearMipMapNearestFilter)return ne.LINEAR_MIPMAP_NEAREST;if(t===THREE.LinearMipMapLinearFilter)return ne.LINEAR_MIPMAP_LINEAR;if(t===THREE.UnsignedByteType)return ne.UNSIGNED_BYTE;if(t===THREE.UnsignedShort4444Type)return ne.UNSIGNED_SHORT_4_4_4_4;if(t===THREE.UnsignedShort5551Type)return ne.UNSIGNED_SHORT_5_5_5_1;if(t===THREE.UnsignedShort565Type)return ne.UNSIGNED_SHORT_5_6_5;if(t===THREE.ByteType)return ne.BYTE;if(t===THREE.ShortType)return ne.SHORT;if(t===THREE.UnsignedShortType)return ne.UNSIGNED_SHORT;if(t===THREE.IntType)return ne.INT;if(t===THREE.UnsignedIntType)return ne.UNSIGNED_INT;if(t===THREE.FloatType)return ne.FLOAT;if(e=oe.get("OES_texture_half_float"),null!==e&&t===THREE.HalfFloatType)return e.HALF_FLOAT_OES;if(t===THREE.AlphaFormat)return ne.ALPHA;if(t===THREE.RGBFormat)return ne.RGB;if(t===THREE.RGBAFormat)return ne.RGBA;if(t===THREE.LuminanceFormat)return ne.LUMINANCE;if(t===THREE.LuminanceAlphaFormat)return ne.LUMINANCE_ALPHA;if(t===THREE.DepthFormat)return ne.DEPTH_COMPONENT;if(t===THREE.AddEquation)return ne.FUNC_ADD;if(t===THREE.SubtractEquation)return ne.FUNC_SUBTRACT;if(t===THREE.ReverseSubtractEquation)return ne.FUNC_REVERSE_SUBTRACT;if(t===THREE.ZeroFactor)return ne.ZERO;if(t===THREE.OneFactor)return ne.ONE;if(t===THREE.SrcColorFactor)return ne.SRC_COLOR;if(t===THREE.OneMinusSrcColorFactor)return ne.ONE_MINUS_SRC_COLOR;if(t===THREE.SrcAlphaFactor)return ne.SRC_ALPHA;if(t===THREE.OneMinusSrcAlphaFactor)return ne.ONE_MINUS_SRC_ALPHA;if(t===THREE.DstAlphaFactor)return ne.DST_ALPHA;if(t===THREE.OneMinusDstAlphaFactor)return ne.ONE_MINUS_DST_ALPHA;if(t===THREE.DstColorFactor)return ne.DST_COLOR;if(t===THREE.OneMinusDstColorFactor)return ne.ONE_MINUS_DST_COLOR;if(t===THREE.SrcAlphaSaturateFactor)return ne.SRC_ALPHA_SATURATE;if(e=oe.get("WEBGL_compressed_texture_s3tc"),null!==e){if(t===THREE.RGB_S3TC_DXT1_Format)return e.COMPRESSED_RGB_S3TC_DXT1_EXT;if(t===THREE.RGBA_S3TC_DXT1_Format)return e.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(t===THREE.RGBA_S3TC_DXT3_Format)return e.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(t===THREE.RGBA_S3TC_DXT5_Format)return e.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(e=oe.get("WEBGL_compressed_texture_pvrtc"),null!==e){if(t===THREE.RGB_PVRTC_4BPPV1_Format)return e.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(t===THREE.RGB_PVRTC_2BPPV1_Format)return e.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(t===THREE.RGBA_PVRTC_4BPPV1_Format)return e.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(t===THREE.RGBA_PVRTC_2BPPV1_Format)return e.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(e=oe.get("WEBGL_compressed_texture_etc1"),null!==e&&t===THREE.RGB_ETC1_Format)return e.COMPRESSED_RGB_ETC1_WEBGL;if(e=oe.get("EXT_blend_minmax"),null!==e){if(t===THREE.MinEquation)return e.MIN_EXT;if(t===THREE.MaxEquation)return e.MAX_EXT}return 0}console.log("THREE.WebGLRenderer",THREE.REVISION),t=t||{};var ot=void 0!==t.canvas?t.canvas:document.createElement("canvas"),at=void 0!==t.context?t.context:null,st=void 0!==t.alpha&&t.alpha,ct=void 0===t.depth||t.depth,lt=void 0===t.stencil||t.stencil,ut=void 0!==t.antialias&&t.antialias,ht=void 0===t.premultipliedAlpha||t.premultipliedAlpha,pt=void 0!==t.preserveDrawingBuffer&&t.preserveDrawingBuffer,dt=[],ft=[],mt=-1,vt=[],gt=-1,yt=new Float32Array(8),Et=[],_t=[];this.domElement=ot,this.context=null,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.gammaInput=!1,this.gammaOutput=!1,this.physicallyCorrectLights=!1,this.toneMapping=THREE.LinearToneMapping,this.toneMappingExposure=1,this.toneMappingWhitePoint=1,this.maxMorphTargets=8,this.maxMorphNormals=4,this.autoScaleCubemaps=!0;var Tt=this,bt=null,wt=null,Rt=null,xt=-1,Ht="",Mt=null,St=new THREE.Vector4,Ct=null,At=new THREE.Vector4,Pt=0,Lt=new THREE.Color(0),Ot=0,jt=ot.width,kt=ot.height,It=1,Dt=new THREE.Vector4(0,0,jt,kt),Bt=!1,Ut=new THREE.Vector4(0,0,jt,kt),Nt=new THREE.Frustum,Ft=!1,Vt=!1,Gt=!1,zt=0,Wt={type:"4fv",value:null,needsUpdate:!1},Xt=null,qt=0,Yt=new THREE.Matrix3,Zt=new THREE.Sphere,Kt=new THREE.Plane,Qt=new THREE.Matrix4,$t=new THREE.Vector3,Jt={hash:"",ambient:[0,0,0],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],shadows:[]},te={geometries:0,textures:0},ee={calls:0,vertices:0,faces:0,points:0};this.info={render:ee,memory:te,programs:null};var ne;try{var ie={alpha:st,depth:ct,stencil:lt,antialias:ut,premultipliedAlpha:ht,preserveDrawingBuffer:pt};if(ne=at||ot.getContext("webgl",ie)||ot.getContext("experimental-webgl",ie),null===ne)throw null!==ot.getContext("webgl")?"Error creating WebGL context with your selected attributes.":"Error creating WebGL context.";void 0===ne.getShaderPrecisionFormat&&(ne.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}}),ot.addEventListener("webglcontextlost",o,!1)}catch(t){console.error("THREE.WebGLRenderer: "+t)}var re="undefined"!=typeof WebGL2RenderingContext&&ne instanceof WebGL2RenderingContext,oe=new THREE.WebGLExtensions(ne);oe.get("WEBGL_depth_texture"),oe.get("OES_texture_float"),oe.get("OES_texture_float_linear"),oe.get("OES_texture_half_float"),oe.get("OES_texture_half_float_linear"),oe.get("OES_standard_derivatives"),oe.get("ANGLE_instanced_arrays"),oe.get("OES_element_index_uint")&&(THREE.BufferGeometry.MaxIndex=4294967296);var ae=new THREE.WebGLCapabilities(ne,oe,t),se=new THREE.WebGLState(ne,oe,rt),ce=new THREE.WebGLProperties,le=new THREE.WebGLObjects(ne,ce,this.info),ue=new THREE.WebGLPrograms(this,ae),he=new THREE.WebGLLights;this.info.programs=ue.programs;var pe=new THREE.WebGLBufferRenderer(ne,oe,ee),de=new THREE.WebGLIndexedBufferRenderer(ne,oe,ee);i(),this.context=ne,this.capabilities=ae,this.extensions=oe,this.properties=ce,this.state=se;var fe=new THREE.WebGLShadowMap(this,Jt,le);this.shadowMap=fe;var me=new THREE.SpritePlugin(this,Et),ve=new THREE.LensFlarePlugin(this,_t);this.getContext=function(){return ne},this.getContextAttributes=function(){return ne.getContextAttributes()},this.forceContextLoss=function(){oe.get("WEBGL_lose_context").loseContext()},this.getMaxAnisotropy=function(){var t;return function(){if(void 0!==t)return t;var e=oe.get("EXT_texture_filter_anisotropic");return t=null!==e?ne.getParameter(e.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0}}(),this.getPrecision=function(){return ae.precision},this.getPixelRatio=function(){return It},this.setPixelRatio=function(t){void 0!==t&&(It=t,this.setSize(Ut.z,Ut.w,!1))},this.getSize=function(){return{width:jt,height:kt}},this.setSize=function(t,e,n){jt=t,kt=e,ot.width=t*It,ot.height=e*It,n!==!1&&(ot.style.width=t+"px",ot.style.height=e+"px"),this.setViewport(0,0,t,e)},this.setViewport=function(t,e,n,i){se.viewport(Ut.set(t,e,n,i))},this.setScissor=function(t,e,n,i){se.scissor(Dt.set(t,e,n,i))},this.setScissorTest=function(t){se.setScissorTest(Bt=t)},this.getClearColor=function(){return Lt},this.setClearColor=function(t,e){Lt.set(t),Ot=void 0!==e?e:1,n(Lt.r,Lt.g,Lt.b,Ot)},this.getClearAlpha=function(){return Ot},this.setClearAlpha=function(t){Ot=t,n(Lt.r,Lt.g,Lt.b,Ot)},this.clear=function(t,e,n){var i=0;(void 0===t||t)&&(i|=ne.COLOR_BUFFER_BIT),(void 0===e||e)&&(i|=ne.DEPTH_BUFFER_BIT),(void 0===n||n)&&(i|=ne.STENCIL_BUFFER_BIT),ne.clear(i)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.clearTarget=function(t,e,n,i){this.setRenderTarget(t),this.clear(e,n,i)},this.resetGLState=r,this.dispose=function(){ot.removeEventListener("webglcontextlost",o,!1)},this.renderBufferImmediate=function(t,e,n){se.initAttributes();var i=ce.get(t);t.hasPositions&&!i.position&&(i.position=ne.createBuffer()),t.hasNormals&&!i.normal&&(i.normal=ne.createBuffer()),t.hasUvs&&!i.uv&&(i.uv=ne.createBuffer()),t.hasColors&&!i.color&&(i.color=ne.createBuffer());var r=e.getAttributes();if(t.hasPositions&&(ne.bindBuffer(ne.ARRAY_BUFFER,i.position),ne.bufferData(ne.ARRAY_BUFFER,t.positionArray,ne.DYNAMIC_DRAW),se.enableAttribute(r.position),ne.vertexAttribPointer(r.position,3,ne.FLOAT,!1,0,0)),t.hasNormals){if(ne.bindBuffer(ne.ARRAY_BUFFER,i.normal),"MeshPhongMaterial"!==n.type&&"MeshStandardMaterial"!==n.type&&"MeshPhysicalMaterial"!==n.type&&n.shading===THREE.FlatShading)for(var o=0,a=3*t.count;o<a;o+=9){var s=t.normalArray,c=(s[o+0]+s[o+3]+s[o+6])/3,l=(s[o+1]+s[o+4]+s[o+7])/3,u=(s[o+2]+s[o+5]+s[o+8])/3;s[o+0]=c,s[o+1]=l,s[o+2]=u,s[o+3]=c,s[o+4]=l,s[o+5]=u,s[o+6]=c,s[o+7]=l,s[o+8]=u}ne.bufferData(ne.ARRAY_BUFFER,t.normalArray,ne.DYNAMIC_DRAW),se.enableAttribute(r.normal),ne.vertexAttribPointer(r.normal,3,ne.FLOAT,!1,0,0)}t.hasUvs&&n.map&&(ne.bindBuffer(ne.ARRAY_BUFFER,i.uv),ne.bufferData(ne.ARRAY_BUFFER,t.uvArray,ne.DYNAMIC_DRAW),
se.enableAttribute(r.uv),ne.vertexAttribPointer(r.uv,2,ne.FLOAT,!1,0,0)),t.hasColors&&n.vertexColors!==THREE.NoColors&&(ne.bindBuffer(ne.ARRAY_BUFFER,i.color),ne.bufferData(ne.ARRAY_BUFFER,t.colorArray,ne.DYNAMIC_DRAW),se.enableAttribute(r.color),ne.vertexAttribPointer(r.color,3,ne.FLOAT,!1,0,0)),se.disableUnusedAttributes(),ne.drawArrays(ne.TRIANGLES,0,t.count),t.count=0},this.renderBufferDirect=function(t,n,i,r,o,a){b(r);var s=R(t,n,r,o),c=!1,l=i.id+"_"+s.id+"_"+r.wireframe;l!==Ht&&(Ht=l,c=!0);var u=o.morphTargetInfluences;if(void 0!==u){for(var h=[],p=0,m=u.length;p<m;p++){var v=u[p];h.push([v,p])}h.sort(f),h.length>8&&(h.length=8);for(var g=i.morphAttributes,p=0,m=h.length;p<m;p++){var v=h[p];if(yt[p]=v[0],0!==v[0]){var y=v[1];r.morphTargets===!0&&g.position&&i.addAttribute("morphTarget"+p,g.position[y]),r.morphNormals===!0&&g.normal&&i.addAttribute("morphNormal"+p,g.normal[y])}else r.morphTargets===!0&&i.removeAttribute("morphTarget"+p),r.morphNormals===!0&&i.removeAttribute("morphNormal"+p)}s.getUniforms().setValue(ne,"morphTargetInfluences",yt),c=!0}var y=i.index,E=i.attributes.position;r.wireframe===!0&&(y=le.getWireframeAttribute(i));var _;null!==y?(_=de,_.setIndex(y)):_=pe,c&&(d(r,s,i),null!==y&&ne.bindBuffer(ne.ELEMENT_ARRAY_BUFFER,le.getAttributeBuffer(y)));var T=0,w=1/0;null!==y?w=y.count:void 0!==E&&(w=E.count);var x=i.drawRange.start,H=i.drawRange.count,M=null!==a?a.start:0,S=null!==a?a.count:1/0,C=Math.max(T,x,M),A=Math.min(T+w,x+H,M+S)-1,P=Math.max(0,A-C+1);if(o instanceof THREE.Mesh)if(r.wireframe===!0)se.setLineWidth(r.wireframeLinewidth*e()),_.setMode(ne.LINES);else switch(o.drawMode){case THREE.TrianglesDrawMode:_.setMode(ne.TRIANGLES);break;case THREE.TriangleStripDrawMode:_.setMode(ne.TRIANGLE_STRIP);break;case THREE.TriangleFanDrawMode:_.setMode(ne.TRIANGLE_FAN)}else if(o instanceof THREE.Line){var L=r.linewidth;void 0===L&&(L=1),se.setLineWidth(L*e()),o instanceof THREE.LineSegments?_.setMode(ne.LINES):_.setMode(ne.LINE_STRIP)}else o instanceof THREE.Points&&_.setMode(ne.POINTS);i instanceof THREE.InstancedBufferGeometry?i.maxInstancedCount>0&&_.renderInstances(i,C,P):_.render(C,P)},this.render=function(t,e,n,i){if(e instanceof THREE.Camera==!1)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");var r=t.fog;if(Ht="",xt=-1,Mt=null,t.autoUpdate===!0&&t.updateMatrixWorld(),null===e.parent&&e.updateMatrixWorld(),e.matrixWorldInverse.getInverse(e.matrixWorld),Qt.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),Nt.setFromMatrix(Qt),dt.length=0,mt=-1,gt=-1,Et.length=0,_t.length=0,D(this.clippingPlanes,e),E(t,e),ft.length=mt+1,vt.length=gt+1,Tt.sortObjects===!0&&(ft.sort(m),vt.sort(v)),Ft&&(Gt=!0,B(null)),k(dt),fe.render(t,e),I(dt,e),Ft&&(Gt=!1,U()),ee.calls=0,ee.vertices=0,ee.faces=0,ee.points=0,void 0===n&&(n=null),this.setRenderTarget(n),(this.autoClear||i)&&this.clear(this.autoClearColor,this.autoClearDepth,this.autoClearStencil),t.overrideMaterial){var o=t.overrideMaterial;_(ft,e,r,o),_(vt,e,r,o)}else se.setBlending(THREE.NoBlending),_(ft,e,r),_(vt,e,r);if(me.render(t,e),ve.render(t,e,At),n){var a=n.texture;a.generateMipmaps&&X(n)&&a.minFilter!==THREE.NearestFilter&&a.minFilter!==THREE.LinearFilter&&nt(n)}se.setDepthTest(!0),se.setDepthWrite(!0),se.setColorWrite(!0)},this.setFaceCulling=function(t,e){t===THREE.CullFaceNone?se.disable(ne.CULL_FACE):(e===THREE.FrontFaceDirectionCW?ne.frontFace(ne.CW):ne.frontFace(ne.CCW),t===THREE.CullFaceBack?ne.cullFace(ne.BACK):t===THREE.CullFaceFront?ne.cullFace(ne.FRONT):ne.cullFace(ne.FRONT_AND_BACK),se.enable(ne.CULL_FACE))};var ge=!1;this.setTexture=function(t,e){ge||(console.warn("THREE.WebGLRenderer: .setTexture is deprecated, use setTexture2D instead."),ge=!0),z(t,e)},this.allocTextureUnit=F,this.setTexture2D=z,this.setTextureCube=function(t,e){t instanceof THREE.CubeTexture||Array.isArray(t.image)&&6===t.image.length?Z(t,e):K(t.texture,e)},this.getCurrentRenderTarget=function(){return wt},this.setRenderTarget=function(t){wt=t,t&&void 0===ce.get(t).__webglFramebuffer&&et(t);var e,n=t instanceof THREE.WebGLRenderTargetCube;if(t){var i=ce.get(t);e=n?i.__webglFramebuffer[t.activeCubeFace]:i.__webglFramebuffer,St.copy(t.scissor),Ct=t.scissorTest,At.copy(t.viewport)}else e=null,St.copy(Dt).multiplyScalar(It),Ct=Bt,At.copy(Ut).multiplyScalar(It);if(Rt!==e&&(ne.bindFramebuffer(ne.FRAMEBUFFER,e),Rt=e),se.scissor(St),se.setScissorTest(Ct),se.viewport(At),n){var r=ce.get(t.texture);ne.framebufferTexture2D(ne.FRAMEBUFFER,ne.COLOR_ATTACHMENT0,ne.TEXTURE_CUBE_MAP_POSITIVE_X+t.activeCubeFace,r.__webglTexture,t.activeMipMapLevel)}},this.readRenderTargetPixels=function(t,e,n,i,r,o){if(t instanceof THREE.WebGLRenderTarget==!1)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");var a=ce.get(t).__webglFramebuffer;if(a){var s=!1;a!==Rt&&(ne.bindFramebuffer(ne.FRAMEBUFFER,a),s=!0);try{var c=t.texture;if(c.format!==THREE.RGBAFormat&&rt(c.format)!==ne.getParameter(ne.IMPLEMENTATION_COLOR_READ_FORMAT))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!(c.type===THREE.UnsignedByteType||rt(c.type)===ne.getParameter(ne.IMPLEMENTATION_COLOR_READ_TYPE)||c.type===THREE.FloatType&&oe.get("WEBGL_color_buffer_float")||c.type===THREE.HalfFloatType&&oe.get("EXT_color_buffer_half_float")))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");ne.checkFramebufferStatus(ne.FRAMEBUFFER)===ne.FRAMEBUFFER_COMPLETE?e>0&&e<=t.width-i&&n>0&&n<=t.height-r&&ne.readPixels(e,n,i,r,rt(c.format),rt(c.type),o):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{s&&ne.bindFramebuffer(ne.FRAMEBUFFER,Rt)}}}},THREE.WebGLRenderTarget=function(t,e,n){this.uuid=THREE.Math.generateUUID(),this.width=t,this.height=e,this.scissor=new THREE.Vector4(0,0,t,e),this.scissorTest=!1,this.viewport=new THREE.Vector4(0,0,t,e),n=n||{},void 0===n.minFilter&&(n.minFilter=THREE.LinearFilter),this.texture=new THREE.Texture((void 0),(void 0),n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0===n.stencilBuffer||n.stencilBuffer,this.depthTexture=null},THREE.WebGLRenderTarget.prototype={constructor:THREE.WebGLRenderTarget,setSize:function(t,e){this.width===t&&this.height===e||(this.width=t,this.height=e,this.dispose()),this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.width=t.width,this.height=t.height,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.depthTexture=t.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}},THREE.EventDispatcher.prototype.apply(THREE.WebGLRenderTarget.prototype),THREE.WebGLRenderTargetCube=function(t,e,n){THREE.WebGLRenderTarget.call(this,t,e,n),this.activeCubeFace=0,this.activeMipMapLevel=0},THREE.WebGLRenderTargetCube.prototype=Object.create(THREE.WebGLRenderTarget.prototype),THREE.WebGLRenderTargetCube.prototype.constructor=THREE.WebGLRenderTargetCube,THREE.WebGLBufferRenderer=function(t,e,n){function i(t){a=t}function r(e,i){t.drawArrays(a,e,i),n.calls++,n.vertices+=i,a===t.TRIANGLES&&(n.faces+=i/3)}function o(i){var r=e.get("ANGLE_instanced_arrays");if(null===r)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");var o=i.attributes.position,s=0;o instanceof THREE.InterleavedBufferAttribute?(s=o.data.count,r.drawArraysInstancedANGLE(a,0,s,i.maxInstancedCount)):(s=o.count,r.drawArraysInstancedANGLE(a,0,s,i.maxInstancedCount)),n.calls++,n.vertices+=s*i.maxInstancedCount,a===t.TRIANGLES&&(n.faces+=i.maxInstancedCount*s/3)}var a;this.setMode=i,this.render=r,this.renderInstances=o},THREE.WebGLIndexedBufferRenderer=function(t,e,n){function i(t){s=t}function r(n){n.array instanceof Uint32Array&&e.get("OES_element_index_uint")?(c=t.UNSIGNED_INT,l=4):(c=t.UNSIGNED_SHORT,l=2)}function o(e,i){t.drawElements(s,i,c,e*l),n.calls++,n.vertices+=i,s===t.TRIANGLES&&(n.faces+=i/3)}function a(i,r,o){var a=e.get("ANGLE_instanced_arrays");return null===a?void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays."):(a.drawElementsInstancedANGLE(s,o,c,r*l,i.maxInstancedCount),n.calls++,n.vertices+=o*i.maxInstancedCount,void(s===t.TRIANGLES&&(n.faces+=i.maxInstancedCount*o/3)))}var s,c,l;this.setMode=i,this.setIndex=r,this.render=o,this.renderInstances=a},THREE.WebGLExtensions=function(t){var e={};this.get=function(n){if(void 0!==e[n])return e[n];var i;switch(n){case"WEBGL_depth_texture":i=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");case"EXT_texture_filter_anisotropic":i=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;case"WEBGL_compressed_texture_etc1":i=t.getExtension("WEBGL_compressed_texture_etc1");break;default:i=t.getExtension(n)}return null===i&&console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),e[n]=i,i}},THREE.WebGLCapabilities=function(t,e,n){function i(e){if("highp"===e){if(t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.HIGH_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision>0)return"highp";e="mediump"}return"mediump"===e&&t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.MEDIUM_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}this.getMaxPrecision=i,this.precision=void 0!==n.precision?n.precision:"highp",this.logarithmicDepthBuffer=void 0!==n.logarithmicDepthBuffer&&n.logarithmicDepthBuffer,this.maxTextures=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),this.maxVertexTextures=t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS),this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),this.maxCubemapSize=t.getParameter(t.MAX_CUBE_MAP_TEXTURE_SIZE),this.maxAttributes=t.getParameter(t.MAX_VERTEX_ATTRIBS),this.maxVertexUniforms=t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS),this.maxVaryings=t.getParameter(t.MAX_VARYING_VECTORS),this.maxFragmentUniforms=t.getParameter(t.MAX_FRAGMENT_UNIFORM_VECTORS),this.vertexTextures=this.maxVertexTextures>0,this.floatFragmentTextures=!!e.get("OES_texture_float"),this.floatVertexTextures=this.vertexTextures&&this.floatFragmentTextures;var r=i(this.precision);r!==this.precision&&(console.warn("THREE.WebGLRenderer:",this.precision,"not supported, using",r,"instead."),this.precision=r),this.logarithmicDepthBuffer&&(this.logarithmicDepthBuffer=!!e.get("EXT_frag_depth"))},THREE.WebGLGeometries=function(t,e,n){function i(t){var e=t.geometry;if(void 0!==l[e.id])return l[e.id];e.addEventListener("dispose",r);var i;return e instanceof THREE.BufferGeometry?i=e:e instanceof THREE.Geometry&&(void 0===e._bufferGeometry&&(e._bufferGeometry=(new THREE.BufferGeometry).setFromObject(t)),i=e._bufferGeometry),l[e.id]=i,n.memory.geometries++,i}function r(t){var i=t.target,o=l[i.id];null!==o.index&&a(o.index),s(o.attributes),i.removeEventListener("dispose",r),delete l[i.id];var c=e.get(i);c.wireframe&&a(c.wireframe),e.delete(i);var u=e.get(o);u.wireframe&&a(u.wireframe),e.delete(o),n.memory.geometries--}function o(t){return t instanceof THREE.InterleavedBufferAttribute?e.get(t.data).__webglBuffer:e.get(t).__webglBuffer}function a(e){var n=o(e);void 0!==n&&(t.deleteBuffer(n),c(e))}function s(t){for(var e in t)a(t[e])}function c(t){t instanceof THREE.InterleavedBufferAttribute?e.delete(t.data):e.delete(t)}var l={};this.get=i},THREE.WebGLLights=function(){var t={};this.get=function(e){if(void 0!==t[e.id])return t[e.id];var n;switch(e.type){case"DirectionalLight":n={direction:new THREE.Vector3,color:new THREE.Color,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new THREE.Vector2};break;case"SpotLight":n={position:new THREE.Vector3,direction:new THREE.Vector3,color:new THREE.Color,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new THREE.Vector2};break;case"PointLight":n={position:new THREE.Vector3,color:new THREE.Color,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new THREE.Vector2};break;case"HemisphereLight":n={direction:new THREE.Vector3,skyColor:new THREE.Color,groundColor:new THREE.Color}}return t[e.id]=n,n}},THREE.WebGLObjects=function(t,e,n){function i(e){var n=u.get(e);e.geometry instanceof THREE.Geometry&&n.updateFromObject(e);var i=n.index,o=n.attributes;null!==i&&r(i,t.ELEMENT_ARRAY_BUFFER);for(var a in o)r(o[a],t.ARRAY_BUFFER);var s=n.morphAttributes;for(var a in s)for(var c=s[a],l=0,h=c.length;l<h;l++)r(c[l],t.ARRAY_BUFFER);return n}function r(t,n){var i=t instanceof THREE.InterleavedBufferAttribute?t.data:t,r=e.get(i);void 0===r.__webglBuffer?o(r,i,n):r.version!==i.version&&a(r,i,n)}function o(e,n,i){e.__webglBuffer=t.createBuffer(),t.bindBuffer(i,e.__webglBuffer);var r=n.dynamic?t.DYNAMIC_DRAW:t.STATIC_DRAW;t.bufferData(i,n.array,r),e.version=n.version}function a(e,n,i){t.bindBuffer(i,e.__webglBuffer),n.dynamic===!1||n.updateRange.count===-1?t.bufferSubData(i,0,n.array):0===n.updateRange.count?console.error("THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually."):(t.bufferSubData(i,n.updateRange.offset*n.array.BYTES_PER_ELEMENT,n.array.subarray(n.updateRange.offset,n.updateRange.offset+n.updateRange.count)),n.updateRange.count=0),e.version=n.version}function s(t){return t instanceof THREE.InterleavedBufferAttribute?e.get(t.data).__webglBuffer:e.get(t).__webglBuffer}function c(n){var i=e.get(n);if(void 0!==i.wireframe)return i.wireframe;var o=[],a=n.index,s=n.attributes,c=s.position;if(null!==a)for(var u={},h=a.array,p=0,d=h.length;p<d;p+=3){var f=h[p+0],m=h[p+1],v=h[p+2];l(u,f,m)&&o.push(f,m),l(u,m,v)&&o.push(m,v),l(u,v,f)&&o.push(v,f)}else for(var h=s.position.array,p=0,d=h.length/3-1;p<d;p+=3){var f=p+0,m=p+1,v=p+2;o.push(f,m,m,v,v,f)}var g=c.count>65535?Uint32Array:Uint16Array,y=new THREE.BufferAttribute(new g(o),1);return r(y,t.ELEMENT_ARRAY_BUFFER),i.wireframe=y,y}function l(t,e,n){if(e>n){var i=e;e=n,n=i}var r=t[e];return void 0===r?(t[e]=[n],!0):r.indexOf(n)===-1&&(r.push(n),!0)}var u=new THREE.WebGLGeometries(t,e,n);this.getAttributeBuffer=s,this.getWireframeAttribute=c,this.update=i},THREE.WebGLProgram=function(){function t(t){switch(t){case THREE.LinearEncoding:return["Linear","( value )"];case THREE.sRGBEncoding:return["sRGB","( value )"];case THREE.RGBEEncoding:return["RGBE","( value )"];case THREE.RGBM7Encoding:return["RGBM","( value, 7.0 )"];case THREE.RGBM16Encoding:return["RGBM","( value, 16.0 )"];case THREE.RGBDEncoding:return["RGBD","( value, 256.0 )"];case THREE.GammaEncoding:return["Gamma","( value, float( GAMMA_FACTOR ) )"];default:throw new Error("unsupported encoding: "+t)}}function e(e,n){var i=t(n);return"vec4 "+e+"( vec4 value ) { return "+i[0]+"ToLinear"+i[1]+"; }"}function n(e,n){var i=t(n);return"vec4 "+e+"( vec4 value ) { return LinearTo"+i[0]+i[1]+"; }"}function i(t,e){var n;switch(e){case THREE.LinearToneMapping:n="Linear";break;case THREE.ReinhardToneMapping:n="Reinhard";break;case THREE.Uncharted2ToneMapping:n="Uncharted2";break;case THREE.CineonToneMapping:n="OptimizedCineon";break;default:throw new Error("unsupported toneMapping: "+e)}return"vec3 "+t+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function r(t,e,n){t=t||{};var i=[t.derivatives||e.envMapCubeUV||e.bumpMap||e.normalMap||e.flatShading?"#extension GL_OES_standard_derivatives : enable":"",(t.fragDepth||e.logarithmicDepthBuffer)&&n.get("EXT_frag_depth")?"#extension GL_EXT_frag_depth : enable":"",t.drawBuffers&&n.get("WEBGL_draw_buffers")?"#extension GL_EXT_draw_buffers : require":"",(t.shaderTextureLOD||e.envMap)&&n.get("EXT_shader_texture_lod")?"#extension GL_EXT_shader_texture_lod : enable":""];return i.filter(s).join("\n")}function o(t){var e=[];for(var n in t){var i=t[n];i!==!1&&e.push("#define "+n+" "+i)}return e.join("\n")}function a(t,e,n){for(var i={},r=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES),o=0;o<r;o++){var a=t.getActiveAttrib(e,o),s=a.name;i[s]=t.getAttribLocation(e,s)}return i}function s(t){return""!==t}function c(t,e){return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights)}function l(t){function e(t,e){var n=THREE.ShaderChunk[e];if(void 0===n)throw new Error("Can not resolve #include <"+e+">");return l(n)}var n=/#include +<([\w\d.]+)>/g;return t.replace(n,e)}function u(t){function e(t,e,n,i){for(var r="",o=parseInt(e);o<parseInt(n);o++)r+=i.replace(/\[ i \]/g,"[ "+o+" ]");return r}var n=/for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g;return t.replace(n,e)}var h=0;return function(t,p,d,f){var m=t.context,v=d.extensions,g=d.defines,y=d.__webglShader.vertexShader,E=d.__webglShader.fragmentShader,_="SHADOWMAP_TYPE_BASIC";f.shadowMapType===THREE.PCFShadowMap?_="SHADOWMAP_TYPE_PCF":f.shadowMapType===THREE.PCFSoftShadowMap&&(_="SHADOWMAP_TYPE_PCF_SOFT");var T="ENVMAP_TYPE_CUBE",b="ENVMAP_MODE_REFLECTION",w="ENVMAP_BLENDING_MULTIPLY";if(f.envMap){switch(d.envMap.mapping){case THREE.CubeReflectionMapping:case THREE.CubeRefractionMapping:T="ENVMAP_TYPE_CUBE";break;case THREE.CubeUVReflectionMapping:case THREE.CubeUVRefractionMapping:T="ENVMAP_TYPE_CUBE_UV";break;case THREE.EquirectangularReflectionMapping:case THREE.EquirectangularRefractionMapping:T="ENVMAP_TYPE_EQUIREC";break;case THREE.SphericalReflectionMapping:T="ENVMAP_TYPE_SPHERE"}switch(d.envMap.mapping){case THREE.CubeRefractionMapping:case THREE.EquirectangularRefractionMapping:b="ENVMAP_MODE_REFRACTION"}switch(d.combine){case THREE.MultiplyOperation:w="ENVMAP_BLENDING_MULTIPLY";break;case THREE.MixOperation:w="ENVMAP_BLENDING_MIX";break;case THREE.AddOperation:w="ENVMAP_BLENDING_ADD"}}var R,x,H=t.gammaFactor>0?t.gammaFactor:1,M=r(v,f,t.extensions),S=o(g),C=m.createProgram();d instanceof THREE.RawShaderMaterial?(R="",x=""):(R=["precision "+f.precision+" float;","precision "+f.precision+" int;","#define SHADER_NAME "+d.__webglShader.name,S,f.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+H,"#define MAX_BONES "+f.maxBones,f.map?"#define USE_MAP":"",f.envMap?"#define USE_ENVMAP":"",f.envMap?"#define "+b:"",f.lightMap?"#define USE_LIGHTMAP":"",f.aoMap?"#define USE_AOMAP":"",f.emissiveMap?"#define USE_EMISSIVEMAP":"",f.bumpMap?"#define USE_BUMPMAP":"",f.normalMap?"#define USE_NORMALMAP":"",f.displacementMap&&f.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",f.specularMap?"#define USE_SPECULARMAP":"",f.roughnessMap?"#define USE_ROUGHNESSMAP":"",f.metalnessMap?"#define USE_METALNESSMAP":"",f.alphaMap?"#define USE_ALPHAMAP":"",f.vertexColors?"#define USE_COLOR":"",f.flatShading?"#define FLAT_SHADED":"",f.skinning?"#define USE_SKINNING":"",f.useVertexTexture?"#define BONE_TEXTURE":"",f.morphTargets?"#define USE_MORPHTARGETS":"",f.morphNormals&&f.flatShading===!1?"#define USE_MORPHNORMALS":"",f.doubleSided?"#define DOUBLE_SIDED":"",f.flipSided?"#define FLIP_SIDED":"","#define NUM_CLIPPING_PLANES "+f.numClippingPlanes,f.shadowMapEnabled?"#define USE_SHADOWMAP":"",f.shadowMapEnabled?"#define "+_:"",f.sizeAttenuation?"#define USE_SIZEATTENUATION":"",f.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",f.logarithmicDepthBuffer&&t.extensions.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(s).join("\n"),x=[M,"precision "+f.precision+" float;","precision "+f.precision+" int;","#define SHADER_NAME "+d.__webglShader.name,S,f.alphaTest?"#define ALPHATEST "+f.alphaTest:"","#define GAMMA_FACTOR "+H,f.useFog&&f.fog?"#define USE_FOG":"",f.useFog&&f.fogExp?"#define FOG_EXP2":"",f.map?"#define USE_MAP":"",f.envMap?"#define USE_ENVMAP":"",f.envMap?"#define "+T:"",f.envMap?"#define "+b:"",f.envMap?"#define "+w:"",f.lightMap?"#define USE_LIGHTMAP":"",f.aoMap?"#define USE_AOMAP":"",f.emissiveMap?"#define USE_EMISSIVEMAP":"",f.bumpMap?"#define USE_BUMPMAP":"",f.normalMap?"#define USE_NORMALMAP":"",f.specularMap?"#define USE_SPECULARMAP":"",f.roughnessMap?"#define USE_ROUGHNESSMAP":"",f.metalnessMap?"#define USE_METALNESSMAP":"",f.alphaMap?"#define USE_ALPHAMAP":"",f.vertexColors?"#define USE_COLOR":"",f.flatShading?"#define FLAT_SHADED":"",f.doubleSided?"#define DOUBLE_SIDED":"",f.flipSided?"#define FLIP_SIDED":"","#define NUM_CLIPPING_PLANES "+f.numClippingPlanes,f.shadowMapEnabled?"#define USE_SHADOWMAP":"",f.shadowMapEnabled?"#define "+_:"",f.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",f.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",f.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",f.logarithmicDepthBuffer&&t.extensions.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"",f.envMap&&t.extensions.get("EXT_shader_texture_lod")?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",f.toneMapping!==THREE.NoToneMapping?"#define TONE_MAPPING":"",f.toneMapping!==THREE.NoToneMapping?THREE.ShaderChunk.tonemapping_pars_fragment:"",f.toneMapping!==THREE.NoToneMapping?i("toneMapping",f.toneMapping):"",f.outputEncoding||f.mapEncoding||f.envMapEncoding||f.emissiveMapEncoding?THREE.ShaderChunk.encodings_pars_fragment:"",f.mapEncoding?e("mapTexelToLinear",f.mapEncoding):"",f.envMapEncoding?e("envMapTexelToLinear",f.envMapEncoding):"",f.emissiveMapEncoding?e("emissiveMapTexelToLinear",f.emissiveMapEncoding):"",f.outputEncoding?n("linearToOutputTexel",f.outputEncoding):"",f.depthPacking?"#define DEPTH_PACKING "+d.depthPacking:"","\n"].filter(s).join("\n")),y=l(y,f),y=c(y,f),E=l(E,f),E=c(E,f),d instanceof THREE.ShaderMaterial==!1&&(y=u(y),E=u(E));var A=R+y,P=x+E,L=THREE.WebGLShader(m,m.VERTEX_SHADER,A),O=THREE.WebGLShader(m,m.FRAGMENT_SHADER,P);m.attachShader(C,L),m.attachShader(C,O),void 0!==d.index0AttributeName?m.bindAttribLocation(C,0,d.index0AttributeName):f.morphTargets===!0&&m.bindAttribLocation(C,0,"position"),m.linkProgram(C);var j=m.getProgramInfoLog(C),k=m.getShaderInfoLog(L),I=m.getShaderInfoLog(O),D=!0,B=!0;m.getProgramParameter(C,m.LINK_STATUS)===!1?(D=!1,console.error("THREE.WebGLProgram: shader error: ",m.getError(),"gl.VALIDATE_STATUS",m.getProgramParameter(C,m.VALIDATE_STATUS),"gl.getProgramInfoLog",j,k,I)):""!==j?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",j):""!==k&&""!==I||(B=!1),B&&(this.diagnostics={runnable:D,material:d,programLog:j,vertexShader:{log:k,prefix:R},fragmentShader:{log:I,prefix:x}}),m.deleteShader(L),m.deleteShader(O);var U;this.getUniforms=function(){return void 0===U&&(U=new THREE.WebGLUniforms(m,C,t)),U};var N;return this.getAttributes=function(){return void 0===N&&(N=a(m,C)),N},this.destroy=function(){m.deleteProgram(C),this.program=void 0},Object.defineProperties(this,{uniforms:{get:function(){return console.warn("THREE.WebGLProgram: .uniforms is now .getUniforms()."),this.getUniforms()}},attributes:{get:function(){return console.warn("THREE.WebGLProgram: .attributes is now .getAttributes()."),this.getAttributes()}}}),this.id=h++,this.code=p,this.usedTimes=1,this.program=C,this.vertexShader=L,this.fragmentShader=O,this}}(),THREE.WebGLPrograms=function(t,e){function n(t){if(e.floatVertexTextures&&t&&t.skeleton&&t.skeleton.useVertexTexture)return 1024;var n=e.maxVertexUniforms,i=Math.floor((n-20)/4),r=i;return void 0!==t&&t instanceof THREE.SkinnedMesh&&(r=Math.min(t.skeleton.bones.length,r),r<t.skeleton.bones.length&&console.warn("WebGLRenderer: too many bones - "+t.skeleton.bones.length+", this GPU supports just "+r+" (try OpenGL instead of ANGLE)")),r}function i(t,e){var n;return t?t instanceof THREE.Texture?n=t.encoding:t instanceof THREE.WebGLRenderTarget&&(n=t.texture.encoding):n=THREE.LinearEncoding,n===THREE.LinearEncoding&&e&&(n=THREE.GammaEncoding),n}var r=[],o={MeshDepthMaterial:"depth",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points"},a=["precision","supportsVertexTextures","map","mapEncoding","envMap","envMapMode","envMapEncoding","lightMap","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","displacementMap","specularMap","roughnessMap","metalnessMap","alphaMap","combine","vertexColors","fog","useFog","fogExp","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","depthPacking"];this.getParameters=function(r,a,s,c,l){var u=o[r.type],h=n(l),p=t.getPrecision();null!==r.precision&&(p=e.getMaxPrecision(r.precision),p!==r.precision&&console.warn("THREE.WebGLProgram.getParameters:",r.precision,"not supported, using",p,"instead."));var d={shaderID:u,precision:p,supportsVertexTextures:e.vertexTextures,outputEncoding:i(t.getCurrentRenderTarget(),t.gammaOutput),map:!!r.map,mapEncoding:i(r.map,t.gammaInput),envMap:!!r.envMap,envMapMode:r.envMap&&r.envMap.mapping,envMapEncoding:i(r.envMap,t.gammaInput),envMapCubeUV:!!r.envMap&&(r.envMap.mapping===THREE.CubeUVReflectionMapping||r.envMap.mapping===THREE.CubeUVRefractionMapping),lightMap:!!r.lightMap,aoMap:!!r.aoMap,emissiveMap:!!r.emissiveMap,emissiveMapEncoding:i(r.emissiveMap,t.gammaInput),bumpMap:!!r.bumpMap,normalMap:!!r.normalMap,displacementMap:!!r.displacementMap,roughnessMap:!!r.roughnessMap,metalnessMap:!!r.metalnessMap,specularMap:!!r.specularMap,alphaMap:!!r.alphaMap,combine:r.combine,vertexColors:r.vertexColors,fog:s,useFog:r.fog,fogExp:s instanceof THREE.FogExp2,flatShading:r.shading===THREE.FlatShading,sizeAttenuation:r.sizeAttenuation,logarithmicDepthBuffer:e.logarithmicDepthBuffer,skinning:r.skinning,maxBones:h,useVertexTexture:e.floatVertexTextures&&l&&l.skeleton&&l.skeleton.useVertexTexture,morphTargets:r.morphTargets,morphNormals:r.morphNormals,maxMorphTargets:t.maxMorphTargets,maxMorphNormals:t.maxMorphNormals,numDirLights:a.directional.length,numPointLights:a.point.length,numSpotLights:a.spot.length,numHemiLights:a.hemi.length,numClippingPlanes:c,shadowMapEnabled:t.shadowMap.enabled&&l.receiveShadow&&a.shadows.length>0,shadowMapType:t.shadowMap.type,toneMapping:t.toneMapping,physicallyCorrectLights:t.physicallyCorrectLights,premultipliedAlpha:r.premultipliedAlpha,alphaTest:r.alphaTest,doubleSided:r.side===THREE.DoubleSide,flipSided:r.side===THREE.BackSide,depthPacking:void 0!==r.depthPacking&&r.depthPacking};return d},this.getProgramCode=function(t,e){var n=[];if(e.shaderID?n.push(e.shaderID):(n.push(t.fragmentShader),n.push(t.vertexShader)),void 0!==t.defines)for(var i in t.defines)n.push(i),n.push(t.defines[i]);for(var r=0;r<a.length;r++)n.push(e[a[r]]);return n.join()},this.acquireProgram=function(e,n,i){for(var o,a=0,s=r.length;a<s;a++){var c=r[a];if(c.code===i){o=c,++o.usedTimes;break}}return void 0===o&&(o=new THREE.WebGLProgram(t,i,e,n),r.push(o)),o},this.releaseProgram=function(t){if(0===--t.usedTimes){var e=r.indexOf(t);r[e]=r[r.length-1],r.pop(),t.destroy()}},this.programs=r},THREE.WebGLProperties=function(){var t={};this.get=function(e){var n=e.uuid,i=t[n];return void 0===i&&(i={},t[n]=i),i},this.delete=function(e){delete t[e.uuid]},this.clear=function(){t={}}},THREE.WebGLShader=function(){function t(t){for(var e=t.split("\n"),n=0;n<e.length;n++)e[n]=n+1+": "+e[n];return e.join("\n")}return function(e,n,i){var r=e.createShader(n);return e.shaderSource(r,i),e.compileShader(r),e.getShaderParameter(r,e.COMPILE_STATUS)===!1&&console.error("THREE.WebGLShader: Shader couldn't compile."),""!==e.getShaderInfoLog(r)&&console.warn("THREE.WebGLShader: gl.getShaderInfoLog()",n===e.VERTEX_SHADER?"vertex":"fragment",e.getShaderInfoLog(r),t(i)),r}}(),THREE.WebGLShadowMap=function(t,e,n){function i(e,n,i,r){var o=e.geometry,a=null,s=g,c=e.customDepthMaterial;if(i&&(s=y,c=e.customDistanceMaterial),c)a=c;else{var l=void 0!==o.morphTargets&&o.morphTargets.length>0&&n.morphTargets,u=e instanceof THREE.SkinnedMesh&&n.skinning,h=0;l&&(h|=f),u&&(h|=m),a=s[h]}if(t.localClippingEnabled&&n.clipShadows===!0&&0!==n.clippingPlanes.length){var p=a.uuid,d=n.uuid,v=E[p];void 0===v&&(v={},E[p]=v);var _=v[d];void 0===_&&(_=a.clone(),v[d]=_),a=_}return a.visible=n.visible,a.wireframe=n.wireframe,a.side=n.side,a.clipShadows=n.clipShadows,a.clippingPlanes=n.clippingPlanes,a.wireframeLinewidth=n.wireframeLinewidth,a.linewidth=n.linewidth,i&&void 0!==a.uniforms.lightPos&&a.uniforms.lightPos.value.copy(r),a}function r(t,e,n){if(t.visible!==!1){if(t.layers.test(e.layers)&&(t instanceof THREE.Mesh||t instanceof THREE.Line||t instanceof THREE.Points)&&t.castShadow&&(t.frustumCulled===!1||s.intersectsObject(t)===!0)){var i=t.material;i.visible===!0&&(t.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,t.matrixWorld),d.push(t))}for(var o=t.children,a=0,c=o.length;a<c;a++)r(o[a],e,n)}}var o=t.context,a=t.state,s=new THREE.Frustum,c=new THREE.Matrix4,l=e.shadows,u=new THREE.Vector2,h=new THREE.Vector3,p=new THREE.Vector3,d=[],f=1,m=2,v=(f|m)+1,g=new Array(v),y=new Array(v),E={},_=[new THREE.Vector3(1,0,0),new THREE.Vector3((-1),0,0),new THREE.Vector3(0,0,1),new THREE.Vector3(0,0,(-1)),new THREE.Vector3(0,1,0),new THREE.Vector3(0,(-1),0)],T=[new THREE.Vector3(0,1,0),new THREE.Vector3(0,1,0),new THREE.Vector3(0,1,0),new THREE.Vector3(0,1,0),new THREE.Vector3(0,0,1),new THREE.Vector3(0,0,(-1))],b=[new THREE.Vector4,new THREE.Vector4,new THREE.Vector4,new THREE.Vector4,new THREE.Vector4,new THREE.Vector4],w=new THREE.MeshDepthMaterial;w.depthPacking=THREE.RGBADepthPacking,w.clipping=!0;for(var R=THREE.ShaderLib.distanceRGBA,x=THREE.UniformsUtils.clone(R.uniforms),H=0;H!==v;++H){var M=0!==(H&f),S=0!==(H&m),C=w.clone();C.morphTargets=M,C.skinning=S,g[H]=C;var A=new THREE.ShaderMaterial({defines:{USE_SHADOWMAP:""},uniforms:x,vertexShader:R.vertexShader,fragmentShader:R.fragmentShader,morphTargets:M,skinning:S,clipping:!0});y[H]=A}var P=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,
this.type=THREE.PCFShadowMap,this.cullFace=THREE.CullFaceFront,this.render=function(e,f){if(P.enabled!==!1&&(P.autoUpdate!==!1||P.needsUpdate!==!1)&&0!==l.length){a.clearColor(1,1,1,1),a.disable(o.BLEND),a.enable(o.CULL_FACE),o.frontFace(o.CCW),o.cullFace(P.cullFace===THREE.CullFaceFront?o.FRONT:o.BACK),a.setDepthTest(!0),a.setScissorTest(!1);for(var m,v,g=0,y=l.length;g<y;g++){var E=l[g],w=E.shadow,R=w.camera;if(u.copy(w.mapSize),E instanceof THREE.PointLight){m=6,v=!0;var x=u.x,H=u.y;b[0].set(2*x,H,x,H),b[1].set(0,H,x,H),b[2].set(3*x,H,x,H),b[3].set(x,H,x,H),b[4].set(3*x,0,x,H),b[5].set(x,0,x,H),u.x*=4,u.y*=2}else m=1,v=!1;if(null===w.map){var M={minFilter:THREE.NearestFilter,magFilter:THREE.NearestFilter,format:THREE.RGBAFormat};w.map=new THREE.WebGLRenderTarget(u.x,u.y,M),R.updateProjectionMatrix()}w instanceof THREE.SpotLightShadow&&w.update(E);var S=w.map,C=w.matrix;p.setFromMatrixPosition(E.matrixWorld),R.position.copy(p),t.setRenderTarget(S),t.clear();for(var A=0;A<m;A++){if(v){h.copy(R.position),h.add(_[A]),R.up.copy(T[A]),R.lookAt(h);var L=b[A];a.viewport(L)}else h.setFromMatrixPosition(E.target.matrixWorld),R.lookAt(h);R.updateMatrixWorld(),R.matrixWorldInverse.getInverse(R.matrixWorld),C.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),C.multiply(R.projectionMatrix),C.multiply(R.matrixWorldInverse),c.multiplyMatrices(R.projectionMatrix,R.matrixWorldInverse),s.setFromMatrix(c),d.length=0,r(e,f,R);for(var O=0,j=d.length;O<j;O++){var k=d[O],I=n.update(k),D=k.material;if(D instanceof THREE.MultiMaterial)for(var B=I.groups,U=D.materials,N=0,F=B.length;N<F;N++){var V=B[N],G=U[V.materialIndex];if(G.visible===!0){var z=i(k,G,v,p);t.renderBufferDirect(R,null,I,z,k,V)}}else{var z=i(k,D,v,p);t.renderBufferDirect(R,null,I,z,k,null)}}}}var W=t.getClearColor(),X=t.getClearAlpha();t.setClearColor(W,X),a.enable(o.BLEND),P.cullFace===THREE.CullFaceFront&&o.cullFace(o.BACK),P.needsUpdate=!1}}},THREE.WebGLState=function(t,e,n){var i=this,r=new THREE.Vector4,o=t.getParameter(t.MAX_VERTEX_ATTRIBS),a=new Uint8Array(o),s=new Uint8Array(o),c=new Uint8Array(o),l={},u=null,h=null,p=null,d=null,f=null,m=null,v=null,g=null,y=!1,E=null,_=null,T=null,b=null,w=null,R=null,x=null,H=null,M=null,S=null,C=null,A=null,P=null,L=null,O=null,j=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),k=void 0,I={},D=new THREE.Vector4,B=null,U=null,N=new THREE.Vector4,F=new THREE.Vector4;this.init=function(){this.clearColor(0,0,0,1),this.clearDepth(1),this.clearStencil(0),this.enable(t.DEPTH_TEST),t.depthFunc(t.LEQUAL),t.frontFace(t.CCW),t.cullFace(t.BACK),this.enable(t.CULL_FACE),this.enable(t.BLEND),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA)},this.initAttributes=function(){for(var t=0,e=a.length;t<e;t++)a[t]=0},this.enableAttribute=function(n){if(a[n]=1,0===s[n]&&(t.enableVertexAttribArray(n),s[n]=1),0!==c[n]){var i=e.get("ANGLE_instanced_arrays");i.vertexAttribDivisorANGLE(n,0),c[n]=0}},this.enableAttributeAndDivisor=function(e,n,i){a[e]=1,0===s[e]&&(t.enableVertexAttribArray(e),s[e]=1),c[e]!==n&&(i.vertexAttribDivisorANGLE(e,n),c[e]=n)},this.disableUnusedAttributes=function(){for(var e=0,n=s.length;e<n;e++)s[e]!==a[e]&&(t.disableVertexAttribArray(e),s[e]=0)},this.enable=function(e){l[e]!==!0&&(t.enable(e),l[e]=!0)},this.disable=function(e){l[e]!==!1&&(t.disable(e),l[e]=!1)},this.getCompressedTextureFormats=function(){if(null===u&&(u=[],e.get("WEBGL_compressed_texture_pvrtc")||e.get("WEBGL_compressed_texture_s3tc")||e.get("WEBGL_compressed_texture_etc1")))for(var n=t.getParameter(t.COMPRESSED_TEXTURE_FORMATS),i=0;i<n.length;i++)u.push(n[i]);return u},this.setBlending=function(e,i,r,o,a,s,c,l){e===THREE.NoBlending?this.disable(t.BLEND):this.enable(t.BLEND),e===h&&l===y||(e===THREE.AdditiveBlending?l?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ONE,t.ONE,t.ONE,t.ONE)):(t.blendEquation(t.FUNC_ADD),t.blendFunc(t.SRC_ALPHA,t.ONE)):e===THREE.SubtractiveBlending?l?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ZERO,t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ONE_MINUS_SRC_ALPHA)):(t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ZERO,t.ONE_MINUS_SRC_COLOR)):e===THREE.MultiplyBlending?l?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ZERO,t.ZERO,t.SRC_COLOR,t.SRC_ALPHA)):(t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ZERO,t.SRC_COLOR)):l?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ONE,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA)):(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA)),h=e,y=l),e===THREE.CustomBlending?(a=a||i,s=s||r,c=c||o,i===p&&a===m||(t.blendEquationSeparate(n(i),n(a)),p=i,m=a),r===d&&o===f&&s===v&&c===g||(t.blendFuncSeparate(n(r),n(o),n(s),n(c)),d=r,f=o,v=s,g=c)):(p=null,d=null,f=null,m=null,v=null,g=null)},this.setDepthFunc=function(e){if(E!==e){if(e)switch(e){case THREE.NeverDepth:t.depthFunc(t.NEVER);break;case THREE.AlwaysDepth:t.depthFunc(t.ALWAYS);break;case THREE.LessDepth:t.depthFunc(t.LESS);break;case THREE.LessEqualDepth:t.depthFunc(t.LEQUAL);break;case THREE.EqualDepth:t.depthFunc(t.EQUAL);break;case THREE.GreaterEqualDepth:t.depthFunc(t.GEQUAL);break;case THREE.GreaterDepth:t.depthFunc(t.GREATER);break;case THREE.NotEqualDepth:t.depthFunc(t.NOTEQUAL);break;default:t.depthFunc(t.LEQUAL)}else t.depthFunc(t.LEQUAL);E=e}},this.setDepthTest=function(e){e?this.enable(t.DEPTH_TEST):this.disable(t.DEPTH_TEST)},this.setDepthWrite=function(e){_!==e&&(t.depthMask(e),_=e)},this.setColorWrite=function(e){T!==e&&(t.colorMask(e,e,e,e),T=e)},this.setStencilFunc=function(e,n,i){w===e&&R===n&&x===i||(t.stencilFunc(e,n,i),w=e,R=n,x=i)},this.setStencilOp=function(e,n,i){H===e&&M===n&&S===i||(t.stencilOp(e,n,i),H=e,M=n,S=i)},this.setStencilTest=function(e){e?this.enable(t.STENCIL_TEST):this.disable(t.STENCIL_TEST)},this.setStencilWrite=function(e){b!==e&&(t.stencilMask(e),b=e)},this.setFlipSided=function(e){C!==e&&(e?t.frontFace(t.CW):t.frontFace(t.CCW),C=e)},this.setLineWidth=function(e){e!==A&&(t.lineWidth(e),A=e)},this.setPolygonOffset=function(e,n,i){e?this.enable(t.POLYGON_OFFSET_FILL):this.disable(t.POLYGON_OFFSET_FILL),!e||P===n&&L===i||(t.polygonOffset(n,i),P=n,L=i)},this.getScissorTest=function(){return O},this.setScissorTest=function(e){O=e,e?this.enable(t.SCISSOR_TEST):this.disable(t.SCISSOR_TEST)},this.activeTexture=function(e){void 0===e&&(e=t.TEXTURE0+j-1),k!==e&&(t.activeTexture(e),k=e)},this.bindTexture=function(e,n){void 0===k&&i.activeTexture();var r=I[k];void 0===r&&(r={type:void 0,texture:void 0},I[k]=r),r.type===e&&r.texture===n||(t.bindTexture(e,n),r.type=e,r.texture=n)},this.compressedTexImage2D=function(){try{t.compressedTexImage2D.apply(t,arguments)}catch(t){console.error(t)}},this.texImage2D=function(){try{t.texImage2D.apply(t,arguments)}catch(t){console.error(t)}},this.clearColor=function(e,n,i,o){r.set(e,n,i,o),D.equals(r)===!1&&(t.clearColor(e,n,i,o),D.copy(r))},this.clearDepth=function(e){B!==e&&(t.clearDepth(e),B=e)},this.clearStencil=function(e){U!==e&&(t.clearStencil(e),U=e)},this.scissor=function(e){N.equals(e)===!1&&(t.scissor(e.x,e.y,e.z,e.w),N.copy(e))},this.viewport=function(e){F.equals(e)===!1&&(t.viewport(e.x,e.y,e.z,e.w),F.copy(e))},this.reset=function(){for(var e=0;e<s.length;e++)1===s[e]&&(t.disableVertexAttribArray(e),s[e]=0);l={},u=null,k=void 0,I={},h=null,T=null,_=null,b=null,C=null}},THREE.WebGLUniforms=function(){var t=function(){this.seq=[],this.map={}},e=[],n=[],i=function(t,n,i){var r=t[0];if(r<=0||r>0)return t;var o=n*i,a=e[o];if(void 0===a&&(a=new Float32Array(o),e[o]=a),0!==n){r.toArray(a,0);for(var s=1,c=0;s!==n;++s)c+=i,t[s].toArray(a,c)}return a},r=function(t,e){var i=n[e];void 0===i&&(i=new Int32Array(e),n[e]=i);for(var r=0;r!==e;++r)i[r]=t.allocTextureUnit();return i},o=function(t,e){t.uniform1f(this.addr,e)},a=function(t,e){t.uniform1i(this.addr,e)},s=function(t,e){void 0===e.x?t.uniform2fv(this.addr,e):t.uniform2f(this.addr,e.x,e.y)},c=function(t,e){void 0!==e.x?t.uniform3f(this.addr,e.x,e.y,e.z):void 0!==e.r?t.uniform3f(this.addr,e.r,e.g,e.b):t.uniform3fv(this.addr,e)},l=function(t,e){void 0===e.x?t.uniform4fv(this.addr,e):t.uniform4f(this.addr,e.x,e.y,e.z,e.w)},u=function(t,e){t.uniformMatrix2fv(this.addr,!1,e.elements||e)},h=function(t,e){t.uniformMatrix3fv(this.addr,!1,e.elements||e)},p=function(t,e){t.uniformMatrix4fv(this.addr,!1,e.elements||e)},d=function(t,e,n){var i=n.allocTextureUnit();t.uniform1i(this.addr,i),e&&n.setTexture2D(e,i)},f=function(t,e,n){var i=n.allocTextureUnit();t.uniform1i(this.addr,i),e&&n.setTextureCube(e,i)},m=function(t,e){t.uniform2iv(this.addr,e)},v=function(t,e){t.uniform3iv(this.addr,e)},g=function(t,e){t.uniform4iv(this.addr,e)},y=function(t){switch(t){case 5126:return o;case 35664:return s;case 35665:return c;case 35666:return l;case 35674:return u;case 35675:return h;case 35676:return p;case 35678:return d;case 35680:return f;case 5124:case 35670:return a;case 35667:case 35671:return m;case 35668:case 35672:return v;case 35669:case 35673:return g}},E=function(t,e){t.uniform1fv(this.addr,e)},_=function(t,e){t.uniform1iv(this.addr,e)},T=function(t,e){t.uniform2fv(this.addr,i(e,this.size,2))},b=function(t,e){t.uniform3fv(this.addr,i(e,this.size,3))},w=function(t,e){t.uniform4fv(this.addr,i(e,this.size,4))},R=function(t,e){t.uniformMatrix2fv(this.addr,!1,i(e,this.size,4))},x=function(t,e){t.uniformMatrix3fv(this.addr,!1,i(e,this.size,9))},H=function(t,e){t.uniformMatrix4fv(this.addr,!1,i(e,this.size,16))},M=function(t,e,n){var i=e.length,o=r(n,i);t.uniform1iv(this.addr,o);for(var a=0;a!==i;++a){var s=e[a];s&&n.setTexture2D(s,o[a])}},S=function(t,e,n){var i=e.length,o=r(n,i);t.uniform1iv(this.addr,o);for(var a=0;a!==i;++a){var s=e[a];s&&n.setTextureCube(s,o[a])}},C=function(t){switch(t){case 5126:return E;case 35664:return T;case 35665:return b;case 35666:return w;case 35674:return R;case 35675:return x;case 35676:return H;case 35678:return M;case 35680:return S;case 5124:case 35670:return _;case 35667:case 35671:return m;case 35668:case 35672:return v;case 35669:case 35673:return g}},A=function(t,e,n){this.id=t,this.addr=n,this.setValue=y(e.type)},P=function(t,e,n){this.id=t,this.addr=n,this.size=e.size,this.setValue=C(e.type)},L=function(e){this.id=e,t.call(this)};L.prototype.setValue=function(t,e){for(var n=this.seq,i=0,r=n.length;i!==r;++i){var o=n[i];o.setValue(t,e[o.id])}};var O=/([\w\d_]+)(\])?(\[|\.)?/g,j=function(t,e){t.seq.push(e),t.map[e.id]=e},k=function(t,e,n){var i=t.name,r=i.length;for(O.lastIndex=0;;){var o=O.exec(i),a=O.lastIndex,s=o[1],c="]"===o[2],l=o[3];if(c&&(s=0|s),void 0===l||"["===l&&a+2===r){j(n,void 0===l?new A(s,t,e):new P(s,t,e));break}var u=n.map,h=u[s];void 0===h&&(h=new L(s),j(n,h)),n=h}},I=function(e,n,i){t.call(this),this.renderer=i;for(var r=e.getProgramParameter(n,e.ACTIVE_UNIFORMS),o=0;o!==r;++o){var a=e.getActiveUniform(n,o),s=a.name,c=e.getUniformLocation(n,s);k(a,c,this)}};return I.prototype.setValue=function(t,e,n){var i=this.map[e];void 0!==i&&i.setValue(t,n,this.renderer)},I.prototype.set=function(t,e,n){var i=this.map[n];void 0!==i&&i.setValue(t,e[n],this.renderer)},I.prototype.setOptional=function(t,e,n){var i=e[n];void 0!==i&&this.setValue(t,n,i)},I.upload=function(t,e,n,i){for(var r=0,o=e.length;r!==o;++r){var a=e[r],s=n[a.id];s.needsUpdate!==!1&&a.setValue(t,s.value,i)}},I.seqWithValue=function(t,e){for(var n=[],i=0,r=t.length;i!==r;++i){var o=t[i];o.id in e&&n.push(o)}return n},I.splitDynamic=function(t,e){for(var n=null,i=t.length,r=0,o=0;o!==i;++o){var a=t[o],s=e[a.id];s&&s.dynamic===!0?(null===n&&(n=[]),n.push(a)):(r<o&&(t[r]=a),++r)}return r<i&&(t.length=r),n},I.evalDynamic=function(t,e,n,i){for(var r=0,o=t.length;r!==o;++r){var a=e[t[r].id],s=a.onUpdateCallback;void 0!==s&&s.call(a,n,i)}},I}(),THREE.LensFlarePlugin=function(t,e){function n(){var t=new Float32Array([-1,-1,0,0,1,-1,1,0,1,1,1,1,-1,1,0,1]),e=new Uint16Array([0,1,2,0,2,3]);r=p.createBuffer(),o=p.createBuffer(),p.bindBuffer(p.ARRAY_BUFFER,r),p.bufferData(p.ARRAY_BUFFER,t,p.STATIC_DRAW),p.bindBuffer(p.ELEMENT_ARRAY_BUFFER,o),p.bufferData(p.ELEMENT_ARRAY_BUFFER,e,p.STATIC_DRAW),u=p.createTexture(),h=p.createTexture(),d.bindTexture(p.TEXTURE_2D,u),p.texImage2D(p.TEXTURE_2D,0,p.RGB,16,16,0,p.RGB,p.UNSIGNED_BYTE,null),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,p.CLAMP_TO_EDGE),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,p.CLAMP_TO_EDGE),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,p.NEAREST),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,p.NEAREST),d.bindTexture(p.TEXTURE_2D,h),p.texImage2D(p.TEXTURE_2D,0,p.RGBA,16,16,0,p.RGBA,p.UNSIGNED_BYTE,null),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,p.CLAMP_TO_EDGE),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,p.CLAMP_TO_EDGE),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,p.NEAREST),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,p.NEAREST),a={vertexShader:["uniform lowp int renderType;","uniform vec3 screenPosition;","uniform vec2 scale;","uniform float rotation;","uniform sampler2D occlusionMap;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","varying float vVisibility;","void main() {","vUV = uv;","vec2 pos = position;","if ( renderType == 2 ) {","vec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );","vVisibility =        visibility.r / 9.0;","vVisibility *= 1.0 - visibility.g / 9.0;","vVisibility *=       visibility.b / 9.0;","vVisibility *= 1.0 - visibility.a / 9.0;","pos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;","pos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;","}","gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["uniform lowp int renderType;","uniform sampler2D map;","uniform float opacity;","uniform vec3 color;","varying vec2 vUV;","varying float vVisibility;","void main() {","if ( renderType == 0 ) {","gl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );","} else if ( renderType == 1 ) {","gl_FragColor = texture2D( map, vUV );","} else {","vec4 texture = texture2D( map, vUV );","texture.a *= opacity * vVisibility;","gl_FragColor = texture;","gl_FragColor.rgb *= color;","}","}"].join("\n")},s=i(a),c={vertex:p.getAttribLocation(s,"position"),uv:p.getAttribLocation(s,"uv")},l={renderType:p.getUniformLocation(s,"renderType"),map:p.getUniformLocation(s,"map"),occlusionMap:p.getUniformLocation(s,"occlusionMap"),opacity:p.getUniformLocation(s,"opacity"),color:p.getUniformLocation(s,"color"),scale:p.getUniformLocation(s,"scale"),rotation:p.getUniformLocation(s,"rotation"),screenPosition:p.getUniformLocation(s,"screenPosition")}}function i(e){var n=p.createProgram(),i=p.createShader(p.FRAGMENT_SHADER),r=p.createShader(p.VERTEX_SHADER),o="precision "+t.getPrecision()+" float;\n";return p.shaderSource(i,o+e.fragmentShader),p.shaderSource(r,o+e.vertexShader),p.compileShader(i),p.compileShader(r),p.attachShader(n,i),p.attachShader(n,r),p.linkProgram(n),n}var r,o,a,s,c,l,u,h,p=t.context,d=t.state;this.render=function(i,a,f){if(0!==e.length){var m=new THREE.Vector3,v=f.w/f.z,g=.5*f.z,y=.5*f.w,E=16/f.w,_=new THREE.Vector2(E*v,E),T=new THREE.Vector3(1,1,0),b=new THREE.Vector2(1,1),w=new THREE.Box2;w.min.set(0,0),w.max.set(f.z-16,f.w-16),void 0===s&&n(),p.useProgram(s),d.initAttributes(),d.enableAttribute(c.vertex),d.enableAttribute(c.uv),d.disableUnusedAttributes(),p.uniform1i(l.occlusionMap,0),p.uniform1i(l.map,1),p.bindBuffer(p.ARRAY_BUFFER,r),p.vertexAttribPointer(c.vertex,2,p.FLOAT,!1,16,0),p.vertexAttribPointer(c.uv,2,p.FLOAT,!1,16,8),p.bindBuffer(p.ELEMENT_ARRAY_BUFFER,o),d.disable(p.CULL_FACE),d.setDepthWrite(!1);for(var R=0,x=e.length;R<x;R++){E=16/f.w,_.set(E*v,E);var H=e[R];if(m.set(H.matrixWorld.elements[12],H.matrixWorld.elements[13],H.matrixWorld.elements[14]),m.applyMatrix4(a.matrixWorldInverse),m.applyProjection(a.projectionMatrix),T.copy(m),b.x=f.x+T.x*g+g-8,b.y=f.y+T.y*y+y-8,w.containsPoint(b)===!0){d.activeTexture(p.TEXTURE0),d.bindTexture(p.TEXTURE_2D,null),d.activeTexture(p.TEXTURE1),d.bindTexture(p.TEXTURE_2D,u),p.copyTexImage2D(p.TEXTURE_2D,0,p.RGB,b.x,b.y,16,16,0),p.uniform1i(l.renderType,0),p.uniform2f(l.scale,_.x,_.y),p.uniform3f(l.screenPosition,T.x,T.y,T.z),d.disable(p.BLEND),d.enable(p.DEPTH_TEST),p.drawElements(p.TRIANGLES,6,p.UNSIGNED_SHORT,0),d.activeTexture(p.TEXTURE0),d.bindTexture(p.TEXTURE_2D,h),p.copyTexImage2D(p.TEXTURE_2D,0,p.RGBA,b.x,b.y,16,16,0),p.uniform1i(l.renderType,1),d.disable(p.DEPTH_TEST),d.activeTexture(p.TEXTURE1),d.bindTexture(p.TEXTURE_2D,u),p.drawElements(p.TRIANGLES,6,p.UNSIGNED_SHORT,0),H.positionScreen.copy(T),H.customUpdateCallback?H.customUpdateCallback(H):H.updateLensFlares(),p.uniform1i(l.renderType,2),d.enable(p.BLEND);for(var M=0,S=H.lensFlares.length;M<S;M++){var C=H.lensFlares[M];C.opacity>.001&&C.scale>.001&&(T.x=C.x,T.y=C.y,T.z=C.z,E=C.size*C.scale/f.w,_.x=E*v,_.y=E,p.uniform3f(l.screenPosition,T.x,T.y,T.z),p.uniform2f(l.scale,_.x,_.y),p.uniform1f(l.rotation,C.rotation),p.uniform1f(l.opacity,C.opacity),p.uniform3f(l.color,C.color.r,C.color.g,C.color.b),d.setBlending(C.blending,C.blendEquation,C.blendSrc,C.blendDst),t.setTexture2D(C.texture,1),p.drawElements(p.TRIANGLES,6,p.UNSIGNED_SHORT,0))}}}d.enable(p.CULL_FACE),d.enable(p.DEPTH_TEST),d.setDepthWrite(!0),t.resetGLState()}}},THREE.SpritePlugin=function(t,e){function n(){var t=new Float32Array([-.5,-.5,0,0,.5,-.5,1,0,.5,.5,1,1,-.5,.5,0,1]),e=new Uint16Array([0,1,2,0,2,3]);o=h.createBuffer(),a=h.createBuffer(),h.bindBuffer(h.ARRAY_BUFFER,o),h.bufferData(h.ARRAY_BUFFER,t,h.STATIC_DRAW),h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,a),h.bufferData(h.ELEMENT_ARRAY_BUFFER,e,h.STATIC_DRAW),s=i(),c={position:h.getAttribLocation(s,"position"),uv:h.getAttribLocation(s,"uv")},l={uvOffset:h.getUniformLocation(s,"uvOffset"),uvScale:h.getUniformLocation(s,"uvScale"),rotation:h.getUniformLocation(s,"rotation"),scale:h.getUniformLocation(s,"scale"),color:h.getUniformLocation(s,"color"),map:h.getUniformLocation(s,"map"),opacity:h.getUniformLocation(s,"opacity"),modelViewMatrix:h.getUniformLocation(s,"modelViewMatrix"),projectionMatrix:h.getUniformLocation(s,"projectionMatrix"),fogType:h.getUniformLocation(s,"fogType"),fogDensity:h.getUniformLocation(s,"fogDensity"),fogNear:h.getUniformLocation(s,"fogNear"),fogFar:h.getUniformLocation(s,"fogFar"),fogColor:h.getUniformLocation(s,"fogColor"),alphaTest:h.getUniformLocation(s,"alphaTest")};var n=document.createElement("canvas");n.width=8,n.height=8;var r=n.getContext("2d");r.fillStyle="white",r.fillRect(0,0,8,8),u=new THREE.Texture(n),u.needsUpdate=!0}function i(){var e=h.createProgram(),n=h.createShader(h.VERTEX_SHADER),i=h.createShader(h.FRAGMENT_SHADER);return h.shaderSource(n,["precision "+t.getPrecision()+" float;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform float rotation;","uniform vec2 scale;","uniform vec2 uvOffset;","uniform vec2 uvScale;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","void main() {","vUV = uvOffset + uv * uvScale;","vec2 alignedPosition = position * scale;","vec2 rotatedPosition;","rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;","rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;","vec4 finalPosition;","finalPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );","finalPosition.xy += rotatedPosition;","finalPosition = projectionMatrix * finalPosition;","gl_Position = finalPosition;","}"].join("\n")),h.shaderSource(i,["precision "+t.getPrecision()+" float;","uniform vec3 color;","uniform sampler2D map;","uniform float opacity;","uniform int fogType;","uniform vec3 fogColor;","uniform float fogDensity;","uniform float fogNear;","uniform float fogFar;","uniform float alphaTest;","varying vec2 vUV;","void main() {","vec4 texture = texture2D( map, vUV );","if ( texture.a < alphaTest ) discard;","gl_FragColor = vec4( color * texture.xyz, texture.a * opacity );","if ( fogType > 0 ) {","float depth = gl_FragCoord.z / gl_FragCoord.w;","float fogFactor = 0.0;","if ( fogType == 1 ) {","fogFactor = smoothstep( fogNear, fogFar, depth );","} else {","const float LOG2 = 1.442695;","fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );","fogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );","}","gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );","}","}"].join("\n")),h.compileShader(n),h.compileShader(i),h.attachShader(e,n),h.attachShader(e,i),h.linkProgram(e),e}function r(t,e){return t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:e.id-t.id}var o,a,s,c,l,u,h=t.context,p=t.state,d=new THREE.Vector3,f=new THREE.Quaternion,m=new THREE.Vector3;this.render=function(i,v){if(0!==e.length){void 0===s&&n(),h.useProgram(s),p.initAttributes(),p.enableAttribute(c.position),p.enableAttribute(c.uv),p.disableUnusedAttributes(),p.disable(h.CULL_FACE),p.enable(h.BLEND),h.bindBuffer(h.ARRAY_BUFFER,o),h.vertexAttribPointer(c.position,2,h.FLOAT,!1,16,0),h.vertexAttribPointer(c.uv,2,h.FLOAT,!1,16,8),h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,a),h.uniformMatrix4fv(l.projectionMatrix,!1,v.projectionMatrix.elements),p.activeTexture(h.TEXTURE0),h.uniform1i(l.map,0);var g=0,y=0,E=i.fog;E?(h.uniform3f(l.fogColor,E.color.r,E.color.g,E.color.b),E instanceof THREE.Fog?(h.uniform1f(l.fogNear,E.near),h.uniform1f(l.fogFar,E.far),h.uniform1i(l.fogType,1),g=1,y=1):E instanceof THREE.FogExp2&&(h.uniform1f(l.fogDensity,E.density),h.uniform1i(l.fogType,2),g=2,y=2)):(h.uniform1i(l.fogType,0),g=0,y=0);for(var _=0,T=e.length;_<T;_++){var b=e[_];b.modelViewMatrix.multiplyMatrices(v.matrixWorldInverse,b.matrixWorld),b.z=-b.modelViewMatrix.elements[14]}e.sort(r);for(var w=[],_=0,T=e.length;_<T;_++){var b=e[_],R=b.material;h.uniform1f(l.alphaTest,R.alphaTest),h.uniformMatrix4fv(l.modelViewMatrix,!1,b.modelViewMatrix.elements),b.matrixWorld.decompose(d,f,m),w[0]=m.x,w[1]=m.y;var x=0;i.fog&&R.fog&&(x=y),g!==x&&(h.uniform1i(l.fogType,x),g=x),null!==R.map?(h.uniform2f(l.uvOffset,R.map.offset.x,R.map.offset.y),h.uniform2f(l.uvScale,R.map.repeat.x,R.map.repeat.y)):(h.uniform2f(l.uvOffset,0,0),h.uniform2f(l.uvScale,1,1)),h.uniform1f(l.opacity,R.opacity),h.uniform3f(l.color,R.color.r,R.color.g,R.color.b),h.uniform1f(l.rotation,R.rotation),h.uniform2fv(l.scale,w),p.setBlending(R.blending,R.blendEquation,R.blendSrc,R.blendDst),p.setDepthTest(R.depthTest),p.setDepthWrite(R.depthWrite),R.map?t.setTexture2D(R.map,0):t.setTexture2D(u,0),h.drawElements(h.TRIANGLES,6,h.UNSIGNED_SHORT,0)}p.enable(h.CULL_FACE),t.resetGLState()}}},Object.defineProperties(THREE.Box2.prototype,{empty:{value:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()}},isIntersectionBox:{value:function(t){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)}}}),Object.defineProperties(THREE.Box3.prototype,{empty:{value:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()}},isIntersectionBox:{value:function(t){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)}},isIntersectionSphere:{value:function(t){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)}}}),Object.defineProperties(THREE.Matrix3.prototype,{multiplyVector3:{value:function(t){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)}},multiplyVector3Array:{value:function(t){return console.warn("THREE.Matrix3: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead."),this.applyToVector3Array(t)}}}),Object.defineProperties(THREE.Matrix4.prototype,{extractPosition:{value:function(t){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(t)}},setRotationFromQuaternion:{value:function(t){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(t)}},multiplyVector3:{value:function(t){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) or vector.applyProjection( matrix ) instead."),t.applyProjection(this)}},multiplyVector4:{value:function(t){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)}},multiplyVector3Array:{value:function(t){return console.warn("THREE.Matrix4: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead."),this.applyToVector3Array(t)}},rotateAxis:{value:function(t){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),t.transformDirection(this)}},crossVector:{value:function(t){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)}},translate:{value:function(t){console.error("THREE.Matrix4: .translate() has been removed.")}},rotateX:{value:function(t){console.error("THREE.Matrix4: .rotateX() has been removed.")}},rotateY:{value:function(t){console.error("THREE.Matrix4: .rotateY() has been removed.")}},rotateZ:{value:function(t){console.error("THREE.Matrix4: .rotateZ() has been removed.")}},rotateByAxis:{value:function(t,e){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")}}}),Object.defineProperties(THREE.Plane.prototype,{isIntersectionLine:{value:function(t){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(t)}}}),Object.defineProperties(THREE.Quaternion.prototype,{multiplyVector3:{value:function(t){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),t.applyQuaternion(this)}}}),Object.defineProperties(THREE.Ray.prototype,{isIntersectionBox:{value:function(t){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)}},isIntersectionPlane:{value:function(t){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(t)}},isIntersectionSphere:{value:function(t){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)}}}),Object.defineProperties(THREE.Vector3.prototype,{setEulerFromRotationMatrix:{value:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")}},setEulerFromQuaternion:{value:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")}},getPositionFromMatrix:{value:function(t){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(t)}},getScaleFromMatrix:{value:function(t){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(t)}},getColumnFromMatrix:{value:function(t,e){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(t,e)}}}),THREE.Face4=function(t,e,n,i,r,o,a){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new THREE.Face3(t,e,n,r,o,a)},THREE.Vertex=function(t,e,n){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new THREE.Vector3(t,e,n)},Object.defineProperties(THREE.Object3D.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(t){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=t}},getChildByName:{value:function(t){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(t)}},renderDepth:{set:function(t){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")}},translate:{value:function(t,e){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(e,t)}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(t){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.defineProperties(THREE,{PointCloud:{value:function(t,e){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new THREE.Points(t,e)}},ParticleSystem:{value:function(t,e){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new THREE.Points(t,e)}}}),Object.defineProperties(THREE.Light.prototype,{onlyShadow:{set:function(t){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(t){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=t}},shadowCameraLeft:{set:function(t){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=t}},shadowCameraRight:{set:function(t){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=t}},shadowCameraTop:{set:function(t){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=t}},shadowCameraBottom:{set:function(t){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=t}},shadowCameraNear:{set:function(t){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=t}},shadowCameraFar:{set:function(t){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=t}},shadowCameraVisible:{set:function(t){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(t){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=t}},shadowDarkness:{set:function(t){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(t){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=t}},shadowMapHeight:{set:function(t){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=t}}}),Object.defineProperties(THREE.BufferAttribute.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Please use .count."),this.array.length}}}),Object.defineProperties(THREE.BufferGeometry.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}},addIndex:{value:function(t){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(t)}},addDrawCall:{value:function(t,e,n){
void 0!==n&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(t,e)}},clearDrawCalls:{value:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()}},computeTangents:{value:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")}},computeOffsets:{value:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")}}}),Object.defineProperties(THREE.Material.prototype,{wrapAround:{get:function(){console.warn("THREE."+this.type+": .wrapAround has been removed.")},set:function(t){console.warn("THREE."+this.type+": .wrapAround has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE."+this.type+": .wrapRGB has been removed."),new THREE.Color}}}),Object.defineProperties(THREE,{PointCloudMaterial:{value:function(t){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new THREE.PointsMaterial(t)}},ParticleBasicMaterial:{value:function(t){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new THREE.PointsMaterial(t)}},ParticleSystemMaterial:{value:function(t){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new THREE.PointsMaterial(t)}}}),Object.defineProperties(THREE.MeshPhongMaterial.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(t){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(THREE.ShaderMaterial.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(t){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=t}}}),Object.defineProperties(THREE.WebGLRenderer.prototype,{supportsFloatTextures:{value:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")}},supportsHalfFloatTextures:{value:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")}},supportsStandardDerivatives:{value:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")}},supportsCompressedTextureS3TC:{value:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")}},supportsCompressedTexturePVRTC:{value:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")}},supportsBlendMinMax:{value:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")}},supportsVertexTextures:{value:function(){return this.capabilities.vertexTextures}},supportsInstancedArrays:{value:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")}},enableScissorTest:{value:function(t){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(t)}},initMaterial:{value:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")}},addPrePlugin:{value:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")}},addPostPlugin:{value:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")}},updateShadowMap:{value:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")}},shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=t}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=t}},shadowMapCullFace:{get:function(){return this.shadowMap.cullFace},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapCullFace is now .shadowMap.cullFace."),this.shadowMap.cullFace=t}}}),Object.defineProperties(THREE.WebGLRenderTarget.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=t}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=t}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=t}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=t}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(t){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=t}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(t){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=t}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(t){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=t}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(t){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=t}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(t){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=t}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(t){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=t}}}),Object.defineProperties(THREE.Audio.prototype,{load:{value:function(t){console.warn("THREE.Audio: .load has been deprecated. Please use THREE.AudioLoader.");var e=this,n=new THREE.AudioLoader;return n.load(t,function(t){e.setBuffer(t)}),this}}}),THREE.GeometryUtils={merge:function(t,e,n){console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead.");var i;e instanceof THREE.Mesh&&(e.matrixAutoUpdate&&e.updateMatrix(),i=e.matrix,e=e.geometry),t.merge(e,i,n)},center:function(t){return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),t.center()}},THREE.ImageUtils={crossOrigin:"anonymous",loadTexture:function(t,e,n,i){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var r=new THREE.TextureLoader;r.setCrossOrigin(this.crossOrigin);var o=r.load(t,n,void 0,i);return e&&(o.mapping=e),o},loadTextureCube:function(t,e,n,i){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var r=new THREE.CubeTextureLoader;r.setCrossOrigin(this.crossOrigin);var o=r.load(t,n,void 0,i);return e&&(o.mapping=e),o},loadCompressedTexture:function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},loadCompressedTextureCube:function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")}},THREE.Projector=function(){console.error("THREE.Projector has been moved to /examples/js/renderers/Projector.js."),this.projectVector=function(t,e){console.warn("THREE.Projector: .projectVector() is now vector.project()."),t.project(e)},this.unprojectVector=function(t,e){console.warn("THREE.Projector: .unprojectVector() is now vector.unproject()."),t.unproject(e)},this.pickingRay=function(t,e){console.error("THREE.Projector: .pickingRay() is now raycaster.setFromCamera().")}},THREE.CanvasRenderer=function(){console.error("THREE.CanvasRenderer has been moved to /examples/js/renderers/CanvasRenderer.js"),this.domElement=document.createElement("canvas"),this.clear=function(){},this.render=function(){},this.setClearColor=function(){},this.setSize=function(){}},THREE.MeshFaceMaterial=THREE.MultiMaterial,Object.defineProperties(THREE.LOD.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),THREE.CurveUtils={tangentQuadraticBezier:function(t,e,n,i){return 2*(1-t)*(n-e)+2*t*(i-n)},tangentCubicBezier:function(t,e,n,i,r){return-3*e*(1-t)*(1-t)+3*n*(1-t)*(1-t)-6*t*n*(1-t)+6*t*i*(1-t)-3*t*t*i+3*t*t*r},tangentSpline:function(t,e,n,i,r){var o=6*t*t-6*t,a=3*t*t-4*t+1,s=-6*t*t+6*t,c=3*t*t-2*t;return o+a+s+c},interpolate:function(t,e,n,i,r){var o=.5*(n-t),a=.5*(i-e),s=r*r,c=r*s;return(2*e-2*n+o+a)*c+(-3*e+3*n-2*o-a)*s+o*r+e}},THREE.SceneUtils={createMultiMaterialObject:function(t,e){for(var n=new THREE.Group,i=0,r=e.length;i<r;i++)n.add(new THREE.Mesh(t,e[i]));return n},detach:function(t,e,n){t.applyMatrix(e.matrixWorld),e.remove(t),n.add(t)},attach:function(t,e,n){var i=new THREE.Matrix4;i.getInverse(n.matrixWorld),t.applyMatrix(i),e.remove(t),n.add(t)}},THREE.ShapeUtils={area:function(t){for(var e=t.length,n=0,i=e-1,r=0;r<e;i=r++)n+=t[i].x*t[r].y-t[r].x*t[i].y;return.5*n},triangulate:function(){function t(t,e,n,i,r,o){var a,s,c,l,u,h,p,d,f;if(s=t[o[e]].x,c=t[o[e]].y,l=t[o[n]].x,u=t[o[n]].y,h=t[o[i]].x,p=t[o[i]].y,Number.EPSILON>(l-s)*(p-c)-(u-c)*(h-s))return!1;var m,v,g,y,E,_,T,b,w,R,x,H,M,S,C;for(m=h-l,v=p-u,g=s-h,y=c-p,E=l-s,_=u-c,a=0;a<r;a++)if(d=t[o[a]].x,f=t[o[a]].y,!(d===s&&f===c||d===l&&f===u||d===h&&f===p)&&(T=d-s,b=f-c,w=d-l,R=f-u,x=d-h,H=f-p,C=m*R-v*w,M=E*b-_*T,S=g*H-y*x,C>=-Number.EPSILON&&S>=-Number.EPSILON&&M>=-Number.EPSILON))return!1;return!0}return function(e,n){var i=e.length;if(i<3)return null;var r,o,a,s=[],c=[],l=[];if(THREE.ShapeUtils.area(e)>0)for(o=0;o<i;o++)c[o]=o;else for(o=0;o<i;o++)c[o]=i-1-o;var u=i,h=2*u;for(o=u-1;u>2;){if(h--<=0)return console.warn("THREE.ShapeUtils: Unable to triangulate polygon! in triangulate()"),n?l:s;if(r=o,u<=r&&(r=0),o=r+1,u<=o&&(o=0),a=o+1,u<=a&&(a=0),t(e,r,o,a,u,c)){var p,d,f,m,v;for(p=c[r],d=c[o],f=c[a],s.push([e[p],e[d],e[f]]),l.push([c[r],c[o],c[a]]),m=o,v=o+1;v<u;m++,v++)c[m]=c[v];u--,h=2*u}}return n?l:s}}(),triangulateShape:function(t,e){function n(t,e,n){return t.x!==e.x?t.x<e.x?t.x<=n.x&&n.x<=e.x:e.x<=n.x&&n.x<=t.x:t.y<e.y?t.y<=n.y&&n.y<=e.y:e.y<=n.y&&n.y<=t.y}function i(t,e,i,r,o){var a=e.x-t.x,s=e.y-t.y,c=r.x-i.x,l=r.y-i.y,u=t.x-i.x,h=t.y-i.y,p=s*c-a*l,d=s*u-a*h;if(Math.abs(p)>Number.EPSILON){var f;if(p>0){if(d<0||d>p)return[];if(f=l*u-c*h,f<0||f>p)return[]}else{if(d>0||d<p)return[];if(f=l*u-c*h,f>0||f<p)return[]}if(0===f)return!o||0!==d&&d!==p?[t]:[];if(f===p)return!o||0!==d&&d!==p?[e]:[];if(0===d)return[i];if(d===p)return[r];var m=f/p;return[{x:t.x+m*a,y:t.y+m*s}]}if(0!==d||l*u!==c*h)return[];var v=0===a&&0===s,g=0===c&&0===l;if(v&&g)return t.x!==i.x||t.y!==i.y?[]:[t];if(v)return n(i,r,t)?[t]:[];if(g)return n(t,e,i)?[i]:[];var y,E,_,T,b,w,R,x;return 0!==a?(t.x<e.x?(y=t,_=t.x,E=e,T=e.x):(y=e,_=e.x,E=t,T=t.x),i.x<r.x?(b=i,R=i.x,w=r,x=r.x):(b=r,R=r.x,w=i,x=i.x)):(t.y<e.y?(y=t,_=t.y,E=e,T=e.y):(y=e,_=e.y,E=t,T=t.y),i.y<r.y?(b=i,R=i.y,w=r,x=r.y):(b=r,R=r.y,w=i,x=i.y)),_<=R?T<R?[]:T===R?o?[]:[b]:T<=x?[b,E]:[b,w]:_>x?[]:_===x?o?[]:[y]:T<=x?[y,E]:[y,w]}function r(t,e,n,i){var r=e.x-t.x,o=e.y-t.y,a=n.x-t.x,s=n.y-t.y,c=i.x-t.x,l=i.y-t.y,u=r*s-o*a,h=r*l-o*c;if(Math.abs(u)>Number.EPSILON){var p=c*s-l*a;return u>0?h>=0&&p>=0:h>=0||p>=0}return h>0}function o(t,e){function n(t,e){var n=y.length-1,i=t-1;i<0&&(i=n);var o=t+1;o>n&&(o=0);var a=r(y[t],y[i],y[o],s[e]);if(!a)return!1;var c=s.length-1,l=e-1;l<0&&(l=c);var u=e+1;return u>c&&(u=0),a=r(s[e],s[l],s[u],y[t]),!!a}function o(t,e){var n,r,o;for(n=0;n<y.length;n++)if(r=n+1,r%=y.length,o=i(t,e,y[n],y[r],!0),o.length>0)return!0;return!1}function a(t,n){var r,o,a,s,c;for(r=0;r<E.length;r++)for(o=e[E[r]],a=0;a<o.length;a++)if(s=a+1,s%=o.length,c=i(t,n,o[a],o[s],!0),c.length>0)return!0;return!1}for(var s,c,l,u,h,p,d,f,m,v,g,y=t.concat(),E=[],_=[],T=0,b=e.length;T<b;T++)E.push(T);for(var w=0,R=2*E.length;E.length>0;){if(R--,R<0){console.log("Infinite Loop! Holes left:"+E.length+", Probably Hole outside Shape!");break}for(l=w;l<y.length;l++){u=y[l],c=-1;for(var T=0;T<E.length;T++)if(p=E[T],d=u.x+":"+u.y+":"+p,void 0===_[d]){s=e[p];for(var x=0;x<s.length;x++)if(h=s[x],n(l,x)&&!o(u,h)&&!a(u,h)){c=x,E.splice(T,1),f=y.slice(0,l+1),m=y.slice(l),v=s.slice(c),g=s.slice(0,c+1),y=f.concat(v).concat(g).concat(m),w=l;break}if(c>=0)break;_[d]=!0}if(c>=0)break}}return y}for(var a,s,c,l,u,h,p={},d=t.concat(),f=0,m=e.length;f<m;f++)Array.prototype.push.apply(d,e[f]);for(a=0,s=d.length;a<s;a++)u=d[a].x+":"+d[a].y,void 0!==p[u]&&console.warn("THREE.Shape: Duplicate point",u),p[u]=a;var v=o(t,e),g=THREE.ShapeUtils.triangulate(v,!1);for(a=0,s=g.length;a<s;a++)for(l=g[a],c=0;c<3;c++)u=l[c].x+":"+l[c].y,h=p[u],void 0!==h&&(l[c]=h);return g.concat()},isClockWise:function(t){return THREE.ShapeUtils.area(t)<0},b2:function(){function t(t,e){var n=1-t;return n*n*e}function e(t,e){return 2*(1-t)*t*e}function n(t,e){return t*t*e}return function(i,r,o,a){return t(i,r)+e(i,o)+n(i,a)}}(),b3:function(){function t(t,e){var n=1-t;return n*n*n*e}function e(t,e){var n=1-t;return 3*n*n*t*e}function n(t,e){var n=1-t;return 3*n*t*t*e}function i(t,e){return t*t*t*e}return function(r,o,a,s,c){return t(r,o)+e(r,a)+n(r,s)+i(r,c)}}()},THREE.Curve=function(){},THREE.Curve.prototype={constructor:THREE.Curve,getPoint:function(t){return console.warn("THREE.Curve: Warning, getPoint() not implemented!"),null},getPointAt:function(t){var e=this.getUtoTmapping(t);return this.getPoint(e)},getPoints:function(t){t||(t=5);var e,n=[];for(e=0;e<=t;e++)n.push(this.getPoint(e/t));return n},getSpacedPoints:function(t){t||(t=5);var e,n=[];for(e=0;e<=t;e++)n.push(this.getPointAt(e/t));return n},getLength:function(){var t=this.getLengths();return t[t.length-1]},getLengths:function(t){if(t||(t=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var e,n,i=[],r=this.getPoint(0),o=0;for(i.push(0),n=1;n<=t;n++)e=this.getPoint(n/t),o+=e.distanceTo(r),i.push(o),r=e;return this.cacheArcLengths=i,i},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(t,e){var n,i=this.getLengths(),r=0,o=i.length;n=e?e:t*i[o-1];for(var a,s=0,c=o-1;s<=c;)if(r=Math.floor(s+(c-s)/2),a=i[r]-n,a<0)s=r+1;else{if(!(a>0)){c=r;break}c=r-1}if(r=c,i[r]===n){var l=r/(o-1);return l}var u=i[r],h=i[r+1],p=h-u,d=(n-u)/p,l=(r+d)/(o-1);return l},getTangent:function(t){var e=1e-4,n=t-e,i=t+e;n<0&&(n=0),i>1&&(i=1);var r=this.getPoint(n),o=this.getPoint(i),a=o.clone().sub(r);return a.normalize()},getTangentAt:function(t){var e=this.getUtoTmapping(t);return this.getTangent(e)}},THREE.Curve.create=function(t,e){return t.prototype=Object.create(THREE.Curve.prototype),t.prototype.constructor=t,t.prototype.getPoint=e,t},THREE.CurvePath=function(){this.curves=[],this.autoClose=!1},THREE.CurvePath.prototype=Object.create(THREE.Curve.prototype),THREE.CurvePath.prototype.constructor=THREE.CurvePath,THREE.CurvePath.prototype.add=function(t){this.curves.push(t)},THREE.CurvePath.prototype.closePath=function(){var t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);t.equals(e)||this.curves.push(new THREE.LineCurve(e,t))},THREE.CurvePath.prototype.getPoint=function(t){for(var e=t*this.getLength(),n=this.getCurveLengths(),i=0;i<n.length;){if(n[i]>=e){var r=n[i]-e,o=this.curves[i],a=1-r/o.getLength();return o.getPointAt(a)}i++}return null},THREE.CurvePath.prototype.getLength=function(){var t=this.getCurveLengths();return t[t.length-1]},THREE.CurvePath.prototype.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var t=[],e=0,n=0,i=this.curves.length;n<i;n++)e+=this.curves[n].getLength(),t.push(e);return this.cacheLengths=t,t},THREE.CurvePath.prototype.createPointsGeometry=function(t){var e=this.getPoints(t);return this.createGeometry(e)},THREE.CurvePath.prototype.createSpacedPointsGeometry=function(t){var e=this.getSpacedPoints(t);return this.createGeometry(e)},THREE.CurvePath.prototype.createGeometry=function(t){for(var e=new THREE.Geometry,n=0,i=t.length;n<i;n++){var r=t[n];e.vertices.push(new THREE.Vector3(r.x,r.y,r.z||0))}return e},THREE.Font=function(t){this.data=t},THREE.Font.prototype={constructor:THREE.Font,generateShapes:function(t,e,n){function i(t){for(var n=String(t).split(""),i=e/o.resolution,a=0,s=[],c=0;c<n.length;c++){var l=r(n[c],i,a);a+=l.offset,s.push(l.path)}return s}function r(t,e,i){var r=o.glyphs[t]||o.glyphs["?"];if(r){var a,s,c,l,u,h,p,d,f,m,v,g=new THREE.Path,y=[],E=THREE.ShapeUtils.b2,_=THREE.ShapeUtils.b3;if(r.o)for(var T=r._cachedOutline||(r._cachedOutline=r.o.split(" ")),b=0,w=T.length;b<w;){var R=T[b++];switch(R){case"m":a=T[b++]*e+i,s=T[b++]*e,g.moveTo(a,s);break;case"l":a=T[b++]*e+i,s=T[b++]*e,g.lineTo(a,s);break;case"q":if(c=T[b++]*e+i,l=T[b++]*e,p=T[b++]*e+i,d=T[b++]*e,g.quadraticCurveTo(p,d,c,l),v=y[y.length-1]){u=v.x,h=v.y;for(var x=1;x<=n;x++){var H=x/n;E(H,u,p,c),E(H,h,d,l)}}break;case"b":if(c=T[b++]*e+i,l=T[b++]*e,p=T[b++]*e+i,d=T[b++]*e,f=T[b++]*e+i,m=T[b++]*e,g.bezierCurveTo(p,d,f,m,c,l),v=y[y.length-1]){u=v.x,h=v.y;for(var x=1;x<=n;x++){var H=x/n;_(H,u,p,f,c),_(H,h,d,m,l)}}}}return{offset:r.ha*e,path:g}}}void 0===e&&(e=100),void 0===n&&(n=4);for(var o=this.data,a=i(t),s=[],c=0,l=a.length;c<l;c++)Array.prototype.push.apply(s,a[c].toShapes());return s}},THREE.Path=function(t){THREE.CurvePath.call(this),this.actions=[],t&&this.fromPoints(t)},THREE.Path.prototype=Object.create(THREE.CurvePath.prototype),THREE.Path.prototype.constructor=THREE.Path,THREE.Path.prototype.fromPoints=function(t){this.moveTo(t[0].x,t[0].y);for(var e=1,n=t.length;e<n;e++)this.lineTo(t[e].x,t[e].y)},THREE.Path.prototype.moveTo=function(t,e){this.actions.push({action:"moveTo",args:[t,e]})},THREE.Path.prototype.lineTo=function(t,e){var n=this.actions[this.actions.length-1].args,i=n[n.length-2],r=n[n.length-1],o=new THREE.LineCurve(new THREE.Vector2(i,r),new THREE.Vector2(t,e));this.curves.push(o),this.actions.push({action:"lineTo",args:[t,e]})},THREE.Path.prototype.quadraticCurveTo=function(t,e,n,i){var r=this.actions[this.actions.length-1].args,o=r[r.length-2],a=r[r.length-1],s=new THREE.QuadraticBezierCurve(new THREE.Vector2(o,a),new THREE.Vector2(t,e),new THREE.Vector2(n,i));this.curves.push(s),this.actions.push({action:"quadraticCurveTo",args:[t,e,n,i]})},THREE.Path.prototype.bezierCurveTo=function(t,e,n,i,r,o){var a=this.actions[this.actions.length-1].args,s=a[a.length-2],c=a[a.length-1],l=new THREE.CubicBezierCurve(new THREE.Vector2(s,c),new THREE.Vector2(t,e),new THREE.Vector2(n,i),new THREE.Vector2(r,o));this.curves.push(l),this.actions.push({action:"bezierCurveTo",args:[t,e,n,i,r,o]})},THREE.Path.prototype.splineThru=function(t){var e=Array.prototype.slice.call(arguments),n=this.actions[this.actions.length-1].args,i=n[n.length-2],r=n[n.length-1],o=[new THREE.Vector2(i,r)];Array.prototype.push.apply(o,t);var a=new THREE.SplineCurve(o);this.curves.push(a),this.actions.push({action:"splineThru",args:e})},THREE.Path.prototype.arc=function(t,e,n,i,r,o){var a=this.actions[this.actions.length-1].args,s=a[a.length-2],c=a[a.length-1];this.absarc(t+s,e+c,n,i,r,o)},THREE.Path.prototype.absarc=function(t,e,n,i,r,o){this.absellipse(t,e,n,n,i,r,o)},THREE.Path.prototype.ellipse=function(t,e,n,i,r,o,a,s){var c=this.actions[this.actions.length-1].args,l=c[c.length-2],u=c[c.length-1];this.absellipse(t+l,e+u,n,i,r,o,a,s)},THREE.Path.prototype.absellipse=function(t,e,n,i,r,o,a,s){var c=[t,e,n,i,r,o,a,s||0],l=new THREE.EllipseCurve(t,e,n,i,r,o,a,s);this.curves.push(l);var u=l.getPoint(1);c.push(u.x),c.push(u.y),this.actions.push({action:"ellipse",args:c})},THREE.Path.prototype.getSpacedPoints=function(t){t||(t=40);for(var e=[],n=0;n<t;n++)e.push(this.getPoint(n/t));return this.autoClose&&e.push(e[0]),e},THREE.Path.prototype.getPoints=function(t){t=t||12;for(var e,n,i,r,o,a,s,c,l,u,h,p=THREE.ShapeUtils.b2,d=THREE.ShapeUtils.b3,f=[],m=0,v=this.actions.length;m<v;m++){var g=this.actions[m],y=g.action,E=g.args;switch(y){case"moveTo":f.push(new THREE.Vector2(E[0],E[1]));break;case"lineTo":f.push(new THREE.Vector2(E[0],E[1]));break;case"quadraticCurveTo":e=E[2],n=E[3],o=E[0],a=E[1],f.length>0?(l=f[f.length-1],s=l.x,c=l.y):(l=this.actions[m-1].args,s=l[l.length-2],c=l[l.length-1]);for(var _=1;_<=t;_++){var T=_/t;u=p(T,s,o,e),h=p(T,c,a,n),f.push(new THREE.Vector2(u,h))}break;case"bezierCurveTo":e=E[4],n=E[5],o=E[0],a=E[1],i=E[2],r=E[3],f.length>0?(l=f[f.length-1],s=l.x,c=l.y):(l=this.actions[m-1].args,s=l[l.length-2],c=l[l.length-1]);for(var _=1;_<=t;_++){var T=_/t;u=d(T,s,o,i,e),h=d(T,c,a,r,n),f.push(new THREE.Vector2(u,h))}break;case"splineThru":l=this.actions[m-1].args;var b=new THREE.Vector2(l[l.length-2],l[l.length-1]),w=[b],R=t*E[0].length;w=w.concat(E[0]);for(var x=new THREE.SplineCurve(w),_=1;_<=R;_++)f.push(x.getPointAt(_/R));break;case"arc":for(var H,M=E[0],S=E[1],C=E[2],A=E[3],P=E[4],L=!!E[5],O=P-A,j=2*t,_=1;_<=j;_++){var T=_/j;L||(T=1-T),H=A+T*O,u=M+C*Math.cos(H),h=S+C*Math.sin(H),f.push(new THREE.Vector2(u,h))}break;case"ellipse":var H,k,I,M=E[0],S=E[1],D=E[2],B=E[3],A=E[4],P=E[5],L=!!E[6],U=E[7],O=P-A,j=2*t;0!==U&&(k=Math.cos(U),I=Math.sin(U));for(var _=1;_<=j;_++){var T=_/j;if(L||(T=1-T),H=A+T*O,u=M+D*Math.cos(H),h=S+B*Math.sin(H),0!==U){var N=u,F=h;u=(N-M)*k-(F-S)*I+M,h=(N-M)*I+(F-S)*k+S}f.push(new THREE.Vector2(u,h))}}}var V=f[f.length-1];return Math.abs(V.x-f[0].x)<Number.EPSILON&&Math.abs(V.y-f[0].y)<Number.EPSILON&&f.splice(f.length-1,1),this.autoClose&&f.push(f[0]),f},THREE.Path.prototype.toShapes=function(t,e){function n(t){for(var e=[],n=new THREE.Path,i=0,r=t.length;i<r;i++){var o=t[i],a=o.args,s=o.action;"moveTo"===s&&0!==n.actions.length&&(e.push(n),n=new THREE.Path),n[s].apply(n,a)}return 0!==n.actions.length&&e.push(n),e}function i(t){for(var e=[],n=0,i=t.length;n<i;n++){var r=t[n],o=new THREE.Shape;o.actions=r.actions,o.curves=r.curves,e.push(o)}return e}function r(t,e){for(var n=e.length,i=!1,r=n-1,o=0;o<n;r=o++){var a=e[r],s=e[o],c=s.x-a.x,l=s.y-a.y;if(Math.abs(l)>Number.EPSILON){if(l<0&&(a=e[o],c=-c,s=e[r],l=-l),t.y<a.y||t.y>s.y)continue;if(t.y===a.y){if(t.x===a.x)return!0}else{var u=l*(t.x-a.x)-c*(t.y-a.y);if(0===u)return!0;if(u<0)continue;i=!i}}else{if(t.y!==a.y)continue;if(s.x<=t.x&&t.x<=a.x||a.x<=t.x&&t.x<=s.x)return!0}}return i}var o=THREE.ShapeUtils.isClockWise,a=n(this.actions);if(0===a.length)return[];if(e===!0)return i(a);var s,c,l,u=[];if(1===a.length)return c=a[0],l=new THREE.Shape,l.actions=c.actions,l.curves=c.curves,u.push(l),u;var h=!o(a[0].getPoints());h=t?!h:h;var p,d=[],f=[],m=[],v=0;f[v]=void 0,m[v]=[];for(var g=0,y=a.length;g<y;g++)c=a[g],p=c.getPoints(),s=o(p),s=t?!s:s,s?(!h&&f[v]&&v++,f[v]={s:new THREE.Shape,p:p},f[v].s.actions=c.actions,f[v].s.curves=c.curves,h&&v++,m[v]=[]):m[v].push({h:c,p:p[0]});if(!f[0])return i(a);if(f.length>1){for(var E=!1,_=[],T=0,b=f.length;T<b;T++)d[T]=[];for(var T=0,b=f.length;T<b;T++)for(var w=m[T],R=0;R<w.length;R++){for(var x=w[R],H=!0,M=0;M<f.length;M++)r(x.p,f[M].p)&&(T!==M&&_.push({froms:T,tos:M,hole:R}),H?(H=!1,d[M].push(x)):E=!0);H&&d[T].push(x)}_.length>0&&(E||(m=d))}for(var S,g=0,C=f.length;g<C;g++){l=f[g].s,u.push(l),S=m[g];for(var A=0,P=S.length;A<P;A++)l.holes.push(S[A].h)}return u},THREE.Shape=function(){THREE.Path.apply(this,arguments),this.holes=[]},THREE.Shape.prototype=Object.create(THREE.Path.prototype),THREE.Shape.prototype.constructor=THREE.Shape,THREE.Shape.prototype.extrude=function(t){return new THREE.ExtrudeGeometry(this,t)},THREE.Shape.prototype.makeGeometry=function(t){return new THREE.ShapeGeometry(this,t)},THREE.Shape.prototype.getPointsHoles=function(t){for(var e=[],n=0,i=this.holes.length;n<i;n++)e[n]=this.holes[n].getPoints(t);return e},THREE.Shape.prototype.extractAllPoints=function(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}},THREE.Shape.prototype.extractPoints=function(t){return this.extractAllPoints(t)},THREE.LineCurve=function(t,e){this.v1=t,this.v2=e},THREE.LineCurve.prototype=Object.create(THREE.Curve.prototype),THREE.LineCurve.prototype.constructor=THREE.LineCurve,THREE.LineCurve.prototype.getPoint=function(t){var e=this.v2.clone().sub(this.v1);return e.multiplyScalar(t).add(this.v1),e},THREE.LineCurve.prototype.getPointAt=function(t){return this.getPoint(t)},THREE.LineCurve.prototype.getTangent=function(t){var e=this.v2.clone().sub(this.v1);return e.normalize()},THREE.QuadraticBezierCurve=function(t,e,n){this.v0=t,this.v1=e,this.v2=n},THREE.QuadraticBezierCurve.prototype=Object.create(THREE.Curve.prototype),THREE.QuadraticBezierCurve.prototype.constructor=THREE.QuadraticBezierCurve,THREE.QuadraticBezierCurve.prototype.getPoint=function(t){var e=THREE.ShapeUtils.b2;return new THREE.Vector2(e(t,this.v0.x,this.v1.x,this.v2.x),e(t,this.v0.y,this.v1.y,this.v2.y))},THREE.QuadraticBezierCurve.prototype.getTangent=function(t){var e=THREE.CurveUtils.tangentQuadraticBezier;return new THREE.Vector2(e(t,this.v0.x,this.v1.x,this.v2.x),e(t,this.v0.y,this.v1.y,this.v2.y)).normalize()},THREE.CubicBezierCurve=function(t,e,n,i){this.v0=t,this.v1=e,this.v2=n,this.v3=i},THREE.CubicBezierCurve.prototype=Object.create(THREE.Curve.prototype),THREE.CubicBezierCurve.prototype.constructor=THREE.CubicBezierCurve,THREE.CubicBezierCurve.prototype.getPoint=function(t){var e=THREE.ShapeUtils.b3;return new THREE.Vector2(e(t,this.v0.x,this.v1.x,this.v2.x,this.v3.x),e(t,this.v0.y,this.v1.y,this.v2.y,this.v3.y))},THREE.CubicBezierCurve.prototype.getTangent=function(t){var e=THREE.CurveUtils.tangentCubicBezier;return new THREE.Vector2(e(t,this.v0.x,this.v1.x,this.v2.x,this.v3.x),e(t,this.v0.y,this.v1.y,this.v2.y,this.v3.y)).normalize()},THREE.SplineCurve=function(t){this.points=void 0==t?[]:t},THREE.SplineCurve.prototype=Object.create(THREE.Curve.prototype),THREE.SplineCurve.prototype.constructor=THREE.SplineCurve,THREE.SplineCurve.prototype.getPoint=function(t){var e=this.points,n=(e.length-1)*t,i=Math.floor(n),r=n-i,o=e[0===i?i:i-1],a=e[i],s=e[i>e.length-2?e.length-1:i+1],c=e[i>e.length-3?e.length-1:i+2],l=THREE.CurveUtils.interpolate;return new THREE.Vector2(l(o.x,a.x,s.x,c.x,r),l(o.y,a.y,s.y,c.y,r))},THREE.EllipseCurve=function(t,e,n,i,r,o,a,s){this.aX=t,this.aY=e,this.xRadius=n,this.yRadius=i,this.aStartAngle=r,this.aEndAngle=o,this.aClockwise=a,this.aRotation=s||0},THREE.EllipseCurve.prototype=Object.create(THREE.Curve.prototype),THREE.EllipseCurve.prototype.constructor=THREE.EllipseCurve,THREE.EllipseCurve.prototype.getPoint=function(t){var e=this.aEndAngle-this.aStartAngle;e<0&&(e+=2*Math.PI),e>2*Math.PI&&(e-=2*Math.PI);var n;n=this.aClockwise===!0?this.aEndAngle+(1-t)*(2*Math.PI-e):this.aStartAngle+t*e;var i=this.aX+this.xRadius*Math.cos(n),r=this.aY+this.yRadius*Math.sin(n);if(0!==this.aRotation){var o=Math.cos(this.aRotation),a=Math.sin(this.aRotation),s=i,c=r;i=(s-this.aX)*o-(c-this.aY)*a+this.aX,r=(s-this.aX)*a+(c-this.aY)*o+this.aY}return new THREE.Vector2(i,r)},THREE.ArcCurve=function(t,e,n,i,r,o){THREE.EllipseCurve.call(this,t,e,n,n,i,r,o)},THREE.ArcCurve.prototype=Object.create(THREE.EllipseCurve.prototype),THREE.ArcCurve.prototype.constructor=THREE.ArcCurve,THREE.LineCurve3=THREE.Curve.create(function(t,e){this.v1=t,this.v2=e},function(t){var e=new THREE.Vector3;return e.subVectors(this.v2,this.v1),e.multiplyScalar(t),e.add(this.v1),e}),THREE.QuadraticBezierCurve3=THREE.Curve.create(function(t,e,n){this.v0=t,this.v1=e,this.v2=n},function(t){var e=THREE.ShapeUtils.b2;return new THREE.Vector3(e(t,this.v0.x,this.v1.x,this.v2.x),e(t,this.v0.y,this.v1.y,this.v2.y),e(t,this.v0.z,this.v1.z,this.v2.z))});THREE.CubicBezierCurve3=THREE.Curve.create(function(t,e,n,i){this.v0=t,this.v1=e,this.v2=n,this.v3=i},function(t){var e=THREE.ShapeUtils.b3;return new THREE.Vector3(e(t,this.v0.x,this.v1.x,this.v2.x,this.v3.x),e(t,this.v0.y,this.v1.y,this.v2.y,this.v3.y),e(t,this.v0.z,this.v1.z,this.v2.z,this.v3.z))});THREE.SplineCurve3=THREE.Curve.create(function(t){console.warn("THREE.SplineCurve3 will be deprecated. Please use THREE.CatmullRomCurve3"),this.points=void 0==t?[]:t},function(t){var e=this.points,n=(e.length-1)*t,i=Math.floor(n),r=n-i,o=e[0==i?i:i-1],a=e[i],s=e[i>e.length-2?e.length-1:i+1],c=e[i>e.length-3?e.length-1:i+2],l=THREE.CurveUtils.interpolate;return new THREE.Vector3(l(o.x,a.x,s.x,c.x,r),l(o.y,a.y,s.y,c.y,r),l(o.z,a.z,s.z,c.z,r))}),THREE.CatmullRomCurve3=function(){function t(){}var e=new THREE.Vector3,n=new t,i=new t,r=new t;return t.prototype.init=function(t,e,n,i){this.c0=t,this.c1=n,this.c2=-3*t+3*e-2*n-i,this.c3=2*t-2*e+n+i},t.prototype.initNonuniformCatmullRom=function(t,e,n,i,r,o,a){var s=(e-t)/r-(n-t)/(r+o)+(n-e)/o,c=(n-e)/o-(i-e)/(o+a)+(i-n)/a;s*=o,c*=o,this.init(e,n,s,c)},t.prototype.initCatmullRom=function(t,e,n,i,r){this.init(e,n,r*(n-t),r*(i-e))},t.prototype.calc=function(t){var e=t*t,n=e*t;return this.c0+this.c1*t+this.c2*e+this.c3*n},THREE.Curve.create(function(t){this.points=t||[],this.closed=!1},function(t){var o,a,s,c,l=this.points;c=l.length,c<2&&console.log("duh, you need at least 2 points"),o=(c-(this.closed?0:1))*t,a=Math.floor(o),s=o-a,this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/l.length)+1)*l.length:0===s&&a===c-1&&(a=c-2,s=1);var u,h,p,d;if(this.closed||a>0?u=l[(a-1)%c]:(e.subVectors(l[0],l[1]).add(l[0]),u=e),h=l[a%c],p=l[(a+1)%c],this.closed||a+2<c?d=l[(a+2)%c]:(e.subVectors(l[c-1],l[c-2]).add(l[c-1]),d=e),void 0===this.type||"centripetal"===this.type||"chordal"===this.type){var f="chordal"===this.type?.5:.25,m=Math.pow(u.distanceToSquared(h),f),v=Math.pow(h.distanceToSquared(p),f),g=Math.pow(p.distanceToSquared(d),f);v<1e-4&&(v=1),m<1e-4&&(m=v),g<1e-4&&(g=v),n.initNonuniformCatmullRom(u.x,h.x,p.x,d.x,m,v,g),i.initNonuniformCatmullRom(u.y,h.y,p.y,d.y,m,v,g),r.initNonuniformCatmullRom(u.z,h.z,p.z,d.z,m,v,g)}else if("catmullrom"===this.type){var y=void 0!==this.tension?this.tension:.5;n.initCatmullRom(u.x,h.x,p.x,d.x,y),i.initCatmullRom(u.y,h.y,p.y,d.y,y),r.initCatmullRom(u.z,h.z,p.z,d.z,y)}var E=new THREE.Vector3(n.calc(s),i.calc(s),r.calc(s));return E})}(),THREE.ClosedSplineCurve3=function(t){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Please use THREE.CatmullRomCurve3."),
THREE.CatmullRomCurve3.call(this,t),this.type="catmullrom",this.closed=!0},THREE.ClosedSplineCurve3.prototype=Object.create(THREE.CatmullRomCurve3.prototype),THREE.BoxGeometry=function(t,e,n,i,r,o){THREE.Geometry.call(this),this.type="BoxGeometry",this.parameters={width:t,height:e,depth:n,widthSegments:i,heightSegments:r,depthSegments:o},this.fromBufferGeometry(new THREE.BoxBufferGeometry(t,e,n,i,r,o)),this.mergeVertices()},THREE.BoxGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.BoxGeometry.prototype.constructor=THREE.BoxGeometry,THREE.CubeGeometry=THREE.BoxGeometry,THREE.BoxBufferGeometry=function(t,e,n,i,r,o){function a(t,e,n){var i=0;return i+=t*e*2,i+=t*n*2,i+=n*e*2,4*i}function s(t,e,n,i,r,o,a,s,l,u,_){for(var T=o/l,b=a/u,w=o/2,R=a/2,x=s/2,H=l+1,M=u+1,S=0,C=0,A=new THREE.Vector3,P=0;P<M;P++)for(var L=P*b-R,O=0;O<H;O++){var j=O*T-w;A[t]=j*i,A[e]=L*r,A[n]=x,p[m]=A.x,p[m+1]=A.y,p[m+2]=A.z,A[t]=0,A[e]=0,A[n]=s>0?1:-1,d[m]=A.x,d[m+1]=A.y,d[m+2]=A.z,f[v]=O/l,f[v+1]=1-P/u,m+=3,v+=2,S+=1}for(P=0;P<u;P++)for(O=0;O<l;O++){var k=y+O+H*P,I=y+O+H*(P+1),D=y+(O+1)+H*(P+1),B=y+(O+1)+H*P;h[g]=k,h[g+1]=I,h[g+2]=B,h[g+3]=I,h[g+4]=D,h[g+5]=B,g+=6,C+=6}c.addGroup(E,C,_),E+=C,y+=S}THREE.BufferGeometry.call(this),this.type="BoxBufferGeometry",this.parameters={width:t,height:e,depth:n,widthSegments:i,heightSegments:r,depthSegments:o};var c=this;i=Math.floor(i)||1,r=Math.floor(r)||1,o=Math.floor(o)||1;var l=a(i,r,o),u=l/4*6,h=new(u>65535?Uint32Array:Uint16Array)(u),p=new Float32Array(3*l),d=new Float32Array(3*l),f=new Float32Array(2*l),m=0,v=0,g=0,y=0,E=0;s("z","y","x",-1,-1,n,e,t,o,r,0),s("z","y","x",1,-1,n,e,-t,o,r,1),s("x","z","y",1,1,t,n,e,i,o,2),s("x","z","y",1,-1,t,n,-e,i,o,3),s("x","y","z",1,-1,t,e,n,i,r,4),s("x","y","z",-1,-1,t,e,-n,i,r,5),this.setIndex(new THREE.BufferAttribute(h,1)),this.addAttribute("position",new THREE.BufferAttribute(p,3)),this.addAttribute("normal",new THREE.BufferAttribute(d,3)),this.addAttribute("uv",new THREE.BufferAttribute(f,2))},THREE.BoxBufferGeometry.prototype=Object.create(THREE.BufferGeometry.prototype),THREE.BoxBufferGeometry.prototype.constructor=THREE.BoxBufferGeometry,THREE.CircleGeometry=function(t,e,n,i){THREE.Geometry.call(this),this.type="CircleGeometry",this.parameters={radius:t,segments:e,thetaStart:n,thetaLength:i},this.fromBufferGeometry(new THREE.CircleBufferGeometry(t,e,n,i))},THREE.CircleGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.CircleGeometry.prototype.constructor=THREE.CircleGeometry,THREE.CircleBufferGeometry=function(t,e,n,i){THREE.BufferGeometry.call(this),this.type="CircleBufferGeometry",this.parameters={radius:t,segments:e,thetaStart:n,thetaLength:i},t=t||50,e=void 0!==e?Math.max(3,e):8,n=void 0!==n?n:0,i=void 0!==i?i:2*Math.PI;var r=e+2,o=new Float32Array(3*r),a=new Float32Array(3*r),s=new Float32Array(2*r);a[2]=1,s[0]=.5,s[1]=.5;for(var c=0,l=3,u=2;c<=e;c++,l+=3,u+=2){var h=n+c/e*i;o[l]=t*Math.cos(h),o[l+1]=t*Math.sin(h),a[l+2]=1,s[u]=(o[l]/t+1)/2,s[u+1]=(o[l+1]/t+1)/2}for(var p=[],l=1;l<=e;l++)p.push(l,l+1,0);this.setIndex(new THREE.BufferAttribute(new Uint16Array(p),1)),this.addAttribute("position",new THREE.BufferAttribute(o,3)),this.addAttribute("normal",new THREE.BufferAttribute(a,3)),this.addAttribute("uv",new THREE.BufferAttribute(s,2)),this.boundingSphere=new THREE.Sphere(new THREE.Vector3,t)},THREE.CircleBufferGeometry.prototype=Object.create(THREE.BufferGeometry.prototype),THREE.CircleBufferGeometry.prototype.constructor=THREE.CircleBufferGeometry,THREE.CylinderBufferGeometry=function(t,e,n,i,r,o,a,s){function c(){var t=(i+1)*(r+1);return o===!1&&(t+=2*(i+1)+2*i),t}function l(){var t=i*r*2*3;return o===!1&&(t+=2*i*3),t}function u(){var o,c,l=new THREE.Vector3,u=new THREE.Vector3,h=0,d=(e-t)/n;for(c=0;c<=r;c++){var f=[],R=c/r,x=R*(e-t)+t;for(o=0;o<=i;o++){var H=o/i;u.x=x*Math.sin(H*s+a),u.y=-R*n+b,u.z=x*Math.cos(H*s+a),v.setXYZ(E,u.x,u.y,u.z),l.copy(u),(0===t&&0===c||0===e&&c===r)&&(l.x=Math.sin(H*s+a),l.z=Math.cos(H*s+a)),l.setY(Math.sqrt(l.x*l.x+l.z*l.z)*d).normalize(),g.setXYZ(E,l.x,l.y,l.z),y.setXY(E,H,1-R),f.push(E),E++}T.push(f)}for(o=0;o<i;o++)for(c=0;c<r;c++){var M=T[c][o],S=T[c+1][o],C=T[c+1][o+1],A=T[c][o+1];m.setX(_,M),_++,m.setX(_,S),_++,m.setX(_,A),_++,m.setX(_,S),_++,m.setX(_,C),_++,m.setX(_,A),_++,h+=6}p.addGroup(w,h,0),w+=h}function h(n){var r,o,c,l=new THREE.Vector2,u=new THREE.Vector3,h=0,d=n===!0?t:e,f=n===!0?1:-1;for(o=E,r=1;r<=i;r++)v.setXYZ(E,0,b*f,0),g.setXYZ(E,0,f,0),n===!0?(l.x=r/i,l.y=0):(l.x=(r-1)/i,l.y=1),y.setXY(E,l.x,l.y),E++;for(c=E,r=0;r<=i;r++){var T=r/i;u.x=d*Math.sin(T*s+a),u.y=b*f,u.z=d*Math.cos(T*s+a),v.setXYZ(E,u.x,u.y,u.z),g.setXYZ(E,0,f,0),y.setXY(E,T,n===!0?1:0),E++}for(r=0;r<i;r++){var R=o+r,x=c+r;n===!0?(m.setX(_,x),_++,m.setX(_,x+1),_++,m.setX(_,R),_++):(m.setX(_,x+1),_++,m.setX(_,x),_++,m.setX(_,R),_++),h+=3}p.addGroup(w,h,n===!0?1:2),w+=h}THREE.BufferGeometry.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:n,radialSegments:i,heightSegments:r,openEnded:o,thetaStart:a,thetaLength:s};var p=this;t=void 0!==t?t:20,e=void 0!==e?e:20,n=void 0!==n?n:100,i=Math.floor(i)||8,r=Math.floor(r)||1,o=void 0!==o&&o,a=void 0!==a?a:0,s=void 0!==s?s:2*Math.PI;var d=c(),f=l(),m=new THREE.BufferAttribute(new(f>65535?Uint32Array:Uint16Array)(f),1),v=new THREE.BufferAttribute(new Float32Array(3*d),3),g=new THREE.BufferAttribute(new Float32Array(3*d),3),y=new THREE.BufferAttribute(new Float32Array(2*d),2),E=0,_=0,T=[],b=n/2,w=0;u(),o===!1&&(t>0&&h(!0),e>0&&h(!1)),this.setIndex(m),this.addAttribute("position",v),this.addAttribute("normal",g),this.addAttribute("uv",y)},THREE.CylinderBufferGeometry.prototype=Object.create(THREE.BufferGeometry.prototype),THREE.CylinderBufferGeometry.prototype.constructor=THREE.CylinderBufferGeometry,THREE.CylinderGeometry=function(t,e,n,i,r,o,a,s){THREE.Geometry.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:n,radialSegments:i,heightSegments:r,openEnded:o,thetaStart:a,thetaLength:s},this.fromBufferGeometry(new THREE.CylinderBufferGeometry(t,e,n,i,r,o,a,s)),this.mergeVertices()},THREE.CylinderGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.CylinderGeometry.prototype.constructor=THREE.CylinderGeometry,THREE.EdgesGeometry=function(t,e){function n(t,e){return t-e}THREE.BufferGeometry.call(this),e=void 0!==e?e:1;var i,r=Math.cos(THREE.Math.DEG2RAD*e),o=[0,0],a={},s=["a","b","c"];t instanceof THREE.BufferGeometry?(i=new THREE.Geometry,i.fromBufferGeometry(t)):i=t.clone(),i.mergeVertices(),i.computeFaceNormals();for(var c=i.vertices,l=i.faces,u=0,h=l.length;u<h;u++)for(var p=l[u],d=0;d<3;d++){o[0]=p[s[d]],o[1]=p[s[(d+1)%3]],o.sort(n);var f=o.toString();void 0===a[f]?a[f]={vert1:o[0],vert2:o[1],face1:u,face2:void 0}:a[f].face2=u}var m=[];for(var f in a){var v=a[f];if(void 0===v.face2||l[v.face1].normal.dot(l[v.face2].normal)<=r){var g=c[v.vert1];m.push(g.x),m.push(g.y),m.push(g.z),g=c[v.vert2],m.push(g.x),m.push(g.y),m.push(g.z)}}this.addAttribute("position",new THREE.BufferAttribute(new Float32Array(m),3))},THREE.EdgesGeometry.prototype=Object.create(THREE.BufferGeometry.prototype),THREE.EdgesGeometry.prototype.constructor=THREE.EdgesGeometry,THREE.ExtrudeGeometry=function(t,e){return"undefined"==typeof t?void(t=[]):(THREE.Geometry.call(this),this.type="ExtrudeGeometry",t=Array.isArray(t)?t:[t],this.addShapeList(t,e),void this.computeFaceNormals())},THREE.ExtrudeGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.ExtrudeGeometry.prototype.constructor=THREE.ExtrudeGeometry,THREE.ExtrudeGeometry.prototype.addShapeList=function(t,e){for(var n=t.length,i=0;i<n;i++){var r=t[i];this.addShape(r,e)}},THREE.ExtrudeGeometry.prototype.addShape=function(t,e){function n(t,e,n){return e||console.error("THREE.ExtrudeGeometry: vec does not exist"),e.clone().multiplyScalar(n).add(t)}function i(t,e,n){var i,r,o=1,a=t.x-e.x,s=t.y-e.y,c=n.x-t.x,l=n.y-t.y,u=a*a+s*s,h=a*l-s*c;if(Math.abs(h)>Number.EPSILON){var p=Math.sqrt(u),d=Math.sqrt(c*c+l*l),f=e.x-s/p,m=e.y+a/p,v=n.x-l/d,g=n.y+c/d,y=((v-f)*l-(g-m)*c)/(a*l-s*c);i=f+a*y-t.x,r=m+s*y-t.y;var E=i*i+r*r;if(E<=2)return new THREE.Vector2(i,r);o=Math.sqrt(E/2)}else{var _=!1;a>Number.EPSILON?c>Number.EPSILON&&(_=!0):a<-Number.EPSILON?c<-Number.EPSILON&&(_=!0):Math.sign(s)===Math.sign(l)&&(_=!0),_?(i=-s,r=a,o=Math.sqrt(u)):(i=a,r=s,o=Math.sqrt(u/2))}return new THREE.Vector2(i/o,r/o)}function r(){if(E){var t=0,e=V*t;for(W=0;W<G;W++)F=j[W],c(F[2]+e,F[1]+e,F[0]+e);for(t=T+2*y,e=V*t,W=0;W<G;W++)F=j[W],c(F[0]+e,F[1]+e,F[2]+e)}else{for(W=0;W<G;W++)F=j[W],c(F[2],F[1],F[0]);for(W=0;W<G;W++)F=j[W],c(F[0]+V*T,F[1]+V*T,F[2]+V*T)}}function o(){var t=0;for(a(k,t),t+=k.length,H=0,M=L.length;H<M;H++)x=L[H],a(x,t),t+=x.length}function a(t,e){var n,i;for(W=t.length;--W>=0;){n=W,i=W-1,i<0&&(i=t.length-1);var r=0,o=T+2*y;for(r=0;r<o;r++){var a=V*r,s=V*(r+1),c=e+n+a,u=e+i+a,h=e+i+s,p=e+n+s;l(c,u,h,p,t,r,o,n,i)}}}function s(t,e,n){S.vertices.push(new THREE.Vector3(t,e,n))}function c(t,e,n){t+=C,e+=C,n+=C,S.faces.push(new THREE.Face3(t,e,n,null,null,0));var i=R.generateTopUV(S,t,e,n);S.faceVertexUvs[0].push(i)}function l(t,e,n,i,r,o,a,s,c){t+=C,e+=C,n+=C,i+=C,S.faces.push(new THREE.Face3(t,e,i,null,null,1)),S.faces.push(new THREE.Face3(e,n,i,null,null,1));var l=R.generateSideWallUV(S,t,e,n,i);S.faceVertexUvs[0].push([l[0],l[1],l[3]]),S.faceVertexUvs[0].push([l[1],l[2],l[3]])}var u,h,p,d,f,m=void 0!==e.amount?e.amount:100,v=void 0!==e.bevelThickness?e.bevelThickness:6,g=void 0!==e.bevelSize?e.bevelSize:v-2,y=void 0!==e.bevelSegments?e.bevelSegments:3,E=void 0===e.bevelEnabled||e.bevelEnabled,_=void 0!==e.curveSegments?e.curveSegments:12,T=void 0!==e.steps?e.steps:1,b=e.extrudePath,w=!1,R=void 0!==e.UVGenerator?e.UVGenerator:THREE.ExtrudeGeometry.WorldUVGenerator;b&&(u=b.getSpacedPoints(T),w=!0,E=!1,h=void 0!==e.frames?e.frames:new THREE.TubeGeometry.FrenetFrames(b,T,(!1)),p=new THREE.Vector3,d=new THREE.Vector3,f=new THREE.Vector3),E||(y=0,v=0,g=0);var x,H,M,S=this,C=this.vertices.length,A=t.extractPoints(_),P=A.shape,L=A.holes,O=!THREE.ShapeUtils.isClockWise(P);if(O){for(P=P.reverse(),H=0,M=L.length;H<M;H++)x=L[H],THREE.ShapeUtils.isClockWise(x)&&(L[H]=x.reverse());O=!1}var j=THREE.ShapeUtils.triangulateShape(P,L),k=P;for(H=0,M=L.length;H<M;H++)x=L[H],P=P.concat(x);for(var I,D,B,U,N,F,V=P.length,G=j.length,z=[],W=0,X=k.length,q=X-1,Y=W+1;W<X;W++,q++,Y++)q===X&&(q=0),Y===X&&(Y=0),z[W]=i(k[W],k[q],k[Y]);var Z,K=[],Q=z.concat();for(H=0,M=L.length;H<M;H++){for(x=L[H],Z=[],W=0,X=x.length,q=X-1,Y=W+1;W<X;W++,q++,Y++)q===X&&(q=0),Y===X&&(Y=0),Z[W]=i(x[W],x[q],x[Y]);K.push(Z),Q=Q.concat(Z)}for(I=0;I<y;I++){for(B=I/y,U=v*(1-B),D=g*Math.sin(B*Math.PI/2),W=0,X=k.length;W<X;W++)N=n(k[W],z[W],D),s(N.x,N.y,-U);for(H=0,M=L.length;H<M;H++)for(x=L[H],Z=K[H],W=0,X=x.length;W<X;W++)N=n(x[W],Z[W],D),s(N.x,N.y,-U)}for(D=g,W=0;W<V;W++)N=E?n(P[W],Q[W],D):P[W],w?(d.copy(h.normals[0]).multiplyScalar(N.x),p.copy(h.binormals[0]).multiplyScalar(N.y),f.copy(u[0]).add(d).add(p),s(f.x,f.y,f.z)):s(N.x,N.y,0);var $;for($=1;$<=T;$++)for(W=0;W<V;W++)N=E?n(P[W],Q[W],D):P[W],w?(d.copy(h.normals[$]).multiplyScalar(N.x),p.copy(h.binormals[$]).multiplyScalar(N.y),f.copy(u[$]).add(d).add(p),s(f.x,f.y,f.z)):s(N.x,N.y,m/T*$);for(I=y-1;I>=0;I--){for(B=I/y,U=v*(1-B),D=g*Math.sin(B*Math.PI/2),W=0,X=k.length;W<X;W++)N=n(k[W],z[W],D),s(N.x,N.y,m+U);for(H=0,M=L.length;H<M;H++)for(x=L[H],Z=K[H],W=0,X=x.length;W<X;W++)N=n(x[W],Z[W],D),w?s(N.x,N.y+u[T-1].y,u[T-1].x+U):s(N.x,N.y,m+U)}r(),o()},THREE.ExtrudeGeometry.WorldUVGenerator={generateTopUV:function(t,e,n,i){var r=t.vertices,o=r[e],a=r[n],s=r[i];return[new THREE.Vector2(o.x,o.y),new THREE.Vector2(a.x,a.y),new THREE.Vector2(s.x,s.y)]},generateSideWallUV:function(t,e,n,i,r){var o=t.vertices,a=o[e],s=o[n],c=o[i],l=o[r];return Math.abs(a.y-s.y)<.01?[new THREE.Vector2(a.x,1-a.z),new THREE.Vector2(s.x,1-s.z),new THREE.Vector2(c.x,1-c.z),new THREE.Vector2(l.x,1-l.z)]:[new THREE.Vector2(a.y,1-a.z),new THREE.Vector2(s.y,1-s.z),new THREE.Vector2(c.y,1-c.z),new THREE.Vector2(l.y,1-l.z)]}},THREE.ShapeGeometry=function(t,e){THREE.Geometry.call(this),this.type="ShapeGeometry",Array.isArray(t)===!1&&(t=[t]),this.addShapeList(t,e),this.computeFaceNormals()},THREE.ShapeGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.ShapeGeometry.prototype.constructor=THREE.ShapeGeometry,THREE.ShapeGeometry.prototype.addShapeList=function(t,e){for(var n=0,i=t.length;n<i;n++)this.addShape(t[n],e);return this},THREE.ShapeGeometry.prototype.addShape=function(t,e){void 0===e&&(e={});var n,i,r,o=void 0!==e.curveSegments?e.curveSegments:12,a=e.material,s=void 0===e.UVGenerator?THREE.ExtrudeGeometry.WorldUVGenerator:e.UVGenerator,c=this.vertices.length,l=t.extractPoints(o),u=l.shape,h=l.holes,p=!THREE.ShapeUtils.isClockWise(u);if(p){for(u=u.reverse(),n=0,i=h.length;n<i;n++)r=h[n],THREE.ShapeUtils.isClockWise(r)&&(h[n]=r.reverse());p=!1}var d=THREE.ShapeUtils.triangulateShape(u,h);for(n=0,i=h.length;n<i;n++)r=h[n],u=u.concat(r);var f,m,v=u.length,g=d.length;for(n=0;n<v;n++)f=u[n],this.vertices.push(new THREE.Vector3(f.x,f.y,0));for(n=0;n<g;n++){m=d[n];var y=m[0]+c,E=m[1]+c,_=m[2]+c;this.faces.push(new THREE.Face3(y,E,_,null,null,a)),this.faceVertexUvs[0].push(s.generateTopUV(this,y,E,_))}},THREE.LatheBufferGeometry=function(t,e,n,i){THREE.BufferGeometry.call(this),this.type="LatheBufferGeometry",this.parameters={points:t,segments:e,phiStart:n,phiLength:i},e=Math.floor(e)||12,n=n||0,i=i||2*Math.PI,i=THREE.Math.clamp(i,0,2*Math.PI);var r,o,a,s=(e+1)*t.length,c=e*t.length*2*3,l=new THREE.BufferAttribute(new(c>65535?Uint32Array:Uint16Array)(c),1),u=new THREE.BufferAttribute(new Float32Array(3*s),3),h=new THREE.BufferAttribute(new Float32Array(2*s),2),p=0,d=0,f=(1/(t.length-1),1/e),m=new THREE.Vector3,v=new THREE.Vector2;for(o=0;o<=e;o++){var g=n+o*f*i,y=Math.sin(g),E=Math.cos(g);for(a=0;a<=t.length-1;a++)m.x=t[a].x*y,m.y=t[a].y,m.z=t[a].x*E,u.setXYZ(p,m.x,m.y,m.z),v.x=o/e,v.y=a/(t.length-1),h.setXY(p,v.x,v.y),p++}for(o=0;o<e;o++)for(a=0;a<t.length-1;a++){r=a+o*t.length;var _=r,T=r+t.length,b=r+t.length+1,w=r+1;l.setX(d,_),d++,l.setX(d,T),d++,l.setX(d,w),d++,l.setX(d,T),d++,l.setX(d,b),d++,l.setX(d,w),d++}if(this.setIndex(l),this.addAttribute("position",u),this.addAttribute("uv",h),this.computeVertexNormals(),i===2*Math.PI){var R=this.attributes.normal.array,x=new THREE.Vector3,H=new THREE.Vector3,M=new THREE.Vector3;for(r=e*t.length*3,o=0,a=0;o<t.length;o++,a+=3)x.x=R[a+0],x.y=R[a+1],x.z=R[a+2],H.x=R[r+a+0],H.y=R[r+a+1],H.z=R[r+a+2],M.addVectors(x,H).normalize(),R[a+0]=R[r+a+0]=M.x,R[a+1]=R[r+a+1]=M.y,R[a+2]=R[r+a+2]=M.z}},THREE.LatheBufferGeometry.prototype=Object.create(THREE.BufferGeometry.prototype),THREE.LatheBufferGeometry.prototype.constructor=THREE.LatheBufferGeometry,THREE.LatheGeometry=function(t,e,n,i){THREE.Geometry.call(this),this.type="LatheGeometry",this.parameters={points:t,segments:e,phiStart:n,phiLength:i},this.fromBufferGeometry(new THREE.LatheBufferGeometry(t,e,n,i)),this.mergeVertices()},THREE.LatheGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.LatheGeometry.prototype.constructor=THREE.LatheGeometry,THREE.PlaneGeometry=function(t,e,n,i){THREE.Geometry.call(this),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:n,heightSegments:i},this.fromBufferGeometry(new THREE.PlaneBufferGeometry(t,e,n,i))},THREE.PlaneGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.PlaneGeometry.prototype.constructor=THREE.PlaneGeometry,THREE.PlaneBufferGeometry=function(t,e,n,i){THREE.BufferGeometry.call(this),this.type="PlaneBufferGeometry",this.parameters={width:t,height:e,widthSegments:n,heightSegments:i};for(var r=t/2,o=e/2,a=Math.floor(n)||1,s=Math.floor(i)||1,c=a+1,l=s+1,u=t/a,h=e/s,p=new Float32Array(c*l*3),d=new Float32Array(c*l*3),f=new Float32Array(c*l*2),m=0,v=0,g=0;g<l;g++)for(var y=g*h-o,E=0;E<c;E++){var _=E*u-r;p[m]=_,p[m+1]=-y,d[m+2]=1,f[v]=E/a,f[v+1]=1-g/s,m+=3,v+=2}m=0;for(var T=new(p.length/3>65535?Uint32Array:Uint16Array)(a*s*6),g=0;g<s;g++)for(var E=0;E<a;E++){var b=E+c*g,w=E+c*(g+1),R=E+1+c*(g+1),x=E+1+c*g;T[m]=b,T[m+1]=w,T[m+2]=x,T[m+3]=w,T[m+4]=R,T[m+5]=x,m+=6}this.setIndex(new THREE.BufferAttribute(T,1)),this.addAttribute("position",new THREE.BufferAttribute(p,3)),this.addAttribute("normal",new THREE.BufferAttribute(d,3)),this.addAttribute("uv",new THREE.BufferAttribute(f,2))},THREE.PlaneBufferGeometry.prototype=Object.create(THREE.BufferGeometry.prototype),THREE.PlaneBufferGeometry.prototype.constructor=THREE.PlaneBufferGeometry,THREE.RingBufferGeometry=function(t,e,n,i,r,o){THREE.BufferGeometry.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:n,phiSegments:i,thetaStart:r,thetaLength:o},t=t||20,e=e||50,r=void 0!==r?r:0,o=void 0!==o?o:2*Math.PI,n=void 0!==n?Math.max(3,n):8,i=void 0!==i?Math.max(1,i):1;var a,s,c,l=(n+1)*(i+1),u=n*i*2*3,h=new THREE.BufferAttribute(new(u>65535?Uint32Array:Uint16Array)(u),1),p=new THREE.BufferAttribute(new Float32Array(3*l),3),d=new THREE.BufferAttribute(new Float32Array(3*l),3),f=new THREE.BufferAttribute(new Float32Array(2*l),2),m=0,v=0,g=t,y=(e-t)/i,E=new THREE.Vector3,_=new THREE.Vector2;for(s=0;s<=i;s++){for(c=0;c<=n;c++)a=r+c/n*o,E.x=g*Math.cos(a),E.y=g*Math.sin(a),p.setXYZ(m,E.x,E.y,E.z),d.setXYZ(m,0,0,1),_.x=(E.x/e+1)/2,_.y=(E.y/e+1)/2,f.setXY(m,_.x,_.y),m++;g+=y}for(s=0;s<i;s++){var T=s*(n+1);for(c=0;c<n;c++){a=c+T;var b=a,w=a+n+1,R=a+n+2,x=a+1;h.setX(v,b),v++,h.setX(v,w),v++,h.setX(v,R),v++,h.setX(v,b),v++,h.setX(v,R),v++,h.setX(v,x),v++}}this.setIndex(h),this.addAttribute("position",p),this.addAttribute("normal",d),this.addAttribute("uv",f)},THREE.RingBufferGeometry.prototype=Object.create(THREE.BufferGeometry.prototype),THREE.RingBufferGeometry.prototype.constructor=THREE.RingBufferGeometry,THREE.RingGeometry=function(t,e,n,i,r,o){THREE.Geometry.call(this),this.type="RingGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:n,phiSegments:i,thetaStart:r,thetaLength:o},this.fromBufferGeometry(new THREE.RingBufferGeometry(t,e,n,i,r,o))},THREE.RingGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.RingGeometry.prototype.constructor=THREE.RingGeometry,THREE.SphereGeometry=function(t,e,n,i,r,o,a){THREE.Geometry.call(this),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:n,phiStart:i,phiLength:r,thetaStart:o,thetaLength:a},this.fromBufferGeometry(new THREE.SphereBufferGeometry(t,e,n,i,r,o,a))},THREE.SphereGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.SphereGeometry.prototype.constructor=THREE.SphereGeometry,THREE.SphereBufferGeometry=function(t,e,n,i,r,o,a){THREE.BufferGeometry.call(this),this.type="SphereBufferGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:n,phiStart:i,phiLength:r,thetaStart:o,thetaLength:a},t=t||50,e=Math.max(3,Math.floor(e)||8),n=Math.max(2,Math.floor(n)||6),i=void 0!==i?i:0,r=void 0!==r?r:2*Math.PI,o=void 0!==o?o:0,a=void 0!==a?a:Math.PI;for(var s=o+a,c=(e+1)*(n+1),l=new THREE.BufferAttribute(new Float32Array(3*c),3),u=new THREE.BufferAttribute(new Float32Array(3*c),3),h=new THREE.BufferAttribute(new Float32Array(2*c),2),p=0,d=[],f=new THREE.Vector3,m=0;m<=n;m++){for(var v=[],g=m/n,y=0;y<=e;y++){var E=y/e,_=-t*Math.cos(i+E*r)*Math.sin(o+g*a),T=t*Math.cos(o+g*a),b=t*Math.sin(i+E*r)*Math.sin(o+g*a);f.set(_,T,b).normalize(),l.setXYZ(p,_,T,b),u.setXYZ(p,f.x,f.y,f.z),h.setXY(p,E,1-g),v.push(p),p++}d.push(v)}for(var w=[],m=0;m<n;m++)for(var y=0;y<e;y++){var R=d[m][y+1],x=d[m][y],H=d[m+1][y],M=d[m+1][y+1];(0!==m||o>0)&&w.push(R,x,M),(m!==n-1||s<Math.PI)&&w.push(x,H,M)}this.setIndex(new(l.count>65535?THREE.Uint32Attribute:THREE.Uint16Attribute)(w,1)),this.addAttribute("position",l),this.addAttribute("normal",u),this.addAttribute("uv",h),this.boundingSphere=new THREE.Sphere(new THREE.Vector3,t)},THREE.SphereBufferGeometry.prototype=Object.create(THREE.BufferGeometry.prototype),THREE.SphereBufferGeometry.prototype.constructor=THREE.SphereBufferGeometry,THREE.TextGeometry=function(t,e){e=e||{};var n=e.font;if(n instanceof THREE.Font==!1)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new THREE.Geometry;var i=n.generateShapes(t,e.size,e.curveSegments);e.amount=void 0!==e.height?e.height:50,void 0===e.bevelThickness&&(e.bevelThickness=10),void 0===e.bevelSize&&(e.bevelSize=8),void 0===e.bevelEnabled&&(e.bevelEnabled=!1),THREE.ExtrudeGeometry.call(this,i,e),this.type="TextGeometry"},THREE.TextGeometry.prototype=Object.create(THREE.ExtrudeGeometry.prototype),THREE.TextGeometry.prototype.constructor=THREE.TextGeometry,THREE.TorusBufferGeometry=function(t,e,n,i,r){THREE.BufferGeometry.call(this),this.type="TorusBufferGeometry",this.parameters={radius:t,tube:e,radialSegments:n,tubularSegments:i,arc:r},t=t||100,e=e||40,n=Math.floor(n)||8,i=Math.floor(i)||6,r=r||2*Math.PI;var o,a,s=(n+1)*(i+1),c=n*i*2*3,l=new(c>65535?Uint32Array:Uint16Array)(c),u=new Float32Array(3*s),h=new Float32Array(3*s),p=new Float32Array(2*s),d=0,f=0,m=0,v=new THREE.Vector3,g=new THREE.Vector3,y=new THREE.Vector3;for(o=0;o<=n;o++)for(a=0;a<=i;a++){var E=a/i*r,_=o/n*Math.PI*2;g.x=(t+e*Math.cos(_))*Math.cos(E),g.y=(t+e*Math.cos(_))*Math.sin(E),g.z=e*Math.sin(_),u[d]=g.x,u[d+1]=g.y,u[d+2]=g.z,v.x=t*Math.cos(E),v.y=t*Math.sin(E),y.subVectors(g,v).normalize(),h[d]=y.x,h[d+1]=y.y,h[d+2]=y.z,p[f]=a/i,p[f+1]=o/n,d+=3,f+=2}for(o=1;o<=n;o++)for(a=1;a<=i;a++){var T=(i+1)*o+a-1,b=(i+1)*(o-1)+a-1,w=(i+1)*(o-1)+a,R=(i+1)*o+a;l[m]=T,l[m+1]=b,l[m+2]=R,l[m+3]=b,l[m+4]=w,l[m+5]=R,m+=6}this.setIndex(new THREE.BufferAttribute(l,1)),this.addAttribute("position",new THREE.BufferAttribute(u,3)),this.addAttribute("normal",new THREE.BufferAttribute(h,3)),this.addAttribute("uv",new THREE.BufferAttribute(p,2))},THREE.TorusBufferGeometry.prototype=Object.create(THREE.BufferGeometry.prototype),THREE.TorusBufferGeometry.prototype.constructor=THREE.TorusBufferGeometry,THREE.TorusGeometry=function(t,e,n,i,r){THREE.Geometry.call(this),this.type="TorusGeometry",this.parameters={radius:t,tube:e,radialSegments:n,tubularSegments:i,arc:r},this.fromBufferGeometry(new THREE.TorusBufferGeometry(t,e,n,i,r))},THREE.TorusGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.TorusGeometry.prototype.constructor=THREE.TorusGeometry,THREE.TorusKnotBufferGeometry=function(t,e,n,i,r,o){function a(t,e,n,i,r){var o=Math.cos(t),a=Math.sin(t),s=n/e*t,c=Math.cos(s);r.x=i*(2+c)*.5*o,r.y=i*(2+c)*a*.5,r.z=i*Math.sin(s)*.5}THREE.BufferGeometry.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:t,tube:e,tubularSegments:n,radialSegments:i,p:r,q:o},t=t||100,e=e||40,n=Math.floor(n)||64,i=Math.floor(i)||8,r=r||2,o=o||3;var s,c,l=(i+1)*(n+1),u=i*n*2*3,h=new THREE.BufferAttribute(new(u>65535?Uint32Array:Uint16Array)(u),1),p=new THREE.BufferAttribute(new Float32Array(3*l),3),d=new THREE.BufferAttribute(new Float32Array(3*l),3),f=new THREE.BufferAttribute(new Float32Array(2*l),2),m=0,v=0,g=new THREE.Vector3,y=new THREE.Vector3,E=new THREE.Vector2,_=new THREE.Vector3,T=new THREE.Vector3,b=new THREE.Vector3,w=new THREE.Vector3,R=new THREE.Vector3;for(s=0;s<=n;++s){var x=s/n*r*Math.PI*2;for(a(x,r,o,t,_),a(x+.01,r,o,t,T),w.subVectors(T,_),R.addVectors(T,_),b.crossVectors(w,R),R.crossVectors(b,w),b.normalize(),R.normalize(),c=0;c<=i;++c){var H=c/i*Math.PI*2,M=-e*Math.cos(H),S=e*Math.sin(H);g.x=_.x+(M*R.x+S*b.x),g.y=_.y+(M*R.y+S*b.y),g.z=_.z+(M*R.z+S*b.z),p.setXYZ(m,g.x,g.y,g.z),y.subVectors(g,_).normalize(),d.setXYZ(m,y.x,y.y,y.z),E.x=s/n,E.y=c/i,f.setXY(m,E.x,E.y),m++}}for(c=1;c<=n;c++)for(s=1;s<=i;s++){var C=(i+1)*(c-1)+(s-1),A=(i+1)*c+(s-1),P=(i+1)*c+s,L=(i+1)*(c-1)+s;h.setX(v,C),v++,h.setX(v,A),v++,h.setX(v,L),v++,h.setX(v,A),v++,h.setX(v,P),v++,h.setX(v,L),v++}this.setIndex(h),this.addAttribute("position",p),this.addAttribute("normal",d),this.addAttribute("uv",f)},THREE.TorusKnotBufferGeometry.prototype=Object.create(THREE.BufferGeometry.prototype),THREE.TorusKnotBufferGeometry.prototype.constructor=THREE.TorusKnotBufferGeometry,THREE.TorusKnotGeometry=function(t,e,n,i,r,o,a){THREE.Geometry.call(this),this.type="TorusKnotGeometry",this.parameters={radius:t,tube:e,tubularSegments:n,radialSegments:i,p:r,q:o},void 0!==a&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new THREE.TorusKnotBufferGeometry(t,e,n,i,r,o)),this.mergeVertices()},THREE.TorusKnotGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.TorusKnotGeometry.prototype.constructor=THREE.TorusKnotGeometry,THREE.TubeGeometry=function(t,e,n,i,r,o){function a(t,e,n){return C.vertices.push(new THREE.Vector3(t,e,n))-1}THREE.Geometry.call(this),this.type="TubeGeometry",this.parameters={path:t,segments:e,radius:n,radialSegments:i,closed:r,taper:o},e=e||64,n=n||1,i=i||8,r=r||!1,o=o||THREE.TubeGeometry.NoTaper;var s,c,l,u,h,p,d,f,m,v,g,y,E,_,T,b,w,R,x,H,M,S=[],C=this,A=e+1,P=new THREE.Vector3,L=new THREE.TubeGeometry.FrenetFrames(t,e,r),O=L.tangents,j=L.normals,k=L.binormals;for(this.tangents=O,this.normals=j,this.binormals=k,v=0;v<A;v++)for(S[v]=[],u=v/(A-1),m=t.getPointAt(u),s=O[v],c=j[v],l=k[v],p=n*o(u),g=0;g<i;g++)h=g/i*2*Math.PI,d=-p*Math.cos(h),f=p*Math.sin(h),P.copy(m),P.x+=d*c.x+f*l.x,P.y+=d*c.y+f*l.y,P.z+=d*c.z+f*l.z,S[v][g]=a(P.x,P.y,P.z);for(v=0;v<e;v++)for(g=0;g<i;g++)y=r?(v+1)%e:v+1,E=(g+1)%i,_=S[v][g],T=S[y][g],b=S[y][E],w=S[v][E],R=new THREE.Vector2(v/e,g/i),x=new THREE.Vector2((v+1)/e,g/i),H=new THREE.Vector2((v+1)/e,(g+1)/i),M=new THREE.Vector2(v/e,(g+1)/i),this.faces.push(new THREE.Face3(_,T,w)),this.faceVertexUvs[0].push([R,x,M]),this.faces.push(new THREE.Face3(T,b,w)),this.faceVertexUvs[0].push([x.clone(),H,M.clone()]);this.computeFaceNormals(),this.computeVertexNormals()},THREE.TubeGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.TubeGeometry.prototype.constructor=THREE.TubeGeometry,THREE.TubeGeometry.NoTaper=function(t){return 1},THREE.TubeGeometry.SinusoidalTaper=function(t){return Math.sin(Math.PI*t)},THREE.TubeGeometry.FrenetFrames=function(t,e,n){function i(){d[0]=new THREE.Vector3,f[0]=new THREE.Vector3,o=Number.MAX_VALUE,a=Math.abs(p[0].x),s=Math.abs(p[0].y),c=Math.abs(p[0].z),a<=o&&(o=a,h.set(1,0,0)),s<=o&&(o=s,h.set(0,1,0)),c<=o&&h.set(0,0,1),m.crossVectors(p[0],h).normalize(),d[0].crossVectors(p[0],m),f[0].crossVectors(p[0],d[0])}var r,o,a,s,c,l,u,h=new THREE.Vector3,p=[],d=[],f=[],m=new THREE.Vector3,v=new THREE.Matrix4,g=e+1;for(this.tangents=p,this.normals=d,this.binormals=f,l=0;l<g;l++)u=l/(g-1),p[l]=t.getTangentAt(u),p[l].normalize();for(i(),l=1;l<g;l++)d[l]=d[l-1].clone(),f[l]=f[l-1].clone(),m.crossVectors(p[l-1],p[l]),m.length()>Number.EPSILON&&(m.normalize(),r=Math.acos(THREE.Math.clamp(p[l-1].dot(p[l]),-1,1)),d[l].applyMatrix4(v.makeRotationAxis(m,r))),f[l].crossVectors(p[l],d[l]);if(n)for(r=Math.acos(THREE.Math.clamp(d[0].dot(d[g-1]),-1,1)),r/=g-1,p[0].dot(m.crossVectors(d[0],d[g-1]))>0&&(r=-r),l=1;l<g;l++)d[l].applyMatrix4(v.makeRotationAxis(p[l],r*l)),f[l].crossVectors(p[l],d[l])},THREE.PolyhedronGeometry=function(t,e,n,i){function r(t){var e=t.normalize().clone();e.index=u.vertices.push(e)-1;var n=s(t)/2/Math.PI+.5,i=c(t)/Math.PI+.5;return e.uv=new THREE.Vector2(n,1-i),e}function o(t,e,n,i){var r=new THREE.Face3(t.index,e.index,n.index,[t.clone(),e.clone(),n.clone()],(void 0),i);u.faces.push(r),E.copy(t).add(e).add(n).divideScalar(3);var o=s(E);u.faceVertexUvs[0].push([l(t.uv,t,o),l(e.uv,e,o),l(n.uv,n,o)])}function a(t,e){for(var n=Math.pow(2,e),i=r(u.vertices[t.a]),a=r(u.vertices[t.b]),s=r(u.vertices[t.c]),c=[],l=t.materialIndex,h=0;h<=n;h++){c[h]=[];for(var p=r(i.clone().lerp(s,h/n)),d=r(a.clone().lerp(s,h/n)),f=n-h,m=0;m<=f;m++)0===m&&h===n?c[h][m]=p:c[h][m]=r(p.clone().lerp(d,m/f))}for(var h=0;h<n;h++)for(var m=0;m<2*(n-h)-1;m++){var v=Math.floor(m/2);m%2===0?o(c[h][v+1],c[h+1][v],c[h][v],l):o(c[h][v+1],c[h+1][v+1],c[h+1][v],l)}}function s(t){return Math.atan2(t.z,-t.x)}function c(t){return Math.atan2(-t.y,Math.sqrt(t.x*t.x+t.z*t.z))}function l(t,e,n){return n<0&&1===t.x&&(t=new THREE.Vector2(t.x-1,t.y)),0===e.x&&0===e.z&&(t=new THREE.Vector2(n/2/Math.PI+.5,t.y)),t.clone()}THREE.Geometry.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:t,indices:e,radius:n,detail:i},n=n||1,i=i||0;for(var u=this,h=0,p=t.length;h<p;h+=3)r(new THREE.Vector3(t[h],t[h+1],t[h+2]));for(var d=this.vertices,f=[],h=0,m=0,p=e.length;h<p;h+=3,m++){var v=d[e[h]],g=d[e[h+1]],y=d[e[h+2]];f[m]=new THREE.Face3(v.index,g.index,y.index,[v.clone(),g.clone(),y.clone()],(void 0),m)}for(var E=new THREE.Vector3,h=0,p=f.length;h<p;h++)a(f[h],i);for(var h=0,p=this.faceVertexUvs[0].length;h<p;h++){var _=this.faceVertexUvs[0][h],T=_[0].x,b=_[1].x,w=_[2].x,R=Math.max(T,b,w),x=Math.min(T,b,w);R>.9&&x<.1&&(T<.2&&(_[0].x+=1),b<.2&&(_[1].x+=1),w<.2&&(_[2].x+=1))}for(var h=0,p=this.vertices.length;h<p;h++)this.vertices[h].multiplyScalar(n);this.mergeVertices(),this.computeFaceNormals(),this.boundingSphere=new THREE.Sphere(new THREE.Vector3,n)},THREE.PolyhedronGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.PolyhedronGeometry.prototype.constructor=THREE.PolyhedronGeometry,THREE.DodecahedronGeometry=function(t,e){var n=(1+Math.sqrt(5))/2,i=1/n,r=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-i,-n,0,-i,n,0,i,-n,0,i,n,-i,-n,0,-i,n,0,i,-n,0,i,n,0,-n,0,-i,n,0,-i,-n,0,i,n,0,i],o=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];THREE.PolyhedronGeometry.call(this,r,o,t,e),this.type="DodecahedronGeometry",this.parameters={radius:t,detail:e}},THREE.DodecahedronGeometry.prototype=Object.create(THREE.PolyhedronGeometry.prototype),THREE.DodecahedronGeometry.prototype.constructor=THREE.DodecahedronGeometry,THREE.IcosahedronGeometry=function(t,e){var n=(1+Math.sqrt(5))/2,i=[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],r=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];THREE.PolyhedronGeometry.call(this,i,r,t,e),this.type="IcosahedronGeometry",this.parameters={radius:t,detail:e}},THREE.IcosahedronGeometry.prototype=Object.create(THREE.PolyhedronGeometry.prototype),THREE.IcosahedronGeometry.prototype.constructor=THREE.IcosahedronGeometry,THREE.OctahedronGeometry=function(t,e){var n=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],i=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];THREE.PolyhedronGeometry.call(this,n,i,t,e),this.type="OctahedronGeometry",this.parameters={radius:t,detail:e}},THREE.OctahedronGeometry.prototype=Object.create(THREE.PolyhedronGeometry.prototype),THREE.OctahedronGeometry.prototype.constructor=THREE.OctahedronGeometry,THREE.TetrahedronGeometry=function(t,e){var n=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],i=[2,1,0,0,3,2,1,3,0,2,3,1];THREE.PolyhedronGeometry.call(this,n,i,t,e),this.type="TetrahedronGeometry",this.parameters={radius:t,detail:e}},THREE.TetrahedronGeometry.prototype=Object.create(THREE.PolyhedronGeometry.prototype),THREE.TetrahedronGeometry.prototype.constructor=THREE.TetrahedronGeometry,THREE.ParametricGeometry=function(t,e,n){THREE.Geometry.call(this),this.type="ParametricGeometry",this.parameters={func:t,slices:e,stacks:n};var i,r,o,a,s,c=this.vertices,l=this.faces,u=this.faceVertexUvs[0],h=e+1;for(i=0;i<=n;i++)for(s=i/n,r=0;r<=e;r++)a=r/e,o=t(a,s),c.push(o);var p,d,f,m,v,g,y,E;for(i=0;i<n;i++)for(r=0;r<e;r++)p=i*h+r,d=i*h+r+1,f=(i+1)*h+r+1,m=(i+1)*h+r,v=new THREE.Vector2(r/e,i/n),g=new THREE.Vector2((r+1)/e,i/n),y=new THREE.Vector2((r+1)/e,(i+1)/n),E=new THREE.Vector2(r/e,(i+1)/n),l.push(new THREE.Face3(p,d,m)),u.push([v,g,E]),l.push(new THREE.Face3(d,f,m)),u.push([g.clone(),y,E.clone()]);this.computeFaceNormals(),this.computeVertexNormals()},THREE.ParametricGeometry.prototype=Object.create(THREE.Geometry.prototype),
THREE.ParametricGeometry.prototype.constructor=THREE.ParametricGeometry,THREE.WireframeGeometry=function(t){function e(t,e){return t-e}THREE.BufferGeometry.call(this);var n=[0,0],i={},r=["a","b","c"];if(t instanceof THREE.Geometry){for(var o=t.vertices,a=t.faces,s=0,c=new Uint32Array(6*a.length),l=0,u=a.length;l<u;l++)for(var h=a[l],p=0;p<3;p++){n[0]=h[r[p]],n[1]=h[r[(p+1)%3]],n.sort(e);var d=n.toString();void 0===i[d]&&(c[2*s]=n[0],c[2*s+1]=n[1],i[d]=!0,s++)}for(var f=new Float32Array(2*s*3),l=0,u=s;l<u;l++)for(var p=0;p<2;p++){var m=o[c[2*l+p]],v=6*l+3*p;f[v+0]=m.x,f[v+1]=m.y,f[v+2]=m.z}this.addAttribute("position",new THREE.BufferAttribute(f,3))}else if(t instanceof THREE.BufferGeometry)if(null!==t.index){var g=t.index.array,o=t.attributes.position,y=t.groups,s=0;0===y.length&&t.addGroup(0,g.length);for(var c=new Uint32Array(2*g.length),E=0,_=y.length;E<_;++E)for(var T=y[E],b=T.start,w=T.count,l=b,R=b+w;l<R;l+=3)for(var p=0;p<3;p++){n[0]=g[l+p],n[1]=g[l+(p+1)%3],n.sort(e);var d=n.toString();void 0===i[d]&&(c[2*s]=n[0],c[2*s+1]=n[1],i[d]=!0,s++)}for(var f=new Float32Array(2*s*3),l=0,u=s;l<u;l++)for(var p=0;p<2;p++){var v=6*l+3*p,x=c[2*l+p];f[v+0]=o.getX(x),f[v+1]=o.getY(x),f[v+2]=o.getZ(x)}this.addAttribute("position",new THREE.BufferAttribute(f,3))}else{for(var o=t.attributes.position.array,s=o.length/3,H=s/3,f=new Float32Array(2*s*3),l=0,u=H;l<u;l++)for(var p=0;p<3;p++){var v=18*l+6*p,M=9*l+3*p;f[v+0]=o[M],f[v+1]=o[M+1],f[v+2]=o[M+2];var x=9*l+3*((p+1)%3);f[v+3]=o[x],f[v+4]=o[x+1],f[v+5]=o[x+2]}this.addAttribute("position",new THREE.BufferAttribute(f,3))}},THREE.WireframeGeometry.prototype=Object.create(THREE.BufferGeometry.prototype),THREE.WireframeGeometry.prototype.constructor=THREE.WireframeGeometry,THREE.AxisHelper=function(t){t=t||1;var e=new Float32Array([0,0,0,t,0,0,0,0,0,0,t,0,0,0,0,0,0,t]),n=new Float32Array([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1]),i=new THREE.BufferGeometry;i.addAttribute("position",new THREE.BufferAttribute(e,3)),i.addAttribute("color",new THREE.BufferAttribute(n,3));var r=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors});THREE.LineSegments.call(this,i,r)},THREE.AxisHelper.prototype=Object.create(THREE.LineSegments.prototype),THREE.AxisHelper.prototype.constructor=THREE.AxisHelper,THREE.ArrowHelper=function(){var t=new THREE.Geometry;t.vertices.push(new THREE.Vector3(0,0,0),new THREE.Vector3(0,1,0));var e=new THREE.CylinderGeometry(0,.5,1,5,1);return e.translate(0,-.5,0),function(n,i,r,o,a,s){THREE.Object3D.call(this),void 0===o&&(o=16776960),void 0===r&&(r=1),void 0===a&&(a=.2*r),void 0===s&&(s=.2*a),this.position.copy(i),this.line=new THREE.Line(t,new THREE.LineBasicMaterial({color:o})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new THREE.Mesh(e,new THREE.MeshBasicMaterial({color:o})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(n),this.setLength(r,a,s)}}(),THREE.ArrowHelper.prototype=Object.create(THREE.Object3D.prototype),THREE.ArrowHelper.prototype.constructor=THREE.ArrowHelper,THREE.ArrowHelper.prototype.setDirection=function(){var t,e=new THREE.Vector3;return function(n){n.y>.99999?this.quaternion.set(0,0,0,1):n.y<-.99999?this.quaternion.set(1,0,0,0):(e.set(n.z,0,-n.x).normalize(),t=Math.acos(n.y),this.quaternion.setFromAxisAngle(e,t))}}(),THREE.ArrowHelper.prototype.setLength=function(t,e,n){void 0===e&&(e=.2*t),void 0===n&&(n=.2*e),this.line.scale.set(1,Math.max(0,t-e),1),this.line.updateMatrix(),this.cone.scale.set(n,e,n),this.cone.position.y=t,this.cone.updateMatrix()},THREE.ArrowHelper.prototype.setColor=function(t){this.line.material.color.set(t),this.cone.material.color.set(t)},THREE.BoxHelper=function(t){var e=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),n=new Float32Array(24),i=new THREE.BufferGeometry;i.setIndex(new THREE.BufferAttribute(e,1)),i.addAttribute("position",new THREE.BufferAttribute(n,3)),THREE.LineSegments.call(this,i,new THREE.LineBasicMaterial({color:16776960})),void 0!==t&&this.update(t)},THREE.BoxHelper.prototype=Object.create(THREE.LineSegments.prototype),THREE.BoxHelper.prototype.constructor=THREE.BoxHelper,THREE.BoxHelper.prototype.update=function(){var t=new THREE.Box3;return function(e){if(e instanceof THREE.Box3?t.copy(e):t.setFromObject(e),!t.isEmpty()){var n=t.min,i=t.max,r=this.geometry.attributes.position,o=r.array;o[0]=i.x,o[1]=i.y,o[2]=i.z,o[3]=n.x,o[4]=i.y,o[5]=i.z,o[6]=n.x,o[7]=n.y,o[8]=i.z,o[9]=i.x,o[10]=n.y,o[11]=i.z,o[12]=i.x,o[13]=i.y,o[14]=n.z,o[15]=n.x,o[16]=i.y,o[17]=n.z,o[18]=n.x,o[19]=n.y,o[20]=n.z,o[21]=i.x,o[22]=n.y,o[23]=n.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere()}}}(),THREE.BoundingBoxHelper=function(t,e){var n=void 0!==e?e:8947848;this.object=t,this.box=new THREE.Box3,THREE.Mesh.call(this,new THREE.BoxGeometry(1,1,1),new THREE.MeshBasicMaterial({color:n,wireframe:!0}))},THREE.BoundingBoxHelper.prototype=Object.create(THREE.Mesh.prototype),THREE.BoundingBoxHelper.prototype.constructor=THREE.BoundingBoxHelper,THREE.BoundingBoxHelper.prototype.update=function(){this.box.setFromObject(this.object),this.box.size(this.scale),this.box.center(this.position)},THREE.CameraHelper=function(t){function e(t,e,i){n(t,i),n(e,i)}function n(t,e){i.vertices.push(new THREE.Vector3),i.colors.push(new THREE.Color(e)),void 0===o[t]&&(o[t]=[]),o[t].push(i.vertices.length-1)}var i=new THREE.Geometry,r=new THREE.LineBasicMaterial({color:16777215,vertexColors:THREE.FaceColors}),o={},a=16755200,s=16711680,c=43775,l=16777215,u=3355443;e("n1","n2",a),e("n2","n4",a),e("n4","n3",a),e("n3","n1",a),e("f1","f2",a),e("f2","f4",a),e("f4","f3",a),e("f3","f1",a),e("n1","f1",a),e("n2","f2",a),e("n3","f3",a),e("n4","f4",a),e("p","n1",s),e("p","n2",s),e("p","n3",s),e("p","n4",s),e("u1","u2",c),e("u2","u3",c),e("u3","u1",c),e("c","t",l),e("p","c",u),e("cn1","cn2",u),e("cn3","cn4",u),e("cf1","cf2",u),e("cf3","cf4",u),THREE.LineSegments.call(this,i,r),this.camera=t,this.camera.updateProjectionMatrix(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update()},THREE.CameraHelper.prototype=Object.create(THREE.LineSegments.prototype),THREE.CameraHelper.prototype.constructor=THREE.CameraHelper,THREE.CameraHelper.prototype.update=function(){function t(t,o,a,s){i.set(o,a,s).unproject(r);var c=n[t];if(void 0!==c)for(var l=0,u=c.length;l<u;l++)e.vertices[c[l]].copy(i)}var e,n,i=new THREE.Vector3,r=new THREE.Camera;return function(){e=this.geometry,n=this.pointMap;var i=1,o=1;r.projectionMatrix.copy(this.camera.projectionMatrix),t("c",0,0,-1),t("t",0,0,1),t("n1",-i,-o,-1),t("n2",i,-o,-1),t("n3",-i,o,-1),t("n4",i,o,-1),t("f1",-i,-o,1),t("f2",i,-o,1),t("f3",-i,o,1),t("f4",i,o,1),t("u1",.7*i,1.1*o,-1),t("u2",.7*-i,1.1*o,-1),t("u3",0,2*o,-1),t("cf1",-i,0,1),t("cf2",i,0,1),t("cf3",0,-o,1),t("cf4",0,o,1),t("cn1",-i,0,-1),t("cn2",i,0,-1),t("cn3",0,-o,-1),t("cn4",0,o,-1),e.verticesNeedUpdate=!0}}(),THREE.DirectionalLightHelper=function(t,e){THREE.Object3D.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,e=e||1;var n=new THREE.Geometry;n.vertices.push(new THREE.Vector3((-e),e,0),new THREE.Vector3(e,e,0),new THREE.Vector3(e,(-e),0),new THREE.Vector3((-e),(-e),0),new THREE.Vector3((-e),e,0));var i=new THREE.LineBasicMaterial({fog:!1});i.color.copy(this.light.color).multiplyScalar(this.light.intensity),this.lightPlane=new THREE.Line(n,i),this.add(this.lightPlane),n=new THREE.Geometry,n.vertices.push(new THREE.Vector3,new THREE.Vector3),i=new THREE.LineBasicMaterial({fog:!1}),i.color.copy(this.light.color).multiplyScalar(this.light.intensity),this.targetLine=new THREE.Line(n,i),this.add(this.targetLine),this.update()},THREE.DirectionalLightHelper.prototype=Object.create(THREE.Object3D.prototype),THREE.DirectionalLightHelper.prototype.constructor=THREE.DirectionalLightHelper,THREE.DirectionalLightHelper.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},THREE.DirectionalLightHelper.prototype.update=function(){var t=new THREE.Vector3,e=new THREE.Vector3,n=new THREE.Vector3;return function(){t.setFromMatrixPosition(this.light.matrixWorld),e.setFromMatrixPosition(this.light.target.matrixWorld),n.subVectors(e,t),this.lightPlane.lookAt(n),this.lightPlane.material.color.copy(this.light.color).multiplyScalar(this.light.intensity),this.targetLine.geometry.vertices[1].copy(n),this.targetLine.geometry.verticesNeedUpdate=!0,this.targetLine.material.color.copy(this.lightPlane.material.color)}}(),THREE.EdgesHelper=function(t,e,n){var i=void 0!==e?e:16777215;THREE.LineSegments.call(this,new THREE.EdgesGeometry(t.geometry,n),new THREE.LineBasicMaterial({color:i})),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1},THREE.EdgesHelper.prototype=Object.create(THREE.LineSegments.prototype),THREE.EdgesHelper.prototype.constructor=THREE.EdgesHelper,THREE.FaceNormalsHelper=function(t,e,n,i){this.object=t,this.size=void 0!==e?e:1;var r=void 0!==n?n:16776960,o=void 0!==i?i:1,a=0,s=this.object.geometry;s instanceof THREE.Geometry?a=s.faces.length:console.warn("THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead.");var c=new THREE.BufferGeometry,l=new THREE.Float32Attribute(2*a*3,3);c.addAttribute("position",l),THREE.LineSegments.call(this,c,new THREE.LineBasicMaterial({color:r,linewidth:o})),this.matrixAutoUpdate=!1,this.update()},THREE.FaceNormalsHelper.prototype=Object.create(THREE.LineSegments.prototype),THREE.FaceNormalsHelper.prototype.constructor=THREE.FaceNormalsHelper,THREE.FaceNormalsHelper.prototype.update=function(){var t=new THREE.Vector3,e=new THREE.Vector3,n=new THREE.Matrix3;return function(){this.object.updateMatrixWorld(!0),n.getNormalMatrix(this.object.matrixWorld);for(var i=this.object.matrixWorld,r=this.geometry.attributes.position,o=this.object.geometry,a=o.vertices,s=o.faces,c=0,l=0,u=s.length;l<u;l++){var h=s[l],p=h.normal;t.copy(a[h.a]).add(a[h.b]).add(a[h.c]).divideScalar(3).applyMatrix4(i),e.copy(p).applyMatrix3(n).normalize().multiplyScalar(this.size).add(t),r.setXYZ(c,t.x,t.y,t.z),c+=1,r.setXYZ(c,e.x,e.y,e.z),c+=1}return r.needsUpdate=!0,this}}(),THREE.GridHelper=function(t,e){var n=new THREE.Geometry,i=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors});this.color1=new THREE.Color(4473924),this.color2=new THREE.Color(8947848);for(var r=-t;r<=t;r+=e){n.vertices.push(new THREE.Vector3((-t),0,r),new THREE.Vector3(t,0,r),new THREE.Vector3(r,0,(-t)),new THREE.Vector3(r,0,t));var o=0===r?this.color1:this.color2;n.colors.push(o,o,o,o)}THREE.LineSegments.call(this,n,i)},THREE.GridHelper.prototype=Object.create(THREE.LineSegments.prototype),THREE.GridHelper.prototype.constructor=THREE.GridHelper,THREE.GridHelper.prototype.setColors=function(t,e){this.color1.set(t),this.color2.set(e),this.geometry.colorsNeedUpdate=!0},THREE.HemisphereLightHelper=function(t,e){THREE.Object3D.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.colors=[new THREE.Color,new THREE.Color];var n=new THREE.SphereGeometry(e,4,2);n.rotateX(-Math.PI/2);for(var i=0,r=8;i<r;i++)n.faces[i].color=this.colors[i<4?0:1];var o=new THREE.MeshBasicMaterial({vertexColors:THREE.FaceColors,wireframe:!0});this.lightSphere=new THREE.Mesh(n,o),this.add(this.lightSphere),this.update()},THREE.HemisphereLightHelper.prototype=Object.create(THREE.Object3D.prototype),THREE.HemisphereLightHelper.prototype.constructor=THREE.HemisphereLightHelper,THREE.HemisphereLightHelper.prototype.dispose=function(){this.lightSphere.geometry.dispose(),this.lightSphere.material.dispose()},THREE.HemisphereLightHelper.prototype.update=function(){var t=new THREE.Vector3;return function(){this.colors[0].copy(this.light.color).multiplyScalar(this.light.intensity),this.colors[1].copy(this.light.groundColor).multiplyScalar(this.light.intensity),this.lightSphere.lookAt(t.setFromMatrixPosition(this.light.matrixWorld).negate()),this.lightSphere.geometry.colorsNeedUpdate=!0}}(),THREE.PointLightHelper=function(t,e){this.light=t,this.light.updateMatrixWorld();var n=new THREE.SphereGeometry(e,4,2),i=new THREE.MeshBasicMaterial({wireframe:!0,fog:!1});i.color.copy(this.light.color).multiplyScalar(this.light.intensity),THREE.Mesh.call(this,n,i),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1},THREE.PointLightHelper.prototype=Object.create(THREE.Mesh.prototype),THREE.PointLightHelper.prototype.constructor=THREE.PointLightHelper,THREE.PointLightHelper.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},THREE.PointLightHelper.prototype.update=function(){this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)},THREE.SkeletonHelper=function(t){this.bones=this.getBoneList(t);for(var e=new THREE.Geometry,n=0;n<this.bones.length;n++){var i=this.bones[n];i.parent instanceof THREE.Bone&&(e.vertices.push(new THREE.Vector3),e.vertices.push(new THREE.Vector3),e.colors.push(new THREE.Color(0,0,1)),e.colors.push(new THREE.Color(0,1,0)))}e.dynamic=!0;var r=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors,depthTest:!1,depthWrite:!1,transparent:!0});THREE.LineSegments.call(this,e,r),this.root=t,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.update()},THREE.SkeletonHelper.prototype=Object.create(THREE.LineSegments.prototype),THREE.SkeletonHelper.prototype.constructor=THREE.SkeletonHelper,THREE.SkeletonHelper.prototype.getBoneList=function(t){var e=[];t instanceof THREE.Bone&&e.push(t);for(var n=0;n<t.children.length;n++)e.push.apply(e,this.getBoneList(t.children[n]));return e},THREE.SkeletonHelper.prototype.update=function(){for(var t=this.geometry,e=(new THREE.Matrix4).getInverse(this.root.matrixWorld),n=new THREE.Matrix4,i=0,r=0;r<this.bones.length;r++){var o=this.bones[r];o.parent instanceof THREE.Bone&&(n.multiplyMatrices(e,o.matrixWorld),t.vertices[i].setFromMatrixPosition(n),n.multiplyMatrices(e,o.parent.matrixWorld),t.vertices[i+1].setFromMatrixPosition(n),i+=2)}t.verticesNeedUpdate=!0,t.computeBoundingSphere()},THREE.SpotLightHelper=function(t){THREE.Object3D.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1;for(var e=new THREE.BufferGeometry,n=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],i=0,r=1,o=32;i<o;i++,r++){var a=i/o*Math.PI*2,s=r/o*Math.PI*2;n.push(Math.cos(a),Math.sin(a),1,Math.cos(s),Math.sin(s),1)}e.addAttribute("position",new THREE.Float32Attribute(n,3));var c=new THREE.LineBasicMaterial({fog:!1});this.cone=new THREE.LineSegments(e,c),this.add(this.cone),this.update()},THREE.SpotLightHelper.prototype=Object.create(THREE.Object3D.prototype),THREE.SpotLightHelper.prototype.constructor=THREE.SpotLightHelper,THREE.SpotLightHelper.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},THREE.SpotLightHelper.prototype.update=function(){var t=new THREE.Vector3,e=new THREE.Vector3;return function(){var n=this.light.distance?this.light.distance:1e3,i=n*Math.tan(this.light.angle);this.cone.scale.set(i,i,n),t.setFromMatrixPosition(this.light.matrixWorld),e.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(e.sub(t)),this.cone.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)}}(),THREE.VertexNormalsHelper=function(t,e,n,i){this.object=t,this.size=void 0!==e?e:1;var r=void 0!==n?n:16711680,o=void 0!==i?i:1,a=0,s=this.object.geometry;s instanceof THREE.Geometry?a=3*s.faces.length:s instanceof THREE.BufferGeometry&&(a=s.attributes.normal.count);var c=new THREE.BufferGeometry,l=new THREE.Float32Attribute(2*a*3,3);c.addAttribute("position",l),THREE.LineSegments.call(this,c,new THREE.LineBasicMaterial({color:r,linewidth:o})),this.matrixAutoUpdate=!1,this.update()},THREE.VertexNormalsHelper.prototype=Object.create(THREE.LineSegments.prototype),THREE.VertexNormalsHelper.prototype.constructor=THREE.VertexNormalsHelper,THREE.VertexNormalsHelper.prototype.update=function(){var t=new THREE.Vector3,e=new THREE.Vector3,n=new THREE.Matrix3;return function(){var i=["a","b","c"];this.object.updateMatrixWorld(!0),n.getNormalMatrix(this.object.matrixWorld);var r=this.object.matrixWorld,o=this.geometry.attributes.position,a=this.object.geometry;if(a instanceof THREE.Geometry)for(var s=a.vertices,c=a.faces,l=0,u=0,h=c.length;u<h;u++)for(var p=c[u],d=0,f=p.vertexNormals.length;d<f;d++){var m=s[p[i[d]]],v=p.vertexNormals[d];t.copy(m).applyMatrix4(r),e.copy(v).applyMatrix3(n).normalize().multiplyScalar(this.size).add(t),o.setXYZ(l,t.x,t.y,t.z),l+=1,o.setXYZ(l,e.x,e.y,e.z),l+=1}else if(a instanceof THREE.BufferGeometry)for(var g=a.attributes.position,y=a.attributes.normal,l=0,d=0,f=g.count;d<f;d++)t.set(g.getX(d),g.getY(d),g.getZ(d)).applyMatrix4(r),e.set(y.getX(d),y.getY(d),y.getZ(d)),e.applyMatrix3(n).normalize().multiplyScalar(this.size).add(t),o.setXYZ(l,t.x,t.y,t.z),l+=1,o.setXYZ(l,e.x,e.y,e.z),l+=1;return o.needsUpdate=!0,this}}(),THREE.WireframeHelper=function(t,e){var n=void 0!==e?e:16777215;THREE.LineSegments.call(this,new THREE.WireframeGeometry(t.geometry),new THREE.LineBasicMaterial({color:n})),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1},THREE.WireframeHelper.prototype=Object.create(THREE.LineSegments.prototype),THREE.WireframeHelper.prototype.constructor=THREE.WireframeHelper,THREE.ImmediateRenderObject=function(t){THREE.Object3D.call(this),this.material=t,this.render=function(t){}},THREE.ImmediateRenderObject.prototype=Object.create(THREE.Object3D.prototype),THREE.ImmediateRenderObject.prototype.constructor=THREE.ImmediateRenderObject,THREE.MorphBlendMesh=function(t,e){THREE.Mesh.call(this,t,e),this.animationsMap={},this.animationsList=[];var n=this.geometry.morphTargets.length,i="__default",r=0,o=n-1,a=n/1;this.createAnimation(i,r,o,a),this.setAnimationWeight(i,1)},THREE.MorphBlendMesh.prototype=Object.create(THREE.Mesh.prototype),THREE.MorphBlendMesh.prototype.constructor=THREE.MorphBlendMesh,THREE.MorphBlendMesh.prototype.createAnimation=function(t,e,n,i){var r={start:e,end:n,length:n-e+1,fps:i,duration:(n-e)/i,lastFrame:0,currentFrame:0,active:!1,time:0,direction:1,weight:1,directionBackwards:!1,mirroredLoop:!1};this.animationsMap[t]=r,this.animationsList.push(r)},THREE.MorphBlendMesh.prototype.autoCreateAnimations=function(t){for(var e,n=/([a-z]+)_?(\d+)/i,i={},r=this.geometry,o=0,a=r.morphTargets.length;o<a;o++){var s=r.morphTargets[o],c=s.name.match(n);if(c&&c.length>1){var l=c[1];i[l]||(i[l]={start:1/0,end:-(1/0)});var u=i[l];o<u.start&&(u.start=o),o>u.end&&(u.end=o),e||(e=l)}}for(var l in i){var u=i[l];this.createAnimation(l,u.start,u.end,t)}this.firstAnimation=e},THREE.MorphBlendMesh.prototype.setAnimationDirectionForward=function(t){var e=this.animationsMap[t];e&&(e.direction=1,e.directionBackwards=!1)},THREE.MorphBlendMesh.prototype.setAnimationDirectionBackward=function(t){var e=this.animationsMap[t];e&&(e.direction=-1,e.directionBackwards=!0)},THREE.MorphBlendMesh.prototype.setAnimationFPS=function(t,e){var n=this.animationsMap[t];n&&(n.fps=e,n.duration=(n.end-n.start)/n.fps)},THREE.MorphBlendMesh.prototype.setAnimationDuration=function(t,e){var n=this.animationsMap[t];n&&(n.duration=e,n.fps=(n.end-n.start)/n.duration)},THREE.MorphBlendMesh.prototype.setAnimationWeight=function(t,e){var n=this.animationsMap[t];n&&(n.weight=e)},THREE.MorphBlendMesh.prototype.setAnimationTime=function(t,e){var n=this.animationsMap[t];n&&(n.time=e)},THREE.MorphBlendMesh.prototype.getAnimationTime=function(t){var e=0,n=this.animationsMap[t];return n&&(e=n.time),e},THREE.MorphBlendMesh.prototype.getAnimationDuration=function(t){var e=-1,n=this.animationsMap[t];return n&&(e=n.duration),e},THREE.MorphBlendMesh.prototype.playAnimation=function(t){var e=this.animationsMap[t];e?(e.time=0,e.active=!0):console.warn("THREE.MorphBlendMesh: animation["+t+"] undefined in .playAnimation()")},THREE.MorphBlendMesh.prototype.stopAnimation=function(t){var e=this.animationsMap[t];e&&(e.active=!1)},THREE.MorphBlendMesh.prototype.update=function(t){for(var e=0,n=this.animationsList.length;e<n;e++){var i=this.animationsList[e];if(i.active){var r=i.duration/i.length;i.time+=i.direction*t,i.mirroredLoop?(i.time>i.duration||i.time<0)&&(i.direction*=-1,i.time>i.duration&&(i.time=i.duration,i.directionBackwards=!0),i.time<0&&(i.time=0,i.directionBackwards=!1)):(i.time=i.time%i.duration,i.time<0&&(i.time+=i.duration));var o=i.start+THREE.Math.clamp(Math.floor(i.time/r),0,i.length-1),a=i.weight;o!==i.currentFrame&&(this.morphTargetInfluences[i.lastFrame]=0,this.morphTargetInfluences[i.currentFrame]=1*a,this.morphTargetInfluences[o]=0,i.lastFrame=i.currentFrame,i.currentFrame=o);var s=i.time%r/r;i.directionBackwards&&(s=1-s),i.currentFrame!==i.lastFrame?(this.morphTargetInfluences[i.currentFrame]=s*a,this.morphTargetInfluences[i.lastFrame]=(1-s)*a):this.morphTargetInfluences[i.currentFrame]=a}}},THREE.OrbitControls=function(t,e){function n(){return 2*Math.PI/60/60*O.autoRotateSpeed}function i(){return Math.pow(.95,O.zoomSpeed)}function r(t){G-=t}function o(t){V-=t}function a(t){O.object instanceof THREE.PerspectiveCamera?z/=t:O.object instanceof THREE.OrthographicCamera?(O.object.zoom=Math.max(O.minZoom,Math.min(O.maxZoom,O.object.zoom*t)),O.object.updateProjectionMatrix(),X=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),O.enableZoom=!1)}function s(t){O.object instanceof THREE.PerspectiveCamera?z*=t:O.object instanceof THREE.OrthographicCamera?(O.object.zoom=Math.max(O.minZoom,Math.min(O.maxZoom,O.object.zoom/t)),O.object.updateProjectionMatrix(),X=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),O.enableZoom=!1)}function c(t){q.set(t.clientX,t.clientY)}function l(t){J.set(t.clientX,t.clientY)}function u(t){K.set(t.clientX,t.clientY)}function h(t){Y.set(t.clientX,t.clientY),Z.subVectors(Y,q);var e=O.domElement===document?O.domElement.body:O.domElement;r(2*Math.PI*Z.x/e.clientWidth*O.rotateSpeed),o(2*Math.PI*Z.y/e.clientHeight*O.rotateSpeed),q.copy(Y),O.update()}function p(t){tt.set(t.clientX,t.clientY),et.subVectors(tt,J),et.y>0?a(i()):et.y<0&&s(i()),J.copy(tt),O.update()}function d(t){Q.set(t.clientX,t.clientY),$.subVectors(Q,K),rt($.x,$.y),K.copy(Q),O.update()}function f(t){}function m(t){var e=0;void 0!==t.wheelDelta?e=t.wheelDelta:void 0!==t.detail&&(e=-t.detail),e>0?s(i()):e<0&&a(i()),O.update()}function v(t){switch(t.keyCode){case O.keys.UP:rt(0,O.keyPanSpeed),O.update();break;case O.keys.BOTTOM:rt(0,-O.keyPanSpeed),O.update();break;case O.keys.LEFT:rt(O.keyPanSpeed,0),O.update();break;case O.keys.RIGHT:rt(-O.keyPanSpeed,0),O.update()}}function g(t){q.set(t.touches[0].pageX,t.touches[0].pageY)}function y(t){var e=t.touches[0].pageX-t.touches[1].pageX,n=t.touches[0].pageY-t.touches[1].pageY,i=Math.sqrt(e*e+n*n);J.set(0,i)}function E(t){K.set(t.touches[0].pageX,t.touches[0].pageY)}function _(t){Y.set(t.touches[0].pageX,t.touches[0].pageY),Z.subVectors(Y,q);var e=O.domElement===document?O.domElement.body:O.domElement;r(2*Math.PI*Z.x/e.clientWidth*O.rotateSpeed),o(2*Math.PI*Z.y/e.clientHeight*O.rotateSpeed),q.copy(Y),O.update()}function T(t){var e=t.touches[0].pageX-t.touches[1].pageX,n=t.touches[0].pageY-t.touches[1].pageY,r=Math.sqrt(e*e+n*n);tt.set(0,r),et.subVectors(tt,J),et.y>0?s(i()):et.y<0&&a(i()),J.copy(tt),O.update()}function b(t){Q.set(t.touches[0].pageX,t.touches[0].pageY),$.subVectors(Q,K),rt($.x,$.y),K.copy(Q),O.update()}function w(t){}function R(t){if(O.enabled!==!1){if(t.preventDefault(),t.button===O.mouseButtons.ORBIT){if(O.enableRotate===!1)return;c(t),B=D.ROTATE}else if(t.button===O.mouseButtons.ZOOM){if(O.enableZoom===!1)return;l(t),B=D.DOLLY}else if(t.button===O.mouseButtons.PAN){if(O.enablePan===!1)return;u(t),B=D.PAN}B!==D.NONE&&(document.addEventListener("mousemove",x,!1),document.addEventListener("mouseup",H,!1),document.addEventListener("mouseout",H,!1),O.dispatchEvent(k))}}function x(t){if(O.enabled!==!1)if(t.preventDefault(),B===D.ROTATE){if(O.enableRotate===!1)return;h(t)}else if(B===D.DOLLY){if(O.enableZoom===!1)return;p(t)}else if(B===D.PAN){if(O.enablePan===!1)return;d(t)}}function H(t){O.enabled!==!1&&(f(t),document.removeEventListener("mousemove",x,!1),document.removeEventListener("mouseup",H,!1),document.removeEventListener("mouseout",H,!1),O.dispatchEvent(I),B=D.NONE)}function M(t){O.enabled!==!1&&O.enableZoom!==!1&&B===D.NONE&&(t.preventDefault(),t.stopPropagation(),m(t),O.dispatchEvent(k),O.dispatchEvent(I))}function S(t){O.enabled!==!1&&O.enableKeys!==!1&&O.enablePan!==!1&&v(t)}function C(t){if(O.enabled!==!1){switch(t.touches.length){case 1:if(O.enableRotate===!1)return;g(t),B=D.TOUCH_ROTATE;break;case 2:if(O.enableZoom===!1)return;y(t),B=D.TOUCH_DOLLY;break;case 3:if(O.enablePan===!1)return;E(t),B=D.TOUCH_PAN;break;default:B=D.NONE}B!==D.NONE&&O.dispatchEvent(k)}}function A(t){if(O.enabled!==!1)switch(t.preventDefault(),t.stopPropagation(),t.touches.length){case 1:if(O.enableRotate===!1)return;if(B!==D.TOUCH_ROTATE)return;_(t);break;case 2:if(O.enableZoom===!1)return;if(B!==D.TOUCH_DOLLY)return;T(t);break;case 3:if(O.enablePan===!1)return;if(B!==D.TOUCH_PAN)return;b(t);break;default:B=D.NONE}}function P(t){O.enabled!==!1&&(w(t),O.dispatchEvent(I),B=D.NONE)}function L(t){t.preventDefault()}this.object=t,this.domElement=void 0!==e?e:document,this.enabled=!0,this.target=new THREE.Vector3,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-(1/0),this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.25,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={ORBIT:THREE.MOUSE.LEFT,ZOOM:THREE.MOUSE.MIDDLE,PAN:THREE.MOUSE.RIGHT},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=function(){return N},this.getAzimuthalAngle=function(){return U},this.reset=function(){O.target.copy(O.target0),O.object.position.copy(O.position0),O.object.zoom=O.zoom0,O.object.updateProjectionMatrix(),O.dispatchEvent(j),O.update(),B=D.NONE},this.update=function(){var e=new THREE.Vector3,i=(new THREE.Quaternion).setFromUnitVectors(t.up,new THREE.Vector3(0,1,0)),o=i.clone().inverse(),a=new THREE.Vector3,s=new THREE.Quaternion;return function(){var t=O.object.position;e.copy(t).sub(O.target),e.applyQuaternion(i),U=Math.atan2(e.x,e.z),N=Math.atan2(Math.sqrt(e.x*e.x+e.z*e.z),e.y),O.autoRotate&&B===D.NONE&&r(n()),U+=G,N+=V,U=Math.max(O.minAzimuthAngle,Math.min(O.maxAzimuthAngle,U)),N=Math.max(O.minPolarAngle,Math.min(O.maxPolarAngle,N)),N=Math.max(F,Math.min(Math.PI-F,N));var c=e.length()*z;return c=Math.max(O.minDistance,Math.min(O.maxDistance,c)),O.target.add(W),e.x=c*Math.sin(N)*Math.sin(U),e.y=c*Math.cos(N),e.z=c*Math.sin(N)*Math.cos(U),e.applyQuaternion(o),t.copy(O.target).add(e),O.object.lookAt(O.target),O.enableDamping===!0?(G*=1-O.dampingFactor,V*=1-O.dampingFactor):(G=0,V=0),z=1,W.set(0,0,0),!!(X||a.distanceToSquared(O.object.position)>F||8*(1-s.dot(O.object.quaternion))>F)&&(O.dispatchEvent(j),a.copy(O.object.position),s.copy(O.object.quaternion),X=!1,!0)}}(),this.dispose=function(){O.domElement.removeEventListener("contextmenu",L,!1),O.domElement.removeEventListener("mousedown",R,!1),O.domElement.removeEventListener("mousewheel",M,!1),O.domElement.removeEventListener("MozMousePixelScroll",M,!1),O.domElement.removeEventListener("touchstart",C,!1),O.domElement.removeEventListener("touchend",P,!1),O.domElement.removeEventListener("touchmove",A,!1),document.removeEventListener("mousemove",x,!1),document.removeEventListener("mouseup",H,!1),document.removeEventListener("mouseout",H,!1),window.removeEventListener("keydown",S,!1)};var O=this,j={type:"change"},k={type:"start"},I={type:"end"},D={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},B=D.NONE;this.get_state=function(){return B};var U,N,F=1e-6,V=0,G=0,z=1,W=new THREE.Vector3,X=!1,q=new THREE.Vector2,Y=new THREE.Vector2,Z=new THREE.Vector2,K=new THREE.Vector2,Q=new THREE.Vector2,$=new THREE.Vector2,J=new THREE.Vector2,tt=new THREE.Vector2,et=new THREE.Vector2,nt=function(){var t=new THREE.Vector3;return function(e,n){var i=n.elements;t.set(i[0],i[1],i[2]),t.multiplyScalar(-e),W.add(t)}}(),it=function(){var t=new THREE.Vector3;return function(e,n){var i=n.elements;t.set(i[4],i[5],i[6]),t.multiplyScalar(e),W.add(t)}}(),rt=function(){var t=new THREE.Vector3;return function(e,n){var i=O.domElement===document?O.domElement.body:O.domElement;if(O.object instanceof THREE.PerspectiveCamera){var r=O.object.position;t.copy(r).sub(O.target);var o=t.length();o*=Math.tan(O.object.fov/2*Math.PI/180),nt(2*e*o/i.clientHeight,O.object.matrix),it(2*n*o/i.clientHeight,O.object.matrix)}else O.object instanceof THREE.OrthographicCamera?(nt(e*(O.object.right-O.object.left)/i.clientWidth,O.object.matrix),it(n*(O.object.top-O.object.bottom)/i.clientHeight,O.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),O.enablePan=!1)}}();O.domElement.addEventListener("contextmenu",L,!1),O.domElement.addEventListener("mousedown",R,!1),O.domElement.addEventListener("mousewheel",M,!1),O.domElement.addEventListener("MozMousePixelScroll",M,!1),O.domElement.addEventListener("touchstart",C,!1),O.domElement.addEventListener("touchend",P,!1),O.domElement.addEventListener("touchmove",A,!1),window.addEventListener("keydown",S,!1),this.update()},THREE.OrbitControls.prototype=Object.create(THREE.EventDispatcher.prototype),THREE.OrbitControls.prototype.constructor=THREE.OrbitControls,Object.defineProperties(THREE.OrbitControls.prototype,{center:{get:function(){return console.warn("THREE.OrbitControls: .center has been renamed to .target"),this.target}},noZoom:{get:function(){return console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),!this.enableZoom},set:function(t){console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),this.enableZoom=!t}},noRotate:{get:function(){return console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),!this.enableRotate},set:function(t){console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),this.enableRotate=!t}},noPan:{get:function(){return console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),!this.enablePan},set:function(t){console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),this.enablePan=!t}},noKeys:{get:function(){return console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),!this.enableKeys},set:function(t){console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),this.enableKeys=!t}},staticMoving:{get:function(){return console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),!this.constraint.enableDamping},set:function(t){console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),this.constraint.enableDamping=!t}},dynamicDampingFactor:{get:function(){return console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.constraint.dampingFactor},set:function(t){console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.constraint.dampingFactor=t}}}),function(){function t(){}function e(){}function n(){}function i(){this.skinIndices=[],this.skinWeights=[],this.matrices=[]}function r(){this.hierarchy=[]}function o(){this.node=null,this.name=null,this.id=null,this.vertices=[],this.indices=[],this.normals=[],this.uvs=[],
this.bones=[],this.skins=null}function a(){this.uv=null,this.map=null,this.ref=null,this.node=null,this.index=null}function s(){this.normal=null,this.map=null,this.ref=null,this.node=null,this.index=null}function c(){this.version=null,this.id=null,this.internalId=null,this.times=null,this.values=null,this.attrFlag=null,this.attrData=null}function l(){this.id=null,this.attr=null,this.attrX=!1,this.attrY=!1,this.attrZ=!1,this.internalId=null,this.containerInternalId=null,this.containerBoneId=null,this.curveIdx=null,this.curves=[]}function u(){this.curves={},this.length=0,this.fps=30,this.frames=0}function h(){this.textures=[],this.perGeoMap={}}function p(){this.fileName="",this.name="",this.id=null,this.parentIds=[]}function d(t,e,n){for(var i=[],r=0;r<e.length;++r)for(var o=0;o<n;++o)i.push(t[e[r]*n+o]);return i}function f(t,e,n){for(var i={},r=[],o=0,a=0;a<e.length;++a)if(!(e[a]in i)){i[e[a]]={};for(var s=0;s<n;++s)i[e[a]][s]=t[a*n+s];o=o<e[a]?e[a]:o}try{for(a=0;a<=o;a++)for(var c=0;c<n;c++)r.push(i[a][c])}catch(t){}return r}THREE.FBXLoader=function(t,e){THREE.Loader.call(this,t),this.manager=void 0!==e?e:THREE.DefaultLoadingManager,this.textureLoader=null,this.textureBasePath=null},THREE.FBXLoader.prototype=Object.create(THREE.Loader.prototype),THREE.FBXLoader.prototype.constructor=THREE.FBXLoader,THREE.FBXLoader.prototype.load=function(t,e,n,i){var r=this,o=new THREE.XHRLoader(r.manager);o.load(t,function(n){r.isFbxFormatASCII(n)?r.isFbxVersionSupported(n)?(r.textureBasePath=r.extractUrlBase(t),e(r.parse(n))):console.warn("FBXLoader: !!! FBX Version below 7 not supported !!!"):console.warn("FBXLoader: !!! FBX Binary format not supported !!!")},n,i)},THREE.FBXLoader.prototype.setCrossOrigin=function(t){this.crossOrigin=t},THREE.FBXLoader.prototype.isFbxFormatASCII=function(t){CORRECT=["K","a","y","d","a","r","a","\\","F","B","X","\\","B","i","n","a","r","y","\\","\\"];for(var e=0,n=function(n){var i=t[n-1];return t=t.slice(e+n),e++,i},i=0;i<CORRECT.length;++i)if(num=n(1),num==CORRECT[i])return!1;return!0},THREE.FBXLoader.prototype.isFbxVersionSupported=function(t){var e=/FBXVersion: (\d+)/;if(match=t.match(e),match){var n=parseInt(match[1]);return console.log("FBXLoader: FBX version "+n),n>=7e3}return!1},THREE.FBXLoader.prototype.parse=function(t){var n=this;console.time("FBXLoader"),console.time("FBXLoader: TextParser");var o=(new e).parse(t);console.timeEnd("FBXLoader: TextParser"),console.time("FBXLoader: ObjectParser"),n.hierarchy=(new r).parseHierarchy(o),n.weights=(new i).parse(o,n.hierarchy),n.animations=(new u).parse(o,n.hierarchy),n.textures=(new h).parse(o,n.hierarchy),console.timeEnd("FBXLoader: ObjectParser"),console.time("FBXLoader: GeometryParser"),geometries=this.parseGeometries(o),console.timeEnd("FBXLoader: GeometryParser");for(var a=new THREE.Group,s=0;s<geometries.length;++s)void 0!==geometries[s]&&a.add(geometries[s]);return console.timeEnd("FBXLoader"),a},THREE.FBXLoader.prototype.parseGeometries=function(t){if(!("Geometry"in t.Objects.subNodes))return[];var e=0;for(var n in t.Objects.subNodes.Geometry)n.match(/^\d+$/)&&e++;var i=[];if(e>0)for(n in t.Objects.subNodes.Geometry)"Mesh"===t.Objects.subNodes.Geometry[n].attrType&&i.push(this.parseGeometry(t.Objects.subNodes.Geometry[n],t));else i.push(this.parseGeometry(t.Objects.subNodes.Geometry,t));return i},THREE.FBXLoader.prototype.parseGeometry=function(t,e){geo=(new o).parse(t),geo.addBones(this.hierarchy.hierarchy);var n=new THREE.BufferGeometry;n.name=geo.name,n.addAttribute("position",new THREE.BufferAttribute(new Float32Array(geo.vertices),3)),void 0!==geo.normals&&geo.normals.length>0&&n.addAttribute("normal",new THREE.BufferAttribute(new Float32Array(geo.normals),3)),void 0!==geo.uvs&&geo.uvs.length>0&&n.addAttribute("uv",new THREE.BufferAttribute(new Float32Array(geo.uvs),2)),void 0!==geo.indices&&geo.indices.length>65535?n.setIndex(new THREE.BufferAttribute(new Uint32Array(geo.indices),1)):void 0!==geo.indices&&n.setIndex(new THREE.BufferAttribute(new Uint16Array(geo.indices),1)),n.verticesNeedUpdate=!0,n.computeBoundingSphere(),n.computeBoundingBox();var i,r=this.textures.getById(e.searchConnectionParent(geo.id));void 0!==r&&r.length>0&&(null===this.textureLoader&&(this.textureLoader=new THREE.TextureLoader),i=this.textureLoader.load(this.textureBasePath+"/"+r[0].fileName));var a;a=void 0!==i?new THREE.MeshBasicMaterial({map:i}):new THREE.MeshBasicMaterial({color:3342591}),n=(new THREE.Geometry).fromBufferGeometry(n),n.bones=geo.bones,n.skinIndices=this.weights.skinIndices,n.skinWeights=this.weights.skinWeights;var s=null;return void 0===geo.bones||void 0===geo.skins||void 0===this.animations||0===this.animations.length?s=new THREE.Mesh(n,a):(a.skinning=!0,s=new THREE.SkinnedMesh(n,a),this.addAnimation(s,this.weights.matrices,this.animations)),s},THREE.FBXLoader.prototype.addAnimation=function(t,e,n){for(var i={name:"animationtest",fps:30,length:n.length,hierarchy:[]},r=0;r<t.geometry.bones.length;++r){var o=t.geometry.bones[r].name;o=o.replace(/.*:/,""),i.hierarchy.push({parent:t.geometry.bones[r].parent,name:o,keys:[]})}var a=function(t,e){if(void 0===t)return!1;var n;switch(e){case"S":if(void 0===t.S)return!1;n=t.S;break;case"R":if(void 0===t.R)return!1;n=t.R;break;case"T":if(void 0===t.T)return!1;n=t.T}return void 0!==n.curves.x&&(void 0!==n.curves.y&&void 0!==n.curves.z)},s=function(t,e){var n=c(t.curves.x,e),i=c(t.curves.y,e),r=c(t.curves.z,e);return n&&i&&r},c=function(t,e){var n=t.values[e];return void 0!==n},l=function(t,e){var i={};if(i.time=frame/n.fps,i.pos=e.pos,i.rot=e.rotq,i.scl=e.scl,void 0===t)return i;try{if(a(t,"T")&&s(t.T,frame)){var r=new THREE.Vector3(t.T.curves.x.values[frame],t.T.curves.y.values[frame],t.T.curves.z.values[frame]);i.pos=[r.x,r.y,r.z]}else delete i.pos;if(a(t,"R")&&s(t.R,frame)){var o=degToRad(t.R.curves.x.values[frame]),c=degToRad(t.R.curves.y.values[frame]),l=degToRad(t.R.curves.z.values[frame]),u=new THREE.Vector3(o,c,l),h=quatFromVec(u.x,u.y,u.z);i.rot=[h.x,h.y,h.z,h.w]}else delete i.rot;if(a(t,"S")&&s(t.S,frame)){var p=new THREE.Vector3(t.S.curves.x.values[frame],t.S.curves.y.values[frame],t.S.curves.z.values[frame]);i.scl=[p.x,p.y,p.z]}else delete i.scl}catch(t){console.log(e),console.log(t)}return i},u=t.geometry.bones;for(frame=0;frame<n.frames;frame++)for(r=0;r<u.length;r++)for(var h=u[r],p=n.curves[r],d=0;d<i.hierarchy.length;d++)i.hierarchy[d].name===h.name&&i.hierarchy[d].keys.push(l(p,h));void 0===t.geometry.animations&&(t.geometry.animations=[]),t.geometry.animations.push(THREE.AnimationClip.parseAnimation(i,t.geometry.bones))},THREE.FBXLoader.prototype.parseMaterials=function(t){if(!("Material"in t.subNodes))return[];var e=0;for(var n in t.subNodes.Materials)n.match(/^\d+$/)&&e++;var i=[];if(e>0)for(n in t.subNodes.Material)i.push(parseMaterial(t.subNodes.Material[n]));else i.push(parseMaterial(t.subNodes.Material));return i},THREE.FBXLoader.prototype.parseMaterial=function(t){},THREE.FBXLoader.prototype.loadFile=function(t,e,n,i,r){var o=new THREE.XHRLoader(this.manager);o.setResponseType(r);var a=o.load(t,function(t){e(t)},n,i);return a},THREE.FBXLoader.prototype.loadFileAsBuffer=function(t,e,n,i){this.loadFile(t,onLoad,n,i,"arraybuffer")},THREE.FBXLoader.prototype.loadFileAsText=function(t,e,n,i){this.loadFile(t,e,n,i,"text")},t.prototype.add=function(t,e){this[t]=e},t.prototype.searchConnectionParent=function(t){if(void 0===this.__cache_search_connection_parent&&(this.__cache_search_connection_parent=[]),void 0!==this.__cache_search_connection_parent[t])return this.__cache_search_connection_parent[t];this.__cache_search_connection_parent[t]=[];for(var e=this.Connections.properties.connections,n=[],i=0;i<e.length;++i)if(e[i][0]==t){var r=0===e[i][1]?-1:e[i][1];n.push(r)}return n.length>0?(this.__cache_search_connection_parent[t]=this.__cache_search_connection_parent[t].concat(n),n):(this.__cache_search_connection_parent[t]=[-1],[-1])},t.prototype.searchConnectionChildren=function(t){if(void 0===this.__cache_search_connection_children&&(this.__cache_search_connection_children=[]),void 0!==this.__cache_search_connection_children[t])return this.__cache_search_connection_children[t];this.__cache_search_connection_children[t]=[];for(var e=this.Connections.properties.connections,n=[],i=0;i<e.length;++i)e[i][1]==t&&n.push(0===e[i][0]?-1:e[i][0]);return n.length>0?(this.__cache_search_connection_children[t]=this.__cache_search_connection_children[t].concat(n),n):(this.__cache_search_connection_children[t]=[-1],[-1])},t.prototype.searchConnectionType=function(t,e){var n=t+","+e;if(void 0===this.__cache_search_connection_type&&(this.__cache_search_connection_type=""),void 0!==this.__cache_search_connection_type[n])return this.__cache_search_connection_type[n];this.__cache_search_connection_type[n]="";for(var i=this.Connections.properties.connections,r=0;r<i.length;++r)if(i[r][0]==t&&i[r][1]==e)return this.__cache_search_connection_type[n]=i[r][2],i[r][2];return this.__cache_search_connection_type[t]=null,null},e.prototype={getPrevNode:function(){return this.nodeStack[this.currentIndent-2]},getCurrentNode:function(){return this.nodeStack[this.currentIndent-1]},getCurrentProp:function(){return this.currentProp},pushStack:function(t){this.nodeStack.push(t),this.currentIndent+=1},popStack:function(){this.nodeStack.pop(),this.currentIndent-=1},setCurrentProp:function(t,e){this.currentProp=t,this.currentPropName=e},parse:function(e){this.currentIndent=0,this.allNodes=new t,this.nodeStack=[],this.currentProp=[],this.currentPropName="";var n=e.split("\n");for(var i in n){var r=n[i];if(!r.match(/^[\s\t]*;/)&&!r.match(/^[\s\t]*$/)){var o=new RegExp("^\\t{"+this.currentIndent+"}(\\w+):(.*){","");if(match=r.match(o),match){var a=match[1].trim().replace(/^"/,"").replace(/"$/,""),s=match[2].split(",").map(function(t){return t.trim().replace(/^"/,"").replace(/"$/,"")});this.parseNodeBegin(r,a,s||null)}else{var c=new RegExp("^\\t{"+this.currentIndent+"}(\\w+):[\\s\\t\\r\\n](.*)");if(match=r.match(c),match){var l=match[1].replace(/^"/,"").replace(/"$/,"").trim(),u=match[2].replace(/^"/,"").replace(/"$/,"").trim();this.parseNodeProperty(r,l,u)}else{var h=new RegExp("^\\t{"+(this.currentIndent-1)+"}}");r.match(h)?this.nodeEnd():r.match(/^[^\s\t}]/)&&this.parseNodePropertyContinued(r)}}}}return this.allNodes},parseNodeBegin:function(t,e,n){var i={name:e,properties:{},subNodes:{}},r=this.parseNodeAttr(n),o=this.getCurrentNode();if(0===this.currentIndent)this.allNodes.add(e,i);else if(e in o.subNodes){var a=o.subNodes[e];this.isFlattenNode(o.subNodes[e])&&(""===r.id?(o.subNodes[e]=[],o.subNodes[e].push(a)):(o.subNodes[e]={},o.subNodes[e][a.id]=a)),""===r.id?o.subNodes[e].push(i):o.subNodes[e][r.id]=i}else o.subNodes[e]=i;n&&(i.id=r.id,i.attrName=r.name,i.attrType=r.type),this.pushStack(i)},parseNodeAttr:function(t){var e=t[0];""!==t[0]&&(e=parseInt(t[0]),isNaN(e)&&(e=t[0]));var n,i;return t.length>1&&(n=t[1].replace(/^(\w+)::/,""),i=t[2]),{id:e,name:n||"",type:i||""}},parseNodeProperty:function(t,e,n){var i=this.getCurrentNode(),r=i.name;if(void 0!==r){var o=r.match(/Properties(\d)+/);if(o)return void this.parseNodeSpecialProperty(t,e,n)}if("C"==e){var a=n.split(",").slice(1),s=parseInt(a[0]),c=parseInt(a[1]),l=n.split(",").slice(3);e="connections",n=[s,c],n=n.concat(l),void 0===i.properties[e]&&(i.properties[e]=[])}if("Node"==e){var u=parseInt(n);i.properties.id=u,i.id=u}e in i.properties?Array.isArray(i.properties[e])?i.properties[e].push(n):i.properties[e]+=n:Array.isArray(i.properties[e])?i.properties[e].push(n):i.properties[e]=n,this.setCurrentProp(i.properties,e)},parseNodePropertyContinued:function(t){this.currentProp[this.currentPropName]+=t},parseNodeSpecialProperty:function(t,e,n){var i=n.split('",').map(function(t){return t.trim().replace(/^\"/,"").replace(/\s/,"_")}),r=i[0],o=i[1],a=i[2],s=i[3],c=i[4];switch(o){case"int":c=parseInt(c);break;case"double":c=parseFloat(c);break;case"ColorRGB":case"Vector3D":var l=c.split(",");c=new THREE.Vector3(l[0],l[1],l[2])}this.getPrevNode().properties[r]={type:o,type2:a,flag:s,value:c},this.setCurrentProp(this.getPrevNode().properties,r)},nodeEnd:function(t){this.popStack()},isFlattenNode:function(t){return"subNodes"in t&&"properties"in t}},n.prototype={},i.prototype.parseCluster=function(t,e,n){var i=t.searchConnectionParent(e),r=toInt(n.subNodes.Indexes.properties.a.split(",")),o=toFloat(n.subNodes.Weights.properties.a.split(",")),a=toMat44(toFloat(n.subNodes.Transform.properties.a.split(","))),s=toMat44(toFloat(n.subNodes.TransformLink.properties.a.split(",")));return{parent:i,id:parseInt(e),indices:r,weights:o,transform:a,transformlink:s,linkMode:n.properties.Mode}},i.prototype.parse=function(t,e){this.skinIndices=[],this.skinWeights=[],this.matrices=[];var n=t.Objects.subNodes.Deformer,i={};for(var r in n)if("Cluster"===n[r].attrType){if(!("Indexes"in n[r].subNodes))continue;var o=this.parseCluster(t,r,n[r]),a=t.searchConnectionChildren(o.id)[0];i[a]=o}for(var s=[],c=e.hierarchy,l=0;l<c.length;++l){var u=c[l].internalId;if(void 0!==i[u]){var h=i[u];this.matrices.push(h.transform);for(var p=0;p<h.indices.length;++p){void 0===s[h.indices[p]]&&(s[h.indices[p]]={},s[h.indices[p]].joint=[],s[h.indices[p]].weight=[]);var d=t.searchConnectionChildren(h.id);d.length>1&&console.warn("FBXLoader: node "+h.id+" have many weight kids: "+d),s[h.indices[p]].joint.push(e.getBoneIdfromInternalId(t,d[0])),s[h.indices[p]].weight.push(h.weights[p])}}else this.matrices.push(new THREE.Matrix4)}for(var f=0;f<s.length;f++){var m=new THREE.Vector4(s[f].joint[0]?s[f].joint[0]:0,s[f].joint[1]?s[f].joint[1]:0,s[f].joint[2]?s[f].joint[2]:0,s[f].joint[3]?s[f].joint[3]:0),v=new THREE.Vector4(s[f].weight[0]?s[f].weight[0]:0,s[f].weight[1]?s[f].weight[1]:0,s[f].weight[2]?s[f].weight[2]:0,s[f].weight[3]?s[f].weight[3]:0);this.skinIndices.push(m),this.skinWeights.push(v)}return this},r.prototype.parseHierarchy=function(t){var e=t.Objects,n=e.subNodes.Model,i=[];for(var r in n)void 0!==n[r].attrType&&i.push(n[r]);this.hierarchy=[];for(var o=0;o<i.length;++o){var a=i[o],s=t.searchConnectionParent(a.id)[0],c=[0,0,0],l=[0,0,0,1],u=[1,1,1];if("Lcl_Translation"in a.properties&&(c=toFloat(a.properties.Lcl_Translation.value.split(","))),"Lcl_Rotation"in a.properties){l=toRad(toFloat(a.properties.Lcl_Rotation.value.split(",")));var h=new THREE.Quaternion;h.setFromEuler(new THREE.Euler(l[0],l[1],l[2],"ZYX")),l=[h.x,h.y,h.z,h.w]}"Lcl_Scaling"in a.properties&&(u=toFloat(a.properties.Lcl_Scaling.value.split(",")));var p=a.attrName;p=p.replace(/:/,""),p=p.replace(/_/,""),p=p.replace(/-/,""),this.hierarchy.push({parent:s,name:p,pos:c,rotq:l,scl:u,internalId:a.id})}return this.reindexParentId(),this.restoreBindPose(t),this},r.prototype.reindexParentId=function(){for(var t=0;t<this.hierarchy.length;t++)for(var e=0;e<this.hierarchy.length;++e)if(this.hierarchy[t].parent==this.hierarchy[e].internalId){this.hierarchy[t].parent=e;break}},r.prototype.restoreBindPose=function(t){var e=t.Objects.subNodes.Pose;if(void 0!==e){for(var n=e.subNodes.PoseNode,i={},r={},o=0;o<n.length;++o){var a=toMat44(n[o].subNodes.Matrix.properties.a.split(",")),s=toMat44(n[o].subNodes.Matrix.properties.a.split(","));i[n[o].id]=a,r[n[o].id]=s}for(var c=0;c<this.hierarchy.length;++c){var l=this.hierarchy[c],u=l.internalId;if(void 0!==r[u]){for(var h,p=new THREE.Vector3(0,0,0),d=new THREE.Quaternion,f=new THREE.Vector3(1,1,1),m=t.searchConnectionParent(u),v=0;v<m.length;++v)if(this.isBoneNode(m[v])){h=m[v];break}if(void 0!==h&&void 0!==i[h]){var g=new THREE.Matrix4;g.getInverse(r[h]),g.multiply(i[u]),i[u]=g}i[u].decompose(p,d,f),l.pos=[p.x,p.y,p.z],l.rotq=[d.x,d.y,d.z,d.w],l.scl=[f.x,f.y,f.z]}}}},r.prototype.searchRealId=function(t){for(var e=0;e<this.hierarchy.length;e++)if(t==this.hierarchy[e].internalId)return e;return-1},r.prototype.getByInternalId=function(t){for(var e=0;e<this.hierarchy.length;e++)if(t==this.hierarchy[e].internalId)return this.hierarchy[e];return null},r.prototype.isBoneNode=function(t){for(var e=0;e<this.hierarchy.length;++e)if(t===this.hierarchy[e].internalId)return!0;return!1},r.prototype.getBoneIdfromInternalId=function(t,e){if(void 0===t.__cache_get_boneid_from_internalid&&(t.__cache_get_boneid_from_internalid=[]),void 0!==t.__cache_get_boneid_from_internalid[e])return t.__cache_get_boneid_from_internalid[e];for(var n=0;n<this.hierarchy.length;++n)if(this.hierarchy[n].internalId==e){return t.__cache_get_boneid_from_internalid[e]=n,n}return-1},o.prototype.parse=function(t){return this.node=t,this.name=t.attrName,this.id=t.id,this.vertices=this.getVertices(),void 0===this.vertices?void console.log("FBXLoader: Geometry.parse(): pass"+this.node.id):(this.indices=this.getPolygonVertexIndices(),this.uvs=(new a).parse(this.node,this),this.normals=(new s).parse(this.node,this),this.getPolygonTopologyMax()>3&&(this.indices=this.convertPolyIndicesToTri(this.indices,this.getPolygonTopologyArray())),this)},o.prototype.getVertices=function(){if(this.node.__cache_vertices)return this.node.__cache_vertices;if(void 0===this.node.subNodes.Vertices)return console.warn("this.node: "+this.node.attrName+"("+this.node.id+") does not have Vertices"),this.node.__cache_vertices=void 0,null;var t=this.node.subNodes.Vertices.properties.a,e=t.split(",").map(function(t){return parseFloat(t)});return this.node.__cache_vertices=e,this.node.__cache_vertices},o.prototype.getPolygonVertexIndices=function(){if(this.node.__cache_indices&&this.node.__cache_poly_topology_max)return this.node.__cache_indices;if(void 0===this.node.subNodes)return console.error("this.node.subNodes undefined"),void console.log(this.node);if(void 0===this.node.subNodes.PolygonVertexIndex)return console.warn("this.node: "+this.node.attrName+"("+this.node.id+") does not have PolygonVertexIndex "),void(this.node.__cache_indices=void 0);for(var t=this.node.subNodes.PolygonVertexIndex.properties.a,e=t.split(","),n=1,i=null,r=[],o=0;o<e.length;++o){var a=parseInt(e[o]);a<0?(n>i&&(i=n),e[o]=a^-1,r.push(n),n=1):(e[o]=a,n++)}return null===i&&(console.warn("FBXLoader: topology N not found: "+this.node.attrName),console.warn(this.node),i=3),this.node.__cache_poly_topology_max=i,this.node.__cache_poly_topology_arr=r,this.node.__cache_indices=e,this.node.__cache_indices},o.prototype.getPolygonTopologyMax=function(){return this.node.__cache_indices&&this.node.__cache_poly_topology_max?this.node.__cache_poly_topology_max:(this.getPolygonVertexIndices(this.node),this.node.__cache_poly_topology_max)},o.prototype.getPolygonTopologyArray=function(){return this.node.__cache_indices&&this.node.__cache_poly_topology_max?this.node.__cache_poly_topology_arr:(this.getPolygonVertexIndices(this.node),this.node.__cache_poly_topology_arr)},o.prototype.convertPolyIndicesToTri=function(t,e){for(var n=[],i=0,r=0,o=0;i<t.length;){o=e[r];for(var a=0;a<=o-3;a++)n.push(t[i]),n.push(t[i+(o-2-a)]),n.push(t[i+(o-1-a)]);r++,i+=o}return n},o.prototype.addBones=function(t){this.bones=t},a.prototype.getUV=function(t){return this.node&&this.uv&&this.map&&this.ref?this.uv:this._parseText(t)},a.prototype.getMap=function(t){return this.node&&this.uv&&this.map&&this.ref?this.map:(this._parseText(t),this.map)},a.prototype.getRef=function(t){return this.node&&this.uv&&this.map&&this.ref?this.ref:(this._parseText(t),this.ref)},a.prototype.getIndex=function(t){return this.node&&this.uv&&this.map&&this.ref?this.index:(this._parseText(t),this.index)},a.prototype.getNode=function(t){return null!==this.node?this.node:(this.node=t.subNodes.LayerElementUV,this.node)},a.prototype._parseText=function(t){var e=this.getNode(t);if(void 0===e)return[];var n=0,i="";for(var r in e)r.match(/^\d+$/)&&(n++,i=r);n>0&&(console.warn("multi uv not supported"),e=e[r]);var o=e.subNodes.UVIndex.properties.a,a=e.subNodes.UV.properties.a,s=e.properties.MappingInformationType,c=e.properties.ReferenceInformationType;return this.uv=toFloat(a.split(",")),this.index=toInt(o.split(",")),this.map=s,this.ref=c,this.uv},a.prototype.parse=function(t,e){this.uvNode=this.getNode(t),this.uv=this.getUV(t);var n=this.getMap(t),i=this.getRef(t),r=this.getIndex(t),o=e.getPolygonTopologyArray();switch(n){case"ByPolygonVertex":switch(i){case"Direct":this.uv=this.parseUV_ByPolygonVertex_Direct(this.uv,r,o,2);break;case"IndexToDirect":this.uv=this.parseUV_ByPolygonVertex_IndexToDirect(this.uv,r)}this.uv=f(this.uv,e.getPolygonVertexIndices(t),2);break;case"ByPolygon":switch(i){case"Direct":this.uv=this.parseUV_ByPolygon_Direct();break;case"IndexToDirect":this.uv=this.parseUV_ByPolygon_IndexToDirect()}}return this.uv},a.prototype.parseUV_ByPolygonVertex_Direct=function(t,e,n,i){return parse_Data_ByPolygonVertex_Direct(t,e,n,i)},a.prototype.parseUV_ByPolygonVertex_IndexToDirect=function(t,e){return d(t,e,2)},a.prototype.parseUV_ByPolygon_Direct=function(t){return console.warn("not implemented"),t},a.prototype.parseUV_ByPolygon_IndexToDirect=function(t){return console.warn("not implemented"),t},a.prototype.parseUV_ByVertex_Direct=function(t){return console.warn("not implemented"),t},s.prototype.getNormal=function(t){return this.node&&this.normal&&this.map&&this.ref?this.normal:(this._parseText(t),this.normal)},s.prototype.getMap=function(t){return this.node&&this.normal&&this.map&&this.ref?this.map:(this._parseText(t),this.map)},s.prototype.getRef=function(t){return this.node&&this.normal&&this.map&&this.ref?this.ref:(this._parseText(t),this.ref)},s.prototype.getNode=function(t){return this.node?this.node:(this.node=t.subNodes.LayerElementNormal,this.node)},s.prototype._parseText=function(t){var e=this.getNode(t);if(void 0===e)return void console.warn("node: "+t.attrName+"("+t.id+") does not have LayerElementNormal");var n=e.properties.MappingInformationType,i=e.properties.ReferenceInformationType,r=e.subNodes.Normals.properties.a;this.normal=toFloat(r.split(",")),this.map=n,this.ref=i},s.prototype.parse=function(t,e){var n=this.getNormal(t),i=(this.getNode(t),this.getMap(t)),r=this.getRef(t),o=e.getPolygonVertexIndices(t),a=e.getPolygonTopologyArray(t);switch(i){case"ByPolygonVertex":switch(r){case"Direct":n=this.parseNormal_ByPolygonVertex_Direct(n,o,a,3);break;case"IndexToDirect":n=this.parseNormal_ByPolygonVertex_IndexToDirect()}break;case"ByPolygon":switch(r){case"Direct":n=this.parseNormal_ByPolygon_Direct();break;case"IndexToDirect":n=this.parseNormal_ByPolygon_IndexToDirect()}}return n},s.prototype.parseNormal_ByPolygonVertex_Direct=function(t,e,n,i){return parse_Data_ByPolygonVertex_Direct(t,e,n,i)},s.prototype.parseNormal_ByPolygonVertex_IndexToDirect=function(t){return console.warn("not implemented"),t},s.prototype.parseNormal_ByPolygon_Direct=function(t){return console.warn("not implemented"),t},s.prototype.parseNormal_ByPolygon_IndexToDirect=function(t){return console.warn("not implemented"),t},s.prototype.parseNormal_ByVertex_Direct=function(t){return console.warn("not implemented"),t},c.prototype.fromNode=function(t){return this.id=t.id,this.internalId=t.id,this.times=t.subNodes.KeyTime.properties.a,this.values=t.subNodes.KeyValueFloat.properties.a,this.attrFlag=t.subNodes.KeyAttrFlags.properties.a,this.attrData=t.subNodes.KeyAttrDataFloat.properties.a,this.times=toFloat(this.times.split(",")),this.values=toFloat(this.values.split(",")),this.attrData=toFloat(this.attrData.split(",")),this.attrFlag=toInt(this.attrFlag.split(",")),this.times=this.times.map(function(t){return m(t)}),this},c.prototype.getLength=function(){return this.times[this.times.length-1]},l.prototype.fromNode=function(t,e,n){if(this.id=e.id,this.attr=e.attrName,this.internalId=e.id,!this.attr.match(/S|R|T/))return null;for(var i in e.properties)i.match(/X/)&&(this.attrX=!0),i.match(/Y/)&&(this.attrY=!0),i.match(/Z/)&&(this.attrZ=!0);this.containerIndices=t.searchConnectionParent(this.id),this.curveIdx=t.searchConnectionChildren(this.id);for(var r=this.containerIndices.length-1;r>=0;--r){var o=n.searchRealId(this.containerIndices[r]);if(o>=0&&(this.containerBoneId=o,this.containerId=this.containerIndices[r]),o>=0)break}return this},l.prototype.setCurve=function(t){this.curves.push(t)},u.prototype.parse=function(t,e){var n=t.Objects.subNodes.AnimationCurveNode,i=t.Objects.subNodes.AnimationCurve,r=[];for(var o in n)if(o.match(/\d+/)){var a=(new l).fromNode(t,n[o],e);r.push(a)}for(var s={},u=0;u<r.length;++u)null!==r[u]&&(s[r[u].id]=r[u]);var h=[],p=0;for(o in i)if(o.match(/\d+/)){var d=(new c).fromNode(i[o]);h.push(d),p=d.getLength()?d.getLength():p;var f=t.searchConnectionParent(d.id)[0],m=t.searchConnectionType(d.id,f);m.match(/X/)&&(m="x"),m.match(/Y/)&&(m="y"),m.match(/Z/)&&(m="z"),s[f].curves[m]=d}for(var v in s){var g=s[v].containerBoneId;void 0===this.curves[g]&&(this.curves[g]={}),this.curves[g][s[v].attr]=s[v]}return this.length=p,this.frames=this.length*this.fps,this},h.prototype.add=function(t){void 0===this.textures&&(this.textures=[]),this.textures.push(t);for(var e=0;e<t.parentIds.length;++e)void 0===this.perGeoMap[t.parentIds[e]]&&(this.perGeoMap[t.parentIds[e]]=[]),this.perGeoMap[t.parentIds[e]].push(this.textures[this.textures.length-1])},h.prototype.parse=function(t,e){var n=t.Objects.subNodes.Texture;for(var i in n){var r=(new p).parse(n[i],t);this.add(r)}return this},h.prototype.getById=function(t){return this.perGeoMap[t]},p.prototype.parse=function(t,e){return this.id=t.id,this.name=t.attrName,this.fileName=this.parseFileName(t.properties.FileName),this.parentIds=this.searchParents(this.id,e),this},p.prototype.parseFileName=function(t){if(void 0===t)return"";var e=t.split(/[\\\/]/);return e.length>0?e[e.length-1]:t},p.prototype.searchParents=function(t,e){var n=e.searchConnectionParent(t);return n},parse_Data_ByPolygonVertex_Direct=function(t,e,n,i){for(var r=[],o=0,a=0;a<e.length;++a){r[e[a]]=[];for(var s=0;s<i;++s)r[e[a]][s]=t[o+s];o+=i}for(var c=[],l=0;l<r.length;++l)if(void 0!==r[l])for(var u=0;u<i;++u)void 0!==r[l][u]&&c.push(r[l][u]);return c};var m=function(t){return t/46186158e3};degToRad=function(t){return t*Math.PI/180},radToDeg=function(t){return 180*t/Math.PI},quatFromVec=function(t,e,n){var i=new THREE.Euler(t,e,n,"ZYX"),r=new THREE.Quaternion;return r.setFromEuler(i),r},toInt=function(t){return t.map(function(t){return parseInt(t)})},toFloat=function(t){return t.map(function(t){return parseFloat(t)})},toRad=function(t){return t.map(function(t){return degToRad(t)})},toMat44=function(t){var e=new THREE.Matrix4;return e.set(t[0],t[4],t[8],t[12],t[1],t[5],t[9],t[13],t[2],t[6],t[10],t[14],t[3],t[7],t[11],t[15]),e}}(),THREE.OBJLoader=function(t){this.manager=void 0!==t?t:THREE.DefaultLoadingManager,this.materials=null},THREE.OBJLoader.prototype={constructor:THREE.OBJLoader,load:function(t,e,n,i){var r=this,o=new THREE.XHRLoader(r.manager);o.setPath(this.path),o.load(t,function(t){e(r.parse(t))},n,i)},setPath:function(t){this.path=t},setMaterials:function(t){this.materials=t},parse:function(t){function e(t){var e={vertices:[],normals:[],uvs:[]},n={name:"",smooth:!0};l={name:t,geometry:e,material:n},u.push(l)}function n(t){var e=parseInt(t);return 3*(e>=0?e-1:e+p.length/3)}function i(t){var e=parseInt(t);return 3*(e>=0?e-1:e+d.length/3)}function r(t){var e=parseInt(t);return 2*(e>=0?e-1:e+f.length/2)}function o(t,e,n){l.geometry.vertices.push(p[t],p[t+1],p[t+2],p[e],p[e+1],p[e+2],p[n],p[n+1],p[n+2])}function a(t,e,n){l.geometry.normals.push(d[t],d[t+1],d[t+2],d[e],d[e+1],d[e+2],d[n],d[n+1],d[n+2])}function s(t,e,n){l.geometry.uvs.push(f[t],f[t+1],f[e],f[e+1],f[n],f[n+1])}function c(t,e,c,l,u,h,p,d,f,m,v,g){var y,E=n(t),_=n(e),T=n(c);void 0===l?o(E,_,T):(y=n(l),o(E,_,y),o(_,T,y)),void 0!==u&&(E=r(u),_=r(h),T=r(p),void 0===l?s(E,_,T):(y=r(d),s(E,_,y),s(_,T,y))),void 0!==f&&(E=i(f),_=i(m),T=i(v),void 0===l?a(E,_,T):(y=i(g),a(E,_,y),a(_,T,y)))}console.time("OBJLoader");var l,u=[],h=!1,p=[],d=[],f=[];e("");for(var m=/^v\s+([\d|\.|\+|\-|e|E]+)\s+([\d|\.|\+|\-|e|E]+)\s+([\d|\.|\+|\-|e|E]+)/,v=/^vn\s+([\d|\.|\+|\-|e|E]+)\s+([\d|\.|\+|\-|e|E]+)\s+([\d|\.|\+|\-|e|E]+)/,g=/^vt\s+([\d|\.|\+|\-|e|E]+)\s+([\d|\.|\+|\-|e|E]+)/,y=/^f\s+(-?\d+)\s+(-?\d+)\s+(-?\d+)(?:\s+(-?\d+))?/,E=/^f\s+((-?\d+)\/(-?\d+))\s+((-?\d+)\/(-?\d+))\s+((-?\d+)\/(-?\d+))(?:\s+((-?\d+)\/(-?\d+)))?/,_=/^f\s+((-?\d+)\/(-?\d+)\/(-?\d+))\s+((-?\d+)\/(-?\d+)\/(-?\d+))\s+((-?\d+)\/(-?\d+)\/(-?\d+))(?:\s+((-?\d+)\/(-?\d+)\/(-?\d+)))?/,T=/^f\s+((-?\d+)\/\/(-?\d+))\s+((-?\d+)\/\/(-?\d+))\s+((-?\d+)\/\/(-?\d+))(?:\s+((-?\d+)\/\/(-?\d+)))?/,b=/^[og]\s+(.+)/,w=/^s\s+(\d+|on|off)/,R=t.split("\n"),x=0;x<R.length;x++){var H=R[x];H=H.trim();var M;if(0!==H.length&&"#"!==H.charAt(0))if(null!==(M=m.exec(H)))p.push(parseFloat(M[1]),parseFloat(M[2]),parseFloat(M[3]));else if(null!==(M=v.exec(H)))d.push(parseFloat(M[1]),parseFloat(M[2]),parseFloat(M[3]));else if(null!==(M=g.exec(H)))f.push(parseFloat(M[1]),parseFloat(M[2]));else if(null!==(M=y.exec(H)))c(M[1],M[2],M[3],M[4]);else if(null!==(M=E.exec(H)))c(M[2],M[5],M[8],M[11],M[3],M[6],M[9],M[12]);else if(null!==(M=_.exec(H)))c(M[2],M[6],M[10],M[14],M[3],M[7],M[11],M[15],M[4],M[8],M[12],M[16]);else if(null!==(M=T.exec(H)))c(M[2],M[5],M[8],M[11],void 0,void 0,void 0,void 0,M[3],M[6],M[9],M[12]);else if(null!==(M=b.exec(H))){var S=M[1].trim();h===!1?(h=!0,l.name=S):e(S)}else if(/^usemtl /.test(H))l.material.name=H.substring(7).trim();else if(/^mtllib /.test(H));else{if(null===(M=w.exec(H)))throw new Error("Unexpected line: "+H);l.material.smooth="1"===M[1]||"on"===M[1]}}for(var C=new THREE.Group,x=0,A=u.length;x<A;x++){l=u[x];var P=l.geometry,L=new THREE.BufferGeometry;L.addAttribute("position",new THREE.BufferAttribute(new Float32Array(P.vertices),3)),P.normals.length>0?L.addAttribute("normal",new THREE.BufferAttribute(new Float32Array(P.normals),3)):L.computeVertexNormals(),P.uvs.length>0&&L.addAttribute("uv",new THREE.BufferAttribute(new Float32Array(P.uvs),2));var O;null!==this.materials&&(O=this.materials.create(l.material.name)),O||(O=new THREE.MeshPhongMaterial,O.name=l.material.name),O.shading=l.material.smooth?THREE.SmoothShading:THREE.FlatShading;var j=new THREE.Mesh(L,O);j.name=l.name,C.add(j)}return console.timeEnd("OBJLoader"),C}},THREE.CSS3DObject=function(t){THREE.Object3D.call(this),this.element=t,this.element.style.position="absolute",this.addEventListener("removed",function(t){null!==this.element.parentNode&&this.element.parentNode.removeChild(this.element)})},THREE.CSS3DObject.prototype=Object.create(THREE.Object3D.prototype),THREE.CSS3DObject.prototype.constructor=THREE.CSS3DObject,THREE.CSS3DSprite=function(t){THREE.CSS3DObject.call(this,t)},THREE.CSS3DSprite.prototype=Object.create(THREE.CSS3DObject.prototype),THREE.CSS3DSprite.prototype.constructor=THREE.CSS3DSprite,THREE.CSS3DRenderer=function(){console.log("THREE.CSS3DRenderer",THREE.REVISION);var t,e,n,i,r=new THREE.Matrix4,o={camera:{fov:0,style:""},objects:{}},a=document.createElement("div");a.style.overflow="hidden",a.style.WebkitTransformStyle="preserve-3d",a.style.MozTransformStyle="preserve-3d",a.style.oTransformStyle="preserve-3d",a.style.transformStyle="preserve-3d",this.domElement=a;var s=document.createElement("div");s.style.WebkitTransformStyle="preserve-3d",s.style.MozTransformStyle="preserve-3d",s.style.oTransformStyle="preserve-3d",s.style.transformStyle="preserve-3d",a.appendChild(s),this.setClearColor=function(){},this.getSize=function(){return{width:t,height:e}},this.setSize=function(r,o){t=r,e=o,n=t/2,i=e/2,a.style.width=r+"px",a.style.height=o+"px",s.style.width=r+"px",s.style.height=o+"px"};var c=function(t){return Math.abs(t)<1e-6?0:t},l=function(t){var e=t.elements;return"matrix3d("+c(e[0])+","+c(-e[1])+","+c(e[2])+","+c(e[3])+","+c(e[4])+","+c(-e[5])+","+c(e[6])+","+c(e[7])+","+c(e[8])+","+c(-e[9])+","+c(e[10])+","+c(e[11])+","+c(e[12])+","+c(-e[13])+","+c(e[14])+","+c(e[15])+")"},u=function(t){var e=t.elements;return"translate3d(-50%,-50%,0) matrix3d("+c(e[0])+","+c(e[1])+","+c(e[2])+","+c(e[3])+","+c(-e[4])+","+c(-e[5])+","+c(-e[6])+","+c(-e[7])+","+c(e[8])+","+c(e[9])+","+c(e[10])+","+c(e[11])+","+c(e[12])+","+c(e[13])+","+c(e[14])+","+c(e[15])+")";
},h=function(t,e){if(t instanceof THREE.CSS3DObject){var n;t instanceof THREE.CSS3DSprite?(r.copy(e.matrixWorldInverse),r.transpose(),r.copyPosition(t.matrixWorld),r.scale(t.scale),r.elements[3]=0,r.elements[7]=0,r.elements[11]=0,r.elements[15]=1,n=u(r)):n=u(t.matrixWorld);var i=t.element,a=o.objects[t.id];void 0!==a&&a===n||(i.style.WebkitTransform=n,i.style.MozTransform=n,i.style.oTransform=n,i.style.transform=n,o.objects[t.id]=n),i.parentNode!==s&&s.appendChild(i)}for(var c=0,l=t.children.length;c<l;c++)h(t.children[c],e)};this.render=function(t,r){var c=.5/Math.tan(THREE.Math.degToRad(.5*r.fov))*e;o.camera.fov!==c&&(a.style.WebkitPerspective=c+"px",a.style.MozPerspective=c+"px",a.style.oPerspective=c+"px",a.style.perspective=c+"px",o.camera.fov=c),t.updateMatrixWorld(),null===r.parent&&r.updateMatrixWorld(),r.matrixWorldInverse.getInverse(r.matrixWorld);var u="translate3d(0,0,"+c+"px)"+l(r.matrixWorldInverse)+" translate3d("+n+"px,"+i+"px, 0)";o.camera.style!==u&&(s.style.WebkitTransform=u,s.style.MozTransform=u,s.style.oTransform=u,s.style.transform=u,o.camera.style=u),h(t,r)}};THREE.CardboardEffect=function(t){var e=new THREE.OrthographicCamera((-1),1,1,(-1),0,1),n=new THREE.Scene,i=new THREE.StereoCamera;i.aspect=.5;var r={minFilter:THREE.LinearFilter,magFilter:THREE.NearestFilter,format:THREE.RGBAFormat},o=new THREE.WebGLRenderTarget(4096,4096,r);o.scissorTest=!0;var a=new THREE.Vector2(.441,.156),s=new THREE.PlaneBufferGeometry(1,1,10,20).removeAttribute("normal").toNonIndexed(),c=s.attributes.position.array,l=s.attributes.uv.array,u=new Float32Array(2*c.length);u.set(c),u.set(c,c.length);var h=new Float32Array(2*l.length);h.set(l),h.set(l,l.length);for(var p=new THREE.Vector2,d=c.length/3,f=0,m=u.length/3;f<m;f++){p.x=u[3*f+0],p.y=u[3*f+1];var v=p.dot(p),g=1.5+(a.x+a.y*v)*v,y=f<d?0:1;u[3*f+0]=p.x/g*1.5-.5+y,u[3*f+1]=p.y/g*3,h[2*f]=.5*(h[2*f]+y)}s.attributes.position.array=u,s.attributes.uv.array=h;var E=new THREE.MeshBasicMaterial({map:o}),_=new THREE.Mesh(s,E);n.add(_),this.setSize=function(e,n){o.setSize(e,n),t.setSize(e,n)},this.render=function(r,a){r.updateMatrixWorld(),null===a.parent&&a.updateMatrixWorld(),i.update(a);var s=o.width/2,c=o.height;o.scissor.set(0,0,s,c),o.viewport.set(0,0,s,c),t.render(r,i.cameraL,o),o.scissor.set(s,0,s,c),o.viewport.set(s,0,s,c),t.render(r,i.cameraR,o),t.render(n,e)}};THREE.TrackballControls=function(t,e){function n(t){p.enabled!==!1&&(g=v,v===d.NONE&&(t.keyCode!==p.keys[d.ROTATE]||p.noRotate?t.keyCode!==p.keys[d.ZOOM]||p.noZoom?t.keyCode!==p.keys[d.PAN]||p.noPan||(v=d.PAN):v=d.ZOOM:v=d.ROTATE))}function i(t){p.enabled!==!1&&(v=g)}function r(t){p.enabled!==!1&&(v===d.NONE&&(v=t.button),v!==d.ROTATE||p.noRotate?v!==d.ZOOM||p.noZoom?v!==d.PAN||p.noPan||(M.copy(L(t.pageX,t.pageY)),S.copy(M)):(w.copy(L(t.pageX,t.pageY)),R.copy(w)):(_.copy(O(t.pageX,t.pageY)),E.copy(_)),document.addEventListener("mousemove",o,!1),document.addEventListener("mouseup",a,!1),p.dispatchEvent(A))}function o(t){p.enabled!==!1&&(v!==d.ROTATE||p.noRotate?v!==d.ZOOM||p.noZoom?v!==d.PAN||p.noPan||S.copy(L(t.pageX,t.pageY)):R.copy(L(t.pageX,t.pageY)):(E.copy(_),_.copy(O(t.pageX,t.pageY))))}function a(t){p.enabled!==!1&&(v=d.NONE,document.removeEventListener("mousemove",o),document.removeEventListener("mouseup",a),p.dispatchEvent(P))}function s(t){if(p.enabled!==!1){var e=0;t.wheelDelta?e=t.wheelDelta/40:t.detail&&(e=-t.detail/3),w.y+=.01*e,p.dispatchEvent(A),p.dispatchEvent(P)}}function c(t){if(p.enabled!==!1){switch(t.touches.length){case 1:v=d.TOUCH_ROTATE,_.copy(O(t.touches[0].pageX,t.touches[0].pageY)),E.copy(_);break;default:v=d.TOUCH_ZOOM_PAN;var e=t.touches[0].pageX-t.touches[1].pageX,n=t.touches[0].pageY-t.touches[1].pageY;H=x=Math.sqrt(e*e+n*n);var i=(t.touches[0].pageX+t.touches[1].pageX)/2,r=(t.touches[0].pageY+t.touches[1].pageY)/2;M.copy(L(i,r)),S.copy(M)}p.dispatchEvent(A)}}function l(t){if(p.enabled!==!1)switch(t.touches.length){case 1:E.copy(_),_.copy(O(t.touches[0].pageX,t.touches[0].pageY));break;default:var e=t.touches[0].pageX-t.touches[1].pageX,n=t.touches[0].pageY-t.touches[1].pageY;H=Math.sqrt(e*e+n*n);var i=(t.touches[0].pageX+t.touches[1].pageX)/2,r=(t.touches[0].pageY+t.touches[1].pageY)/2;S.copy(L(i,r))}}function u(t){if(p.enabled!==!1){switch(t.touches.length){case 0:v=d.NONE;break;case 1:v=d.TOUCH_ROTATE,_.copy(O(t.touches[0].pageX,t.touches[0].pageY)),E.copy(_)}p.dispatchEvent(P)}}function h(t){t.preventDefault()}var p=this,d={NONE:-1,ROTATE:0,ZOOM:1,PAN:2,TOUCH_ROTATE:3,TOUCH_ZOOM_PAN:4};this.object=t,this.domElement=void 0!==e?e:document,this.enabled=!0,this.screen={left:0,top:0,width:0,height:0},this.rotateSpeed=1,this.zoomSpeed=1.2,this.panSpeed=.3,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.staticMoving=!1,this.dynamicDampingFactor=.2,this.minDistance=0,this.maxDistance=1/0,this.keys=[65,83,68],this.target=new THREE.Vector3;var f=1e-6,m=new THREE.Vector3,v=d.NONE,g=d.NONE,y=new THREE.Vector3,E=new THREE.Vector2,_=new THREE.Vector2,T=new THREE.Vector3,b=0,w=new THREE.Vector2,R=new THREE.Vector2,x=0,H=0,M=new THREE.Vector2,S=new THREE.Vector2;this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.up0=this.object.up.clone();var C={type:"change"},A={type:"start"},P={type:"end"};this.handleResize=function(){if(this.domElement===document)this.screen.left=0,this.screen.top=0,this.screen.width=window.innerWidth,this.screen.height=window.innerHeight;else{var t=this.domElement.getBoundingClientRect(),e=this.domElement.ownerDocument.documentElement;this.screen.left=t.left+window.pageXOffset-e.clientLeft,this.screen.top=t.top+window.pageYOffset-e.clientTop,this.screen.width=t.width,this.screen.height=t.height}},this.handleEvent=function(t){"function"==typeof this[t.type]&&this[t.type](t)};var L=function(){var t=new THREE.Vector2;return function(e,n){return t.set((e-p.screen.left)/p.screen.width,(n-p.screen.top)/p.screen.height),t}}(),O=function(){var t=new THREE.Vector2;return function(e,n){return t.set((e-.5*p.screen.width-p.screen.left)/(.5*p.screen.width),(p.screen.height+2*(p.screen.top-n))/p.screen.width),t}}();this.rotateCamera=function(){var t,e=new THREE.Vector3,n=new THREE.Quaternion,i=new THREE.Vector3,r=new THREE.Vector3,o=new THREE.Vector3,a=new THREE.Vector3;return function(){a.set(_.x-E.x,_.y-E.y,0),t=a.length(),t?(y.copy(p.object.position).sub(p.target),i.copy(y).normalize(),r.copy(p.object.up).normalize(),o.crossVectors(r,i).normalize(),r.setLength(_.y-E.y),o.setLength(_.x-E.x),a.copy(r.add(o)),e.crossVectors(a,y).normalize(),t*=p.rotateSpeed,n.setFromAxisAngle(e,t),y.applyQuaternion(n),p.object.up.applyQuaternion(n),T.copy(e),b=t):!p.staticMoving&&b&&(b*=Math.sqrt(1-p.dynamicDampingFactor),y.copy(p.object.position).sub(p.target),n.setFromAxisAngle(T,b),y.applyQuaternion(n),p.object.up.applyQuaternion(n)),E.copy(_)}}(),this.zoomCamera=function(){var t;v===d.TOUCH_ZOOM_PAN?(t=x/H,x=H,y.multiplyScalar(t)):(t=1+(R.y-w.y)*p.zoomSpeed,1!==t&&t>0&&(y.multiplyScalar(t),p.staticMoving?w.copy(R):w.y+=(R.y-w.y)*this.dynamicDampingFactor))},this.panCamera=function(){var t=new THREE.Vector2,e=new THREE.Vector3,n=new THREE.Vector3;return function(){t.copy(S).sub(M),t.lengthSq()&&(t.multiplyScalar(y.length()*p.panSpeed),n.copy(y).cross(p.object.up).setLength(t.x),n.add(e.copy(p.object.up).setLength(t.y)),p.object.position.add(n),p.target.add(n),p.staticMoving?M.copy(S):M.add(t.subVectors(S,M).multiplyScalar(p.dynamicDampingFactor)))}}(),this.checkDistances=function(){p.noZoom&&p.noPan||(y.lengthSq()>p.maxDistance*p.maxDistance&&(p.object.position.addVectors(p.target,y.setLength(p.maxDistance)),w.copy(R)),y.lengthSq()<p.minDistance*p.minDistance&&(p.object.position.addVectors(p.target,y.setLength(p.minDistance)),w.copy(R)))},this.update=function(){y.subVectors(p.object.position,p.target),p.noRotate||p.rotateCamera(),p.noZoom||p.zoomCamera(),p.noPan||p.panCamera(),p.object.position.addVectors(p.target,y),p.checkDistances(),p.object.lookAt(p.target),m.distanceToSquared(p.object.position)>f&&(p.dispatchEvent(C),m.copy(p.object.position))},this.reset=function(){v=d.NONE,g=d.NONE,p.target.copy(p.target0),p.object.position.copy(p.position0),p.object.up.copy(p.up0),y.subVectors(p.object.position,p.target),p.object.lookAt(p.target),p.dispatchEvent(C),m.copy(p.object.position)},this.dispose=function(){this.domElement.removeEventListener("contextmenu",h,!1),this.domElement.removeEventListener("mousedown",r,!1),this.domElement.removeEventListener("mousewheel",s,!1),this.domElement.removeEventListener("MozMousePixelScroll",s,!1),this.domElement.removeEventListener("touchstart",c,!1),this.domElement.removeEventListener("touchend",u,!1),this.domElement.removeEventListener("touchmove",l,!1),document.removeEventListener("mousemove",o,!1),document.removeEventListener("mouseup",a,!1),window.removeEventListener("keydown",n,!1),window.removeEventListener("keyup",i,!1)},this.domElement.addEventListener("contextmenu",h,!1),this.domElement.addEventListener("mousedown",r,!1),this.domElement.addEventListener("mousewheel",s,!1),this.domElement.addEventListener("MozMousePixelScroll",s,!1),this.domElement.addEventListener("touchstart",c,!1),this.domElement.addEventListener("touchend",u,!1),this.domElement.addEventListener("touchmove",l,!1),window.addEventListener("keydown",n,!1),window.addEventListener("keyup",i,!1),this.handleResize(),this.update()},THREE.TrackballControls.prototype=Object.create(THREE.EventDispatcher.prototype),THREE.TrackballControls.prototype.constructor=THREE.TrackballControls,/**
 * @license
 * Video.js 5.9.2 <http://videojs.com/>
 * Copyright Brightcove, Inc. <https://www.brightcove.com/>
 * Available under Apache License Version 2.0
 * <https://github.com/videojs/video.js/blob/master/LICENSE>
 *
 * Includes vtt.js <https://github.com/mozilla/vtt.js>
 * Available under Apache License Version 2.0
 * <https://github.com/mozilla/vtt.js/blob/master/LICENSE>
 */
function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.videojs=t()}}(function(){var t;return function t(e,n,i){function r(a,s){if(!n[a]){if(!e[a]){var c="function"==typeof require&&require;if(!s&&c)return c(a,!0);if(o)return o(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var u=n[a]={exports:{}};e[a][0].call(u.exports,function(t){var n=e[a][1][t];return r(n?n:t)},u,u.exports,t,e,n,i)}return n[a].exports}for(var o="function"==typeof require&&require,a=0;a<i.length;a++)r(i[a]);return r}({1:[function(t,e,n){(function(n){var i="undefined"!=typeof n?n:"undefined"!=typeof window?window:{},r=t("min-document");if("undefined"!=typeof document)e.exports=document;else{var o=i["__GLOBAL_DOCUMENT_CACHE@4"];o||(o=i["__GLOBAL_DOCUMENT_CACHE@4"]=r),e.exports=o}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"min-document":3}],2:[function(t,e,n){(function(t){"undefined"!=typeof window?e.exports=window:"undefined"!=typeof t?e.exports=t:"undefined"!=typeof self?e.exports=self:e.exports={}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],3:[function(t,e,n){},{}],4:[function(t,e,n){var i=t("../internal/getNative"),r=i(Date,"now"),o=r||function(){return(new Date).getTime()};e.exports=o},{"../internal/getNative":20}],5:[function(t,e,n){function i(t,e,n){function i(){g&&clearTimeout(g),d&&clearTimeout(d),E=0,d=g=y=void 0}function c(e,n){n&&clearTimeout(n),d=g=y=void 0,e&&(E=o(),f=t.apply(v,p),g||d||(p=v=void 0))}function l(){var t=e-(o()-m);t<=0||t>e?c(y,d):g=setTimeout(l,t)}function u(){c(T,g)}function h(){if(p=arguments,m=o(),v=this,y=T&&(g||!b),_===!1)var n=b&&!g;else{d||b||(E=m);var i=_-(m-E),r=i<=0||i>_;r?(d&&(d=clearTimeout(d)),E=m,f=t.apply(v,p)):d||(d=setTimeout(u,i))}return r&&g?g=clearTimeout(g):g||e===_||(g=setTimeout(l,e)),n&&(r=!0,f=t.apply(v,p)),!r||g||d||(p=v=void 0),f}var p,d,f,m,v,g,y,E=0,_=!1,T=!0;if("function"!=typeof t)throw new TypeError(a);if(e=e<0?0:+e||0,n===!0){var b=!0;T=!1}else r(n)&&(b=!!n.leading,_="maxWait"in n&&s(+n.maxWait||0,e),T="trailing"in n?!!n.trailing:T);return h.cancel=i,h}var r=t("../lang/isObject"),o=t("../date/now"),a="Expected a function",s=Math.max;e.exports=i},{"../date/now":4,"../lang/isObject":33}],6:[function(t,e,n){function i(t,e){if("function"!=typeof t)throw new TypeError(r);return e=o(void 0===e?t.length-1:+e||0,0),function(){for(var n=arguments,i=-1,r=o(n.length-e,0),a=Array(r);++i<r;)a[i]=n[e+i];switch(e){case 0:return t.call(this,a);case 1:return t.call(this,n[0],a);case 2:return t.call(this,n[0],n[1],a)}var s=Array(e+1);for(i=-1;++i<e;)s[i]=n[i];return s[e]=a,t.apply(this,s)}}var r="Expected a function",o=Math.max;e.exports=i},{}],7:[function(t,e,n){function i(t,e,n){var i=!0,s=!0;if("function"!=typeof t)throw new TypeError(a);return n===!1?i=!1:o(n)&&(i="leading"in n?!!n.leading:i,s="trailing"in n?!!n.trailing:s),r(t,e,{leading:i,maxWait:+e,trailing:s})}var r=t("./debounce"),o=t("../lang/isObject"),a="Expected a function";e.exports=i},{"../lang/isObject":33,"./debounce":5}],8:[function(t,e,n){function i(t,e){var n=-1,i=t.length;for(e||(e=Array(i));++n<i;)e[n]=t[n];return e}e.exports=i},{}],9:[function(t,e,n){function i(t,e){for(var n=-1,i=t.length;++n<i&&e(t[n],n,t)!==!1;);return t}e.exports=i},{}],10:[function(t,e,n){function i(t,e,n){n||(n={});for(var i=-1,r=e.length;++i<r;){var o=e[i];n[o]=t[o]}return n}e.exports=i},{}],11:[function(t,e,n){var i=t("./createBaseFor"),r=i();e.exports=r},{"./createBaseFor":18}],12:[function(t,e,n){function i(t,e){return r(t,e,o)}var r=t("./baseFor"),o=t("../object/keysIn");e.exports=i},{"../object/keysIn":39,"./baseFor":11}],13:[function(t,e,n){function i(t,e,n,p,d){if(!c(t))return t;var f=s(e)&&(a(e)||u(e)),m=f?void 0:h(e);return r(m||e,function(r,a){if(m&&(a=r,r=e[a]),l(r))p||(p=[]),d||(d=[]),o(t,e,a,i,n,p,d);else{var s=t[a],c=n?n(s,r,a,t,e):void 0,u=void 0===c;u&&(c=r),void 0===c&&(!f||a in t)||!u&&(c===c?c===s:s!==s)||(t[a]=c)}}),t}var r=t("./arrayEach"),o=t("./baseMergeDeep"),a=t("../lang/isArray"),s=t("./isArrayLike"),c=t("../lang/isObject"),l=t("./isObjectLike"),u=t("../lang/isTypedArray"),h=t("../object/keys");e.exports=i},{"../lang/isArray":30,"../lang/isObject":33,"../lang/isTypedArray":36,"../object/keys":38,"./arrayEach":9,"./baseMergeDeep":14,"./isArrayLike":21,"./isObjectLike":26}],14:[function(t,e,n){function i(t,e,n,i,h,p,d){for(var f=p.length,m=e[n];f--;)if(p[f]==m)return void(t[n]=d[f]);var v=t[n],g=h?h(v,m,n,t,e):void 0,y=void 0===g;y&&(g=m,s(m)&&(a(m)||l(m))?g=a(v)?v:s(v)?r(v):[]:c(m)||o(m)?g=o(v)?u(v):c(v)?v:{}:y=!1),p.push(m),d.push(g),y?t[n]=i(g,m,h,p,d):(g===g?g!==v:v===v)&&(t[n]=g)}var r=t("./arrayCopy"),o=t("../lang/isArguments"),a=t("../lang/isArray"),s=t("./isArrayLike"),c=t("../lang/isPlainObject"),l=t("../lang/isTypedArray"),u=t("../lang/toPlainObject");e.exports=i},{"../lang/isArguments":29,"../lang/isArray":30,"../lang/isPlainObject":34,"../lang/isTypedArray":36,"../lang/toPlainObject":37,"./arrayCopy":8,"./isArrayLike":21}],15:[function(t,e,n){function i(t){return function(e){return null==e?void 0:r(e)[t]}}var r=t("./toObject");e.exports=i},{"./toObject":28}],16:[function(t,e,n){function i(t,e,n){if("function"!=typeof t)return r;if(void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 3:return function(n,i,r){return t.call(e,n,i,r)};case 4:return function(n,i,r,o){return t.call(e,n,i,r,o)};case 5:return function(n,i,r,o,a){return t.call(e,n,i,r,o,a)}}return function(){return t.apply(e,arguments)}}var r=t("../utility/identity");e.exports=i},{"../utility/identity":42}],17:[function(t,e,n){function i(t){return a(function(e,n){var i=-1,a=null==e?0:n.length,s=a>2?n[a-2]:void 0,c=a>2?n[2]:void 0,l=a>1?n[a-1]:void 0;for("function"==typeof s?(s=r(s,l,5),a-=2):(s="function"==typeof l?l:void 0,a-=s?1:0),c&&o(n[0],n[1],c)&&(s=a<3?void 0:s,a=1);++i<a;){var u=n[i];u&&t(e,u,s)}return e})}var r=t("./bindCallback"),o=t("./isIterateeCall"),a=t("../function/restParam");e.exports=i},{"../function/restParam":6,"./bindCallback":16,"./isIterateeCall":24}],18:[function(t,e,n){function i(t){return function(e,n,i){for(var o=r(e),a=i(e),s=a.length,c=t?s:-1;t?c--:++c<s;){var l=a[c];if(n(o[l],l,o)===!1)break}return e}}var r=t("./toObject");e.exports=i},{"./toObject":28}],19:[function(t,e,n){var i=t("./baseProperty"),r=i("length");e.exports=r},{"./baseProperty":15}],20:[function(t,e,n){function i(t,e){var n=null==t?void 0:t[e];return r(n)?n:void 0}var r=t("../lang/isNative");e.exports=i},{"../lang/isNative":32}],21:[function(t,e,n){function i(t){return null!=t&&o(r(t))}var r=t("./getLength"),o=t("./isLength");e.exports=i},{"./getLength":19,"./isLength":25}],22:[function(t,e,n){var i=function(){try{Object({toString:0}+"")}catch(t){return function(){return!1}}return function(t){return"function"!=typeof t.toString&&"string"==typeof(t+"")}}();e.exports=i},{}],23:[function(t,e,n){function i(t,e){return t="number"==typeof t||r.test(t)?+t:-1,e=null==e?o:e,t>-1&&t%1==0&&t<e}var r=/^\d+$/,o=9007199254740991;e.exports=i},{}],24:[function(t,e,n){function i(t,e,n){if(!a(n))return!1;var i=typeof e;if("number"==i?r(n)&&o(e,n.length):"string"==i&&e in n){var s=n[e];return t===t?t===s:s!==s}return!1}var r=t("./isArrayLike"),o=t("./isIndex"),a=t("../lang/isObject");e.exports=i},{"../lang/isObject":33,"./isArrayLike":21,"./isIndex":23}],25:[function(t,e,n){function i(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=r}var r=9007199254740991;e.exports=i},{}],26:[function(t,e,n){function i(t){return!!t&&"object"==typeof t}e.exports=i},{}],27:[function(t,e,n){function i(t){for(var e=l(t),n=e.length,i=n&&t.length,u=!!i&&s(i)&&(o(t)||r(t)||c(t)),p=-1,d=[];++p<n;){var f=e[p];(u&&a(f,i)||h.call(t,f))&&d.push(f)}return d}var r=t("../lang/isArguments"),o=t("../lang/isArray"),a=t("./isIndex"),s=t("./isLength"),c=t("../lang/isString"),l=t("../object/keysIn"),u=Object.prototype,h=u.hasOwnProperty;e.exports=i},{"../lang/isArguments":29,"../lang/isArray":30,"../lang/isString":35,"../object/keysIn":39,"./isIndex":23,"./isLength":25}],28:[function(t,e,n){function i(t){if(a.unindexedChars&&o(t)){for(var e=-1,n=t.length,i=Object(t);++e<n;)i[e]=t.charAt(e);return i}return r(t)?t:Object(t)}var r=t("../lang/isObject"),o=t("../lang/isString"),a=t("../support");e.exports=i},{"../lang/isObject":33,"../lang/isString":35,"../support":41}],29:[function(t,e,n){function i(t){return o(t)&&r(t)&&s.call(t,"callee")&&!c.call(t,"callee")}var r=t("../internal/isArrayLike"),o=t("../internal/isObjectLike"),a=Object.prototype,s=a.hasOwnProperty,c=a.propertyIsEnumerable;e.exports=i},{"../internal/isArrayLike":21,"../internal/isObjectLike":26}],30:[function(t,e,n){var i=t("../internal/getNative"),r=t("../internal/isLength"),o=t("../internal/isObjectLike"),a="[object Array]",s=Object.prototype,c=s.toString,l=i(Array,"isArray"),u=l||function(t){return o(t)&&r(t.length)&&c.call(t)==a};e.exports=u},{"../internal/getNative":20,"../internal/isLength":25,"../internal/isObjectLike":26}],31:[function(t,e,n){function i(t){return r(t)&&s.call(t)==o}var r=t("./isObject"),o="[object Function]",a=Object.prototype,s=a.toString;e.exports=i},{"./isObject":33}],32:[function(t,e,n){function i(t){return null!=t&&(r(t)?h.test(l.call(t)):a(t)&&(o(t)?h:s).test(t))}var r=t("./isFunction"),o=t("../internal/isHostObject"),a=t("../internal/isObjectLike"),s=/^\[object .+?Constructor\]$/,c=Object.prototype,l=Function.prototype.toString,u=c.hasOwnProperty,h=RegExp("^"+l.call(u).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=i},{"../internal/isHostObject":22,"../internal/isObjectLike":26,"./isFunction":31}],33:[function(t,e,n){function i(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}e.exports=i},{}],34:[function(t,e,n){function i(t){var e;if(!s(t)||p.call(t)!=l||a(t)||o(t)||!h.call(t,"constructor")&&(e=t.constructor,"function"==typeof e&&!(e instanceof e)))return!1;var n;return c.ownLast?(r(t,function(t,e,i){return n=h.call(i,e),!1}),n!==!1):(r(t,function(t,e){n=e}),void 0===n||h.call(t,n))}var r=t("../internal/baseForIn"),o=t("./isArguments"),a=t("../internal/isHostObject"),s=t("../internal/isObjectLike"),c=t("../support"),l="[object Object]",u=Object.prototype,h=u.hasOwnProperty,p=u.toString;e.exports=i},{"../internal/baseForIn":12,"../internal/isHostObject":22,"../internal/isObjectLike":26,"../support":41,"./isArguments":29}],35:[function(t,e,n){function i(t){return"string"==typeof t||r(t)&&s.call(t)==o}var r=t("../internal/isObjectLike"),o="[object String]",a=Object.prototype,s=a.toString;e.exports=i},{"../internal/isObjectLike":26}],36:[function(t,e,n){function i(t){return o(t)&&r(t.length)&&!!C[P.call(t)]}var r=t("../internal/isLength"),o=t("../internal/isObjectLike"),a="[object Arguments]",s="[object Array]",c="[object Boolean]",l="[object Date]",u="[object Error]",h="[object Function]",p="[object Map]",d="[object Number]",f="[object Object]",m="[object RegExp]",v="[object Set]",g="[object String]",y="[object WeakMap]",E="[object ArrayBuffer]",_="[object Float32Array]",T="[object Float64Array]",b="[object Int8Array]",w="[object Int16Array]",R="[object Int32Array]",x="[object Uint8Array]",H="[object Uint8ClampedArray]",M="[object Uint16Array]",S="[object Uint32Array]",C={};C[_]=C[T]=C[b]=C[w]=C[R]=C[x]=C[H]=C[M]=C[S]=!0,C[a]=C[s]=C[E]=C[c]=C[l]=C[u]=C[h]=C[p]=C[d]=C[f]=C[m]=C[v]=C[g]=C[y]=!1;var A=Object.prototype,P=A.toString;e.exports=i},{"../internal/isLength":25,"../internal/isObjectLike":26}],37:[function(t,e,n){function i(t){return r(t,o(t))}var r=t("../internal/baseCopy"),o=t("../object/keysIn");e.exports=i},{"../internal/baseCopy":10,"../object/keysIn":39}],38:[function(t,e,n){var i=t("../internal/getNative"),r=t("../internal/isArrayLike"),o=t("../lang/isObject"),a=t("../internal/shimKeys"),s=t("../support"),c=i(Object,"keys"),l=c?function(t){var e=null==t?void 0:t.constructor;return"function"==typeof e&&e.prototype===t||("function"==typeof t?s.enumPrototypes:r(t))?a(t):o(t)?c(t):[]}:a;e.exports=l},{"../internal/getNative":20,"../internal/isArrayLike":21,"../internal/shimKeys":27,"../lang/isObject":33,"../support":41}],39:[function(t,e,n){function i(t){if(null==t)return[];u(t)||(t=Object(t));var e=t.length;e=e&&l(e)&&(a(t)||o(t)||h(t))&&e||0;for(var n=t.constructor,i=-1,r=s(n)&&n.prototype||R,d=r===t,f=Array(e),m=e>0,g=p.enumErrorProps&&(t===w||t instanceof Error),y=p.enumPrototypes&&s(t);++i<e;)f[i]=i+"";for(var _ in t)y&&"prototype"==_||g&&("message"==_||"name"==_)||m&&c(_,e)||"constructor"==_&&(d||!H.call(t,_))||f.push(_);if(p.nonEnumShadows&&t!==R){var C=t===x?T:t===w?v:M.call(t),A=S[C]||S[E];for(C==E&&(r=R),e=b.length;e--;){_=b[e];var P=A[_];d&&P||(P?!H.call(t,_):t[_]===r[_])||f.push(_)}}return f}var r=t("../internal/arrayEach"),o=t("../lang/isArguments"),a=t("../lang/isArray"),s=t("../lang/isFunction"),c=t("../internal/isIndex"),l=t("../internal/isLength"),u=t("../lang/isObject"),h=t("../lang/isString"),p=t("../support"),d="[object Array]",f="[object Boolean]",m="[object Date]",v="[object Error]",g="[object Function]",y="[object Number]",E="[object Object]",_="[object RegExp]",T="[object String]",b=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],w=Error.prototype,R=Object.prototype,x=String.prototype,H=R.hasOwnProperty,M=R.toString,S={};S[d]=S[m]=S[y]={constructor:!0,toLocaleString:!0,toString:!0,valueOf:!0},S[f]=S[T]={constructor:!0,toString:!0,valueOf:!0},S[v]=S[g]=S[_]={constructor:!0,toString:!0},S[E]={constructor:!0},r(b,function(t){for(var e in S)if(H.call(S,e)){var n=S[e];n[t]=H.call(n,t)}}),e.exports=i},{"../internal/arrayEach":9,"../internal/isIndex":23,"../internal/isLength":25,"../lang/isArguments":29,"../lang/isArray":30,"../lang/isFunction":31,"../lang/isObject":33,"../lang/isString":35,"../support":41}],40:[function(t,e,n){var i=t("../internal/baseMerge"),r=t("../internal/createAssigner"),o=r(i);e.exports=o},{"../internal/baseMerge":13,"../internal/createAssigner":17}],41:[function(t,e,n){var i=Array.prototype,r=Error.prototype,o=Object.prototype,a=o.propertyIsEnumerable,s=i.splice,c={};!function(t){var e=function(){this.x=t},n={0:t,length:t},i=[];e.prototype={valueOf:t,y:t};for(var o in new e)i.push(o);c.enumErrorProps=a.call(r,"message")||a.call(r,"name"),c.enumPrototypes=a.call(e,"prototype"),c.nonEnumShadows=!/valueOf/.test(i),c.ownLast="x"!=i[0],c.spliceObjects=(s.call(n,0,1),!n[0]),c.unindexedChars="x"[0]+Object("x")[0]!="xx"}(1,0),e.exports=c},{}],42:[function(t,e,n){function i(t){return t}e.exports=i},{}],43:[function(t,e,n){"use strict";var i=t("object-keys");e.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var t={},e=Symbol("test");if("string"==typeof e)return!1;var n=42;t[e]=n;for(e in t)return!1;if(0!==i(t).length)return!1;if("function"==typeof Object.keys&&0!==Object.keys(t).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(t).length)return!1;var r=Object.getOwnPropertySymbols(t);if(1!==r.length||r[0]!==e)return!1;if(!Object.prototype.propertyIsEnumerable.call(t,e))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var o=Object.getOwnPropertyDescriptor(t,e);if(o.value!==n||o.enumerable!==!0)return!1}return!0}},{"object-keys":50}],44:[function(t,e,n){"use strict";var i=t("object-keys"),r=t("function-bind"),o=function(t){return"undefined"!=typeof t&&null!==t},a=t("./hasSymbols")(),s=Object,c=r.call(Function.call,Array.prototype.push),l=r.call(Function.call,Object.prototype.propertyIsEnumerable);e.exports=function(t,e){if(!o(t))throw new TypeError("target must be an object");var n,r,u,h,p,d,f,m=s(t);for(n=1;n<arguments.length;++n){if(r=s(arguments[n]),h=i(r),a&&Object.getOwnPropertySymbols)for(p=Object.getOwnPropertySymbols(r),u=0;u<p.length;++u)f=p[u],l(r,f)&&c(h,f);for(u=0;u<h.length;++u)f=h[u],d=r[f],l(r,f)&&(m[f]=d)}return m}},{"./hasSymbols":43,"function-bind":49,"object-keys":50}],45:[function(t,e,n){"use strict";var i=t("define-properties"),r=t("./implementation"),o=t("./polyfill"),a=t("./shim");i(r,{implementation:r,getPolyfill:o,shim:a}),e.exports=r},{"./implementation":44,"./polyfill":52,"./shim":53,"define-properties":46}],46:[function(t,e,n){"use strict";var i=t("object-keys"),r=t("foreach"),o="function"==typeof Symbol&&"symbol"==typeof Symbol(),a=Object.prototype.toString,s=function(t){return"function"==typeof t&&"[object Function]"===a.call(t)},c=function(){var t={};try{Object.defineProperty(t,"x",{enumerable:!1,value:t});for(var e in t)return!1;return t.x===t}catch(t){return!1}},l=Object.defineProperty&&c(),u=function(t,e,n,i){(!(e in t)||s(i)&&i())&&(l?Object.defineProperty(t,e,{configurable:!0,enumerable:!1,value:n,writable:!0}):t[e]=n)},h=function(t,e){var n=arguments.length>2?arguments[2]:{},a=i(e);o&&(a=a.concat(Object.getOwnPropertySymbols(e))),r(a,function(i){u(t,i,e[i],n[i])})};h.supportsDescriptors=!!l,e.exports=h},{foreach:47,"object-keys":50}],47:[function(t,e,n){var i=Object.prototype.hasOwnProperty,r=Object.prototype.toString;e.exports=function(t,e,n){if("[object Function]"!==r.call(e))throw new TypeError("iterator must be a function");var o=t.length;if(o===+o)for(var a=0;a<o;a++)e.call(n,t[a],a,t);else for(var s in t)i.call(t,s)&&e.call(n,t[s],s,t)}},{}],48:[function(t,e,n){var i="Function.prototype.bind called on incompatible ",r=Array.prototype.slice,o=Object.prototype.toString,a="[object Function]";e.exports=function(t){var e=this;if("function"!=typeof e||o.call(e)!==a)throw new TypeError(i+e);for(var n,s=r.call(arguments,1),c=function(){if(this instanceof n){var i=e.apply(this,s.concat(r.call(arguments)));return Object(i)===i?i:this}return e.apply(t,s.concat(r.call(arguments)))},l=Math.max(0,e.length-s.length),u=[],h=0;h<l;h++)u.push("$"+h);if(n=Function("binder","return function ("+u.join(",")+"){ return binder.apply(this,arguments); }")(c),e.prototype){var p=function(){};p.prototype=e.prototype,n.prototype=new p,p.prototype=null}return n}},{}],49:[function(t,e,n){var i=t("./implementation");e.exports=Function.prototype.bind||i},{"./implementation":48}],50:[function(t,e,n){"use strict";var i=Object.prototype.hasOwnProperty,r=Object.prototype.toString,o=Array.prototype.slice,a=t("./isArguments"),s=!{toString:null}.propertyIsEnumerable("toString"),c=function(){}.propertyIsEnumerable("prototype"),l=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],u=function(t){var e=t.constructor;return e&&e.prototype===t},h={$console:!0,$frame:!0,$frameElement:!0,$frames:!0,$parent:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},p=function(){if("undefined"==typeof window)return!1;for(var t in window)try{if(!h["$"+t]&&i.call(window,t)&&null!==window[t]&&"object"==typeof window[t])try{u(window[t])}catch(t){return!0}}catch(t){return!0}return!1}(),d=function(t){if("undefined"==typeof window||!p)return u(t);try{return u(t)}catch(t){return!1}},f=function(t){var e=null!==t&&"object"==typeof t,n="[object Function]"===r.call(t),o=a(t),u=e&&"[object String]"===r.call(t),h=[];if(!e&&!n&&!o)throw new TypeError("Object.keys called on a non-object");var p=c&&n;if(u&&t.length>0&&!i.call(t,0))for(var f=0;f<t.length;++f)h.push(String(f));if(o&&t.length>0)for(var m=0;m<t.length;++m)h.push(String(m));else for(var v in t)p&&"prototype"===v||!i.call(t,v)||h.push(String(v));if(s)for(var g=d(t),y=0;y<l.length;++y)g&&"constructor"===l[y]||!i.call(t,l[y])||h.push(l[y]);return h};f.shim=function(){if(Object.keys){var t=function(){return 2===(Object.keys(arguments)||"").length}(1,2);if(!t){var e=Object.keys;Object.keys=function(t){return e(a(t)?o.call(t):t)}}}else Object.keys=f;return Object.keys||f},e.exports=f},{"./isArguments":51}],51:[function(t,e,n){"use strict";var i=Object.prototype.toString;e.exports=function(t){var e=i.call(t),n="[object Arguments]"===e;return n||(n="[object Array]"!==e&&null!==t&&"object"==typeof t&&"number"==typeof t.length&&t.length>=0&&"[object Function]"===i.call(t.callee)),n}},{}],52:[function(t,e,n){"use strict";var i=t("./implementation"),r=function(){if(!Object.assign)return!1;for(var t="abcdefghijklmnopqrst",e=t.split(""),n={},i=0;i<e.length;++i)n[e[i]]=e[i];var r=Object.assign({},n),o="";for(var a in r)o+=a;return t!==o},o=function(){if(!Object.assign||!Object.preventExtensions)return!1;var t=Object.preventExtensions({1:2});try{Object.assign(t,"xy")}catch(e){return"y"===t[1]}};e.exports=function(){return Object.assign?r()?i:o()?i:Object.assign:i}},{"./implementation":44}],53:[function(t,e,n){"use strict";var i=t("define-properties"),r=t("./polyfill");e.exports=function(){var t=r();return i(Object,{assign:t},{assign:function(){return Object.assign!==t}}),t}},{"./polyfill":52,"define-properties":46}],54:[function(t,e,n){function i(t,e){var n,i=null;try{n=JSON.parse(t,e)}catch(t){i=t}return[i,n]}e.exports=i},{}],55:[function(t,e,n){function i(t){return t.replace(/\n\r?\s*/g,"")}e.exports=function(t){for(var e="",n=0;n<arguments.length;n++)e+=i(t[n])+(arguments[n+1]||"");return e}},{}],56:[function(t,e,n){"use strict";function i(t,e){for(var n=0;n<t.length;n++)e(t[n])}function r(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0}function o(t,e,n){var i=t;return h(e)?(n=e,"string"==typeof t&&(i={uri:t})):i=d(e,{uri:t}),i.callback=n,i}function a(t,e,n){return e=o(t,e,n),s(e)}function s(t){function e(){4===l.readyState&&o()}function n(){var t=void 0;if(l.response?t=l.response:"text"!==l.responseType&&l.responseType||(t=l.responseText||l.responseXML),_)try{t=JSON.parse(t)}catch(t){}return t}function i(t){clearTimeout(f),t instanceof Error||(t=new Error(""+(t||"Unknown XMLHttpRequest Error"))),t.statusCode=0,s(t,c)}function o(){if(!d){var e;clearTimeout(f),e=t.useXDR&&void 0===l.status?200:1223===l.status?204:l.status;var i=c,r=null;0!==e?(i={body:n(),statusCode:e,method:v,headers:{},url:m,rawRequest:l},l.getAllResponseHeaders&&(i.headers=p(l.getAllResponseHeaders()))):r=new Error("Internal XMLHttpRequest Error"),s(r,i,i.body)}}var s=t.callback;if("undefined"==typeof s)throw new Error("callback argument missing");s=u(s);var c={body:void 0,headers:{},statusCode:0,method:v,url:m,rawRequest:l},l=t.xhr||null;l||(l=t.cors||t.useXDR?new a.XDomainRequest:new a.XMLHttpRequest);var h,d,f,m=l.url=t.uri||t.url,v=l.method=t.method||"GET",g=t.body||t.data||null,y=l.headers=t.headers||{},E=!!t.sync,_=!1;if("json"in t&&(_=!0,y.accept||y.Accept||(y.Accept="application/json"),"GET"!==v&&"HEAD"!==v&&(y["content-type"]||y["Content-Type"]||(y["Content-Type"]="application/json"),g=JSON.stringify(t.json))),l.onreadystatechange=e,l.onload=o,l.onerror=i,l.onprogress=function(){},l.ontimeout=i,l.open(v,m,!E,t.username,t.password),E||(l.withCredentials=!!t.withCredentials),!E&&t.timeout>0&&(f=setTimeout(function(){d=!0,l.abort("timeout");var t=new Error("XMLHttpRequest timeout");t.code="ETIMEDOUT",i(t)},t.timeout)),l.setRequestHeader)for(h in y)y.hasOwnProperty(h)&&l.setRequestHeader(h,y[h]);else if(t.headers&&!r(t.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in t&&(l.responseType=t.responseType),"beforeSend"in t&&"function"==typeof t.beforeSend&&t.beforeSend(l),l.send(g),l}function c(){}var l=t("global/window"),u=t("once"),h=t("is-function"),p=t("parse-headers"),d=t("xtend");e.exports=a,a.XMLHttpRequest=l.XMLHttpRequest||c,a.XDomainRequest="withCredentials"in new a.XMLHttpRequest?a.XMLHttpRequest:l.XDomainRequest,i(["get","put","post","patch","head","delete"],function(t){a["delete"===t?"del":t]=function(e,n,i){return n=o(e,n,i),n.method=t.toUpperCase(),s(n)}})},{"global/window":2,"is-function":57,once:58,"parse-headers":61,xtend:62}],57:[function(t,e,n){function i(t){var e=r.call(t);return"[object Function]"===e||"function"==typeof t&&"[object RegExp]"!==e||"undefined"!=typeof window&&(t===window.setTimeout||t===window.alert||t===window.confirm||t===window.prompt)}e.exports=i;var r=Object.prototype.toString},{}],58:[function(t,e,n){function i(t){var e=!1;return function(){if(!e)return e=!0,t.apply(this,arguments)}}e.exports=i,i.proto=i(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return i(this)},configurable:!0})})},{}],59:[function(t,e,n){function i(t,e,n){if(!s(e))throw new TypeError("iterator must be a function");arguments.length<3&&(n=this),"[object Array]"===c.call(t)?r(t,e,n):"string"==typeof t?o(t,e,n):a(t,e,n)}function r(t,e,n){for(var i=0,r=t.length;i<r;i++)l.call(t,i)&&e.call(n,t[i],i,t)}function o(t,e,n){for(var i=0,r=t.length;i<r;i++)e.call(n,t.charAt(i),i,t)}function a(t,e,n){for(var i in t)l.call(t,i)&&e.call(n,t[i],i,t)}var s=t("is-function");e.exports=i;var c=Object.prototype.toString,l=Object.prototype.hasOwnProperty},{"is-function":57}],60:[function(t,e,n){function i(t){return t.replace(/^\s*|\s*$/g,"")}n=e.exports=i,n.left=function(t){return t.replace(/^\s*/,"")},n.right=function(t){return t.replace(/\s*$/,"")}},{}],61:[function(t,e,n){var i=t("trim"),r=t("for-each"),o=function(t){return"[object Array]"===Object.prototype.toString.call(t)};e.exports=function(t){if(!t)return{};var e={};return r(i(t).split("\n"),function(t){var n=t.indexOf(":"),r=i(t.slice(0,n)).toLowerCase(),a=i(t.slice(n+1));"undefined"==typeof e[r]?e[r]=a:o(e[r])?e[r].push(a):e[r]=[e[r],a]}),e}},{"for-each":59,trim:60}],62:[function(t,e,n){function i(){for(var t={},e=0;e<arguments.length;e++){var n=arguments[e];for(var i in n)r.call(n,i)&&(t[i]=n[i])}return t}e.exports=i;var r=Object.prototype.hasOwnProperty},{}],63:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}n.__esModule=!0;var a=t("./button.js"),s=i(a),c=t("./component.js"),l=i(c),u=function(t){function e(n,i){r(this,e),t.call(this,n,i)}return o(e,t),e.prototype.buildCSSClass=function(){return"vjs-big-play-button"},e.prototype.handleClick=function(){this.player_.play()},e}(s.default);u.prototype.controlText_="Play Video",l.default.registerComponent("BigPlayButton",u),n.default=u,e.exports=n.default},{"./button.js":64,"./component.js":67}],64:[function(t,e,n){"use strict";function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}n.__esModule=!0;var s=t("./clickable-component.js"),c=r(s),l=t("./component"),u=r(l),h=t("./utils/events.js"),p=(i(h),t("./utils/fn.js")),d=(i(p),t("./utils/log.js")),f=r(d),m=t("global/document"),v=(r(m),t("object.assign")),g=r(v),y=function(t){function e(n,i){o(this,e),t.call(this,n,i)}return a(e,t),e.prototype.createEl=function(){var t=arguments.length<=0||void 0===arguments[0]?"button":arguments[0],e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];e=g.default({className:this.buildCSSClass()},e),"button"!==t&&(f.default.warn("Creating a Button with an HTML element of "+t+" is deprecated; use ClickableComponent instead."),e=g.default({tabIndex:0},e),n=g.default({role:"button"},n)),n=g.default({type:"button","aria-live":"polite"},n);var i=u.default.prototype.createEl.call(this,t,e,n);return this.createControlTextEl(i),i},e.prototype.addChild=function(t){var e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=this.constructor.name;return f.default.warn("Adding an actionable (user controllable) child to a Button ("+n+") is not supported; use a ClickableComponent instead."),u.default.prototype.addChild.call(this,t,e)},e.prototype.handleKeyPress=function(e){32===e.which||13===e.which||t.prototype.handleKeyPress.call(this,e)},e}(c.default);u.default.registerComponent("Button",y),n.default=y,e.exports=n.default},{"./clickable-component.js":65,"./component":67,"./utils/events.js":135,"./utils/fn.js":136,"./utils/log.js":139,"global/document":1,"object.assign":45}],65:[function(t,e,n){"use strict";function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}n.__esModule=!0;var s=t("./component"),c=r(s),l=t("./utils/dom.js"),u=i(l),h=t("./utils/events.js"),p=i(h),d=t("./utils/fn.js"),f=i(d),m=t("./utils/log.js"),v=r(m),g=t("global/document"),y=r(g),E=t("object.assign"),_=r(E),T=function(t){function e(n,i){o(this,e),t.call(this,n,i),this.emitTapEvents(),this.on("tap",this.handleClick),this.on("click",this.handleClick),this.on("focus",this.handleFocus),this.on("blur",this.handleBlur)}return a(e,t),e.prototype.createEl=function(){var e=arguments.length<=0||void 0===arguments[0]?"div":arguments[0],n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],i=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];n=_.default({className:this.buildCSSClass(),tabIndex:0},n),"button"===e&&v.default.error("Creating a ClickableComponent with an HTML element of "+e+" is not supported; use a Button instead."),i=_.default({role:"button","aria-live":"polite"},i);var r=t.prototype.createEl.call(this,e,n,i);return this.createControlTextEl(r),r},e.prototype.createControlTextEl=function(t){return this.controlTextEl_=u.createEl("span",{className:"vjs-control-text"}),t&&t.appendChild(this.controlTextEl_),this.controlText(this.controlText_),this.controlTextEl_},e.prototype.controlText=function(t){return t?(this.controlText_=t,this.controlTextEl_.innerHTML=this.localize(this.controlText_),this):this.controlText_||"Need Text"},e.prototype.buildCSSClass=function(){return"vjs-control vjs-button "+t.prototype.buildCSSClass.call(this)},e.prototype.addChild=function(e){var n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return t.prototype.addChild.call(this,e,n)},e.prototype.enable=function(){return this.removeClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","false"),this},e.prototype.disable=function(){return this.addClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","true"),this},e.prototype.handleClick=function(){},e.prototype.handleFocus=function(){p.on(y.default,"keydown",f.bind(this,this.handleKeyPress))},e.prototype.handleKeyPress=function(e){32===e.which||13===e.which?(e.preventDefault(),this.handleClick(e)):t.prototype.handleKeyPress&&t.prototype.handleKeyPress.call(this,e)},e.prototype.handleBlur=function(){p.off(y.default,"keydown",f.bind(this,this.handleKeyPress))},e}(c.default);c.default.registerComponent("ClickableComponent",T),
n.default=T,e.exports=n.default},{"./component":67,"./utils/dom.js":134,"./utils/events.js":135,"./utils/fn.js":136,"./utils/log.js":139,"global/document":1,"object.assign":45}],66:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}n.__esModule=!0;var a=t("./button"),s=i(a),c=t("./component"),l=i(c),u=function(t){function e(n,i){r(this,e),t.call(this,n,i),this.controlText(i&&i.controlText||this.localize("Close"))}return o(e,t),e.prototype.buildCSSClass=function(){return"vjs-close-button "+t.prototype.buildCSSClass.call(this)},e.prototype.handleClick=function(){this.trigger({type:"close",bubbles:!1})},e}(s.default);l.default.registerComponent("CloseButton",u),n.default=u,e.exports=n.default},{"./button":64,"./component":67}],67:[function(t,e,n){"use strict";function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.__esModule=!0;var a=t("global/window"),s=r(a),c=t("./utils/dom.js"),l=i(c),u=t("./utils/fn.js"),h=i(u),p=t("./utils/guid.js"),d=i(p),f=t("./utils/events.js"),m=i(f),v=t("./utils/log.js"),g=r(v),y=t("./utils/to-title-case.js"),E=r(y),_=t("object.assign"),T=r(_),b=t("./utils/merge-options.js"),w=r(b),R=function(){function t(e,n,i){if(o(this,t),!e&&this.play?this.player_=e=this:this.player_=e,this.options_=w.default({},this.options_),n=this.options_=w.default(this.options_,n),this.id_=n.id||n.el&&n.el.id,!this.id_){var r=e&&e.id&&e.id()||"no_player";this.id_=r+"_component_"+d.newGUID()}this.name_=n.name||null,n.el?this.el_=n.el:n.createEl!==!1&&(this.el_=this.createEl()),this.children_=[],this.childIndex_={},this.childNameIndex_={},n.initChildren!==!1&&this.initChildren(),this.ready(i),n.reportTouchActivity!==!1&&this.enableTouchActivity()}return t.prototype.dispose=function(){if(this.trigger({type:"dispose",bubbles:!1}),this.children_)for(var t=this.children_.length-1;t>=0;t--)this.children_[t].dispose&&this.children_[t].dispose();this.children_=null,this.childIndex_=null,this.childNameIndex_=null,this.off(),this.el_.parentNode&&this.el_.parentNode.removeChild(this.el_),l.removeElData(this.el_),this.el_=null},t.prototype.player=function(){return this.player_},t.prototype.options=function(t){return g.default.warn("this.options() has been deprecated and will be moved to the constructor in 6.0"),t?(this.options_=w.default(this.options_,t),this.options_):this.options_},t.prototype.el=function(){return this.el_},t.prototype.createEl=function(t,e,n){return l.createEl(t,e,n)},t.prototype.localize=function(t){var e=this.player_.language&&this.player_.language(),n=this.player_.languages&&this.player_.languages();if(!e||!n)return t;var i=n[e];if(i&&i[t])return i[t];var r=e.split("-")[0],o=n[r];return o&&o[t]?o[t]:t},t.prototype.contentEl=function(){return this.contentEl_||this.el_},t.prototype.id=function(){return this.id_},t.prototype.name=function(){return this.name_},t.prototype.children=function(){return this.children_},t.prototype.getChildById=function(t){return this.childIndex_[t]},t.prototype.getChild=function(t){return this.childNameIndex_[t]},t.prototype.addChild=function(e){var n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],i=arguments.length<=2||void 0===arguments[2]?this.children_.length:arguments[2],r=void 0,o=void 0;if("string"==typeof e){o=e,n||(n={}),n===!0&&(g.default.warn("Initializing a child component with `true` is deprecated. Children should be defined in an array when possible, but if necessary use an object instead of `true`."),n={});var a=n.componentClass||E.default(o);n.name=o;var s=t.getComponent(a);if(!s)throw new Error("Component "+a+" does not exist");if("function"!=typeof s)return null;r=new s(this.player_||this,n)}else r=e;if(this.children_.splice(i,0,r),"function"==typeof r.id&&(this.childIndex_[r.id()]=r),o=o||r.name&&r.name(),o&&(this.childNameIndex_[o]=r),"function"==typeof r.el&&r.el()){var c=this.contentEl().children,l=c[i]||null;this.contentEl().insertBefore(r.el(),l)}return r},t.prototype.removeChild=function(t){if("string"==typeof t&&(t=this.getChild(t)),t&&this.children_){for(var e=!1,n=this.children_.length-1;n>=0;n--)if(this.children_[n]===t){e=!0,this.children_.splice(n,1);break}if(e){this.childIndex_[t.id()]=null,this.childNameIndex_[t.name()]=null;var i=t.el();i&&i.parentNode===this.contentEl()&&this.contentEl().removeChild(t.el())}}},t.prototype.initChildren=function(){var e=this,n=this.options_.children;n&&!function(){var i=e.options_,r=function(t){var n=t.name,r=t.opts;if(void 0!==i[n]&&(r=i[n]),r!==!1){r===!0&&(r={}),r.playerOptions=e.options_.playerOptions;var o=e.addChild(n,r);o&&(e[n]=o)}},o=void 0,a=t.getComponent("Tech");o=Array.isArray(n)?n:Object.keys(n),o.concat(Object.keys(e.options_).filter(function(t){return!o.some(function(e){return"string"==typeof e?t===e:t===e.name})})).map(function(t){var i=void 0,r=void 0;return"string"==typeof t?(i=t,r=n[i]||e.options_[i]||{}):(i=t.name,r=t),{name:i,opts:r}}).filter(function(e){var n=t.getComponent(e.opts.componentClass||E.default(e.name));return n&&!a.isTech(n)}).forEach(r)}()},t.prototype.buildCSSClass=function(){return""},t.prototype.on=function(t,e,n){var i=this;return"string"==typeof t||Array.isArray(t)?m.on(this.el_,t,h.bind(this,e)):!function(){var r=t,o=e,a=h.bind(i,n),s=function(){return i.off(r,o,a)};s.guid=a.guid,i.on("dispose",s);var c=function(){return i.off("dispose",s)};c.guid=a.guid,t.nodeName?(m.on(r,o,a),m.on(r,"dispose",c)):"function"==typeof t.on&&(r.on(o,a),r.on("dispose",c))}(),this},t.prototype.off=function(t,e,n){if(!t||"string"==typeof t||Array.isArray(t))m.off(this.el_,t,e);else{var i=t,r=e,o=h.bind(this,n);this.off("dispose",o),t.nodeName?(m.off(i,r,o),m.off(i,"dispose",o)):(i.off(r,o),i.off("dispose",o))}return this},t.prototype.one=function(t,e,n){var i=this,r=arguments;return"string"==typeof t||Array.isArray(t)?m.one(this.el_,t,h.bind(this,e)):!function(){var o=t,a=e,s=h.bind(i,n),c=function t(){i.off(o,a,t),s.apply(null,r)};c.guid=s.guid,i.on(o,a,c)}(),this},t.prototype.trigger=function(t,e){return m.trigger(this.el_,t,e),this},t.prototype.ready=function(t){var e=!(arguments.length<=1||void 0===arguments[1])&&arguments[1];return t&&(this.isReady_?e?t.call(this):this.setTimeout(t,1):(this.readyQueue_=this.readyQueue_||[],this.readyQueue_.push(t))),this},t.prototype.triggerReady=function(){this.isReady_=!0,this.setTimeout(function(){var t=this.readyQueue_;this.readyQueue_=[],t&&t.length>0&&t.forEach(function(t){t.call(this)},this),this.trigger("ready")},1)},t.prototype.$=function(t,e){return l.$(t,e||this.contentEl())},t.prototype.$$=function(t,e){return l.$$(t,e||this.contentEl())},t.prototype.hasClass=function(t){return l.hasElClass(this.el_,t)},t.prototype.addClass=function(t){return l.addElClass(this.el_,t),this},t.prototype.removeClass=function(t){return l.removeElClass(this.el_,t),this},t.prototype.toggleClass=function(t,e){return l.toggleElClass(this.el_,t,e),this},t.prototype.show=function(){return this.removeClass("vjs-hidden"),this},t.prototype.hide=function(){return this.addClass("vjs-hidden"),this},t.prototype.lockShowing=function(){return this.addClass("vjs-lock-showing"),this},t.prototype.unlockShowing=function(){return this.removeClass("vjs-lock-showing"),this},t.prototype.width=function(t,e){return this.dimension("width",t,e)},t.prototype.height=function(t,e){return this.dimension("height",t,e)},t.prototype.dimensions=function(t,e){return this.width(t,!0).height(e)},t.prototype.dimension=function(t,e,n){if(void 0!==e)return null!==e&&e===e||(e=0),(""+e).indexOf("%")!==-1||(""+e).indexOf("px")!==-1?this.el_.style[t]=e:"auto"===e?this.el_.style[t]="":this.el_.style[t]=e+"px",n||this.trigger("resize"),this;if(!this.el_)return 0;var i=this.el_.style[t],r=i.indexOf("px");return r!==-1?parseInt(i.slice(0,r),10):parseInt(this.el_["offset"+E.default(t)],10)},t.prototype.currentDimension=function(t){var e=0;if("width"!==t&&"height"!==t)throw new Error("currentDimension only accepts width or height value");if("function"==typeof s.default.getComputedStyle){var n=s.default.getComputedStyle(this.el_);e=n.getPropertyValue(t)||n[t]}else if(this.el_.currentStyle){var i="offset"+E.default(t);e=this.el_[i]}return e=parseFloat(e)},t.prototype.currentDimensions=function(){return{width:this.currentDimension("width"),height:this.currentDimension("height")}},t.prototype.currentWidth=function(){return this.currentDimension("width")},t.prototype.currentHeight=function(){return this.currentDimension("height")},t.prototype.emitTapEvents=function(){var t=0,e=null,n=10,i=200,r=void 0;this.on("touchstart",function(n){1===n.touches.length&&(e=T.default({},n.touches[0]),t=(new Date).getTime(),r=!0)}),this.on("touchmove",function(t){if(t.touches.length>1)r=!1;else if(e){var i=t.touches[0].pageX-e.pageX,o=t.touches[0].pageY-e.pageY,a=Math.sqrt(i*i+o*o);a>n&&(r=!1)}});var o=function(){r=!1};this.on("touchleave",o),this.on("touchcancel",o),this.on("touchend",function(n){if(e=null,r===!0){var o=(new Date).getTime()-t;o<i&&(n.preventDefault(),this.trigger("tap"))}})},t.prototype.enableTouchActivity=function(){if(this.player()&&this.player().reportUserActivity){var t=h.bind(this.player(),this.player().reportUserActivity),e=void 0;this.on("touchstart",function(){t(),this.clearInterval(e),e=this.setInterval(t,250)});var n=function(n){t(),this.clearInterval(e)};this.on("touchmove",t),this.on("touchend",n),this.on("touchcancel",n)}},t.prototype.setTimeout=function(t,e){t=h.bind(this,t);var n=s.default.setTimeout(t,e),i=function(){this.clearTimeout(n)};return i.guid="vjs-timeout-"+n,this.on("dispose",i),n},t.prototype.clearTimeout=function(t){s.default.clearTimeout(t);var e=function(){};return e.guid="vjs-timeout-"+t,this.off("dispose",e),t},t.prototype.setInterval=function(t,e){t=h.bind(this,t);var n=s.default.setInterval(t,e),i=function(){this.clearInterval(n)};return i.guid="vjs-interval-"+n,this.on("dispose",i),n},t.prototype.clearInterval=function(t){s.default.clearInterval(t);var e=function(){};return e.guid="vjs-interval-"+t,this.off("dispose",e),t},t.registerComponent=function(e,n){return t.components_||(t.components_={}),t.components_[e]=n,n},t.getComponent=function(e){return t.components_&&t.components_[e]?t.components_[e]:s.default&&s.default.videojs&&s.default.videojs[e]?(g.default.warn("The "+e+" component was added to the videojs object when it should be registered using videojs.registerComponent(name, component)"),s.default.videojs[e]):void 0},t.extend=function(e){e=e||{},g.default.warn("Component.extend({}) has been deprecated, use videojs.extend(Component, {}) instead");var n=e.init||e.init||this.prototype.init||this.prototype.init||function(){},i=function(){n.apply(this,arguments)};i.prototype=Object.create(this.prototype),i.prototype.constructor=i,i.extend=t.extend;for(var r in e)e.hasOwnProperty(r)&&(i.prototype[r]=e[r]);return i},t}();R.registerComponent("Component",R),n.default=R,e.exports=n.default},{"./utils/dom.js":134,"./utils/events.js":135,"./utils/fn.js":136,"./utils/guid.js":138,"./utils/log.js":139,"./utils/merge-options.js":140,"./utils/to-title-case.js":143,"global/window":2,"object.assign":45}],68:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}n.__esModule=!0;var a=t("../component.js"),s=i(a),c=t("./play-toggle.js"),l=(i(c),t("./time-controls/current-time-display.js")),u=(i(l),t("./time-controls/duration-display.js")),h=(i(u),t("./time-controls/time-divider.js")),p=(i(h),t("./time-controls/remaining-time-display.js")),d=(i(p),t("./live-display.js")),f=(i(d),t("./progress-control/progress-control.js")),m=(i(f),t("./fullscreen-toggle.js")),v=(i(m),t("./volume-control/volume-control.js")),g=(i(v),t("./volume-menu-button.js")),y=(i(g),t("./mute-toggle.js")),E=(i(y),t("./text-track-controls/chapters-button.js")),_=(i(E),t("./text-track-controls/descriptions-button.js")),T=(i(_),t("./text-track-controls/subtitles-button.js")),b=(i(T),t("./text-track-controls/captions-button.js")),w=(i(b),t("./playback-rate-menu/playback-rate-menu-button.js")),R=(i(w),t("./spacer-controls/custom-control-spacer.js")),x=(i(R),function(t){function e(){r(this,e),t.apply(this,arguments)}return o(e,t),e.prototype.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-control-bar",dir:"ltr"},{role:"group"})},e}(s.default));x.prototype.options_={loadEvent:"play",children:["playToggle","volumeMenuButton","currentTimeDisplay","timeDivider","durationDisplay","progressControl","liveDisplay","remainingTimeDisplay","customControlSpacer","playbackRateMenuButton","chaptersButton","descriptionsButton","subtitlesButton","captionsButton","fullscreenToggle"]},s.default.registerComponent("ControlBar",x),n.default=x,e.exports=n.default},{"../component.js":67,"./fullscreen-toggle.js":69,"./live-display.js":70,"./mute-toggle.js":71,"./play-toggle.js":72,"./playback-rate-menu/playback-rate-menu-button.js":73,"./progress-control/progress-control.js":78,"./spacer-controls/custom-control-spacer.js":81,"./text-track-controls/captions-button.js":84,"./text-track-controls/chapters-button.js":85,"./text-track-controls/descriptions-button.js":87,"./text-track-controls/subtitles-button.js":89,"./time-controls/current-time-display.js":92,"./time-controls/duration-display.js":93,"./time-controls/remaining-time-display.js":94,"./time-controls/time-divider.js":95,"./volume-control/volume-control.js":97,"./volume-menu-button.js":99}],69:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}n.__esModule=!0;var a=t("../button.js"),s=i(a),c=t("../component.js"),l=i(c),u=function(t){function e(){r(this,e),t.apply(this,arguments)}return o(e,t),e.prototype.buildCSSClass=function(){return"vjs-fullscreen-control "+t.prototype.buildCSSClass.call(this)},e.prototype.handleClick=function(){this.player_.isFullscreen()?(this.player_.exitFullscreen(),this.controlText("Fullscreen")):(this.player_.requestFullscreen(),this.controlText("Non-Fullscreen"))},e}(s.default);u.prototype.controlText_="Fullscreen",l.default.registerComponent("FullscreenToggle",u),n.default=u,e.exports=n.default},{"../button.js":64,"../component.js":67}],70:[function(t,e,n){"use strict";function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}n.__esModule=!0;var s=t("../component"),c=r(s),l=t("../utils/dom.js"),u=i(l),h=function(t){function e(n,i){o(this,e),t.call(this,n,i),this.updateShowing(),this.on(this.player(),"durationchange",this.updateShowing)}return a(e,t),e.prototype.createEl=function(){var e=t.prototype.createEl.call(this,"div",{className:"vjs-live-control vjs-control"});return this.contentEl_=u.createEl("div",{className:"vjs-live-display",innerHTML:'<span class="vjs-control-text">'+this.localize("Stream Type")+"</span>"+this.localize("LIVE")},{"aria-live":"off"}),e.appendChild(this.contentEl_),e},e.prototype.updateShowing=function(){this.player().duration()===1/0?this.show():this.hide()},e}(c.default);c.default.registerComponent("LiveDisplay",h),n.default=h,e.exports=n.default},{"../component":67,"../utils/dom.js":134}],71:[function(t,e,n){"use strict";function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}n.__esModule=!0;var s=t("../button"),c=r(s),l=t("../component"),u=r(l),h=t("../utils/dom.js"),p=i(h),d=function(t){function e(n,i){o(this,e),t.call(this,n,i),this.on(n,"volumechange",this.update),n.tech_&&n.tech_.featuresVolumeControl===!1&&this.addClass("vjs-hidden"),this.on(n,"loadstart",function(){this.update(),n.tech_.featuresVolumeControl===!1?this.addClass("vjs-hidden"):this.removeClass("vjs-hidden")})}return a(e,t),e.prototype.buildCSSClass=function(){return"vjs-mute-control "+t.prototype.buildCSSClass.call(this)},e.prototype.handleClick=function(){this.player_.muted(!this.player_.muted())},e.prototype.update=function(){var t=this.player_.volume(),e=3;0===t||this.player_.muted()?e=0:t<.33?e=1:t<.67&&(e=2);var n=this.player_.muted()?"Unmute":"Mute";this.controlText()!==n&&this.controlText(n);for(var i=0;i<4;i++)p.removeElClass(this.el_,"vjs-vol-"+i);p.addElClass(this.el_,"vjs-vol-"+e)},e}(c.default);d.prototype.controlText_="Mute",u.default.registerComponent("MuteToggle",d),n.default=d,e.exports=n.default},{"../button":64,"../component":67,"../utils/dom.js":134}],72:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}n.__esModule=!0;var a=t("../button.js"),s=i(a),c=t("../component.js"),l=i(c),u=function(t){function e(n,i){r(this,e),t.call(this,n,i),this.on(n,"play",this.handlePlay),this.on(n,"pause",this.handlePause)}return o(e,t),e.prototype.buildCSSClass=function(){return"vjs-play-control "+t.prototype.buildCSSClass.call(this)},e.prototype.handleClick=function(){this.player_.paused()?this.player_.play():this.player_.pause()},e.prototype.handlePlay=function(){this.removeClass("vjs-paused"),this.addClass("vjs-playing"),this.controlText("Pause")},e.prototype.handlePause=function(){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.controlText("Play")},e}(s.default);u.prototype.controlText_="Play",l.default.registerComponent("PlayToggle",u),n.default=u,e.exports=n.default},{"../button.js":64,"../component.js":67}],73:[function(t,e,n){"use strict";function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}n.__esModule=!0;var s=t("../../menu/menu-button.js"),c=r(s),l=t("../../menu/menu.js"),u=r(l),h=t("./playback-rate-menu-item.js"),p=r(h),d=t("../../component.js"),f=r(d),m=t("../../utils/dom.js"),v=i(m),g=function(t){function e(n,i){o(this,e),t.call(this,n,i),this.updateVisibility(),this.updateLabel(),this.on(n,"loadstart",this.updateVisibility),this.on(n,"ratechange",this.updateLabel)}return a(e,t),e.prototype.createEl=function(){var e=t.prototype.createEl.call(this);return this.labelEl_=v.createEl("div",{className:"vjs-playback-rate-value",innerHTML:1}),e.appendChild(this.labelEl_),e},e.prototype.buildCSSClass=function(){return"vjs-playback-rate "+t.prototype.buildCSSClass.call(this)},e.prototype.createMenu=function(){var t=new u.default(this.player()),e=this.playbackRates();if(e)for(var n=e.length-1;n>=0;n--)t.addChild(new p.default(this.player(),{rate:e[n]+"x"}));return t},e.prototype.updateARIAAttributes=function(){this.el().setAttribute("aria-valuenow",this.player().playbackRate())},e.prototype.handleClick=function(){for(var t=this.player().playbackRate(),e=this.playbackRates(),n=e[0],i=0;i<e.length;i++)if(e[i]>t){n=e[i];break}this.player().playbackRate(n)},e.prototype.playbackRates=function(){return this.options_.playbackRates||this.options_.playerOptions&&this.options_.playerOptions.playbackRates},e.prototype.playbackRateSupported=function(){return this.player().tech_&&this.player().tech_.featuresPlaybackRate&&this.playbackRates()&&this.playbackRates().length>0},e.prototype.updateVisibility=function(){this.playbackRateSupported()?this.removeClass("vjs-hidden"):this.addClass("vjs-hidden")},e.prototype.updateLabel=function(){this.playbackRateSupported()&&(this.labelEl_.innerHTML=this.player().playbackRate()+"x")},e}(c.default);g.prototype.controlText_="Playback Rate",f.default.registerComponent("PlaybackRateMenuButton",g),n.default=g,e.exports=n.default},{"../../component.js":67,"../../menu/menu-button.js":106,"../../menu/menu.js":108,"../../utils/dom.js":134,"./playback-rate-menu-item.js":74}],74:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}n.__esModule=!0;var a=t("../../menu/menu-item.js"),s=i(a),c=t("../../component.js"),l=i(c),u=function(t){function e(n,i){r(this,e);var o=i.rate,a=parseFloat(o,10);i.label=o,i.selected=1===a,t.call(this,n,i),this.label=o,this.rate=a,this.on(n,"ratechange",this.update)}return o(e,t),e.prototype.handleClick=function(){t.prototype.handleClick.call(this),this.player().playbackRate(this.rate)},e.prototype.update=function(){this.selected(this.player().playbackRate()===this.rate)},e}(s.default);u.prototype.contentElType="button",l.default.registerComponent("PlaybackRateMenuItem",u),n.default=u,e.exports=n.default},{"../../component.js":67,"../../menu/menu-item.js":107}],75:[function(t,e,n){"use strict";function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}n.__esModule=!0;var s=t("../../component.js"),c=r(s),l=t("../../utils/dom.js"),u=i(l),h=function(t){function e(n,i){o(this,e),t.call(this,n,i),this.on(n,"progress",this.update)}return a(e,t),e.prototype.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-load-progress",innerHTML:'<span class="vjs-control-text"><span>'+this.localize("Loaded")+"</span>: 0%</span>"})},e.prototype.update=function(){var t=this.player_.buffered(),e=this.player_.duration(),n=this.player_.bufferedEnd(),i=this.el_.children,r=function(t,e){var n=t/e||0;return 100*(n>=1?1:n)+"%"};this.el_.style.width=r(n,e);for(var o=0;o<t.length;o++){var a=t.start(o),s=t.end(o),c=i[o];c||(c=this.el_.appendChild(u.createEl())),c.style.left=r(a,n),c.style.width=r(s-a,n)}for(var o=i.length;o>t.length;o--)this.el_.removeChild(i[o-1])},e}(c.default);c.default.registerComponent("LoadProgressBar",h),n.default=h,e.exports=n.default},{"../../component.js":67,"../../utils/dom.js":134}],76:[function(t,e,n){"use strict";function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}n.__esModule=!0;var s=t("global/window"),c=r(s),l=t("../../component.js"),u=r(l),h=t("../../utils/dom.js"),p=i(h),d=t("../../utils/fn.js"),f=i(d),m=t("../../utils/format-time.js"),v=r(m),g=t("lodash-compat/function/throttle"),y=r(g),E=function(t){function e(n,i){var r=this;o(this,e),t.call(this,n,i),i.playerOptions&&i.playerOptions.controlBar&&i.playerOptions.controlBar.progressControl&&i.playerOptions.controlBar.progressControl.keepTooltipsInside&&(this.keepTooltipsInside=i.playerOptions.controlBar.progressControl.keepTooltipsInside),this.keepTooltipsInside&&(this.tooltip=p.createEl("div",{className:"vjs-time-tooltip"}),this.el().appendChild(this.tooltip),this.addClass("vjs-keep-tooltips-inside")),this.update(0,0),n.on("ready",function(){r.on(n.controlBar.progressControl.el(),"mousemove",y.default(f.bind(r,r.handleMouseMove),25))})}return a(e,t),e.prototype.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-mouse-display"})},e.prototype.handleMouseMove=function(t){var e=this.player_.duration(),n=this.calculateDistance(t)*e,i=t.pageX-p.findElPosition(this.el().parentNode).left;this.update(n,i)},e.prototype.update=function(t,e){var n=v.default(t,this.player_.duration());if(this.el().style.left=e+"px",this.el().setAttribute("data-current-time",n),this.keepTooltipsInside){var i=this.clampPosition_(e),r=e-i+1,o=parseFloat(c.default.getComputedStyle(this.tooltip).width),a=o/2;this.tooltip.innerHTML=n,this.tooltip.style.right="-"+(a-r)+"px"}},e.prototype.calculateDistance=function(t){return p.getPointerPosition(this.el().parentNode,t).x},e.prototype.clampPosition_=function(t){if(!this.keepTooltipsInside)return t;var e=parseFloat(c.default.getComputedStyle(this.player().el()).width),n=parseFloat(c.default.getComputedStyle(this.tooltip).width),i=n/2,r=t;return t<i?r=Math.ceil(i):t>e-i&&(r=Math.floor(e-i)),r},e}(u.default);u.default.registerComponent("MouseTimeDisplay",E),n.default=E,e.exports=n.default},{"../../component.js":67,"../../utils/dom.js":134,"../../utils/fn.js":136,"../../utils/format-time.js":137,"global/window":2,"lodash-compat/function/throttle":7}],77:[function(t,e,n){"use strict";function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}n.__esModule=!0;var s=t("../../component.js"),c=r(s),l=t("../../utils/fn.js"),u=i(l),h=t("../../utils/dom.js"),p=(i(h),t("../../utils/format-time.js")),d=r(p),f=function(t){function e(n,i){o(this,e),t.call(this,n,i),this.updateDataAttr(),this.on(n,"timeupdate",this.updateDataAttr),n.ready(u.bind(this,this.updateDataAttr)),i.playerOptions&&i.playerOptions.controlBar&&i.playerOptions.controlBar.progressControl&&i.playerOptions.controlBar.progressControl.keepTooltipsInside&&(this.keepTooltipsInside=i.playerOptions.controlBar.progressControl.keepTooltipsInside),this.keepTooltipsInside&&this.addClass("vjs-keep-tooltips-inside")}return a(e,t),e.prototype.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-play-progress vjs-slider-bar",innerHTML:'<span class="vjs-control-text"><span>'+this.localize("Progress")+"</span>: 0%</span>"})},e.prototype.updateDataAttr=function(){var t=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime();this.el_.setAttribute("data-current-time",d.default(t,this.player_.duration()))},e}(c.default);c.default.registerComponent("PlayProgressBar",f),n.default=f,e.exports=n.default},{"../../component.js":67,"../../utils/dom.js":134,"../../utils/fn.js":136,"../../utils/format-time.js":137}],78:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}n.__esModule=!0;var a=t("../../component.js"),s=i(a),c=t("./seek-bar.js"),l=(i(c),t("./mouse-time-display.js")),u=(i(l),function(t){function e(){r(this,e),t.apply(this,arguments)}return o(e,t),e.prototype.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-progress-control vjs-control"})},e}(s.default));u.prototype.options_={children:["seekBar"]},s.default.registerComponent("ProgressControl",u),n.default=u,e.exports=n.default},{"../../component.js":67,"./mouse-time-display.js":76,"./seek-bar.js":79}],79:[function(t,e,n){"use strict";function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}n.__esModule=!0;var s=t("global/window"),c=r(s),l=t("../../slider/slider.js"),u=r(l),h=t("../../component.js"),p=r(h),d=t("./load-progress-bar.js"),f=(r(d),
t("./play-progress-bar.js")),m=(r(f),t("./tooltip-progress-bar.js")),v=(r(m),t("../../utils/fn.js")),g=i(v),y=t("../../utils/format-time.js"),E=r(y),_=t("object.assign"),T=(r(_),function(t){function e(n,i){o(this,e),t.call(this,n,i),this.on(n,"timeupdate",this.updateProgress),this.on(n,"ended",this.updateProgress),n.ready(g.bind(this,this.updateProgress)),i.playerOptions&&i.playerOptions.controlBar&&i.playerOptions.controlBar.progressControl&&i.playerOptions.controlBar.progressControl.keepTooltipsInside&&(this.keepTooltipsInside=i.playerOptions.controlBar.progressControl.keepTooltipsInside),this.keepTooltipsInside&&(this.tooltipProgressBar=this.addChild("TooltipProgressBar"))}return a(e,t),e.prototype.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-progress-holder"},{"aria-label":"progress bar"})},e.prototype.updateProgress=function(){if(this.updateAriaAttributes(this.el_),this.keepTooltipsInside){this.updateAriaAttributes(this.tooltipProgressBar.el_),this.tooltipProgressBar.el_.style.width=this.bar.el_.style.width;var t=parseFloat(c.default.getComputedStyle(this.player().el()).width),e=parseFloat(c.default.getComputedStyle(this.tooltipProgressBar.tooltip).width),n=this.tooltipProgressBar.el().style;n.maxWidth=Math.floor(t-e/2)+"px",n.minWidth=Math.ceil(e/2)+"px",n.right="-"+e/2+"px"}},e.prototype.updateAriaAttributes=function(t){var e=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime();t.setAttribute("aria-valuenow",(100*this.getPercent()).toFixed(2)),t.setAttribute("aria-valuetext",E.default(e,this.player_.duration()))},e.prototype.getPercent=function(){var t=this.player_.currentTime()/this.player_.duration();return t>=1?1:t},e.prototype.handleMouseDown=function(e){t.prototype.handleMouseDown.call(this,e),this.player_.scrubbing(!0),this.videoWasPlaying=!this.player_.paused(),this.player_.pause()},e.prototype.handleMouseMove=function(t){var e=this.calculateDistance(t)*this.player_.duration();e===this.player_.duration()&&(e-=.1),this.player_.currentTime(e)},e.prototype.handleMouseUp=function(e){t.prototype.handleMouseUp.call(this,e),this.player_.scrubbing(!1),this.videoWasPlaying&&this.player_.play()},e.prototype.stepForward=function(){this.player_.currentTime(this.player_.currentTime()+5)},e.prototype.stepBack=function(){this.player_.currentTime(this.player_.currentTime()-5)},e}(u.default));T.prototype.options_={children:["loadProgressBar","mouseTimeDisplay","playProgressBar"],barName:"playProgressBar"},T.prototype.playerEvent="timeupdate",p.default.registerComponent("SeekBar",T),n.default=T,e.exports=n.default},{"../../component.js":67,"../../slider/slider.js":116,"../../utils/fn.js":136,"../../utils/format-time.js":137,"./load-progress-bar.js":75,"./play-progress-bar.js":77,"./tooltip-progress-bar.js":80,"global/window":2,"object.assign":45}],80:[function(t,e,n){"use strict";function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}n.__esModule=!0;var s=t("../../component.js"),c=r(s),l=t("../../utils/fn.js"),u=i(l),h=t("../../utils/dom.js"),p=(i(h),t("../../utils/format-time.js")),d=r(p),f=function(t){function e(n,i){o(this,e),t.call(this,n,i),this.updateDataAttr(),this.on(n,"timeupdate",this.updateDataAttr),n.ready(u.bind(this,this.updateDataAttr))}return a(e,t),e.prototype.createEl=function(){var e=t.prototype.createEl.call(this,"div",{className:"vjs-tooltip-progress-bar vjs-slider-bar",innerHTML:'<div class="vjs-time-tooltip"></div>\n        <span class="vjs-control-text"><span>'+this.localize("Progress")+"</span>: 0%</span>"});return this.tooltip=e.querySelector(".vjs-time-tooltip"),e},e.prototype.updateDataAttr=function(){var t=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime(),e=d.default(t,this.player_.duration());this.el_.setAttribute("data-current-time",e),this.tooltip.innerHTML=e},e}(c.default);c.default.registerComponent("TooltipProgressBar",f),n.default=f,e.exports=n.default},{"../../component.js":67,"../../utils/dom.js":134,"../../utils/fn.js":136,"../../utils/format-time.js":137}],81:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}n.__esModule=!0;var a=t("./spacer.js"),s=i(a),c=t("../../component.js"),l=i(c),u=function(t){function e(){r(this,e),t.apply(this,arguments)}return o(e,t),e.prototype.buildCSSClass=function(){return"vjs-custom-control-spacer "+t.prototype.buildCSSClass.call(this)},e.prototype.createEl=function(){var e=t.prototype.createEl.call(this,{className:this.buildCSSClass()});return e.innerHTML="&nbsp;",e},e}(s.default);l.default.registerComponent("CustomControlSpacer",u),n.default=u,e.exports=n.default},{"../../component.js":67,"./spacer.js":82}],82:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}n.__esModule=!0;var a=t("../../component.js"),s=i(a),c=function(t){function e(){r(this,e),t.apply(this,arguments)}return o(e,t),e.prototype.buildCSSClass=function(){return"vjs-spacer "+t.prototype.buildCSSClass.call(this)},e.prototype.createEl=function(){return t.prototype.createEl.call(this,"div",{className:this.buildCSSClass()})},e}(s.default);s.default.registerComponent("Spacer",c),n.default=c,e.exports=n.default},{"../../component.js":67}],83:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}n.__esModule=!0;var a=t("./text-track-menu-item.js"),s=i(a),c=t("../../component.js"),l=i(c),u=function(t){function e(n,i){r(this,e),i.track={kind:i.kind,player:n,label:i.kind+" settings",selectable:!1,default:!1,mode:"disabled"},i.selectable=!1,t.call(this,n,i),this.addClass("vjs-texttrack-settings"),this.controlText(", opens "+i.kind+" settings dialog")}return o(e,t),e.prototype.handleClick=function(){this.player().getChild("textTrackSettings").show(),this.player().getChild("textTrackSettings").el_.focus()},e}(s.default);l.default.registerComponent("CaptionSettingsMenuItem",u),n.default=u,e.exports=n.default},{"../../component.js":67,"./text-track-menu-item.js":91}],84:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}n.__esModule=!0;var a=t("./text-track-button.js"),s=i(a),c=t("../../component.js"),l=i(c),u=t("./caption-settings-menu-item.js"),h=i(u),p=function(t){function e(n,i,o){r(this,e),t.call(this,n,i,o),this.el_.setAttribute("aria-label","Captions Menu")}return o(e,t),e.prototype.buildCSSClass=function(){return"vjs-captions-button "+t.prototype.buildCSSClass.call(this)},e.prototype.update=function(){var e=2;t.prototype.update.call(this),this.player().tech_&&this.player().tech_.featuresNativeTextTracks&&(e=1),this.items&&this.items.length>e?this.show():this.hide()},e.prototype.createItems=function(){var e=[];return this.player().tech_&&this.player().tech_.featuresNativeTextTracks||e.push(new h.default(this.player_,{kind:this.kind_})),t.prototype.createItems.call(this,e)},e}(s.default);p.prototype.kind_="captions",p.prototype.controlText_="Captions",l.default.registerComponent("CaptionsButton",p),n.default=p,e.exports=n.default},{"../../component.js":67,"./caption-settings-menu-item.js":83,"./text-track-button.js":90}],85:[function(t,e,n){"use strict";function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}n.__esModule=!0;var s=t("./text-track-button.js"),c=r(s),l=t("../../component.js"),u=r(l),h=t("./text-track-menu-item.js"),p=r(h),d=t("./chapters-track-menu-item.js"),f=r(d),m=t("../../menu/menu.js"),v=r(m),g=t("../../utils/dom.js"),y=i(g),E=t("../../utils/fn.js"),_=(i(E),t("../../utils/to-title-case.js")),T=r(_),b=t("global/window"),w=(r(b),function(t){function e(n,i,r){o(this,e),t.call(this,n,i,r),this.el_.setAttribute("aria-label","Chapters Menu")}return a(e,t),e.prototype.buildCSSClass=function(){return"vjs-chapters-button "+t.prototype.buildCSSClass.call(this)},e.prototype.createItems=function(){var t=[],e=this.player_.textTracks();if(!e)return t;for(var n=0;n<e.length;n++){var i=e[n];i.kind===this.kind_&&t.push(new p.default(this.player_,{track:i}))}return t},e.prototype.createMenu=function(){for(var t=this,e=this.player_.textTracks()||[],n=void 0,i=this.items=[],r=0,o=e.length;r<o;r++){var a=e[r];if(a.kind===this.kind_){n=a;break}}var s=this.menu;if(void 0===s){s=new v.default(this.player_);var c=y.createEl("li",{className:"vjs-menu-title",innerHTML:T.default(this.kind_),tabIndex:-1});s.children_.unshift(c),y.insertElFirst(c,s.contentEl())}if(n&&null==n.cues){n.mode="hidden";var l=this.player_.remoteTextTrackEls().getTrackElementByTrack_(n);l&&l.addEventListener("load",function(e){return t.update()})}if(n&&n.cues&&n.cues.length>0){for(var u=n.cues,h=void 0,r=0,p=u.length;r<p;r++){h=u[r];var d=new f.default(this.player_,{track:n,cue:h});i.push(d),s.addChild(d)}this.addChild(s)}return this.items.length>0&&this.show(),s},e}(c.default));w.prototype.kind_="chapters",w.prototype.controlText_="Chapters",u.default.registerComponent("ChaptersButton",w),n.default=w,e.exports=n.default},{"../../component.js":67,"../../menu/menu.js":108,"../../utils/dom.js":134,"../../utils/fn.js":136,"../../utils/to-title-case.js":143,"./chapters-track-menu-item.js":86,"./text-track-button.js":90,"./text-track-menu-item.js":91,"global/window":2}],86:[function(t,e,n){"use strict";function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}n.__esModule=!0;var s=t("../../menu/menu-item.js"),c=r(s),l=t("../../component.js"),u=r(l),h=t("../../utils/fn.js"),p=i(h),d=function(t){function e(n,i){o(this,e);var r=i.track,a=i.cue,s=n.currentTime();i.label=a.text,i.selected=a.startTime<=s&&s<a.endTime,t.call(this,n,i),this.track=r,this.cue=a,r.addEventListener("cuechange",p.bind(this,this.update))}return a(e,t),e.prototype.handleClick=function(){t.prototype.handleClick.call(this),this.player_.currentTime(this.cue.startTime),this.update(this.cue.startTime)},e.prototype.update=function(){var t=this.cue,e=this.player_.currentTime();this.selected(t.startTime<=e&&e<t.endTime)},e}(c.default);u.default.registerComponent("ChaptersTrackMenuItem",d),n.default=d,e.exports=n.default},{"../../component.js":67,"../../menu/menu-item.js":107,"../../utils/fn.js":136}],87:[function(t,e,n){"use strict";function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}n.__esModule=!0;var s=t("./text-track-button.js"),c=r(s),l=t("../../component.js"),u=r(l),h=t("../../utils/fn.js"),p=i(h),d=function(t){function e(n,i,r){var a=this;o(this,e),t.call(this,n,i,r),this.el_.setAttribute("aria-label","Descriptions Menu");var s=n.textTracks();s&&!function(){var t=p.bind(a,a.handleTracksChange);s.addEventListener("change",t),a.on("dispose",function(){s.removeEventListener("change",t)})}()}return a(e,t),e.prototype.handleTracksChange=function(t){for(var e=this.player().textTracks(),n=!1,i=0,r=e.length;i<r;i++){var o=e[i];if(o.kind!==this.kind_&&"showing"===o.mode){n=!0;break}}n?this.disable():this.enable()},e.prototype.buildCSSClass=function(){return"vjs-descriptions-button "+t.prototype.buildCSSClass.call(this)},e}(c.default);d.prototype.kind_="descriptions",d.prototype.controlText_="Descriptions",u.default.registerComponent("DescriptionsButton",d),n.default=d,e.exports=n.default},{"../../component.js":67,"../../utils/fn.js":136,"./text-track-button.js":90}],88:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}n.__esModule=!0;var a=t("./text-track-menu-item.js"),s=i(a),c=t("../../component.js"),l=i(c),u=function(t){function e(n,i){r(this,e),i.track={kind:i.kind,player:n,label:i.kind+" off",default:!1,mode:"disabled"},i.selectable=!0,t.call(this,n,i),this.selected(!0)}return o(e,t),e.prototype.handleTracksChange=function(t){for(var e=this.player().textTracks(),n=!0,i=0,r=e.length;i<r;i++){var o=e[i];if(o.kind===this.track.kind&&"showing"===o.mode){n=!1;break}}this.selected(n)},e}(s.default);l.default.registerComponent("OffTextTrackMenuItem",u),n.default=u,e.exports=n.default},{"../../component.js":67,"./text-track-menu-item.js":91}],89:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}n.__esModule=!0;var a=t("./text-track-button.js"),s=i(a),c=t("../../component.js"),l=i(c),u=function(t){function e(n,i,o){r(this,e),t.call(this,n,i,o),this.el_.setAttribute("aria-label","Subtitles Menu")}return o(e,t),e.prototype.buildCSSClass=function(){return"vjs-subtitles-button "+t.prototype.buildCSSClass.call(this)},e}(s.default);u.prototype.kind_="subtitles",u.prototype.controlText_="Subtitles",l.default.registerComponent("SubtitlesButton",u),n.default=u,e.exports=n.default},{"../../component.js":67,"./text-track-button.js":90}],90:[function(t,e,n){"use strict";function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}n.__esModule=!0;var s=t("../../menu/menu-button.js"),c=r(s),l=t("../../component.js"),u=r(l),h=t("../../utils/fn.js"),p=i(h),d=t("./text-track-menu-item.js"),f=r(d),m=t("./off-text-track-menu-item.js"),v=r(m),g=function(t){function e(n,i){o(this,e),t.call(this,n,i);var r=this.player_.textTracks();if(this.items.length<=1&&this.hide(),r){var a=p.bind(this,this.update);r.addEventListener("removetrack",a),r.addEventListener("addtrack",a),this.player_.on("dispose",function(){r.removeEventListener("removetrack",a),r.removeEventListener("addtrack",a)})}}return a(e,t),e.prototype.createItems=function(){var t=arguments.length<=0||void 0===arguments[0]?[]:arguments[0];t.push(new v.default(this.player_,{kind:this.kind_}));var e=this.player_.textTracks();if(!e)return t;for(var n=0;n<e.length;n++){var i=e[n];i.kind===this.kind_&&t.push(new f.default(this.player_,{selectable:!0,track:i}))}return t},e}(c.default);u.default.registerComponent("TextTrackButton",g),n.default=g,e.exports=n.default},{"../../component.js":67,"../../menu/menu-button.js":106,"../../utils/fn.js":136,"./off-text-track-menu-item.js":88,"./text-track-menu-item.js":91}],91:[function(t,e,n){"use strict";function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}n.__esModule=!0;var s=t("../../menu/menu-item.js"),c=r(s),l=t("../../component.js"),u=r(l),h=t("../../utils/fn.js"),p=i(h),d=t("global/window"),f=r(d),m=t("global/document"),v=r(m),g=function(t){function e(n,i){var r=this;o(this,e);var a=i.track,s=n.textTracks();i.label=a.label||a.language||"Unknown",i.selected=a.default||"showing"===a.mode,t.call(this,n,i),this.track=a,s&&!function(){var t=p.bind(r,r.handleTracksChange);s.addEventListener("change",t),r.on("dispose",function(){s.removeEventListener("change",t)})}(),s&&void 0===s.onchange&&!function(){var t=void 0;r.on(["tap","click"],function(){if("object"!=typeof f.default.Event)try{t=new f.default.Event("change")}catch(t){}t||(t=v.default.createEvent("Event"),t.initEvent("change",!0,!0)),s.dispatchEvent(t)})}()}return a(e,t),e.prototype.handleClick=function(e){var n=this.track.kind,i=this.player_.textTracks();if(t.prototype.handleClick.call(this,e),i)for(var r=0;r<i.length;r++){var o=i[r];o.kind===n&&(o===this.track?o.mode="showing":o.mode="disabled")}},e.prototype.handleTracksChange=function(t){this.selected("showing"===this.track.mode)},e}(c.default);u.default.registerComponent("TextTrackMenuItem",g),n.default=g,e.exports=n.default},{"../../component.js":67,"../../menu/menu-item.js":107,"../../utils/fn.js":136,"global/document":1,"global/window":2}],92:[function(t,e,n){"use strict";function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}n.__esModule=!0;var s=t("../../component.js"),c=r(s),l=t("../../utils/dom.js"),u=i(l),h=t("../../utils/format-time.js"),p=r(h),d=function(t){function e(n,i){o(this,e),t.call(this,n,i),this.on(n,"timeupdate",this.updateContent)}return a(e,t),e.prototype.createEl=function(){var e=t.prototype.createEl.call(this,"div",{className:"vjs-current-time vjs-time-control vjs-control"});return this.contentEl_=u.createEl("div",{className:"vjs-current-time-display",innerHTML:'<span class="vjs-control-text">Current Time </span>0:00'},{"aria-live":"off"}),e.appendChild(this.contentEl_),e},e.prototype.updateContent=function(){var t=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime(),e=this.localize("Current Time"),n=p.default(t,this.player_.duration());n!==this.formattedTime_&&(this.formattedTime_=n,this.contentEl_.innerHTML='<span class="vjs-control-text">'+e+"</span> "+n)},e}(c.default);c.default.registerComponent("CurrentTimeDisplay",d),n.default=d,e.exports=n.default},{"../../component.js":67,"../../utils/dom.js":134,"../../utils/format-time.js":137}],93:[function(t,e,n){"use strict";function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}n.__esModule=!0;var s=t("../../component.js"),c=r(s),l=t("../../utils/dom.js"),u=i(l),h=t("../../utils/format-time.js"),p=r(h),d=function(t){function e(n,i){o(this,e),t.call(this,n,i),this.on(n,"timeupdate",this.updateContent),this.on(n,"loadedmetadata",this.updateContent)}return a(e,t),e.prototype.createEl=function(){var e=t.prototype.createEl.call(this,"div",{className:"vjs-duration vjs-time-control vjs-control"});return this.contentEl_=u.createEl("div",{className:"vjs-duration-display",innerHTML:'<span class="vjs-control-text">'+this.localize("Duration Time")+"</span> 0:00"},{"aria-live":"off"}),e.appendChild(this.contentEl_),e},e.prototype.updateContent=function(){var t=this.player_.duration();if(t&&this.duration_!==t){this.duration_=t;var e=this.localize("Duration Time"),n=p.default(t);this.contentEl_.innerHTML='<span class="vjs-control-text">'+e+"</span> "+n}},e}(c.default);c.default.registerComponent("DurationDisplay",d),n.default=d,e.exports=n.default},{"../../component.js":67,"../../utils/dom.js":134,"../../utils/format-time.js":137}],94:[function(t,e,n){"use strict";function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}n.__esModule=!0;var s=t("../../component.js"),c=r(s),l=t("../../utils/dom.js"),u=i(l),h=t("../../utils/format-time.js"),p=r(h),d=function(t){function e(n,i){o(this,e),t.call(this,n,i),this.on(n,"timeupdate",this.updateContent)}return a(e,t),e.prototype.createEl=function(){var e=t.prototype.createEl.call(this,"div",{className:"vjs-remaining-time vjs-time-control vjs-control"});return this.contentEl_=u.createEl("div",{className:"vjs-remaining-time-display",innerHTML:'<span class="vjs-control-text">'+this.localize("Remaining Time")+"</span> -0:00"},{"aria-live":"off"}),e.appendChild(this.contentEl_),e},e.prototype.updateContent=function(){if(this.player_.duration()){var t=this.localize("Remaining Time"),e=p.default(this.player_.remainingTime());e!==this.formattedTime_&&(this.formattedTime_=e,this.contentEl_.innerHTML='<span class="vjs-control-text">'+t+"</span> -"+e)}},e}(c.default);c.default.registerComponent("RemainingTimeDisplay",d),n.default=d,e.exports=n.default},{"../../component.js":67,"../../utils/dom.js":134,"../../utils/format-time.js":137}],95:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}n.__esModule=!0;var a=t("../../component.js"),s=i(a),c=function(t){function e(){r(this,e),t.apply(this,arguments)}return o(e,t),e.prototype.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-time-control vjs-time-divider",innerHTML:"<div><span>/</span></div>"})},e}(s.default);s.default.registerComponent("TimeDivider",c),n.default=c,e.exports=n.default},{"../../component.js":67}],96:[function(t,e,n){"use strict";function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}n.__esModule=!0;var s=t("../../slider/slider.js"),c=r(s),l=t("../../component.js"),u=r(l),h=t("../../utils/fn.js"),p=i(h),d=t("./volume-level.js"),f=(r(d),function(t){function e(n,i){o(this,e),t.call(this,n,i),this.on(n,"volumechange",this.updateARIAAttributes),n.ready(p.bind(this,this.updateARIAAttributes))}return a(e,t),e.prototype.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-volume-bar vjs-slider-bar"},{"aria-label":"volume level"})},e.prototype.handleMouseMove=function(t){this.checkMuted(),this.player_.volume(this.calculateDistance(t))},e.prototype.checkMuted=function(){this.player_.muted()&&this.player_.muted(!1)},e.prototype.getPercent=function(){return this.player_.muted()?0:this.player_.volume()},e.prototype.stepForward=function(){this.checkMuted(),this.player_.volume(this.player_.volume()+.1)},e.prototype.stepBack=function(){this.checkMuted(),this.player_.volume(this.player_.volume()-.1)},e.prototype.updateARIAAttributes=function(){var t=(100*this.player_.volume()).toFixed(2);this.el_.setAttribute("aria-valuenow",t),this.el_.setAttribute("aria-valuetext",t+"%")},e}(c.default));f.prototype.options_={children:["volumeLevel"],barName:"volumeLevel"},f.prototype.playerEvent="volumechange",u.default.registerComponent("VolumeBar",f),n.default=f,e.exports=n.default},{"../../component.js":67,"../../slider/slider.js":116,"../../utils/fn.js":136,"./volume-level.js":98}],97:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}n.__esModule=!0;var a=t("../../component.js"),s=i(a),c=t("./volume-bar.js"),l=(i(c),function(t){function e(n,i){r(this,e),t.call(this,n,i),n.tech_&&n.tech_.featuresVolumeControl===!1&&this.addClass("vjs-hidden"),this.on(n,"loadstart",function(){n.tech_.featuresVolumeControl===!1?this.addClass("vjs-hidden"):this.removeClass("vjs-hidden")})}return o(e,t),e.prototype.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-volume-control vjs-control"})},e}(s.default));l.prototype.options_={children:["volumeBar"]},s.default.registerComponent("VolumeControl",l),n.default=l,e.exports=n.default},{"../../component.js":67,"./volume-bar.js":96}],98:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}n.__esModule=!0;var a=t("../../component.js"),s=i(a),c=function(t){function e(){r(this,e),t.apply(this,arguments)}return o(e,t),e.prototype.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-volume-level",innerHTML:'<span class="vjs-control-text"></span>'})},e}(s.default);s.default.registerComponent("VolumeLevel",c),n.default=c,e.exports=n.default},{"../../component.js":67}],99:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}n.__esModule=!0;var s=t("../utils/fn.js"),c=r(s),l=t("../component.js"),u=i(l),h=t("../popup/popup.js"),p=i(h),d=t("../popup/popup-button.js"),f=i(d),m=t("./mute-toggle.js"),v=i(m),g=t("./volume-control/volume-bar.js"),y=i(g),E=function(t){
function e(n){function i(){n.tech_&&n.tech_.featuresVolumeControl===!1?this.addClass("vjs-hidden"):this.removeClass("vjs-hidden")}var r=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];o(this,e),void 0===r.inline&&(r.inline=!0),void 0===r.vertical&&(r.inline?r.vertical=!1:r.vertical=!0),r.volumeBar=r.volumeBar||{},r.volumeBar.vertical=!!r.vertical,t.call(this,n,r),this.on(n,"volumechange",this.volumeUpdate),this.on(n,"loadstart",this.volumeUpdate),i.call(this),this.on(n,"loadstart",i),this.on(this.volumeBar,["slideractive","focus"],function(){this.addClass("vjs-slider-active")}),this.on(this.volumeBar,["sliderinactive","blur"],function(){this.removeClass("vjs-slider-active")}),this.on(this.volumeBar,["focus"],function(){this.addClass("vjs-lock-showing")}),this.on(this.volumeBar,["blur"],function(){this.removeClass("vjs-lock-showing")})}return a(e,t),e.prototype.buildCSSClass=function(){var e="";return e=this.options_.vertical?"vjs-volume-menu-button-vertical":"vjs-volume-menu-button-horizontal","vjs-volume-menu-button "+t.prototype.buildCSSClass.call(this)+" "+e},e.prototype.createPopup=function(){var t=new p.default(this.player_,{contentElType:"div"}),e=new y.default(this.player_,this.options_.volumeBar);return t.addChild(e),this.menuContent=t,this.volumeBar=e,this.attachVolumeBarEvents(),t},e.prototype.handleClick=function(){v.default.prototype.handleClick.call(this),t.prototype.handleClick.call(this)},e.prototype.attachVolumeBarEvents=function(){this.menuContent.on(["mousedown","touchdown"],c.bind(this,this.handleMouseDown))},e.prototype.handleMouseDown=function(t){this.on(["mousemove","touchmove"],c.bind(this.volumeBar,this.volumeBar.handleMouseMove)),this.on(this.el_.ownerDocument,["mouseup","touchend"],this.handleMouseUp)},e.prototype.handleMouseUp=function(t){this.off(["mousemove","touchmove"],c.bind(this.volumeBar,this.volumeBar.handleMouseMove))},e}(f.default);E.prototype.volumeUpdate=v.default.prototype.update,E.prototype.controlText_="Mute",u.default.registerComponent("VolumeMenuButton",E),n.default=E,e.exports=n.default},{"../component.js":67,"../popup/popup-button.js":112,"../popup/popup.js":113,"../utils/fn.js":136,"./mute-toggle.js":71,"./volume-control/volume-bar.js":96}],100:[function(t,e,n){"use strict";function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}n.__esModule=!0;var s=t("./component"),c=r(s),l=t("./modal-dialog"),u=r(l),h=t("./utils/dom"),p=(i(h),t("./utils/merge-options")),d=r(p),f=function(t){function e(n,i){o(this,e),t.call(this,n,i),this.on(n,"error",this.open)}return a(e,t),e.prototype.buildCSSClass=function(){return"vjs-error-display "+t.prototype.buildCSSClass.call(this)},e.prototype.content=function(){var t=this.player().error();return t?this.localize(t.message):""},e}(u.default);f.prototype.options_=d.default(u.default.prototype.options_,{fillAlways:!0,temporary:!1,uncloseable:!0}),c.default.registerComponent("ErrorDisplay",f),n.default=f,e.exports=n.default},{"./component":67,"./modal-dialog":109,"./utils/dom":134,"./utils/merge-options":140}],101:[function(t,e,n){"use strict";function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}n.__esModule=!0;var r=t("./utils/events.js"),o=i(r),a=function(){};a.prototype.allowedEvents_={},a.prototype.on=function(t,e){var n=this.addEventListener;this.addEventListener=Function.prototype,o.on(this,t,e),this.addEventListener=n},a.prototype.addEventListener=a.prototype.on,a.prototype.off=function(t,e){o.off(this,t,e)},a.prototype.removeEventListener=a.prototype.off,a.prototype.one=function(t,e){o.one(this,t,e)},a.prototype.trigger=function(t){var e=t.type||t;"string"==typeof t&&(t={type:e}),t=o.fixEvent(t),this.allowedEvents_[e]&&this["on"+e]&&this["on"+e](t),o.trigger(this,t)},a.prototype.dispatchEvent=a.prototype.trigger,n.default=a,e.exports=n.default},{"./utils/events.js":135}],102:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}n.__esModule=!0;var r=t("./utils/log"),o=i(r),a=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(t.super_=e)},s=function(t){var e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=function(){t.apply(this,arguments)},i={};"object"==typeof e?("function"==typeof e.init&&(o.default.warn("Constructor logic via init() is deprecated; please use constructor() instead."),e.constructor=e.init),e.constructor!==Object.prototype.constructor&&(n=e.constructor),i=e):"function"==typeof e&&(n=e),a(n,t);for(var r in i)i.hasOwnProperty(r)&&(n.prototype[r]=i[r]);return n};n.default=s,e.exports=n.default},{"./utils/log":139}],103:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}n.__esModule=!0;for(var r=t("global/document"),o=i(r),a={},s=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],c=s[0],l=void 0,u=0;u<s.length;u++)if(s[u][1]in o.default){l=s[u];break}if(l)for(var u=0;u<l.length;u++)a[c[u]]=l[u];n.default=a,e.exports=n.default},{"global/document":1}],104:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}n.__esModule=!0;var a=t("./component"),s=i(a),c=function(t){function e(){r(this,e),t.apply(this,arguments)}return o(e,t),e.prototype.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-loading-spinner",dir:"ltr"})},e}(s.default);s.default.registerComponent("LoadingSpinner",c),n.default=c,e.exports=n.default},{"./component":67}],105:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}n.__esModule=!0;var r=t("object.assign"),o=i(r),a=function t(e){"number"==typeof e?this.code=e:"string"==typeof e?this.message=e:"object"==typeof e&&o.default(this,e),this.message||(this.message=t.defaultMessages[this.code]||"")};a.prototype.code=0,a.prototype.message="",a.prototype.status=null,a.errorTypes=["MEDIA_ERR_CUSTOM","MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED","MEDIA_ERR_ENCRYPTED"],a.defaultMessages={1:"You aborted the media playback",2:"A network error caused the media download to fail part-way.",3:"The media playback was aborted due to a corruption problem or because the media used features your browser did not support.",4:"The media could not be loaded, either because the server or network failed or because the format is not supported.",5:"The media is encrypted and we do not have the keys to decrypt it."};for(var s=0;s<a.errorTypes.length;s++)a[a.errorTypes[s]]=s,a.prototype[a.errorTypes[s]]=s;n.default=a,e.exports=n.default},{"object.assign":45}],106:[function(t,e,n){"use strict";function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}n.__esModule=!0;var s=t("../clickable-component.js"),c=r(s),l=t("../component.js"),u=r(l),h=t("./menu.js"),p=r(h),d=t("../utils/dom.js"),f=i(d),m=t("../utils/fn.js"),v=i(m),g=t("../utils/to-title-case.js"),y=r(g),E=function(t){function e(n){var i=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];o(this,e),t.call(this,n,i),this.update(),this.enabled_=!0,this.el_.setAttribute("aria-haspopup","true"),this.el_.setAttribute("role","menuitem"),this.on("keydown",this.handleSubmenuKeyPress)}return a(e,t),e.prototype.update=function(){var t=this.createMenu();this.menu&&this.removeChild(this.menu),this.menu=t,this.addChild(t),this.buttonPressed_=!1,this.el_.setAttribute("aria-expanded","false"),this.items&&0===this.items.length?this.hide():this.items&&this.items.length>1&&this.show()},e.prototype.createMenu=function(){var t=new p.default(this.player_);if(this.options_.title){var e=f.createEl("li",{className:"vjs-menu-title",innerHTML:y.default(this.options_.title),tabIndex:-1});t.children_.unshift(e),f.insertElFirst(e,t.contentEl())}if(this.items=this.createItems(),this.items)for(var n=0;n<this.items.length;n++)t.addItem(this.items[n]);return t},e.prototype.createItems=function(){},e.prototype.createEl=function(){return t.prototype.createEl.call(this,"div",{className:this.buildCSSClass()})},e.prototype.buildCSSClass=function(){var e="vjs-menu-button";return e+=this.options_.inline===!0?"-inline":"-popup","vjs-menu-button "+e+" "+t.prototype.buildCSSClass.call(this)},e.prototype.handleClick=function(){this.one("mouseout",v.bind(this,function(){this.menu.unlockShowing(),this.el_.blur()})),this.buttonPressed_?this.unpressButton():this.pressButton()},e.prototype.handleKeyPress=function(e){27===e.which||9===e.which?(this.buttonPressed_&&this.unpressButton(),9!==e.which&&e.preventDefault()):38===e.which||40===e.which?this.buttonPressed_||(this.pressButton(),e.preventDefault()):t.prototype.handleKeyPress.call(this,e)},e.prototype.handleSubmenuKeyPress=function(t){27!==t.which&&9!==t.which||(this.buttonPressed_&&this.unpressButton(),9!==t.which&&t.preventDefault())},e.prototype.pressButton=function(){this.enabled_&&(this.buttonPressed_=!0,this.menu.lockShowing(),this.el_.setAttribute("aria-expanded","true"),this.menu.focus())},e.prototype.unpressButton=function(){this.enabled_&&(this.buttonPressed_=!1,this.menu.unlockShowing(),this.el_.setAttribute("aria-expanded","false"),this.el_.focus())},e.prototype.disable=function(){return this.buttonPressed_=!1,this.menu.unlockShowing(),this.el_.setAttribute("aria-expanded","false"),this.enabled_=!1,t.prototype.disable.call(this)},e.prototype.enable=function(){return this.enabled_=!0,t.prototype.enable.call(this)},e}(c.default);u.default.registerComponent("MenuButton",E),n.default=E,e.exports=n.default},{"../clickable-component.js":65,"../component.js":67,"../utils/dom.js":134,"../utils/fn.js":136,"../utils/to-title-case.js":143,"./menu.js":108}],107:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}n.__esModule=!0;var a=t("../clickable-component.js"),s=i(a),c=t("../component.js"),l=i(c),u=t("object.assign"),h=i(u),p=function(t){function e(n,i){r(this,e),t.call(this,n,i),this.selectable=i.selectable,this.selected(i.selected),this.selectable?this.el_.setAttribute("role","menuitemcheckbox"):this.el_.setAttribute("role","menuitem")}return o(e,t),e.prototype.createEl=function(e,n,i){return t.prototype.createEl.call(this,"li",h.default({className:"vjs-menu-item",innerHTML:this.localize(this.options_.label),tabIndex:-1},n),i)},e.prototype.handleClick=function(){this.selected(!0)},e.prototype.selected=function(t){this.selectable&&(t?(this.addClass("vjs-selected"),this.el_.setAttribute("aria-checked","true"),this.controlText(", selected")):(this.removeClass("vjs-selected"),this.el_.setAttribute("aria-checked","false"),this.controlText(" ")))},e}(s.default);l.default.registerComponent("MenuItem",p),n.default=p,e.exports=n.default},{"../clickable-component.js":65,"../component.js":67,"object.assign":45}],108:[function(t,e,n){"use strict";function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}n.__esModule=!0;var s=t("../component.js"),c=r(s),l=t("../utils/dom.js"),u=i(l),h=t("../utils/fn.js"),p=i(h),d=t("../utils/events.js"),f=i(d),m=function(t){function e(n,i){o(this,e),t.call(this,n,i),this.focusedChild_=-1,this.on("keydown",this.handleKeyPress)}return a(e,t),e.prototype.addItem=function(t){this.addChild(t),t.on("click",p.bind(this,function(){this.unlockShowing()}))},e.prototype.createEl=function(){var e=this.options_.contentElType||"ul";this.contentEl_=u.createEl(e,{className:"vjs-menu-content"}),this.contentEl_.setAttribute("role","menu");var n=t.prototype.createEl.call(this,"div",{append:this.contentEl_,className:"vjs-menu"});return n.setAttribute("role","presentation"),n.appendChild(this.contentEl_),f.on(n,"click",function(t){t.preventDefault(),t.stopImmediatePropagation()}),n},e.prototype.handleKeyPress=function(t){37===t.which||40===t.which?(t.preventDefault(),this.stepForward()):38!==t.which&&39!==t.which||(t.preventDefault(),this.stepBack())},e.prototype.stepForward=function(){var t=0;void 0!==this.focusedChild_&&(t=this.focusedChild_+1),this.focus(t)},e.prototype.stepBack=function(){var t=0;void 0!==this.focusedChild_&&(t=this.focusedChild_-1),this.focus(t)},e.prototype.focus=function(){var t=arguments.length<=0||void 0===arguments[0]?0:arguments[0],e=this.children().slice(),n=e.length&&e[0].className&&/vjs-menu-title/.test(e[0].className);n&&e.shift(),e.length>0&&(t<0?t=0:t>=e.length&&(t=e.length-1),this.focusedChild_=t,e[t].el_.focus())},e}(c.default);c.default.registerComponent("Menu",m),n.default=m,e.exports=n.default},{"../component.js":67,"../utils/dom.js":134,"../utils/events.js":135,"../utils/fn.js":136}],109:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}n.__esModule=!0;var s=t("./utils/dom"),c=r(s),l=t("./utils/fn"),u=r(l),h=t("./utils/log"),p=(i(h),t("./component")),d=i(p),f=t("./close-button"),m=(i(f),"vjs-modal-dialog"),v=27,g=function(t){function e(n,i){o(this,e),t.call(this,n,i),this.opened_=this.hasBeenOpened_=this.hasBeenFilled_=!1,this.closeable(!this.options_.uncloseable),this.content(this.options_.content),this.contentEl_=c.createEl("div",{className:m+"-content"},{role:"document"}),this.descEl_=c.createEl("p",{className:m+"-description vjs-offscreen",id:this.el().getAttribute("aria-describedby")}),c.textContent(this.descEl_,this.description()),this.el_.appendChild(this.descEl_),this.el_.appendChild(this.contentEl_)}return a(e,t),e.prototype.createEl=function(){return t.prototype.createEl.call(this,"div",{className:this.buildCSSClass(),tabIndex:-1},{"aria-describedby":this.id()+"_description","aria-hidden":"true","aria-label":this.label(),role:"dialog"})},e.prototype.buildCSSClass=function(){return m+" vjs-hidden "+t.prototype.buildCSSClass.call(this)},e.prototype.handleKeyPress=function(t){t.which===v&&this.closeable()&&this.close()},e.prototype.label=function(){return this.options_.label||this.localize("Modal Window")},e.prototype.description=function(){var t=this.options_.description||this.localize("This is a modal window.");return this.closeable()&&(t+=" "+this.localize("This modal can be closed by pressing the Escape key or activating the close button.")),t},e.prototype.open=function(){if(!this.opened_){var t=this.player();this.trigger("beforemodalopen"),this.opened_=!0,(this.options_.fillAlways||!this.hasBeenOpened_&&!this.hasBeenFilled_)&&this.fill(),this.wasPlaying_=!t.paused(),this.wasPlaying_&&t.pause(),this.closeable()&&this.on(this.el_.ownerDocument,"keydown",u.bind(this,this.handleKeyPress)),t.controls(!1),this.show(),this.el().setAttribute("aria-hidden","false"),this.trigger("modalopen"),this.hasBeenOpened_=!0}return this},e.prototype.opened=function(t){return"boolean"==typeof t&&this[t?"open":"close"](),this.opened_},e.prototype.close=function(){if(this.opened_){var t=this.player();this.trigger("beforemodalclose"),this.opened_=!1,this.wasPlaying_&&t.play(),this.closeable()&&this.off(this.el_.ownerDocument,"keydown",u.bind(this,this.handleKeyPress)),t.controls(!0),this.hide(),this.el().setAttribute("aria-hidden","true"),this.trigger("modalclose"),this.options_.temporary&&this.dispose()}return this},e.prototype.closeable=function t(e){if("boolean"==typeof e){var t=this.closeable_=!!e,n=this.getChild("closeButton");if(t&&!n){var i=this.contentEl_;this.contentEl_=this.el_,n=this.addChild("closeButton"),this.contentEl_=i,this.on(n,"close",this.close)}!t&&n&&(this.off(n,"close",this.close),this.removeChild(n),n.dispose())}return this.closeable_},e.prototype.fill=function(){return this.fillWith(this.content())},e.prototype.fillWith=function(t){var e=this.contentEl(),n=e.parentNode,i=e.nextSibling;return this.trigger("beforemodalfill"),this.hasBeenFilled_=!0,n.removeChild(e),this.empty(),c.insertContent(e,t),this.trigger("modalfill"),i?n.insertBefore(e,i):n.appendChild(e),this},e.prototype.empty=function(){return this.trigger("beforemodalempty"),c.emptyEl(this.contentEl()),this.trigger("modalempty"),this},e.prototype.content=function(t){return"undefined"!=typeof t&&(this.content_=t),this.content_},e}(d.default);g.prototype.options_={temporary:!0},d.default.registerComponent("ModalDialog",g),n.default=g,e.exports=n.default},{"./close-button":66,"./component":67,"./utils/dom":134,"./utils/fn":136,"./utils/log":139}],110:[function(t,e,n){"use strict";function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}n.__esModule=!0;var s=t("./component.js"),c=r(s),l=t("global/document"),u=r(l),h=t("global/window"),p=r(h),d=t("./utils/events.js"),f=i(d),m=t("./utils/dom.js"),v=i(m),g=t("./utils/fn.js"),y=i(g),E=t("./utils/guid.js"),_=i(E),T=t("./utils/browser.js"),b=i(T),w=t("./utils/log.js"),R=r(w),x=t("./utils/to-title-case.js"),H=r(x),M=t("./utils/time-ranges.js"),S=t("./utils/buffer.js"),C=t("./utils/stylesheet.js"),A=i(C),P=t("./fullscreen-api.js"),L=r(P),O=t("./media-error.js"),j=r(O),k=t("safe-json-parse/tuple"),I=r(k),D=t("object.assign"),B=r(D),U=t("./utils/merge-options.js"),N=r(U),F=t("./tracks/text-track-list-converter.js"),V=r(F),G=t("./tech/loader.js"),z=(r(G),t("./poster-image.js")),W=(r(z),t("./tracks/text-track-display.js")),X=(r(W),t("./loading-spinner.js")),q=(r(X),t("./big-play-button.js")),Y=(r(q),t("./control-bar/control-bar.js")),Z=(r(Y),t("./error-display.js")),K=(r(Z),t("./tracks/text-track-settings.js")),Q=(r(K),t("./modal-dialog")),$=r(Q),J=t("./tech/tech.js"),tt=r(J),et=t("./tech/html5.js"),nt=(r(et),function(t){function e(n,i,r){var a=this;if(o(this,e),n.id=n.id||"vjs_video_"+_.newGUID(),i=B.default(e.getTagSettings(n),i),i.initChildren=!1,i.createEl=!1,i.reportTouchActivity=!1,t.call(this,null,i,r),!this.options_||!this.options_.techOrder||!this.options_.techOrder.length)throw new Error("No techOrder specified. Did you overwrite videojs.options instead of just changing the properties you want to override?");this.tag=n,this.tagAttributes=n&&v.getElAttributes(n),this.language(this.options_.language),i.languages?!function(){var t={};Object.getOwnPropertyNames(i.languages).forEach(function(e){t[e.toLowerCase()]=i.languages[e]}),a.languages_=t}():this.languages_=e.prototype.options_.languages,this.cache_={},this.poster_=i.poster||"",this.controls_=!!i.controls,n.controls=!1,this.scrubbing_=!1,this.el_=this.createEl();var s=N.default(this.options_);i.plugins&&!function(){var t=i.plugins;Object.getOwnPropertyNames(t).forEach(function(e){"function"==typeof this[e]?this[e](t[e]):R.default.error("Unable to find plugin:",e)},a)}(),this.options_.playerOptions=s,this.initChildren(),this.isAudio("audio"===n.nodeName.toLowerCase()),this.controls()?this.addClass("vjs-controls-enabled"):this.addClass("vjs-controls-disabled"),this.el_.setAttribute("role","region"),this.isAudio()?this.el_.setAttribute("aria-label","audio player"):this.el_.setAttribute("aria-label","video player"),this.isAudio()&&this.addClass("vjs-audio"),this.flexNotSupported_()&&this.addClass("vjs-no-flex"),b.IS_IOS||this.addClass("vjs-workinghover"),e.players[this.id_]=this,this.userActive(!0),this.reportUserActivity(),this.listenForUserActivity_(),this.on("fullscreenchange",this.handleFullscreenChange_),this.on("stageclick",this.handleStageClick_)}return a(e,t),e.prototype.dispose=function(){this.trigger("dispose"),this.off("dispose"),this.styleEl_&&this.styleEl_.parentNode&&this.styleEl_.parentNode.removeChild(this.styleEl_),e.players[this.id_]=null,this.tag&&this.tag.player&&(this.tag.player=null),this.el_&&this.el_.player&&(this.el_.player=null),this.tech_&&this.tech_.dispose(),t.prototype.dispose.call(this)},e.prototype.createEl=function(){var e=this.el_=t.prototype.createEl.call(this,"div"),n=this.tag;n.removeAttribute("width"),n.removeAttribute("height");var i=v.getElAttributes(n);if(Object.getOwnPropertyNames(i).forEach(function(t){"class"===t?e.className=i[t]:e.setAttribute(t,i[t])}),n.playerId=n.id,n.id+="_html5_api",n.className="vjs-tech",n.player=e.player=this,this.addClass("vjs-paused"),p.default.VIDEOJS_NO_DYNAMIC_STYLE!==!0){this.styleEl_=A.createStyleElement("vjs-styles-dimensions");var r=v.$(".vjs-styles-defaults"),o=v.$("head");o.insertBefore(this.styleEl_,r?r.nextSibling:o.firstChild)}this.width(this.options_.width),this.height(this.options_.height),this.fluid(this.options_.fluid),this.aspectRatio(this.options_.aspectRatio);for(var a=n.getElementsByTagName("a"),s=0;s<a.length;s++){var c=a.item(s);v.addElClass(c,"vjs-hidden"),c.setAttribute("hidden","hidden")}return n.initNetworkState_=n.networkState,n.parentNode&&n.parentNode.insertBefore(e,n),v.insertElFirst(n,e),this.children_.unshift(n),this.el_=e,e},e.prototype.width=function(t){return this.dimension("width",t)},e.prototype.height=function(t){return this.dimension("height",t)},e.prototype.dimension=function(t,e){var n=t+"_";if(void 0===e)return this[n]||0;if(""===e)this[n]=void 0;else{var i=parseFloat(e);if(isNaN(i))return R.default.error('Improper value "'+e+'" supplied for for '+t),this;this[n]=i}return this.updateStyleEl_(),this},e.prototype.fluid=function(t){return void 0===t?!!this.fluid_:(this.fluid_=!!t,void(t?this.addClass("vjs-fluid"):this.removeClass("vjs-fluid")))},e.prototype.aspectRatio=function(t){if(void 0===t)return this.aspectRatio_;if(!/^\d+\:\d+$/.test(t))throw new Error("Improper value supplied for aspect ratio. The format should be width:height, for example 16:9.");this.aspectRatio_=t,this.fluid(!0),this.updateStyleEl_()},e.prototype.updateStyleEl_=function(){if(p.default.VIDEOJS_NO_DYNAMIC_STYLE===!0){var t="number"==typeof this.width_?this.width_:this.options_.width,e="number"==typeof this.height_?this.height_:this.options_.height,n=this.tech_&&this.tech_.el();return void(n&&(t>=0&&(n.width=t),e>=0&&(n.height=e)))}var i=void 0,r=void 0,o=void 0,a=void 0;o=void 0!==this.aspectRatio_&&"auto"!==this.aspectRatio_?this.aspectRatio_:this.videoWidth()?this.videoWidth()+":"+this.videoHeight():"16:9";var s=o.split(":"),c=s[1]/s[0];i=void 0!==this.width_?this.width_:void 0!==this.height_?this.height_/c:this.videoWidth()||300,r=void 0!==this.height_?this.height_:i*c,a=/^[^a-zA-Z]/.test(this.id())?"dimensions-"+this.id():this.id()+"-dimensions",this.addClass(a),A.setTextContent(this.styleEl_,"\n      ."+a+" {\n        width: "+i+"px;\n        height: "+r+"px;\n      }\n\n      ."+a+".vjs-fluid {\n        padding-top: "+100*c+"%;\n      }\n    ")},e.prototype.loadTech_=function(t,e){this.tech_&&this.unloadTech_(),"Html5"!==t&&this.tag&&(tt.default.getTech("Html5").disposeMediaElement(this.tag),this.tag.player=null,this.tag=null),this.techName_=t,this.isReady_=!1;var n=B.default({nativeControlsForTouch:this.options_.nativeControlsForTouch,source:e,playerId:this.id(),techId:this.id()+"_"+t+"_api",textTracks:this.textTracks_,autoplay:this.options_.autoplay,preload:this.options_.preload,loop:this.options_.loop,muted:this.options_.muted,poster:this.poster(),language:this.language(),"vtt.js":this.options_["vtt.js"]},this.options_[t.toLowerCase()]);this.tag&&(n.tag=this.tag),e&&(this.currentType_=e.type,e.src===this.cache_.src&&this.cache_.currentTime>0&&(n.startTime=this.cache_.currentTime),this.cache_.src=e.src);var i=tt.default.getTech(t);i||(i=c.default.getComponent(t)),this.tech_=new i(n),this.tech_.ready(y.bind(this,this.handleTechReady_),!0),V.default.jsonToTextTracks(this.textTracksJson_||[],this.tech_),this.on(this.tech_,"loadstart",this.handleTechLoadStart_),this.on(this.tech_,"waiting",this.handleTechWaiting_),this.on(this.tech_,"canplay",this.handleTechCanPlay_),this.on(this.tech_,"canplaythrough",this.handleTechCanPlayThrough_),this.on(this.tech_,"playing",this.handleTechPlaying_),this.on(this.tech_,"ended",this.handleTechEnded_),this.on(this.tech_,"seeking",this.handleTechSeeking_),this.on(this.tech_,"seeked",this.handleTechSeeked_),this.on(this.tech_,"play",this.handleTechPlay_),this.on(this.tech_,"firstplay",this.handleTechFirstPlay_),this.on(this.tech_,"pause",this.handleTechPause_),this.on(this.tech_,"progress",this.handleTechProgress_),this.on(this.tech_,"durationchange",this.handleTechDurationChange_),this.on(this.tech_,"fullscreenchange",this.handleTechFullscreenChange_),this.on(this.tech_,"error",this.handleTechError_),this.on(this.tech_,"suspend",this.handleTechSuspend_),this.on(this.tech_,"abort",this.handleTechAbort_),this.on(this.tech_,"emptied",this.handleTechEmptied_),this.on(this.tech_,"stalled",this.handleTechStalled_),this.on(this.tech_,"loadedmetadata",this.handleTechLoadedMetaData_),this.on(this.tech_,"loadeddata",this.handleTechLoadedData_),this.on(this.tech_,"timeupdate",this.handleTechTimeUpdate_),this.on(this.tech_,"ratechange",this.handleTechRateChange_),this.on(this.tech_,"volumechange",this.handleTechVolumeChange_),this.on(this.tech_,"texttrackchange",this.handleTechTextTrackChange_),this.on(this.tech_,"loadedmetadata",this.updateStyleEl_),this.on(this.tech_,"posterchange",this.handleTechPosterChange_),this.usingNativeControls(this.techGet_("controls")),this.controls()&&!this.usingNativeControls()&&this.addTechControlsListeners_(),this.tech_.el().parentNode===this.el()||"Html5"===t&&this.tag||v.insertElFirst(this.tech_.el(),this.el()),this.tag&&(this.tag.player=null,this.tag=null)},e.prototype.unloadTech_=function(){this.textTracks_=this.textTracks(),this.textTracksJson_=V.default.textTracksToJson(this.tech_),this.isReady_=!1,this.tech_.dispose(),this.tech_=!1},e.prototype.tech=function(t){if(t&&t.IWillNotUseThisInPlugins)return this.tech_;var e="\n      Please make sure that you are not using this inside of a plugin.\n      To disable this alert and error, please pass in an object with\n      `IWillNotUseThisInPlugins` to the `tech` method. See\n      https://github.com/videojs/video.js/issues/2617 for more info.\n    ";throw p.default.alert(e),new Error(e)},e.prototype.addTechControlsListeners_=function(){this.removeTechControlsListeners_(),this.on(this.tech_,"mousedown",this.handleTechClick_),this.on(this.tech_,"touchstart",this.handleTechTouchStart_),this.on(this.tech_,"touchmove",this.handleTechTouchMove_),this.on(this.tech_,"touchend",this.handleTechTouchEnd_),this.on(this.tech_,"tap",this.handleTechTap_)},e.prototype.removeTechControlsListeners_=function(){this.off(this.tech_,"tap",this.handleTechTap_),this.off(this.tech_,"touchstart",this.handleTechTouchStart_),this.off(this.tech_,"touchmove",this.handleTechTouchMove_),this.off(this.tech_,"touchend",this.handleTechTouchEnd_),this.off(this.tech_,"mousedown",this.handleTechClick_)},e.prototype.handleTechReady_=function(){this.triggerReady(),this.cache_.volume&&this.techCall_("setVolume",this.cache_.volume),this.handleTechPosterChange_(),this.handleTechDurationChange_(),this.src()&&this.tag&&this.options_.autoplay&&this.paused()&&(delete this.tag.poster,this.play())},e.prototype.handleTechLoadStart_=function(){this.removeClass("vjs-ended"),this.error(null),this.paused()?(this.hasStarted(!1),this.trigger("loadstart")):(this.trigger("loadstart"),this.trigger("firstplay"))},e.prototype.hasStarted=function(t){return void 0!==t?(this.hasStarted_!==t&&(this.hasStarted_=t,t?(this.addClass("vjs-has-started"),this.trigger("firstplay")):this.removeClass("vjs-has-started")),this):!!this.hasStarted_},e.prototype.handleTechPlay_=function(){this.removeClass("vjs-ended"),this.removeClass("vjs-paused"),this.addClass("vjs-playing"),this.hasStarted(!0),this.trigger("play")},e.prototype.handleTechWaiting_=function(){var t=this;this.addClass("vjs-waiting"),this.trigger("waiting"),this.one("timeupdate",function(){return t.removeClass("vjs-waiting")})},e.prototype.handleTechCanPlay_=function(){this.removeClass("vjs-waiting"),this.trigger("canplay")},e.prototype.handleTechCanPlayThrough_=function(){this.removeClass("vjs-waiting"),this.trigger("canplaythrough")},e.prototype.handleTechPlaying_=function(){this.removeClass("vjs-waiting"),this.trigger("playing")},e.prototype.handleTechSeeking_=function(){
this.addClass("vjs-seeking"),this.trigger("seeking")},e.prototype.handleTechSeeked_=function(){this.removeClass("vjs-seeking"),this.trigger("seeked")},e.prototype.handleTechFirstPlay_=function(){this.options_.starttime&&this.currentTime(this.options_.starttime),this.addClass("vjs-has-started"),this.trigger("firstplay")},e.prototype.handleTechPause_=function(){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.trigger("pause")},e.prototype.handleTechProgress_=function(){this.trigger("progress")},e.prototype.handleTechEnded_=function(){this.addClass("vjs-ended"),this.options_.loop?(this.currentTime(0),this.play()):this.paused()||this.pause(),this.trigger("ended")},e.prototype.handleTechDurationChange_=function(){this.duration(this.techGet_("duration"))},e.prototype.handleTechClick_=function(t){0===t.button&&this.controls()&&(this.paused()?this.play():this.pause())},e.prototype.handleTechTap_=function(){this.userActive(!this.userActive())},e.prototype.handleTechTouchStart_=function(){this.userWasActive=this.userActive()},e.prototype.handleTechTouchMove_=function(){this.userWasActive&&this.reportUserActivity()},e.prototype.handleTechTouchEnd_=function(t){t.preventDefault()},e.prototype.handleFullscreenChange_=function(){this.isFullscreen()?this.addClass("vjs-fullscreen"):this.removeClass("vjs-fullscreen")},e.prototype.handleStageClick_=function(){this.reportUserActivity()},e.prototype.handleTechFullscreenChange_=function(t,e){e&&this.isFullscreen(e.isFullscreen),this.trigger("fullscreenchange")},e.prototype.handleTechError_=function(){var t=this.tech_.error();this.error(t&&t.code)},e.prototype.handleTechSuspend_=function(){this.trigger("suspend")},e.prototype.handleTechAbort_=function(){this.trigger("abort")},e.prototype.handleTechEmptied_=function(){this.trigger("emptied")},e.prototype.handleTechStalled_=function(){this.trigger("stalled")},e.prototype.handleTechLoadedMetaData_=function(){this.trigger("loadedmetadata")},e.prototype.handleTechLoadedData_=function(){this.trigger("loadeddata")},e.prototype.handleTechTimeUpdate_=function(){this.trigger("timeupdate")},e.prototype.handleTechRateChange_=function(){this.trigger("ratechange")},e.prototype.handleTechVolumeChange_=function(){this.trigger("volumechange")},e.prototype.handleTechTextTrackChange_=function(){this.trigger("texttrackchange")},e.prototype.getCache=function(){return this.cache_},e.prototype.techCall_=function(t,e){if(this.tech_&&!this.tech_.isReady_)this.tech_.ready(function(){this[t](e)},!0);else try{this.tech_[t](e)}catch(t){throw R.default(t),t}},e.prototype.techGet_=function(t){if(this.tech_&&this.tech_.isReady_)try{return this.tech_[t]()}catch(e){throw void 0===this.tech_[t]?R.default("Video.js: "+t+" method not defined for "+this.techName_+" playback technology.",e):"TypeError"===e.name?(R.default("Video.js: "+t+" unavailable on "+this.techName_+" playback technology element.",e),this.tech_.isReady_=!1):R.default(e),e}},e.prototype.play=function(){return this.techCall_("play"),this},e.prototype.pause=function(){return this.techCall_("pause"),this},e.prototype.paused=function(){return this.techGet_("paused")!==!1},e.prototype.scrubbing=function(t){return void 0!==t?(this.scrubbing_=!!t,t?this.addClass("vjs-scrubbing"):this.removeClass("vjs-scrubbing"),this):this.scrubbing_},e.prototype.currentTime=function(t){return void 0!==t?(this.techCall_("setCurrentTime",t),this):this.cache_.currentTime=this.techGet_("currentTime")||0},e.prototype.duration=function(t){return void 0===t?this.cache_.duration||0:(t=parseFloat(t)||0,t<0&&(t=1/0),t!==this.cache_.duration&&(this.cache_.duration=t,t===1/0?this.addClass("vjs-live"):this.removeClass("vjs-live"),this.trigger("durationchange")),this)},e.prototype.remainingTime=function(){return this.duration()-this.currentTime()},e.prototype.buffered=function t(){var t=this.techGet_("buffered");return t&&t.length||(t=M.createTimeRange(0,0)),t},e.prototype.bufferedPercent=function(){return S.bufferedPercent(this.buffered(),this.duration())},e.prototype.bufferedEnd=function(){var t=this.buffered(),e=this.duration(),n=t.end(t.length-1);return n>e&&(n=e),n},e.prototype.volume=function(t){var e=void 0;return void 0!==t?(e=Math.max(0,Math.min(1,parseFloat(t))),this.cache_.volume=e,this.techCall_("setVolume",e),this):(e=parseFloat(this.techGet_("volume")),isNaN(e)?1:e)},e.prototype.muted=function(t){return void 0!==t?(this.techCall_("setMuted",t),this):this.techGet_("muted")||!1},e.prototype.supportsFullScreen=function(){return this.techGet_("supportsFullScreen")||!1},e.prototype.isFullscreen=function(t){return void 0!==t?(this.isFullscreen_=!!t,this):!!this.isFullscreen_},e.prototype.requestFullscreen=function(){var t=L.default;return this.isFullscreen(!0),t.requestFullscreen?(f.on(u.default,t.fullscreenchange,y.bind(this,function e(n){this.isFullscreen(u.default[t.fullscreenElement]),this.isFullscreen()===!1&&f.off(u.default,t.fullscreenchange,e),this.trigger("fullscreenchange")})),this.el_[t.requestFullscreen]()):this.tech_.supportsFullScreen()?this.techCall_("enterFullScreen"):(this.enterFullWindow(),this.trigger("fullscreenchange")),this},e.prototype.exitFullscreen=function(){var t=L.default;return this.isFullscreen(!1),t.requestFullscreen?u.default[t.exitFullscreen]():this.tech_.supportsFullScreen()?this.techCall_("exitFullScreen"):(this.exitFullWindow(),this.trigger("fullscreenchange")),this},e.prototype.enterFullWindow=function(){this.isFullWindow=!0,this.docOrigOverflow=u.default.documentElement.style.overflow,f.on(u.default,"keydown",y.bind(this,this.fullWindowOnEscKey)),u.default.documentElement.style.overflow="hidden",v.addElClass(u.default.body,"vjs-full-window"),this.trigger("enterFullWindow")},e.prototype.fullWindowOnEscKey=function(t){27===t.keyCode&&(this.isFullscreen()===!0?this.exitFullscreen():this.exitFullWindow())},e.prototype.exitFullWindow=function(){this.isFullWindow=!1,f.off(u.default,"keydown",this.fullWindowOnEscKey),u.default.documentElement.style.overflow=this.docOrigOverflow,v.removeElClass(u.default.body,"vjs-full-window"),this.trigger("exitFullWindow")},e.prototype.canPlayType=function(t){for(var e=void 0,n=0,i=this.options_.techOrder;n<i.length;n++){var r=H.default(i[n]),o=tt.default.getTech(r);if(o||(o=c.default.getComponent(r)),o){if(o.isSupported()&&(e=o.canPlayType(t)))return e}else R.default.error('The "'+r+'" tech is undefined. Skipped browser support check for that tech.')}return""},e.prototype.selectSource=function(t){var e=this.options_.techOrder.map(H.default).map(function(t){return[t,tt.default.getTech(t)||c.default.getComponent(t)]}).filter(function(t){var e=t[0],n=t[1];return n?n.isSupported():(R.default.error('The "'+e+'" tech is undefined. Skipped browser support check for that tech.'),!1)}),n=function(t,e,n){var i=void 0;return t.some(function(t){return e.some(function(e){if(i=n(t,e))return!0})}),i},i=void 0,r=function(t){return function(e,n){return t(n,e)}},o=function(t,e){var n=t[0],i=t[1];if(i.canPlaySource(e))return{source:e,tech:n}};return i=this.options_.sourceOrder?n(t,e,r(o)):n(e,t,o),i||!1},e.prototype.src=function(t){if(void 0===t)return this.techGet_("src");var e=tt.default.getTech(this.techName_);return e||(e=c.default.getComponent(this.techName_)),Array.isArray(t)?this.sourceList_(t):"string"==typeof t?this.src({src:t}):t instanceof Object&&(t.type&&!e.canPlaySource(t)?this.sourceList_([t]):(this.cache_.src=t.src,this.currentType_=t.type||"",this.ready(function(){e.prototype.hasOwnProperty("setSource")?this.techCall_("setSource",t):this.techCall_("src",t.src),"auto"===this.options_.preload&&this.load(),this.options_.autoplay&&this.play()},!0))),this},e.prototype.sourceList_=function(t){var e=this.selectSource(t);e?e.tech===this.techName_?this.src(e.source):this.loadTech_(e.tech,e.source):(this.setTimeout(function(){this.error({code:4,message:this.localize(this.options_.notSupportedMessage)})},0),this.triggerReady())},e.prototype.load=function(){return this.techCall_("load"),this},e.prototype.reset=function(){return this.loadTech_(H.default(this.options_.techOrder[0]),null),this.techCall_("reset"),this},e.prototype.currentSrc=function(){return this.techGet_("currentSrc")||this.cache_.src||""},e.prototype.currentType=function(){return this.currentType_||""},e.prototype.preload=function(t){return void 0!==t?(this.techCall_("setPreload",t),this.options_.preload=t,this):this.techGet_("preload")},e.prototype.autoplay=function(t){return void 0!==t?(this.techCall_("setAutoplay",t),this.options_.autoplay=t,this):this.techGet_("autoplay",t)},e.prototype.loop=function(t){return void 0!==t?(this.techCall_("setLoop",t),this.options_.loop=t,this):this.techGet_("loop")},e.prototype.poster=function(t){return void 0===t?this.poster_:(t||(t=""),this.poster_=t,this.techCall_("setPoster",t),this.trigger("posterchange"),this)},e.prototype.handleTechPosterChange_=function(){!this.poster_&&this.tech_&&this.tech_.poster&&(this.poster_=this.tech_.poster()||"",this.trigger("posterchange"))},e.prototype.controls=function(t){return void 0!==t?(t=!!t,this.controls_!==t&&(this.controls_=t,this.usingNativeControls()&&this.techCall_("setControls",t),t?(this.removeClass("vjs-controls-disabled"),this.addClass("vjs-controls-enabled"),this.trigger("controlsenabled"),this.usingNativeControls()||this.addTechControlsListeners_()):(this.removeClass("vjs-controls-enabled"),this.addClass("vjs-controls-disabled"),this.trigger("controlsdisabled"),this.usingNativeControls()||this.removeTechControlsListeners_())),this):!!this.controls_},e.prototype.usingNativeControls=function(t){return void 0!==t?(t=!!t,this.usingNativeControls_!==t&&(this.usingNativeControls_=t,t?(this.addClass("vjs-using-native-controls"),this.trigger("usingnativecontrols")):(this.removeClass("vjs-using-native-controls"),this.trigger("usingcustomcontrols"))),this):!!this.usingNativeControls_},e.prototype.error=function(t){return void 0===t?this.error_||null:null===t?(this.error_=t,this.removeClass("vjs-error"),this.errorDisplay.close(),this):(t instanceof j.default?this.error_=t:this.error_=new j.default(t),this.addClass("vjs-error"),R.default.error("(CODE:"+this.error_.code+" "+j.default.errorTypes[this.error_.code]+")",this.error_.message,this.error_),this.trigger("error"),this)},e.prototype.ended=function(){return this.techGet_("ended")},e.prototype.seeking=function(){return this.techGet_("seeking")},e.prototype.seekable=function(){return this.techGet_("seekable")},e.prototype.reportUserActivity=function(t){this.userActivity_=!0},e.prototype.userActive=function(t){return void 0!==t?(t=!!t,t!==this.userActive_&&(this.userActive_=t,t?(this.userActivity_=!0,this.removeClass("vjs-user-inactive"),this.addClass("vjs-user-active"),this.trigger("useractive")):(this.userActivity_=!1,this.tech_&&this.tech_.one("mousemove",function(t){t.stopPropagation(),t.preventDefault()}),this.removeClass("vjs-user-active"),this.addClass("vjs-user-inactive"),this.trigger("userinactive"))),this):this.userActive_},e.prototype.listenForUserActivity_=function(){var t=void 0,e=void 0,n=void 0,i=y.bind(this,this.reportUserActivity),r=function(t){t.screenX===e&&t.screenY===n||(e=t.screenX,n=t.screenY,i())},o=function(){i(),this.clearInterval(t),t=this.setInterval(i,250)},a=function(e){i(),this.clearInterval(t)};this.on("mousedown",o),this.on("mousemove",r),this.on("mouseup",a),this.on("keydown",i),this.on("keyup",i);var s=void 0;this.setInterval(function(){if(this.userActivity_){this.userActivity_=!1,this.userActive(!0),this.clearTimeout(s);var t=this.options_.inactivityTimeout;t>0&&(s=this.setTimeout(function(){this.userActivity_||this.userActive(!1)},t))}},250)},e.prototype.playbackRate=function(t){return void 0!==t?(this.techCall_("setPlaybackRate",t),this):this.tech_&&this.tech_.featuresPlaybackRate?this.techGet_("playbackRate"):1},e.prototype.isAudio=function(t){return void 0!==t?(this.isAudio_=!!t,this):!!this.isAudio_},e.prototype.networkState=function(){return this.techGet_("networkState")},e.prototype.readyState=function(){return this.techGet_("readyState")},e.prototype.textTracks=function(){return this.tech_&&this.tech_.textTracks()},e.prototype.remoteTextTracks=function(){return this.tech_&&this.tech_.remoteTextTracks()},e.prototype.remoteTextTrackEls=function(){return this.tech_&&this.tech_.remoteTextTrackEls()},e.prototype.addTextTrack=function(t,e,n){return this.tech_&&this.tech_.addTextTrack(t,e,n)},e.prototype.addRemoteTextTrack=function(t){return this.tech_&&this.tech_.addRemoteTextTrack(t)},e.prototype.removeRemoteTextTrack=function(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],e=t.track,n=void 0===e?arguments[0]:e;this.tech_&&this.tech_.removeRemoteTextTrack(n)},e.prototype.videoWidth=function(){return this.tech_&&this.tech_.videoWidth&&this.tech_.videoWidth()||0},e.prototype.videoHeight=function(){return this.tech_&&this.tech_.videoHeight&&this.tech_.videoHeight()||0},e.prototype.language=function(t){return void 0===t?this.language_:(this.language_=(""+t).toLowerCase(),this)},e.prototype.languages=function(){return N.default(e.prototype.options_.languages,this.languages_)},e.prototype.toJSON=function(){var t=N.default(this.options_),e=t.tracks;t.tracks=[];for(var n=0;n<e.length;n++){var i=e[n];i=N.default(i),i.player=void 0,t.tracks[n]=i}return t},e.prototype.createModal=function(t,e){var n=this;e=e||{},e.content=t||"";var i=new $.default(n,e);return n.addChild(i),i.on("dispose",function(){n.removeChild(i)}),i.open()},e.getTagSettings=function(t){var e={sources:[],tracks:[]},n=v.getElAttributes(t),i=n["data-setup"];if(null!==i){var r=I.default(i||"{}"),o=r[0],a=r[1];o&&R.default.error(o),B.default(n,a)}if(B.default(e,n),t.hasChildNodes())for(var s=t.childNodes,c=0,l=s.length;c<l;c++){var u=s[c],h=u.nodeName.toLowerCase();"source"===h?e.sources.push(v.getElAttributes(u)):"track"===h&&e.tracks.push(v.getElAttributes(u))}return e},e}(c.default));nt.players={};var it=p.default.navigator;nt.prototype.options_={techOrder:["html5","flash"],html5:{},flash:{},defaultVolume:0,inactivityTimeout:2e3,playbackRates:[],children:["mediaLoader","posterImage","textTrackDisplay","loadingSpinner","bigPlayButton","controlBar","errorDisplay","textTrackSettings"],language:u.default.getElementsByTagName("html")[0].getAttribute("lang")||it.languages&&it.languages[0]||it.userLanguage||it.language||"en",languages:{},notSupportedMessage:"No compatible source was found for this media."},nt.prototype.handleLoadedMetaData_,nt.prototype.handleLoadedData_,nt.prototype.handleUserActive_,nt.prototype.handleUserInactive_,nt.prototype.handleTimeUpdate_,nt.prototype.handleTechEnded_,nt.prototype.handleVolumeChange_,nt.prototype.handleError_,nt.prototype.flexNotSupported_=function(){var t=u.default.createElement("i");return!("flexBasis"in t.style||"webkitFlexBasis"in t.style||"mozFlexBasis"in t.style||"msFlexBasis"in t.style||"msFlexOrder"in t.style)},c.default.registerComponent("Player",nt),n.default=nt,e.exports=n.default},{"./big-play-button.js":63,"./component.js":67,"./control-bar/control-bar.js":68,"./error-display.js":100,"./fullscreen-api.js":103,"./loading-spinner.js":104,"./media-error.js":105,"./modal-dialog":109,"./poster-image.js":114,"./tech/html5.js":119,"./tech/loader.js":120,"./tech/tech.js":121,"./tracks/text-track-display.js":125,"./tracks/text-track-list-converter.js":127,"./tracks/text-track-settings.js":129,"./utils/browser.js":131,"./utils/buffer.js":132,"./utils/dom.js":134,"./utils/events.js":135,"./utils/fn.js":136,"./utils/guid.js":138,"./utils/log.js":139,"./utils/merge-options.js":140,"./utils/stylesheet.js":141,"./utils/time-ranges.js":142,"./utils/to-title-case.js":143,"global/document":1,"global/window":2,"object.assign":45,"safe-json-parse/tuple":54}],111:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}n.__esModule=!0;var r=t("./player.js"),o=i(r),a=function(t,e){o.default.prototype[t]=e};n.default=a,e.exports=n.default},{"./player.js":110}],112:[function(t,e,n){"use strict";function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}n.__esModule=!0;var s=t("../clickable-component.js"),c=r(s),l=t("../component.js"),u=r(l),h=t("./popup.js"),p=(r(h),t("../utils/dom.js")),d=(i(p),t("../utils/fn.js")),f=(i(d),t("../utils/to-title-case.js")),m=(r(f),function(t){function e(n){var i=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];o(this,e),t.call(this,n,i),this.update()}return a(e,t),e.prototype.update=function(){var t=this.createPopup();this.popup&&this.removeChild(this.popup),this.popup=t,this.addChild(t),this.items&&0===this.items.length?this.hide():this.items&&this.items.length>1&&this.show()},e.prototype.createPopup=function(){},e.prototype.createEl=function(){return t.prototype.createEl.call(this,"div",{className:this.buildCSSClass()})},e.prototype.buildCSSClass=function(){var e="vjs-menu-button";return e+=this.options_.inline===!0?"-inline":"-popup","vjs-menu-button "+e+" "+t.prototype.buildCSSClass.call(this)},e}(c.default));u.default.registerComponent("PopupButton",m),n.default=m,e.exports=n.default},{"../clickable-component.js":65,"../component.js":67,"../utils/dom.js":134,"../utils/fn.js":136,"../utils/to-title-case.js":143,"./popup.js":113}],113:[function(t,e,n){"use strict";function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}n.__esModule=!0;var s=t("../component.js"),c=r(s),l=t("../utils/dom.js"),u=i(l),h=t("../utils/fn.js"),p=i(h),d=t("../utils/events.js"),f=i(d),m=function(t){function e(){o(this,e),t.apply(this,arguments)}return a(e,t),e.prototype.addItem=function(t){this.addChild(t),t.on("click",p.bind(this,function(){this.unlockShowing()}))},e.prototype.createEl=function(){var e=this.options_.contentElType||"ul";this.contentEl_=u.createEl(e,{className:"vjs-menu-content"});var n=t.prototype.createEl.call(this,"div",{append:this.contentEl_,className:"vjs-menu"});return n.appendChild(this.contentEl_),f.on(n,"click",function(t){t.preventDefault(),t.stopImmediatePropagation()}),n},e}(c.default);c.default.registerComponent("Popup",m),n.default=m,e.exports=n.default},{"../component.js":67,"../utils/dom.js":134,"../utils/events.js":135,"../utils/fn.js":136}],114:[function(t,e,n){"use strict";function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}n.__esModule=!0;var s=t("./clickable-component.js"),c=r(s),l=t("./component.js"),u=r(l),h=t("./utils/fn.js"),p=i(h),d=t("./utils/dom.js"),f=i(d),m=t("./utils/browser.js"),v=i(m),g=function(t){function e(n,i){o(this,e),t.call(this,n,i),this.update(),n.on("posterchange",p.bind(this,this.update))}return a(e,t),e.prototype.dispose=function(){this.player().off("posterchange",this.update),t.prototype.dispose.call(this)},e.prototype.createEl=function(){var t=f.createEl("div",{className:"vjs-poster",tabIndex:-1});return v.BACKGROUND_SIZE_SUPPORTED||(this.fallbackImg_=f.createEl("img"),t.appendChild(this.fallbackImg_)),t},e.prototype.update=function(){var t=this.player().poster();this.setSrc(t),t?this.show():this.hide()},e.prototype.setSrc=function(t){if(this.fallbackImg_)this.fallbackImg_.src=t;else{var e="";t&&(e='url("'+t+'")'),this.el_.style.backgroundImage=e}},e.prototype.handleClick=function(){this.player_.paused()?this.player_.play():this.player_.pause()},e}(c.default);u.default.registerComponent("PosterImage",g),n.default=g,e.exports=n.default},{"./clickable-component.js":65,"./component.js":67,"./utils/browser.js":131,"./utils/dom.js":134,"./utils/fn.js":136}],115:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}n.__esModule=!0;var o=t("./utils/events.js"),a=r(o),s=t("global/document"),c=i(s),l=t("global/window"),u=i(l),h=!1,p=void 0,d=function(){var t=c.default.getElementsByTagName("video"),e=c.default.getElementsByTagName("audio"),n=[];if(t&&t.length>0)for(var i=0,r=t.length;i<r;i++)n.push(t[i]);if(e&&e.length>0)for(var i=0,r=e.length;i<r;i++)n.push(e[i]);if(n&&n.length>0)for(var i=0,r=n.length;i<r;i++){var o=n[i];if(!o||!o.getAttribute){f(1);break}if(void 0===o.player){var a=o.getAttribute("data-setup");if(null!==a){p(o)}}}else h||f(1)},f=function(t,e){e&&(p=e),setTimeout(d,t)};"complete"===c.default.readyState?h=!0:a.one(u.default,"load",function(){h=!0});var m=function(){return h};n.autoSetup=d,n.autoSetupTimeout=f,n.hasLoaded=m},{"./utils/events.js":135,"global/document":1,"global/window":2}],116:[function(t,e,n){"use strict";function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}n.__esModule=!0;var s=t("../component.js"),c=r(s),l=t("../utils/dom.js"),u=i(l),h=t("object.assign"),p=r(h),d=function(t){function e(n,i){o(this,e),t.call(this,n,i),this.bar=this.getChild(this.options_.barName),this.vertical(!!this.options_.vertical),this.on("mousedown",this.handleMouseDown),this.on("touchstart",this.handleMouseDown),this.on("focus",this.handleFocus),this.on("blur",this.handleBlur),this.on("click",this.handleClick),this.on(n,"controlsvisible",this.update),this.on(n,this.playerEvent,this.update)}return a(e,t),e.prototype.createEl=function(e){var n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],i=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];return n.className=n.className+" vjs-slider",n=p.default({tabIndex:0},n),i=p.default({role:"slider","aria-valuenow":0,"aria-valuemin":0,"aria-valuemax":100,tabIndex:0},i),t.prototype.createEl.call(this,e,n,i)},e.prototype.handleMouseDown=function(t){var e=this.bar.el_.ownerDocument;t.preventDefault(),u.blockTextSelection(),this.addClass("vjs-sliding"),this.trigger("slideractive"),this.on(e,"mousemove",this.handleMouseMove),this.on(e,"mouseup",this.handleMouseUp),this.on(e,"touchmove",this.handleMouseMove),this.on(e,"touchend",this.handleMouseUp),this.handleMouseMove(t)},e.prototype.handleMouseMove=function(){},e.prototype.handleMouseUp=function(){var t=this.bar.el_.ownerDocument;u.unblockTextSelection(),this.removeClass("vjs-sliding"),this.trigger("sliderinactive"),this.off(t,"mousemove",this.handleMouseMove),this.off(t,"mouseup",this.handleMouseUp),this.off(t,"touchmove",this.handleMouseMove),this.off(t,"touchend",this.handleMouseUp),this.update()},e.prototype.update=function(){if(this.el_){var t=this.getPercent(),e=this.bar;if(e){("number"!=typeof t||t!==t||t<0||t===1/0)&&(t=0);var n=(100*t).toFixed(2)+"%";this.vertical()?e.el().style.height=n:e.el().style.width=n}}},e.prototype.calculateDistance=function(t){var e=u.getPointerPosition(this.el_,t);return this.vertical()?e.y:e.x},e.prototype.handleFocus=function(){this.on(this.bar.el_.ownerDocument,"keydown",this.handleKeyPress)},e.prototype.handleKeyPress=function(t){37===t.which||40===t.which?(t.preventDefault(),this.stepBack()):38!==t.which&&39!==t.which||(t.preventDefault(),this.stepForward())},e.prototype.handleBlur=function(){this.off(this.bar.el_.ownerDocument,"keydown",this.handleKeyPress)},e.prototype.handleClick=function(t){t.stopImmediatePropagation(),t.preventDefault()},e.prototype.vertical=function(t){return void 0===t?this.vertical_||!1:(this.vertical_=!!t,this.vertical_?this.addClass("vjs-slider-vertical"):this.addClass("vjs-slider-horizontal"),this)},e}(c.default);c.default.registerComponent("Slider",d),n.default=d,e.exports=n.default},{"../component.js":67,"../utils/dom.js":134,"object.assign":45}],117:[function(t,e,n){"use strict";function i(t){return t.streamingFormats={"rtmp/mp4":"MP4","rtmp/flv":"FLV"},t.streamFromParts=function(t,e){return t+"&"+e},t.streamToParts=function(t){var e={connection:"",stream:""};if(!t)return e;var n=t.search(/&(?!\w+=)/),i=void 0;return n!==-1?i=n+1:(n=i=t.lastIndexOf("/")+1,0===n&&(n=i=t.length)),e.connection=t.substring(0,n),e.stream=t.substring(i,t.length),e},t.isStreamingType=function(e){return e in t.streamingFormats},t.RTMP_RE=/^rtmp[set]?:\/\//i,t.isStreamingSrc=function(e){return t.RTMP_RE.test(e)},t.rtmpSourceHandler={},t.rtmpSourceHandler.canPlayType=function(e){return t.isStreamingType(e)?"maybe":""},t.rtmpSourceHandler.canHandleSource=function(e){var n=t.rtmpSourceHandler.canPlayType(e.type);return n?n:t.isStreamingSrc(e.src)?"maybe":""},t.rtmpSourceHandler.handleSource=function(e,n){var i=t.streamToParts(e.src);n.setRtmpConnection(i.connection),n.setRtmpStream(i.stream)},t.registerSourceHandler(t.rtmpSourceHandler),t}n.__esModule=!0,n.default=i,e.exports=n.default},{}],118:[function(t,e,n){"use strict";function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function s(t){var e=t.charAt(0).toUpperCase()+t.slice(1);H["set"+e]=function(e){return this.el_.vjs_setProperty(t,e)}}function c(t){H[t]=function(){return this.el_.vjs_getProperty(t)}}n.__esModule=!0;for(var l=t("./tech"),u=r(l),h=t("../utils/dom.js"),p=i(h),d=t("../utils/url.js"),f=i(d),m=t("../utils/time-ranges.js"),v=t("./flash-rtmp"),g=r(v),y=t("../component"),E=r(y),_=t("global/window"),T=r(_),b=t("object.assign"),w=r(b),R=T.default.navigator,x=function(t){function e(n,i){o(this,e),t.call(this,n,i),n.source&&this.ready(function(){this.setSource(n.source)},!0),n.startTime&&this.ready(function(){this.load(),this.play(),this.currentTime(n.startTime)},!0),T.default.videojs=T.default.videojs||{},T.default.videojs.Flash=T.default.videojs.Flash||{},T.default.videojs.Flash.onReady=e.onReady,T.default.videojs.Flash.onEvent=e.onEvent,T.default.videojs.Flash.onError=e.onError,this.on("seeked",function(){this.lastSeekTarget_=void 0})}return a(e,t),e.prototype.createEl=function(){var t=this.options_;t.swf||(t.swf="//vjs.zencdn.net/swf/5.0.1/video-js.swf");var n=t.techId,i=w.default({readyFunction:"videojs.Flash.onReady",eventProxyFunction:"videojs.Flash.onEvent",errorEventProxyFunction:"videojs.Flash.onError",autoplay:t.autoplay,preload:t.preload,loop:t.loop,muted:t.muted},t.flashVars),r=w.default({wmode:"opaque",bgcolor:"#000000"},t.params),o=w.default({id:n,name:n,class:"vjs-tech"},t.attributes);return this.el_=e.embed(t.swf,i,r,o),this.el_.tech=this,this.el_},e.prototype.play=function(){this.ended()&&this.setCurrentTime(0),this.el_.vjs_play()},e.prototype.pause=function(){this.el_.vjs_pause()},e.prototype.src=function(t){return void 0===t?this.currentSrc():this.setSrc(t)},e.prototype.setSrc=function(t){if(t=f.getAbsoluteURL(t),this.el_.vjs_src(t),this.autoplay()){var e=this;this.setTimeout(function(){e.play()},0)}},e.prototype.seeking=function(){return void 0!==this.lastSeekTarget_},e.prototype.setCurrentTime=function(e){var n=this.seekable();n.length&&(e=e>n.start(0)?e:n.start(0),e=e<n.end(n.length-1)?e:n.end(n.length-1),this.lastSeekTarget_=e,this.trigger("seeking"),this.el_.vjs_setProperty("currentTime",e),t.prototype.setCurrentTime.call(this))},e.prototype.currentTime=function(t){return this.seeking()?this.lastSeekTarget_||0:this.el_.vjs_getProperty("currentTime")},e.prototype.currentSrc=function(){return this.currentSource_?this.currentSource_.src:this.el_.vjs_getProperty("currentSrc")},e.prototype.load=function(){this.el_.vjs_load()},e.prototype.poster=function(){this.el_.vjs_getProperty("poster")},e.prototype.setPoster=function(){},e.prototype.seekable=function(){var t=this.duration();return 0===t?m.createTimeRange():m.createTimeRange(0,t)},e.prototype.buffered=function(){var t=this.el_.vjs_getProperty("buffered");return 0===t.length?m.createTimeRange():m.createTimeRange(t[0][0],t[0][1])},e.prototype.supportsFullScreen=function(){return!1},e.prototype.enterFullScreen=function(){return!1},e}(u.default),H=x.prototype,M="rtmpConnection,rtmpStream,preload,defaultPlaybackRate,playbackRate,autoplay,loop,mediaGroup,controller,controls,volume,muted,defaultMuted".split(","),S="networkState,readyState,initialTime,duration,startOffsetTime,paused,ended,videoTracks,audioTracks,videoWidth,videoHeight".split(","),C=0;C<M.length;C++)c(M[C]),s(M[C]);for(var C=0;C<S.length;C++)c(S[C]);x.isSupported=function(){return x.version()[0]>=10},u.default.withSourceHandlers(x),x.nativeSourceHandler={},x.nativeSourceHandler.canPlayType=function(t){return t in x.formats?"maybe":""},x.nativeSourceHandler.canHandleSource=function(t){function e(t){var e=f.getFileExtension(t);return e?"video/"+e:""}var n;return n=t.type?t.type.replace(/;.*/,"").toLowerCase():e(t.src),x.nativeSourceHandler.canPlayType(n)},x.nativeSourceHandler.handleSource=function(t,e){e.setSrc(t.src)},x.nativeSourceHandler.dispose=function(){},x.registerSourceHandler(x.nativeSourceHandler),x.formats={"video/flv":"FLV","video/x-flv":"FLV","video/mp4":"MP4","video/m4v":"MP4"},x.onReady=function(t){var e=p.getEl(t),n=e&&e.tech;n&&n.el()&&x.checkReady(n)},x.checkReady=function(t){t.el()&&(t.el().vjs_getProperty?t.triggerReady():this.setTimeout(function(){x.checkReady(t)},50))},x.onEvent=function(t,e){var n=p.getEl(t).tech;n.trigger(e)},x.onError=function(t,e){var n=p.getEl(t).tech;return"srcnotfound"===e?n.error(4):void n.error("FLASH: "+e)},x.version=function(){var t="0,0,0";try{t=new T.default.ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version").replace(/\D+/g,",").match(/^,?(.+),?$/)[1]}catch(e){try{R.mimeTypes["application/x-shockwave-flash"].enabledPlugin&&(t=(R.plugins["Shockwave Flash 2.0"]||R.plugins["Shockwave Flash"]).description.replace(/\D+/g,",").match(/^,?(.+),?$/)[1])}catch(t){}}return t.split(",")},
x.embed=function(t,e,n,i){var r=x.getEmbedCode(t,e,n,i),o=p.createEl("div",{innerHTML:r}).childNodes[0];return o},x.getEmbedCode=function(t,e,n,i){var r='<object type="application/x-shockwave-flash" ',o="",a="",s="";return e&&Object.getOwnPropertyNames(e).forEach(function(t){o+=t+"="+e[t]+"&amp;"}),n=w.default({movie:t,flashvars:o,allowScriptAccess:"always",allowNetworking:"all"},n),Object.getOwnPropertyNames(n).forEach(function(t){a+='<param name="'+t+'" value="'+n[t]+'" />'}),i=w.default({data:t,width:"100%",height:"100%"},i),Object.getOwnPropertyNames(i).forEach(function(t){s+=t+'="'+i[t]+'" '}),""+r+s+">"+a+"</object>"},g.default(x),E.default.registerComponent("Flash",x),u.default.registerTech("Flash",x),n.default=x,e.exports=n.default},{"../component":67,"../utils/dom.js":134,"../utils/time-ranges.js":142,"../utils/url.js":144,"./flash-rtmp":117,"./tech":121,"global/window":2,"object.assign":45}],119:[function(t,e,n){"use strict";function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}n.__esModule=!0;var s=t("./tech.js"),c=r(s),l=t("../component"),u=r(l),h=t("../utils/dom.js"),p=i(h),d=t("../utils/url.js"),f=i(d),m=t("../utils/fn.js"),v=i(m),g=t("../utils/log.js"),y=r(g),E=t("../utils/browser.js"),_=i(E),T=t("global/document"),b=r(T),w=t("global/window"),R=r(w),x=t("object.assign"),H=r(x),M=t("../utils/merge-options.js"),S=r(M),C=function(t){function e(n,i){o(this,e),t.call(this,n,i);var r=n.source;if(r&&(this.el_.currentSrc!==r.src||n.tag&&3===n.tag.initNetworkState_)?this.setSource(r):this.handleLateInit_(this.el_),this.el_.hasChildNodes()){for(var a=this.el_.childNodes,s=a.length,c=[];s--;){var l=a[s],u=l.nodeName.toLowerCase();"track"===u&&(this.featuresNativeTextTracks?(this.remoteTextTrackEls().addTrackElement_(l),this.remoteTextTracks().addTrack_(l.track)):c.push(l))}for(var h=0;h<c.length;h++)this.el_.removeChild(c[h])}this.featuresNativeTextTracks&&(this.handleTextTrackChange_=v.bind(this,this.handleTextTrackChange),this.handleTextTrackAdd_=v.bind(this,this.handleTextTrackAdd),this.handleTextTrackRemove_=v.bind(this,this.handleTextTrackRemove),this.proxyNativeTextTracks_()),(_.TOUCH_ENABLED&&n.nativeControlsForTouch===!0||_.IS_IPHONE||_.IS_NATIVE_ANDROID)&&this.setControls(!0),this.triggerReady()}return a(e,t),e.prototype.dispose=function(){var n=this.el().textTracks,i=this.textTracks();n&&n.removeEventListener&&(n.removeEventListener("change",this.handleTextTrackChange_),n.removeEventListener("addtrack",this.handleTextTrackAdd_),n.removeEventListener("removetrack",this.handleTextTrackRemove_));for(var r=i.length;r--;)i.removeTrack_(i[r]);e.disposeMediaElement(this.el_),t.prototype.dispose.call(this)},e.prototype.createEl=function(){var t=this.options_.tag;if(!t||this.movingMediaElementInDOM===!1)if(t){var n=t.cloneNode(!0);t.parentNode.insertBefore(n,t),e.disposeMediaElement(t),t=n}else{t=b.default.createElement("video");var i=this.options_.tag&&p.getElAttributes(this.options_.tag),r=S.default({},i);_.TOUCH_ENABLED&&this.options_.nativeControlsForTouch===!0||delete r.controls,p.setElAttributes(t,H.default(r,{id:this.options_.techId,class:"vjs-tech"}))}for(var o=["autoplay","preload","loop","muted"],a=o.length-1;a>=0;a--){var s=o[a],c={};"undefined"!=typeof this.options_[s]&&(c[s]=this.options_[s]),p.setElAttributes(t,c)}return t},e.prototype.handleLateInit_=function(t){var e=this;if(0!==t.networkState&&3!==t.networkState){if(0===t.readyState){var n=function(){var t=!1,n=function(){t=!0};e.on("loadstart",n);var i=function(){t||this.trigger("loadstart")};return e.on("loadedmetadata",i),e.ready(function(){this.off("loadstart",n),this.off("loadedmetadata",i),t||this.trigger("loadstart")}),{v:void 0}}();if("object"==typeof n)return n.v}var i=["loadstart"];i.push("loadedmetadata"),t.readyState>=2&&i.push("loadeddata"),t.readyState>=3&&i.push("canplay"),t.readyState>=4&&i.push("canplaythrough"),this.ready(function(){i.forEach(function(t){this.trigger(t)},this)})}},e.prototype.proxyNativeTextTracks_=function(){var t=this.el().textTracks;if(t){for(var e=0;e<t.length;e++)this.textTracks().addTrack_(t[e]);t.addEventListener&&(t.addEventListener("change",this.handleTextTrackChange_),t.addEventListener("addtrack",this.handleTextTrackAdd_),t.addEventListener("removetrack",this.handleTextTrackRemove_))}},e.prototype.handleTextTrackChange=function(t){var e=this.textTracks();this.textTracks().trigger({type:"change",target:e,currentTarget:e,srcElement:e})},e.prototype.handleTextTrackAdd=function(t){this.textTracks().addTrack_(t.track)},e.prototype.handleTextTrackRemove=function(t){this.textTracks().removeTrack_(t.track)},e.prototype.play=function(){this.el_.play()},e.prototype.pause=function(){this.el_.pause()},e.prototype.paused=function(){return this.el_.paused},e.prototype.currentTime=function(){return this.el_.currentTime},e.prototype.setCurrentTime=function(t){try{this.el_.currentTime=t}catch(t){y.default(t,"Video is not ready. (Video.js)")}},e.prototype.duration=function(){return this.el_.duration||0},e.prototype.buffered=function(){return this.el_.buffered},e.prototype.volume=function(){return this.el_.volume},e.prototype.setVolume=function(t){this.el_.volume=t},e.prototype.muted=function(){return this.el_.muted},e.prototype.setMuted=function(t){this.el_.muted=t},e.prototype.width=function(){return this.el_.offsetWidth},e.prototype.height=function(){return this.el_.offsetHeight},e.prototype.supportsFullScreen=function(){if("function"==typeof this.el_.webkitEnterFullScreen){var t=R.default.navigator.userAgent;if(/Android/.test(t)||!/Chrome|Mac OS X 10.5/.test(t))return!0}return!1},e.prototype.enterFullScreen=function(){var t=this.el_;"webkitDisplayingFullscreen"in t&&this.one("webkitbeginfullscreen",function(){this.one("webkitendfullscreen",function(){this.trigger("fullscreenchange",{isFullscreen:!1})}),this.trigger("fullscreenchange",{isFullscreen:!0})}),t.paused&&t.networkState<=t.HAVE_METADATA?(this.el_.play(),this.setTimeout(function(){t.pause(),t.webkitEnterFullScreen()},0)):t.webkitEnterFullScreen()},e.prototype.exitFullScreen=function(){this.el_.webkitExitFullScreen()},e.prototype.src=function(t){return void 0===t?this.el_.src:void this.setSrc(t)},e.prototype.setSrc=function(t){this.el_.src=t},e.prototype.load=function(){this.el_.load()},e.prototype.reset=function(){e.resetMediaElement(this.el_)},e.prototype.currentSrc=function(){return this.currentSource_?this.currentSource_.src:this.el_.currentSrc},e.prototype.poster=function(){return this.el_.poster},e.prototype.setPoster=function(t){this.el_.poster=t},e.prototype.preload=function(){return this.el_.preload},e.prototype.setPreload=function(t){this.el_.preload=t},e.prototype.autoplay=function(){return this.el_.autoplay},e.prototype.setAutoplay=function(t){this.el_.autoplay=t},e.prototype.controls=function(){return this.el_.controls},e.prototype.setControls=function(t){this.el_.controls=!!t},e.prototype.loop=function(){return this.el_.loop},e.prototype.setLoop=function(t){this.el_.loop=t},e.prototype.error=function(){return this.el_.error},e.prototype.seeking=function(){return this.el_.seeking},e.prototype.seekable=function(){return this.el_.seekable},e.prototype.ended=function(){return this.el_.ended},e.prototype.defaultMuted=function(){return this.el_.defaultMuted},e.prototype.playbackRate=function(){return this.el_.playbackRate},e.prototype.played=function(){return this.el_.played},e.prototype.setPlaybackRate=function(t){this.el_.playbackRate=t},e.prototype.networkState=function(){return this.el_.networkState},e.prototype.readyState=function(){return this.el_.readyState},e.prototype.videoWidth=function(){return this.el_.videoWidth},e.prototype.videoHeight=function(){return this.el_.videoHeight},e.prototype.textTracks=function(){return t.prototype.textTracks.call(this)},e.prototype.addTextTrack=function(e,n,i){return this.featuresNativeTextTracks?this.el_.addTextTrack(e,n,i):t.prototype.addTextTrack.call(this,e,n,i)},e.prototype.addRemoteTextTrack=function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];if(!this.featuresNativeTextTracks)return t.prototype.addRemoteTextTrack.call(this,e);var n=b.default.createElement("track");return e.kind&&(n.kind=e.kind),e.label&&(n.label=e.label),(e.language||e.srclang)&&(n.srclang=e.language||e.srclang),e.default&&(n.default=e.default),e.id&&(n.id=e.id),e.src&&(n.src=e.src),this.el().appendChild(n),this.remoteTextTrackEls().addTrackElement_(n),this.remoteTextTracks().addTrack_(n.track),n},e.prototype.removeRemoteTextTrack=function(e){if(!this.featuresNativeTextTracks)return t.prototype.removeRemoteTextTrack.call(this,e);var n=void 0,i=void 0,r=this.remoteTextTrackEls().getTrackElementByTrack_(e);for(this.remoteTextTrackEls().removeTrackElement_(r),this.remoteTextTracks().removeTrack_(e),n=this.$$("track"),i=n.length;i--;)e!==n[i]&&e!==n[i].track||this.el().removeChild(n[i])},e}(c.default);C.TEST_VID=b.default.createElement("video");var A=b.default.createElement("track");A.kind="captions",A.srclang="en",A.label="English",C.TEST_VID.appendChild(A),C.isSupported=function(){try{C.TEST_VID.volume=.5}catch(t){return!1}return!!C.TEST_VID.canPlayType},c.default.withSourceHandlers(C),C.nativeSourceHandler={},C.nativeSourceHandler.canPlayType=function(t){try{return C.TEST_VID.canPlayType(t)}catch(t){return""}},C.nativeSourceHandler.canHandleSource=function(t){var e;return t.type?C.nativeSourceHandler.canPlayType(t.type):t.src?(e=f.getFileExtension(t.src),C.nativeSourceHandler.canPlayType("video/"+e)):""},C.nativeSourceHandler.handleSource=function(t,e){e.setSrc(t.src)},C.nativeSourceHandler.dispose=function(){},C.registerSourceHandler(C.nativeSourceHandler),C.canControlVolume=function(){var t=C.TEST_VID.volume;return C.TEST_VID.volume=t/2+.1,t!==C.TEST_VID.volume},C.canControlPlaybackRate=function(){if(_.IS_ANDROID&&_.IS_CHROME)return!1;var t=C.TEST_VID.playbackRate;return C.TEST_VID.playbackRate=t/2+.1,t!==C.TEST_VID.playbackRate},C.supportsNativeTextTracks=function(){var t;return t=!!C.TEST_VID.textTracks,t&&C.TEST_VID.textTracks.length>0&&(t="number"!=typeof C.TEST_VID.textTracks[0].mode),t&&_.IS_FIREFOX&&(t=!1),!t||"onremovetrack"in C.TEST_VID.textTracks||(t=!1),t},C.Events=["loadstart","suspend","abort","error","emptied","stalled","loadedmetadata","loadeddata","canplay","canplaythrough","playing","waiting","seeking","seeked","ended","durationchange","timeupdate","progress","play","pause","ratechange","volumechange"],C.prototype.featuresVolumeControl=C.canControlVolume(),C.prototype.featuresPlaybackRate=C.canControlPlaybackRate(),C.prototype.movingMediaElementInDOM=!_.IS_IOS,C.prototype.featuresFullscreenResize=!0,C.prototype.featuresProgressEvents=!0,C.prototype.featuresNativeTextTracks=C.supportsNativeTextTracks();var P=void 0,L=/^application\/(?:x-|vnd\.apple\.)mpegurl/i,O=/^video\/mp4/i;C.patchCanPlayType=function(){_.ANDROID_VERSION>=4&&(P||(P=C.TEST_VID.constructor.prototype.canPlayType),C.TEST_VID.constructor.prototype.canPlayType=function(t){return t&&L.test(t)?"maybe":P.call(this,t)}),_.IS_OLD_ANDROID&&(P||(P=C.TEST_VID.constructor.prototype.canPlayType),C.TEST_VID.constructor.prototype.canPlayType=function(t){return t&&O.test(t)?"maybe":P.call(this,t)})},C.unpatchCanPlayType=function(){var t=C.TEST_VID.constructor.prototype.canPlayType;return C.TEST_VID.constructor.prototype.canPlayType=P,P=null,t},C.patchCanPlayType(),C.disposeMediaElement=function(t){if(t){for(t.parentNode&&t.parentNode.removeChild(t);t.hasChildNodes();)t.removeChild(t.firstChild);t.removeAttribute("src"),"function"==typeof t.load&&!function(){try{t.load()}catch(t){}}()}},C.resetMediaElement=function(t){if(t){for(var e=t.querySelectorAll("source"),n=e.length;n--;)t.removeChild(e[n]);t.removeAttribute("src"),"function"==typeof t.load&&!function(){try{t.load()}catch(t){}}()}},u.default.registerComponent("Html5",C),c.default.registerTech("Html5",C),n.default=C,e.exports=n.default},{"../component":67,"../utils/browser.js":131,"../utils/dom.js":134,"../utils/fn.js":136,"../utils/log.js":139,"../utils/merge-options.js":140,"../utils/url.js":144,"./tech.js":121,"global/document":1,"global/window":2,"object.assign":45}],120:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}n.__esModule=!0;var a=t("../component.js"),s=i(a),c=t("./tech.js"),l=i(c),u=t("global/window"),h=(i(u),t("../utils/to-title-case.js")),p=i(h),d=function(t){function e(n,i,o){if(r(this,e),t.call(this,n,i,o),i.playerOptions.sources&&0!==i.playerOptions.sources.length)n.src(i.playerOptions.sources);else for(var a=0,c=i.playerOptions.techOrder;a<c.length;a++){var u=p.default(c[a]),h=l.default.getTech(u);if(u||(h=s.default.getComponent(u)),h&&h.isSupported()){n.loadTech_(u);break}}}return o(e,t),e}(s.default);s.default.registerComponent("MediaLoader",d),n.default=d,e.exports=n.default},{"../component.js":67,"../utils/to-title-case.js":143,"./tech.js":121,"global/window":2}],121:[function(t,e,n){"use strict";function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}n.__esModule=!0;var s=t("../component"),c=r(s),l=t("../tracks/html-track-element"),u=r(l),h=t("../tracks/html-track-element-list"),p=r(h),d=t("../utils/merge-options.js"),f=r(d),m=t("../tracks/text-track"),v=r(m),g=t("../tracks/text-track-list"),y=r(g),E=t("../utils/fn.js"),_=i(E),T=t("../utils/log.js"),b=r(T),w=t("../utils/time-ranges.js"),R=t("../utils/buffer.js"),x=t("../media-error.js"),H=r(x),M=t("global/window"),S=r(M),C=t("global/document"),A=r(C),P=function(t){function e(){var n=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],i=arguments.length<=1||void 0===arguments[1]?function(){}:arguments[1];o(this,e),n.reportTouchActivity=!1,t.call(this,null,n,i),this.hasStarted_=!1,this.on("playing",function(){this.hasStarted_=!0}),this.on("loadstart",function(){this.hasStarted_=!1}),this.textTracks_=n.textTracks,this.featuresProgressEvents||this.manualProgressOn(),this.featuresTimeupdateEvents||this.manualTimeUpdatesOn(),n.nativeCaptions!==!1&&n.nativeTextTracks!==!1||(this.featuresNativeTextTracks=!1),this.featuresNativeTextTracks||this.on("ready",this.emulateTextTracks),this.initTextTrackListeners(),this.emitTapEvents()}/*! Time Tracking -------------------------------------------------------------- */
return a(e,t),e.prototype.manualProgressOn=function(){this.on("durationchange",this.onDurationChange),this.manualProgress=!0,this.one("ready",this.trackProgress)},e.prototype.manualProgressOff=function(){this.manualProgress=!1,this.stopTrackingProgress(),this.off("durationchange",this.onDurationChange)},e.prototype.trackProgress=function(){this.stopTrackingProgress(),this.progressInterval=this.setInterval(_.bind(this,function(){var t=this.bufferedPercent();this.bufferedPercent_!==t&&this.trigger("progress"),this.bufferedPercent_=t,1===t&&this.stopTrackingProgress()}),500)},e.prototype.onDurationChange=function(){this.duration_=this.duration()},e.prototype.buffered=function(){return w.createTimeRange(0,0)},e.prototype.bufferedPercent=function(){return R.bufferedPercent(this.buffered(),this.duration_)},e.prototype.stopTrackingProgress=function(){this.clearInterval(this.progressInterval)},e.prototype.manualTimeUpdatesOn=function(){this.manualTimeUpdates=!0,this.on("play",this.trackCurrentTime),this.on("pause",this.stopTrackingCurrentTime)},e.prototype.manualTimeUpdatesOff=function(){this.manualTimeUpdates=!1,this.stopTrackingCurrentTime(),this.off("play",this.trackCurrentTime),this.off("pause",this.stopTrackingCurrentTime)},e.prototype.trackCurrentTime=function(){this.currentTimeInterval&&this.stopTrackingCurrentTime(),this.currentTimeInterval=this.setInterval(function(){this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},250)},e.prototype.stopTrackingCurrentTime=function(){this.clearInterval(this.currentTimeInterval),this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},e.prototype.dispose=function(){var e=this.textTracks();if(e)for(var n=e.length;n--;)this.removeRemoteTextTrack(e[n]);this.manualProgress&&this.manualProgressOff(),this.manualTimeUpdates&&this.manualTimeUpdatesOff(),t.prototype.dispose.call(this)},e.prototype.reset=function(){},e.prototype.error=function(t){return void 0!==t&&(t instanceof H.default?this.error_=t:this.error_=new H.default(t),this.trigger("error")),this.error_},e.prototype.played=function(){return this.hasStarted_?w.createTimeRange(0,0):w.createTimeRange()},e.prototype.setCurrentTime=function(){this.manualTimeUpdates&&this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},e.prototype.initTextTrackListeners=function(){var t=_.bind(this,function(){this.trigger("texttrackchange")}),e=this.textTracks();e&&(e.addEventListener("removetrack",t),e.addEventListener("addtrack",t),this.on("dispose",_.bind(this,function(){e.removeEventListener("removetrack",t),e.removeEventListener("addtrack",t)})))},e.prototype.emulateTextTracks=function(){var t=this,e=this.textTracks();if(e){S.default.WebVTT||null==this.el().parentNode||!function(){var e=A.default.createElement("script");e.src=t.options_["vtt.js"]||"https://cdn.rawgit.com/gkatsev/vtt.js/vjs-v0.12.1/dist/vtt.min.js",e.onload=function(){t.trigger("vttjsloaded")},e.onerror=function(){t.trigger("vttjserror")},t.on("dispose",function(){e.onload=null,e.onerror=null}),t.el().parentNode.appendChild(e),S.default.WebVTT=!0}();var n=function(){return t.trigger("texttrackchange")},i=function(){n();for(var t=0;t<e.length;t++){var i=e[t];i.removeEventListener("cuechange",n),"showing"===i.mode&&i.addEventListener("cuechange",n)}};i(),e.addEventListener("change",i),this.on("dispose",function(){e.removeEventListener("change",i)})}},e.prototype.textTracks=function(){return this.textTracks_=this.textTracks_||new y.default,this.textTracks_},e.prototype.remoteTextTracks=function(){return this.remoteTextTracks_=this.remoteTextTracks_||new y.default,this.remoteTextTracks_},e.prototype.remoteTextTrackEls=function(){return this.remoteTextTrackEls_=this.remoteTextTrackEls_||new p.default,this.remoteTextTrackEls_},e.prototype.addTextTrack=function(t,e,n){if(!t)throw new Error("TextTrack kind is required but was not provided");return L(this,t,e,n)},e.prototype.addRemoteTextTrack=function(t){var e=f.default(t,{tech:this}),n=new u.default(e);return this.remoteTextTrackEls().addTrackElement_(n),this.remoteTextTracks().addTrack_(n.track),this.textTracks().addTrack_(n.track),n},e.prototype.removeRemoteTextTrack=function(t){this.textTracks().removeTrack_(t);var e=this.remoteTextTrackEls().getTrackElementByTrack_(t);this.remoteTextTrackEls().removeTrackElement_(e),this.remoteTextTracks().removeTrack_(t)},e.prototype.setPoster=function(){},e.prototype.canPlayType=function(){return""},e.isTech=function(t){return t.prototype instanceof e||t instanceof e||t===e},e.registerTech=function(t,n){if(e.techs_||(e.techs_={}),!e.isTech(n))throw new Error("Tech "+t+" must be a Tech");return e.techs_[t]=n,n},e.getTech=function(t){return e.techs_&&e.techs_[t]?e.techs_[t]:S.default&&S.default.videojs&&S.default.videojs[t]?(b.default.warn("The "+t+" tech was added to the videojs object when it should be registered using videojs.registerTech(name, tech)"),S.default.videojs[t]):void 0},e}(c.default);P.prototype.textTracks_;var L=function(t,e,n,i){var r=arguments.length<=4||void 0===arguments[4]?{}:arguments[4],o=t.textTracks();r.kind=e,n&&(r.label=n),i&&(r.language=i),r.tech=t;var a=new v.default(r);return o.addTrack_(a),a};P.prototype.featuresVolumeControl=!0,P.prototype.featuresFullscreenResize=!1,P.prototype.featuresPlaybackRate=!1,P.prototype.featuresProgressEvents=!1,P.prototype.featuresTimeupdateEvents=!1,P.prototype.featuresNativeTextTracks=!1,P.withSourceHandlers=function(t){t.registerSourceHandler=function(e,n){var i=t.sourceHandlers;i||(i=t.sourceHandlers=[]),void 0===n&&(n=i.length),i.splice(n,0,e)},t.canPlayType=function(e){for(var n=t.sourceHandlers||[],i=void 0,r=0;r<n.length;r++)if(i=n[r].canPlayType(e))return i;return""},t.selectSourceHandler=function(e){for(var n=t.sourceHandlers||[],i=void 0,r=0;r<n.length;r++)if(i=n[r].canHandleSource(e))return n[r];return null},t.canPlaySource=function(e){var n=t.selectSourceHandler(e);return n?n.canHandleSource(e):""};var e=["seekable","duration"];e.forEach(function(t){var e=this[t];"function"==typeof e&&(this[t]=function(){return this.sourceHandler_&&this.sourceHandler_[t]?this.sourceHandler_[t].apply(this.sourceHandler_,arguments):e.apply(this,arguments)})},t.prototype),t.prototype.setSource=function(e){var n=t.selectSourceHandler(e);return n||(t.nativeSourceHandler?n=t.nativeSourceHandler:b.default.error("No source hander found for the current source.")),this.disposeSourceHandler(),this.off("dispose",this.disposeSourceHandler),this.currentSource_=e,this.sourceHandler_=n.handleSource(e,this),this.on("dispose",this.disposeSourceHandler),this},t.prototype.disposeSourceHandler=function(){this.sourceHandler_&&this.sourceHandler_.dispose&&this.sourceHandler_.dispose()}},c.default.registerComponent("Tech",P),c.default.registerComponent("MediaTechController",P),P.registerTech("Tech",P),n.default=P,e.exports=n.default},{"../component":67,"../media-error.js":105,"../tracks/html-track-element":123,"../tracks/html-track-element-list":122,"../tracks/text-track":130,"../tracks/text-track-list":128,"../utils/buffer.js":132,"../utils/fn.js":136,"../utils/log.js":139,"../utils/merge-options.js":140,"../utils/time-ranges.js":142,"global/document":1,"global/window":2}],122:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.__esModule=!0;var a=t("../utils/browser.js"),s=r(a),c=t("global/document"),l=i(c),u=function(){function t(){var e=arguments.length<=0||void 0===arguments[0]?[]:arguments[0];o(this,t);var n=this;if(s.IS_IE8){n=l.default.createElement("custom");for(var i in t.prototype)"constructor"!==i&&(n[i]=t.prototype[i])}n.trackElements_=[],Object.defineProperty(n,"length",{get:function(){return this.trackElements_.length}});for(var r=0,a=e.length;r<a;r++)n.addTrackElement_(e[r]);if(s.IS_IE8)return n}return t.prototype.addTrackElement_=function(t){this.trackElements_.push(t)},t.prototype.getTrackElementByTrack_=function(t){for(var e=void 0,n=0,i=this.trackElements_.length;n<i;n++)if(t===this.trackElements_[n].track){e=this.trackElements_[n];break}return e},t.prototype.removeTrackElement_=function(t){for(var e=0,n=this.trackElements_.length;e<n;e++)if(t===this.trackElements_[e]){this.trackElements_.splice(e,1);break}},t}();n.default=u,e.exports=n.default},{"../utils/browser.js":131,"global/document":1}],123:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}n.__esModule=!0;var s=t("../utils/browser.js"),c=r(s),l=t("global/document"),u=i(l),h=t("../event-target"),p=i(h),d=t("../tracks/text-track"),f=i(d),m=0,v=1,g=2,y=3,E=function(t){function e(){var n=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];o(this,e),t.call(this);var i=void 0,r=this;if(c.IS_IE8){r=u.default.createElement("custom");for(var a in e.prototype)"constructor"!==a&&(r[a]=e.prototype[a])}var s=new f.default(n);if(r.kind=s.kind,r.src=s.src,r.srclang=s.language,r.label=s.label,r.default=s.default,Object.defineProperty(r,"readyState",{get:function(){return i}}),Object.defineProperty(r,"track",{get:function(){return s}}),i=m,s.addEventListener("loadeddata",function(){i=g,r.trigger({type:"load",target:r})}),c.IS_IE8)return r}return a(e,t),e}(p.default);E.prototype.allowedEvents_={load:"load"},E.NONE=m,E.LOADING=v,E.LOADED=g,E.ERROR=y,n.default=E,e.exports=n.default},{"../event-target":101,"../tracks/text-track":130,"../utils/browser.js":131,"global/document":1}],124:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.__esModule=!0;var a=t("../utils/browser.js"),s=r(a),c=t("global/document"),l=i(c),u=function(){function t(e){o(this,t);var n=this;if(s.IS_IE8){n=l.default.createElement("custom");for(var i in t.prototype)"constructor"!==i&&(n[i]=t.prototype[i])}if(t.prototype.setCues_.call(n,e),Object.defineProperty(n,"length",{get:function(){return this.length_}}),s.IS_IE8)return n}return t.prototype.setCues_=function(t){var e=this.length||0,n=0,i=t.length;this.cues_=t,this.length_=t.length;var r=function(t){""+t in this||Object.defineProperty(this,""+t,{get:function(){return this.cues_[t]}})};if(e<i)for(n=e;n<i;n++)r.call(this,n)},t.prototype.getCueById=function(t){for(var e=null,n=0,i=this.length;n<i;n++){var r=this[n];if(r.id===t){e=r;break}}return e},t}();n.default=u,e.exports=n.default},{"../utils/browser.js":131,"global/document":1}],125:[function(t,e,n){"use strict";function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function s(t,e){return"rgba("+parseInt(t[1]+t[1],16)+","+parseInt(t[2]+t[2],16)+","+parseInt(t[3]+t[3],16)+","+e+")"}function c(t,e,n){try{t.style[e]=n}catch(t){}}n.__esModule=!0;var l=t("../component"),u=r(l),h=t("../menu/menu.js"),p=(r(h),t("../menu/menu-item.js")),d=(r(p),t("../menu/menu-button.js")),f=(r(d),t("../utils/fn.js")),m=i(f),v=t("global/document"),g=(r(v),t("global/window")),y=r(g),E="#222",_="#ccc",T={monospace:"monospace",sansSerif:"sans-serif",serif:"serif",monospaceSansSerif:'"Andale Mono", "Lucida Console", monospace',monospaceSerif:'"Courier New", monospace',proportionalSansSerif:"sans-serif",proportionalSerif:"serif",casual:'"Comic Sans MS", Impact, fantasy',script:'"Monotype Corsiva", cursive',smallcaps:'"Andale Mono", "Lucida Console", monospace, sans-serif'},b=function(t){function e(n,i,r){o(this,e),t.call(this,n,i,r),n.on("loadstart",m.bind(this,this.toggleDisplay)),n.on("texttrackchange",m.bind(this,this.updateDisplay)),n.ready(m.bind(this,function(){if(n.tech_&&n.tech_.featuresNativeTextTracks)return void this.hide();n.on("fullscreenchange",m.bind(this,this.updateDisplay));for(var t=this.options_.playerOptions.tracks||[],e=0;e<t.length;e++){var i=t[e];this.player_.addRemoteTextTrack(i)}var r={captions:1,subtitles:1},o=this.player_.textTracks(),a=void 0,s=void 0;if(o){for(var e=0;e<o.length;e++){var i=o[e];i.default&&("descriptions"!==i.kind||a?i.kind in r&&!s&&(s=i):a=i)}s?s.mode="showing":a&&(a.mode="showing")}}))}return a(e,t),e.prototype.toggleDisplay=function(){this.player_.tech_&&this.player_.tech_.featuresNativeTextTracks?this.hide():this.show()},e.prototype.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-text-track-display"},{"aria-live":"assertive","aria-atomic":"true"})},e.prototype.clearDisplay=function(){"function"==typeof y.default.WebVTT&&y.default.WebVTT.processCues(y.default,[],this.el_)},e.prototype.updateDisplay=function(){var t=this.player_.textTracks();if(this.clearDisplay(),t){for(var e=null,n=null,i=t.length;i--;){var r=t[i];"showing"===r.mode&&("descriptions"===r.kind?e=r:n=r)}n?this.updateForTrack(n):e&&this.updateForTrack(e)}},e.prototype.updateForTrack=function(t){if("function"==typeof y.default.WebVTT&&t.activeCues){for(var e=this.player_.textTrackSettings.getValues(),n=[],i=0;i<t.activeCues.length;i++)n.push(t.activeCues[i]);y.default.WebVTT.processCues(y.default,n,this.el_);for(var r=n.length;r--;){var o=n[r];if(o){var a=o.displayState;if(e.color&&(a.firstChild.style.color=e.color),e.textOpacity&&c(a.firstChild,"color",s(e.color||"#fff",e.textOpacity)),e.backgroundColor&&(a.firstChild.style.backgroundColor=e.backgroundColor),e.backgroundOpacity&&c(a.firstChild,"backgroundColor",s(e.backgroundColor||"#000",e.backgroundOpacity)),e.windowColor&&(e.windowOpacity?c(a,"backgroundColor",s(e.windowColor,e.windowOpacity)):a.style.backgroundColor=e.windowColor),e.edgeStyle&&("dropshadow"===e.edgeStyle?a.firstChild.style.textShadow="2px 2px 3px "+E+", 2px 2px 4px "+E+", 2px 2px 5px "+E:"raised"===e.edgeStyle?a.firstChild.style.textShadow="1px 1px "+E+", 2px 2px "+E+", 3px 3px "+E:"depressed"===e.edgeStyle?a.firstChild.style.textShadow="1px 1px "+_+", 0 1px "+_+", -1px -1px "+E+", 0 -1px "+E:"uniform"===e.edgeStyle&&(a.firstChild.style.textShadow="0 0 4px "+E+", 0 0 4px "+E+", 0 0 4px "+E+", 0 0 4px "+E)),e.fontPercent&&1!==e.fontPercent){var l=y.default.parseFloat(a.style.fontSize);a.style.fontSize=l*e.fontPercent+"px",a.style.height="auto",a.style.top="auto",a.style.bottom="2px"}e.fontFamily&&"default"!==e.fontFamily&&("small-caps"===e.fontFamily?a.firstChild.style.fontVariant="small-caps":a.firstChild.style.fontFamily=T[e.fontFamily])}}}},e}(u.default);u.default.registerComponent("TextTrackDisplay",b),n.default=b,e.exports=n.default},{"../component":67,"../menu/menu-button.js":106,"../menu/menu-item.js":107,"../menu/menu.js":108,"../utils/fn.js":136,"global/document":1,"global/window":2}],126:[function(t,e,n){"use strict";n.__esModule=!0;var i={disabled:"disabled",hidden:"hidden",showing:"showing"},r={subtitles:"subtitles",captions:"captions",descriptions:"descriptions",chapters:"chapters",metadata:"metadata"};n.TextTrackMode=i,n.TextTrackKind=r},{}],127:[function(t,e,n){"use strict";n.__esModule=!0;var i=function(t){var e=["kind","label","language","id","inBandMetadataTrackDispatchType","mode","src"].reduce(function(e,n,i){return t[n]&&(e[n]=t[n]),e},{cues:t.cues&&Array.prototype.map.call(t.cues,function(t){return{startTime:t.startTime,endTime:t.endTime,text:t.text,id:t.id}})});return e},r=function(t){var e=t.$$("track"),n=Array.prototype.map.call(e,function(t){return t.track}),r=Array.prototype.map.call(e,function(t){var e=i(t.track);return t.src&&(e.src=t.src),e});return r.concat(Array.prototype.filter.call(t.textTracks(),function(t){return n.indexOf(t)===-1}).map(i))},o=function(t,e){return t.forEach(function(t){var n=e.addRemoteTextTrack(t).track;!t.src&&t.cues&&t.cues.forEach(function(t){return n.addCue(t)})}),e.textTracks()};n.default={textTracksToJson:r,jsonToTextTracks:o,trackToJson_:i},e.exports=n.default},{}],128:[function(t,e,n){"use strict";function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}n.__esModule=!0;var s=t("../event-target"),c=r(s),l=t("../utils/fn.js"),u=i(l),h=t("../utils/browser.js"),p=i(h),d=t("global/document"),f=r(d),m=function(t){function e(){var n=arguments.length<=0||void 0===arguments[0]?[]:arguments[0];o(this,e),t.call(this);var i=this;if(p.IS_IE8){i=f.default.createElement("custom");for(var r in e.prototype)"constructor"!==r&&(i[r]=e.prototype[r])}i.tracks_=[],Object.defineProperty(i,"length",{get:function(){return this.tracks_.length}});for(var a=0;a<n.length;a++)i.addTrack_(n[a]);if(p.IS_IE8)return i}return a(e,t),e.prototype.addTrack_=function(t){var e=this.tracks_.length;""+e in this||Object.defineProperty(this,e,{get:function(){return this.tracks_[e]}}),t.addEventListener("modechange",u.bind(this,function(){this.trigger("change")})),this.tracks_.indexOf(t)===-1&&(this.tracks_.push(t),this.trigger({track:t,type:"addtrack"}))},e.prototype.removeTrack_=function(t){for(var e=void 0,n=0,i=this.length;n<i;n++)if(this[n]===t){e=this[n],e.off&&e.off(),this.tracks_.splice(n,1);break}e&&this.trigger({track:e,type:"removetrack"})},e.prototype.getTrackById=function(t){for(var e=null,n=0,i=this.length;n<i;n++){var r=this[n];if(r.id===t){e=r;break}}return e},e}(c.default);m.prototype.allowedEvents_={change:"change",addtrack:"addtrack",removetrack:"removetrack"};for(var v in m.prototype.allowedEvents_)m.prototype["on"+v]=null;n.default=m,e.exports=n.default},{"../event-target":101,"../utils/browser.js":131,"../utils/fn.js":136,"global/document":1}],129:[function(t,e,n){"use strict";function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function s(t){var e=void 0;return t.selectedOptions?e=t.selectedOptions[0]:t.options&&(e=t.options[t.options.selectedIndex]),e.value}function c(t,e){if(e){var n=void 0;for(n=0;n<t.options.length;n++){var i=t.options[n];if(i.value===e)break}t.selectedIndex=n}}function l(){var t='<div class="vjs-tracksettings">\n      <div class="vjs-tracksettings-colors">\n        <div class="vjs-fg-color vjs-tracksetting">\n            <label class="vjs-label">Foreground</label>\n            <select>\n              <option value="">---</option>\n              <option value="#FFF">White</option>\n              <option value="#000">Black</option>\n              <option value="#F00">Red</option>\n              <option value="#0F0">Green</option>\n              <option value="#00F">Blue</option>\n              <option value="#FF0">Yellow</option>\n              <option value="#F0F">Magenta</option>\n              <option value="#0FF">Cyan</option>\n            </select>\n            <span class="vjs-text-opacity vjs-opacity">\n              <select>\n                <option value="">---</option>\n                <option value="1">Opaque</option>\n                <option value="0.5">Semi-Opaque</option>\n              </select>\n            </span>\n        </div> <!-- vjs-fg-color -->\n        <div class="vjs-bg-color vjs-tracksetting">\n            <label class="vjs-label">Background</label>\n            <select>\n              <option value="">---</option>\n              <option value="#FFF">White</option>\n              <option value="#000">Black</option>\n              <option value="#F00">Red</option>\n              <option value="#0F0">Green</option>\n              <option value="#00F">Blue</option>\n              <option value="#FF0">Yellow</option>\n              <option value="#F0F">Magenta</option>\n              <option value="#0FF">Cyan</option>\n            </select>\n            <span class="vjs-bg-opacity vjs-opacity">\n                <select>\n                  <option value="">---</option>\n                  <option value="1">Opaque</option>\n                  <option value="0.5">Semi-Transparent</option>\n                  <option value="0">Transparent</option>\n                </select>\n            </span>\n        </div> <!-- vjs-bg-color -->\n        <div class="window-color vjs-tracksetting">\n            <label class="vjs-label">Window</label>\n            <select>\n              <option value="">---</option>\n              <option value="#FFF">White</option>\n              <option value="#000">Black</option>\n              <option value="#F00">Red</option>\n              <option value="#0F0">Green</option>\n              <option value="#00F">Blue</option>\n              <option value="#FF0">Yellow</option>\n              <option value="#F0F">Magenta</option>\n              <option value="#0FF">Cyan</option>\n            </select>\n            <span class="vjs-window-opacity vjs-opacity">\n                <select>\n                  <option value="">---</option>\n                  <option value="1">Opaque</option>\n                  <option value="0.5">Semi-Transparent</option>\n                  <option value="0">Transparent</option>\n                </select>\n            </span>\n        </div> <!-- vjs-window-color -->\n      </div> <!-- vjs-tracksettings -->\n      <div class="vjs-tracksettings-font">\n        <div class="vjs-font-percent vjs-tracksetting">\n          <label class="vjs-label">Font Size</label>\n          <select>\n            <option value="0.50">50%</option>\n            <option value="0.75">75%</option>\n            <option value="1.00" selected>100%</option>\n            <option value="1.25">125%</option>\n            <option value="1.50">150%</option>\n            <option value="1.75">175%</option>\n            <option value="2.00">200%</option>\n            <option value="3.00">300%</option>\n            <option value="4.00">400%</option>\n          </select>\n        </div> <!-- vjs-font-percent -->\n        <div class="vjs-edge-style vjs-tracksetting">\n          <label class="vjs-label">Text Edge Style</label>\n          <select>\n            <option value="none">None</option>\n            <option value="raised">Raised</option>\n            <option value="depressed">Depressed</option>\n            <option value="uniform">Uniform</option>\n            <option value="dropshadow">Dropshadow</option>\n          </select>\n        </div> <!-- vjs-edge-style -->\n        <div class="vjs-font-family vjs-tracksetting">\n          <label class="vjs-label">Font Family</label>\n          <select>\n            <option value="">Default</option>\n            <option value="monospaceSerif">Monospace Serif</option>\n            <option value="proportionalSerif">Proportional Serif</option>\n            <option value="monospaceSansSerif">Monospace Sans-Serif</option>\n            <option value="proportionalSansSerif">Proportional Sans-Serif</option>\n            <option value="casual">Casual</option>\n            <option value="script">Script</option>\n            <option value="small-caps">Small Caps</option>\n          </select>\n        </div> <!-- vjs-font-family -->\n      </div>\n    </div>\n    <div class="vjs-tracksettings-controls">\n      <button class="vjs-default-button">Defaults</button>\n      <button class="vjs-done-button">Done</button>\n    </div>';return t}n.__esModule=!0;var u=t("../component"),h=r(u),p=t("../utils/events.js"),d=i(p),f=t("../utils/fn.js"),m=i(f),v=t("../utils/log.js"),g=r(v),y=t("safe-json-parse/tuple"),E=r(y),_=t("global/window"),T=r(_),b=function(t){function e(n,i){o(this,e),t.call(this,n,i),this.hide(),void 0===i.persistTextTrackSettings&&(this.options_.persistTextTrackSettings=this.options_.playerOptions.persistTextTrackSettings),d.on(this.$(".vjs-done-button"),"click",m.bind(this,function(){this.saveSettings(),this.hide()})),d.on(this.$(".vjs-default-button"),"click",m.bind(this,function(){this.$(".vjs-fg-color > select").selectedIndex=0,this.$(".vjs-bg-color > select").selectedIndex=0,this.$(".window-color > select").selectedIndex=0,this.$(".vjs-text-opacity > select").selectedIndex=0,this.$(".vjs-bg-opacity > select").selectedIndex=0,this.$(".vjs-window-opacity > select").selectedIndex=0,this.$(".vjs-edge-style select").selectedIndex=0,this.$(".vjs-font-family select").selectedIndex=0,this.$(".vjs-font-percent select").selectedIndex=2,this.updateDisplay()})),d.on(this.$(".vjs-fg-color > select"),"change",m.bind(this,this.updateDisplay)),d.on(this.$(".vjs-bg-color > select"),"change",m.bind(this,this.updateDisplay)),d.on(this.$(".window-color > select"),"change",m.bind(this,this.updateDisplay)),d.on(this.$(".vjs-text-opacity > select"),"change",m.bind(this,this.updateDisplay)),d.on(this.$(".vjs-bg-opacity > select"),"change",m.bind(this,this.updateDisplay)),d.on(this.$(".vjs-window-opacity > select"),"change",m.bind(this,this.updateDisplay)),d.on(this.$(".vjs-font-percent select"),"change",m.bind(this,this.updateDisplay)),d.on(this.$(".vjs-edge-style select"),"change",m.bind(this,this.updateDisplay)),d.on(this.$(".vjs-font-family select"),"change",m.bind(this,this.updateDisplay)),this.options_.persistTextTrackSettings&&this.restoreSettings()}return a(e,t),e.prototype.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-caption-settings vjs-modal-overlay",innerHTML:l()})},e.prototype.getValues=function(){var t=s(this.$(".vjs-edge-style select")),e=s(this.$(".vjs-font-family select")),n=s(this.$(".vjs-fg-color > select")),i=s(this.$(".vjs-text-opacity > select")),r=s(this.$(".vjs-bg-color > select")),o=s(this.$(".vjs-bg-opacity > select")),a=s(this.$(".window-color > select")),c=s(this.$(".vjs-window-opacity > select")),l=T.default.parseFloat(s(this.$(".vjs-font-percent > select"))),u={backgroundOpacity:o,textOpacity:i,windowOpacity:c,edgeStyle:t,fontFamily:e,color:n,backgroundColor:r,windowColor:a,fontPercent:l};for(var h in u)(""===u[h]||"none"===u[h]||"fontPercent"===h&&1===u[h])&&delete u[h];return u},e.prototype.setValues=function(t){c(this.$(".vjs-edge-style select"),t.edgeStyle),c(this.$(".vjs-font-family select"),t.fontFamily),c(this.$(".vjs-fg-color > select"),t.color),c(this.$(".vjs-text-opacity > select"),t.textOpacity),c(this.$(".vjs-bg-color > select"),t.backgroundColor),c(this.$(".vjs-bg-opacity > select"),t.backgroundOpacity),c(this.$(".window-color > select"),t.windowColor),c(this.$(".vjs-window-opacity > select"),t.windowOpacity);var e=t.fontPercent;e&&(e=e.toFixed(2)),c(this.$(".vjs-font-percent > select"),e)},e.prototype.restoreSettings=function(){var t=void 0,e=void 0;try{var n=E.default(T.default.localStorage.getItem("vjs-text-track-settings"));t=n[0],e=n[1],t&&g.default.error(t)}catch(t){g.default.warn(t)}e&&this.setValues(e)},e.prototype.saveSettings=function(){if(this.options_.persistTextTrackSettings){var t=this.getValues();try{Object.getOwnPropertyNames(t).length>0?T.default.localStorage.setItem("vjs-text-track-settings",JSON.stringify(t)):T.default.localStorage.removeItem("vjs-text-track-settings")}catch(t){g.default.warn(t)}}},e.prototype.updateDisplay=function(){var t=this.player_.getChild("textTrackDisplay");t&&t.updateDisplay()},e}(h.default);h.default.registerComponent("TextTrackSettings",b),n.default=b,e.exports=n.default},{"../component":67,"../utils/events.js":135,"../utils/fn.js":136,"../utils/log.js":139,"global/window":2,"safe-json-parse/tuple":54}],130:[function(t,e,n){"use strict";function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}n.__esModule=!0;var s=t("./text-track-cue-list"),c=r(s),l=t("../utils/fn.js"),u=i(l),h=t("../utils/guid.js"),p=i(h),d=t("../utils/browser.js"),f=i(d),m=t("./text-track-enums"),v=i(m),g=t("../utils/log.js"),y=r(g),E=t("../event-target"),_=r(E),T=t("global/document"),b=r(T),w=t("global/window"),R=r(w),x=t("../utils/url.js"),H=t("xhr"),M=r(H),S=function(t,e){var n=new R.default.WebVTT.Parser(R.default,R.default.vttjs,R.default.WebVTT.StringDecoder()),i=[];n.oncue=function(t){e.addCue(t)},n.onparsingerror=function(t){i.push(t)},n.onflush=function(){e.trigger({type:"loadeddata",target:e})},n.parse(t),i.length>0&&(console.groupCollapsed&&console.groupCollapsed("Text Track parsing errors for "+e.src),i.forEach(function(t){return y.default.error(t)}),console.groupEnd&&console.groupEnd()),n.flush()},C=function(t,e){var n={uri:t},i=x.isCrossOrigin(t);i&&(n.cors=i),M.default(n,u.bind(this,function(t,n,i){return t?y.default.error(t,n):(e.loaded_=!0,void("function"!=typeof R.default.WebVTT?e.tech_&&!function(){var t=function(){return S(i,e)};e.tech_.on("vttjsloaded",t),e.tech_.on("vttjserror",function(){y.default.error("vttjs failed to load, stopping trying to process "+e.src),e.tech_.off("vttjsloaded",t)})}():S(i,e)))}))},A=function(t){function e(){var n=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];if(o(this,e),t.call(this),!n.tech)throw new Error("A tech was not provided.");var i=this;if(f.IS_IE8){i=b.default.createElement("custom");for(var r in e.prototype)"constructor"!==r&&(i[r]=e.prototype[r])}i.tech_=n.tech;var a=v.TextTrackMode[n.mode]||"disabled",s=v.TextTrackKind[n.kind]||"subtitles",l=n.default,h=n.label||"",d=n.language||n.srclang||"",m=n.id||"vjs_text_track_"+p.newGUID();"metadata"!==s&&"chapters"!==s||(a="hidden"),i.cues_=[],i.activeCues_=[];var g=new c.default(i.cues_),y=new c.default(i.activeCues_),E=!1,_=u.bind(i,function(){this.activeCues,E&&(this.trigger("cuechange"),E=!1)});if("disabled"!==a&&i.tech_.on("timeupdate",_),Object.defineProperty(i,"kind",{get:function(){return s;
},set:function(){}}),Object.defineProperty(i,"label",{get:function(){return h},set:function(){}}),Object.defineProperty(i,"language",{get:function(){return d},set:function(){}}),Object.defineProperty(i,"id",{get:function(){return m},set:function(){}}),Object.defineProperty(i,"default",{get:function(){return l},set:function(){}}),Object.defineProperty(i,"mode",{get:function(){return a},set:function(t){v.TextTrackMode[t]&&(a=t,"showing"===a&&this.tech_.on("timeupdate",_),this.trigger("modechange"))}}),Object.defineProperty(i,"cues",{get:function(){return this.loaded_?g:null},set:function(){}}),Object.defineProperty(i,"activeCues",{get:function(){if(!this.loaded_)return null;if(0===this.cues.length)return y;for(var t=this.tech_.currentTime(),e=[],n=0,i=this.cues.length;n<i;n++){var r=this.cues[n];r.startTime<=t&&r.endTime>=t?e.push(r):r.startTime===r.endTime&&r.startTime<=t&&r.startTime+.5>=t&&e.push(r)}if(E=!1,e.length!==this.activeCues_.length)E=!0;else for(var n=0;n<e.length;n++)this.activeCues_.indexOf(e[n])===-1&&(E=!0);return this.activeCues_=e,y.setCues_(this.activeCues_),y},set:function(){}}),n.src?(i.src=n.src,C(n.src,i)):i.loaded_=!0,f.IS_IE8)return i}return a(e,t),e.prototype.addCue=function(t){var e=this.tech_.textTracks();if(e)for(var n=0;n<e.length;n++)e[n]!==this&&e[n].removeCue(t);this.cues_.push(t),this.cues.setCues_(this.cues_)},e.prototype.removeCue=function(t){for(var e=!1,n=0,i=this.cues_.length;n<i;n++){var r=this.cues_[n];r===t&&(this.cues_.splice(n,1),e=!0)}e&&this.cues.setCues_(this.cues_)},e}(_.default);A.prototype.allowedEvents_={cuechange:"cuechange"},n.default=A,e.exports=n.default},{"../event-target":101,"../utils/browser.js":131,"../utils/fn.js":136,"../utils/guid.js":138,"../utils/log.js":139,"../utils/url.js":144,"./text-track-cue-list":124,"./text-track-enums":126,"global/document":1,"global/window":2,xhr:56}],131:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}n.__esModule=!0;var r=t("global/document"),o=i(r),a=t("global/window"),s=i(a),c=s.default.navigator.userAgent,l=/AppleWebKit\/([\d.]+)/i.exec(c),u=l?parseFloat(l.pop()):null,h=/iPad/i.test(c);n.IS_IPAD=h;var p=/iPhone/i.test(c)&&!h;n.IS_IPHONE=p;var d=/iPod/i.test(c);n.IS_IPOD=d;var f=p||h||d;n.IS_IOS=f;var m=function(){var t=c.match(/OS (\d+)_/i);if(t&&t[1])return t[1]}();n.IOS_VERSION=m;var v=/Android/i.test(c);n.IS_ANDROID=v;var g=function(){var t,e,n=c.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i);return n?(t=n[1]&&parseFloat(n[1]),e=n[2]&&parseFloat(n[2]),t&&e?parseFloat(n[1]+"."+n[2]):t?t:null):null}();n.ANDROID_VERSION=g;var y=v&&/webkit/i.test(c)&&g<2.3;n.IS_OLD_ANDROID=y;var E=v&&g<5&&u<537;n.IS_NATIVE_ANDROID=E;var _=/Firefox/i.test(c);n.IS_FIREFOX=_;var T=/Edge/i.test(c);n.IS_EDGE=T;var b=!T&&/Chrome/i.test(c);n.IS_CHROME=b;var w=/MSIE\s8\.0/.test(c);n.IS_IE8=w;var R=!!("ontouchstart"in s.default||s.default.DocumentTouch&&o.default instanceof s.default.DocumentTouch);n.TOUCH_ENABLED=R;var x="backgroundSize"in o.default.createElement("video").style;n.BACKGROUND_SIZE_SUPPORTED=x},{"global/document":1,"global/window":2}],132:[function(t,e,n){"use strict";function i(t,e){var n,i,o=0;if(!e)return 0;t&&t.length||(t=r.createTimeRange(0,0));for(var a=0;a<t.length;a++)n=t.start(a),i=t.end(a),i>e&&(i=e),o+=i-n;return o/e}n.__esModule=!0,n.bufferedPercent=i;var r=t("./time-ranges.js")},{"./time-ranges.js":142}],133:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}n.__esModule=!0;var r=t("./log.js"),o=i(r),a={get:function(t,e){return t[e]},set:function(t,e,n){return t[e]=n,!0}};n.default=function(t){var e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];if("function"==typeof Proxy){var n=function(){var n={};return Object.keys(e).forEach(function(t){a.hasOwnProperty(t)&&(n[t]=function(){return o.default.warn(e[t]),a[t].apply(this,arguments)})}),{v:new Proxy(t,n)}}();if("object"==typeof n)return n.v}return t},e.exports=n.default},{"./log.js":139}],134:[function(t,e,n){"use strict";function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e){return t.raw=e,t}function a(t){return"string"==typeof t&&/\S/.test(t)}function s(t){if(/\s/.test(t))throw new Error("class has illegal whitespace characters")}function c(t){return new RegExp("(^|\\s)"+t+"($|\\s)")}function l(t){return function(e,n){return a(e)?(a(n)&&(n=k.default.querySelector(n)),(M(n)?n:k.default)[t](e)):k.default[t](null)}}function u(t){return 0===t.indexOf("#")&&(t=t.slice(1)),k.default.getElementById(t)}function h(){var t=arguments.length<=0||void 0===arguments[0]?"div":arguments[0],e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],i=k.default.createElement(t);return Object.getOwnPropertyNames(e).forEach(function(t){var n=e[t];t.indexOf("aria-")!==-1||"role"===t||"type"===t?(F.default.warn(G.default(O,t,n)),i.setAttribute(t,n)):i[t]=n}),Object.getOwnPropertyNames(n).forEach(function(t){n[t];i.setAttribute(t,n[t])}),i}function p(t,e){"undefined"==typeof t.textContent?t.innerText=e:t.textContent=e}function d(t,e){e.firstChild?e.insertBefore(t,e.firstChild):e.appendChild(t)}function f(t){var e=t[W];return e||(e=t[W]=U.newGUID()),z[e]||(z[e]={}),z[e]}function m(t){var e=t[W];return!!e&&!!Object.getOwnPropertyNames(z[e]).length}function v(t){var e=t[W];if(e){delete z[e];try{delete t[W]}catch(e){t.removeAttribute?t.removeAttribute(W):t[W]=null}}}function g(t,e){return t.classList?t.classList.contains(e):(s(e),c(e).test(t.className))}function y(t,e){return t.classList?t.classList.add(e):g(t,e)||(t.className=(t.className+" "+e).trim()),t}function E(t,e){return t.classList?t.classList.remove(e):(s(e),t.className=t.className.split(/\s+/).filter(function(t){return t!==e}).join(" ")),t}function _(t,e,n){var i=g(t,e);if("function"==typeof n&&(n=n(t,e)),"boolean"!=typeof n&&(n=!i),n!==i)return n?y(t,e):E(t,e),t}function T(t,e){Object.getOwnPropertyNames(e).forEach(function(n){var i=e[n];null===i||"undefined"==typeof i||i===!1?t.removeAttribute(n):t.setAttribute(n,i===!0?"":i)})}function b(t){var e,n,i,r,o;if(e={},n=",autoplay,controls,loop,muted,default,",t&&t.attributes&&t.attributes.length>0){i=t.attributes;for(var a=i.length-1;a>=0;a--)r=i[a].name,o=i[a].value,"boolean"!=typeof t[r]&&n.indexOf(","+r+",")===-1||(o=null!==o),e[r]=o}return e}function w(){k.default.body.focus(),k.default.onselectstart=function(){return!1}}function R(){k.default.onselectstart=function(){return!0}}function x(t){var e=void 0;if(t.getBoundingClientRect&&t.parentNode&&(e=t.getBoundingClientRect()),!e)return{left:0,top:0};var n=k.default.documentElement,i=k.default.body,r=n.clientLeft||i.clientLeft||0,o=D.default.pageXOffset||i.scrollLeft,a=e.left+o-r,s=n.clientTop||i.clientTop||0,c=D.default.pageYOffset||i.scrollTop,l=e.top+c-s;return{left:Math.round(a),top:Math.round(l)}}function H(t,e){var n={},i=x(t),r=t.offsetWidth,o=t.offsetHeight,a=i.top,s=i.left,c=e.pageY,l=e.pageX;return e.changedTouches&&(l=e.changedTouches[0].pageX,c=e.changedTouches[0].pageY),n.y=Math.max(0,Math.min(1,(a-c+o)/o)),n.x=Math.max(0,Math.min(1,(l-s)/r)),n}function M(t){return!!t&&"object"==typeof t&&1===t.nodeType}function S(t){return!!t&&"object"==typeof t&&3===t.nodeType}function C(t){for(;t.firstChild;)t.removeChild(t.firstChild);return t}function A(t){return"function"==typeof t&&(t=t()),(Array.isArray(t)?t:[t]).map(function(t){return"function"==typeof t&&(t=t()),M(t)||S(t)?t:"string"==typeof t&&/\S/.test(t)?k.default.createTextNode(t):void 0}).filter(function(t){return t})}function P(t,e){return A(e).forEach(function(e){return t.appendChild(e)}),t}function L(t,e){return P(C(t),e)}n.__esModule=!0,n.getEl=u,n.createEl=h,n.textContent=p,n.insertElFirst=d,n.getElData=f,n.hasElData=m,n.removeElData=v,n.hasElClass=g,n.addElClass=y,n.removeElClass=E,n.toggleElClass=_,n.setElAttributes=T,n.getElAttributes=b,n.blockTextSelection=w,n.unblockTextSelection=R,n.findElPosition=x,n.getPointerPosition=H,n.isEl=M,n.isTextNode=S,n.emptyEl=C,n.normalizeContent=A,n.appendContent=P,n.insertContent=L;var O=o(["Setting attributes in the second argument of createEl()\n                has been deprecated. Use the third argument instead.\n                createEl(type, properties, attributes). Attempting to set "," to ","."],["Setting attributes in the second argument of createEl()\n                has been deprecated. Use the third argument instead.\n                createEl(type, properties, attributes). Attempting to set "," to ","."]),j=t("global/document"),k=r(j),I=t("global/window"),D=r(I),B=t("./guid.js"),U=i(B),N=t("./log.js"),F=r(N),V=t("tsml"),G=r(V),z={},W="vdata"+(new Date).getTime(),X=l("querySelector");n.$=X;var q=l("querySelectorAll");n.$$=q},{"./guid.js":138,"./log.js":139,"global/document":1,"global/window":2,tsml:55}],135:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function o(t,e,n){if(Array.isArray(e))return h(o,t,e,n);var i=d.getElData(t);i.handlers||(i.handlers={}),i.handlers[e]||(i.handlers[e]=[]),n.guid||(n.guid=m.newGUID()),i.handlers[e].push(n),i.dispatcher||(i.disabled=!1,i.dispatcher=function(e,n){if(!i.disabled){e=l(e);var r=i.handlers[e.type];if(r)for(var o=r.slice(0),a=0,s=o.length;a<s&&!e.isImmediatePropagationStopped();a++)o[a].call(t,e,n)}}),1===i.handlers[e].length&&(t.addEventListener?t.addEventListener(e,i.dispatcher,!1):t.attachEvent&&t.attachEvent("on"+e,i.dispatcher))}function a(t,e,n){if(d.hasElData(t)){var i=d.getElData(t);if(i.handlers){if(Array.isArray(e))return h(a,t,e,n);var r=function(e){i.handlers[e]=[],u(t,e)};if(e){var o=i.handlers[e];if(o){if(!n)return void r(e);if(n.guid)for(var s=0;s<o.length;s++)o[s].guid===n.guid&&o.splice(s--,1);u(t,e)}}else for(var c in i.handlers)r(c)}}}function s(t,e,n){var i=d.hasElData(t)?d.getElData(t):{},r=t.parentNode||t.ownerDocument;if("string"==typeof e&&(e={type:e,target:t}),e=l(e),i.dispatcher&&i.dispatcher.call(t,e,n),r&&!e.isPropagationStopped()&&e.bubbles===!0)s.call(null,r,e,n);else if(!r&&!e.defaultPrevented){var o=d.getElData(e.target);e.target[e.type]&&(o.disabled=!0,"function"==typeof e.target[e.type]&&e.target[e.type](),o.disabled=!1)}return!e.defaultPrevented}function c(t,e,n){if(Array.isArray(e))return h(c,t,e,n);var i=function i(){a(t,e,i),n.apply(this,arguments)};i.guid=n.guid=n.guid||m.newGUID(),o(t,e,i)}function l(t){function e(){return!0}function n(){return!1}if(!t||!t.isPropagationStopped){var i=t||g.default.event;t={};for(var r in i)"layerX"!==r&&"layerY"!==r&&"keyLocation"!==r&&"webkitMovementX"!==r&&"webkitMovementY"!==r&&("returnValue"===r&&i.preventDefault||(t[r]=i[r]));if(t.target||(t.target=t.srcElement||E.default),t.relatedTarget||(t.relatedTarget=t.fromElement===t.target?t.toElement:t.fromElement),t.preventDefault=function(){i.preventDefault&&i.preventDefault(),t.returnValue=!1,i.returnValue=!1,t.defaultPrevented=!0},t.defaultPrevented=!1,t.stopPropagation=function(){i.stopPropagation&&i.stopPropagation(),t.cancelBubble=!0,i.cancelBubble=!0,t.isPropagationStopped=e},t.isPropagationStopped=n,t.stopImmediatePropagation=function(){i.stopImmediatePropagation&&i.stopImmediatePropagation(),t.isImmediatePropagationStopped=e,t.stopPropagation()},t.isImmediatePropagationStopped=n,null!=t.clientX){var o=E.default.documentElement,a=E.default.body;t.pageX=t.clientX+(o&&o.scrollLeft||a&&a.scrollLeft||0)-(o&&o.clientLeft||a&&a.clientLeft||0),t.pageY=t.clientY+(o&&o.scrollTop||a&&a.scrollTop||0)-(o&&o.clientTop||a&&a.clientTop||0)}t.which=t.charCode||t.keyCode,null!=t.button&&(t.button=1&t.button?0:4&t.button?1:2&t.button?2:0)}return t}function u(t,e){var n=d.getElData(t);0===n.handlers[e].length&&(delete n.handlers[e],t.removeEventListener?t.removeEventListener(e,n.dispatcher,!1):t.detachEvent&&t.detachEvent("on"+e,n.dispatcher)),Object.getOwnPropertyNames(n.handlers).length<=0&&(delete n.handlers,delete n.dispatcher,delete n.disabled),0===Object.getOwnPropertyNames(n).length&&d.removeElData(t)}function h(t,e,n,i){n.forEach(function(n){t(e,n,i)})}n.__esModule=!0,n.on=o,n.off=a,n.trigger=s,n.one=c,n.fixEvent=l;var p=t("./dom.js"),d=r(p),f=t("./guid.js"),m=r(f),v=t("global/window"),g=i(v),y=t("global/document"),E=i(y)},{"./dom.js":134,"./guid.js":138,"global/document":1,"global/window":2}],136:[function(t,e,n){"use strict";n.__esModule=!0;var i=t("./guid.js"),r=function(t,e,n){e.guid||(e.guid=i.newGUID());var r=function(){return e.apply(t,arguments)};return r.guid=n?n+"_"+e.guid:e.guid,r};n.bind=r},{"./guid.js":138}],137:[function(t,e,n){"use strict";function i(t){var e=arguments.length<=1||void 0===arguments[1]?t:arguments[1];return function(){t=t<0?0:t;var n=Math.floor(t%60),i=Math.floor(t/60%60),r=Math.floor(t/3600),o=Math.floor(e/60%60),a=Math.floor(e/3600);return(isNaN(t)||t===1/0)&&(r=i=n="-"),r=r>0||a>0?r+":":"",i=((r||o>=10)&&i<10?"0"+i:i)+":",n=n<10?"0"+n:n,r+i+n}()}n.__esModule=!0,n.default=i,e.exports=n.default},{}],138:[function(t,e,n){"use strict";function i(){return r++}n.__esModule=!0,n.newGUID=i;var r=1},{}],139:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){var n=Array.prototype.slice.call(e),i=function(){},r=a.default.console||{log:i,warn:i,error:i};t?n.unshift(t.toUpperCase()+":"):t="log",s.history.push(n),n.unshift("VIDEOJS:"),r[t].apply?r[t].apply(r,n):r[t](n.join(" "))}n.__esModule=!0;var o=t("global/window"),a=i(o),s=function(){r(null,arguments)};s.history=[],s.error=function(){r("error",arguments)},s.warn=function(){r("warn",arguments)},n.default=s,e.exports=n.default},{"global/window":2}],140:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t){return!!t&&"object"==typeof t&&"[object Object]"===t.toString()&&t.constructor===Object}function o(){var t=Array.prototype.slice.call(arguments);return t.unshift({}),t.push(c),s.default.apply(null,t),t[0]}n.__esModule=!0,n.default=o;var a=t("lodash-compat/object/merge"),s=i(a),c=function(t,e){return r(e)?r(t)?void 0:o(e):e};e.exports=n.default},{"lodash-compat/object/merge":40}],141:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}n.__esModule=!0;var r=t("global/document"),o=i(r),a=function(t){var e=o.default.createElement("style");return e.className=t,e};n.createStyleElement=a;var s=function(t,e){t.styleSheet?t.styleSheet.cssText=e:t.textContent=e};n.setTextContent=s},{"global/document":1}],142:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){return Array.isArray(t)?o(t):void 0===t||void 0===e?o():o([[t,e]])}function o(t){return void 0===t||0===t.length?{length:0,start:function(){throw new Error("This TimeRanges object is empty")},end:function(){throw new Error("This TimeRanges object is empty")}}:{length:t.length,start:a.bind(null,"start",0,t),end:a.bind(null,"end",1,t)}}function a(t,e,n,i){return void 0===i&&(l.default.warn("DEPRECATED: Function '"+t+"' on 'TimeRanges' called without an index argument."),i=0),s(t,i,n.length-1),n[i][e]}function s(t,e,n){if(e<0||e>n)throw new Error("Failed to execute '"+t+"' on 'TimeRanges': The index provided ("+e+") is greater than or equal to the maximum bound ("+n+").")}n.__esModule=!0,n.createTimeRanges=r;var c=t("./log.js"),l=i(c);n.createTimeRange=r},{"./log.js":139}],143:[function(t,e,n){"use strict";function i(t){return t.charAt(0).toUpperCase()+t.slice(1)}n.__esModule=!0,n.default=i,e.exports=n.default},{}],144:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}n.__esModule=!0;var r=t("global/document"),o=i(r),a=t("global/window"),s=i(a),c=function(t){var e=["protocol","hostname","port","pathname","search","hash","host"],n=o.default.createElement("a");n.href=t;var i=""===n.host&&"file:"!==n.protocol,r=void 0;i&&(r=o.default.createElement("div"),r.innerHTML='<a href="'+t+'"></a>',n=r.firstChild,r.setAttribute("style","display:none; position:absolute;"),o.default.body.appendChild(r));for(var a={},s=0;s<e.length;s++)a[e[s]]=n[e[s]];return"http:"===a.protocol&&(a.host=a.host.replace(/:80$/,"")),"https:"===a.protocol&&(a.host=a.host.replace(/:443$/,"")),i&&o.default.body.removeChild(r),a};n.parseUrl=c;var l=function(t){if(!t.match(/^https?:\/\//)){var e=o.default.createElement("div");e.innerHTML='<a href="'+t+'">x</a>',t=e.firstChild.href}return t};n.getAbsoluteURL=l;var u=function(t){if("string"==typeof t){var e=/^(\/?)([\s\S]*?)((?:\.{1,2}|[^\/]+?)(\.([^\.\/\?]+)))(?:[\/]*|[\?].*)$/i,n=e.exec(t);if(n)return n.pop().toLowerCase()}return""};n.getFileExtension=u;var h=function(t){var e=s.default.location,n=c(t),i=":"===n.protocol?e.protocol:n.protocol,r=i+n.host!==e.protocol+e.host;return r};n.isCrossOrigin=h},{"global/document":1,"global/window":2}],145:[function(e,n,i){"use strict";function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function o(t){return t&&t.__esModule?t:{default:t}}i.__esModule=!0;var a=e("global/window"),s=o(a),c=e("global/document"),l=o(c),u=e("./setup"),h=r(u),p=e("./utils/stylesheet.js"),d=r(p),f=e("./component"),m=o(f),v=e("./event-target"),g=o(v),y=e("./utils/events.js"),E=r(y),_=e("./player"),T=o(_),b=e("./plugins.js"),w=o(b),R=e("../../src/js/utils/merge-options.js"),x=o(R),H=e("./utils/fn.js"),M=r(H),S=e("./tracks/text-track.js"),C=o(S),A=e("object.assign"),P=(o(A),e("./utils/time-ranges.js")),L=e("./utils/format-time.js"),O=o(L),j=e("./utils/log.js"),k=o(j),I=e("./utils/dom.js"),D=r(I),B=e("./utils/browser.js"),U=r(B),N=e("./utils/url.js"),F=r(N),V=e("./extend.js"),G=o(V),z=e("lodash-compat/object/merge"),W=o(z),X=e("./utils/create-deprecation-proxy.js"),q=o(X),Y=e("xhr"),Z=o(Y),K=e("./tech/tech.js"),Q=o(K),$=e("./tech/html5.js"),J=(o($),e("./tech/flash.js"));o(J);"undefined"==typeof HTMLVideoElement&&(l.default.createElement("video"),l.default.createElement("audio"),l.default.createElement("track"));var tt=function t(e,n,i){var r=void 0;if("string"==typeof e){if(0===e.indexOf("#")&&(e=e.slice(1)),t.getPlayers()[e])return n&&k.default.warn('Player "'+e+'" is already initialised. Options will not be applied.'),i&&t.getPlayers()[e].ready(i),t.getPlayers()[e];r=D.getEl(e)}else r=e;if(!r||!r.nodeName)throw new TypeError("The element or ID supplied is not valid. (videojs)");return r.player||T.default.players[r.playerId]||new T.default(r,n,i)};if(s.default.VIDEOJS_NO_DYNAMIC_STYLE!==!0){var et=D.$(".vjs-styles-defaults");if(!et){et=d.createStyleElement("vjs-styles-defaults");var nt=D.$("head");nt.insertBefore(et,nt.firstChild),d.setTextContent(et,"\n      .video-js {\n        width: 300px;\n        height: 150px;\n      }\n\n      .vjs-fluid {\n        padding-top: 56.25%\n      }\n    ")}}h.autoSetupTimeout(1,tt),tt.VERSION="5.9.2",tt.options=T.default.prototype.options_,tt.getPlayers=function(){return T.default.players},tt.players=q.default(T.default.players,{get:"Access to videojs.players is deprecated; use videojs.getPlayers instead",set:"Modification of videojs.players is deprecated"}),tt.getComponent=m.default.getComponent,tt.registerComponent=function(t,e){Q.default.isTech(e)&&k.default.warn("The "+t+" tech was registered as a component. It should instead be registered using videojs.registerTech(name, tech)"),m.default.registerComponent.call(m.default,t,e)},tt.getTech=Q.default.getTech,tt.registerTech=Q.default.registerTech,tt.browser=U,tt.TOUCH_ENABLED=U.TOUCH_ENABLED,tt.extend=G.default,tt.mergeOptions=x.default,tt.bind=M.bind,tt.plugin=w.default,tt.addLanguage=function(t,e){var n;return t=(""+t).toLowerCase(),W.default(tt.options.languages,(n={},n[t]=e,n))[t]},tt.log=k.default,tt.createTimeRange=tt.createTimeRanges=P.createTimeRanges,tt.formatTime=O.default,tt.parseUrl=F.parseUrl,tt.isCrossOrigin=F.isCrossOrigin,tt.EventTarget=g.default,tt.on=E.on,tt.one=E.one,tt.off=E.off,tt.trigger=E.trigger,tt.xhr=Z.default,tt.TextTrack=C.default,tt.isEl=D.isEl,tt.isTextNode=D.isTextNode,tt.createEl=D.createEl,tt.hasClass=D.hasElClass,tt.addClass=D.addElClass,tt.removeClass=D.removeElClass,tt.toggleClass=D.toggleElClass,tt.setAttributes=D.setElAttributes,tt.getAttributes=D.getElAttributes,tt.emptyEl=D.emptyEl,tt.appendContent=D.appendContent,tt.insertContent=D.insertContent,"function"==typeof t&&t.amd?t("videojs",[],function(){return tt}):"object"==typeof i&&"object"==typeof n&&(n.exports=tt),i.default=tt,n.exports=i.default},{"../../src/js/utils/merge-options.js":140,"./component":67,"./event-target":101,"./extend.js":102,"./player":110,"./plugins.js":111,"./setup":115,"./tech/flash.js":118,"./tech/html5.js":119,"./tech/tech.js":121,"./tracks/text-track.js":130,"./utils/browser.js":131,"./utils/create-deprecation-proxy.js":133,"./utils/dom.js":134,"./utils/events.js":135,"./utils/fn.js":136,"./utils/format-time.js":137,"./utils/log.js":139,"./utils/stylesheet.js":141,"./utils/time-ranges.js":142,"./utils/url.js":144,"global/document":1,"global/window":2,"lodash-compat/object/merge":40,"object.assign":45,xhr:56}]},{},[145])(145)}),function(t){var e=t.vttjs={},n=e.VTTCue,i=e.VTTRegion,r=t.VTTCue,o=t.VTTRegion;e.shim=function(){e.VTTCue=n,e.VTTRegion=i},e.restore=function(){e.VTTCue=r,e.VTTRegion=o}}(this),function(t,e){function n(t){if("string"!=typeof t)return!1;var e=s[t.toLowerCase()];return!!e&&t.toLowerCase()}function i(t){if("string"!=typeof t)return!1;var e=c[t.toLowerCase()];return!!e&&t.toLowerCase()}function r(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)t[i]=n[i]}return t}function o(t,e,o){var s=this,c=/MSIE\s8\.0/.test(navigator.userAgent),l={};c?s=document.createElement("custom"):l.enumerable=!0,s.hasBeenReset=!1;var u="",h=!1,p=t,d=e,f=o,m=null,v="",g=!0,y="auto",E="start",_=50,T="middle",b=50,w="middle";if(Object.defineProperty(s,"id",r({},l,{get:function(){return u},set:function(t){u=""+t}})),Object.defineProperty(s,"pauseOnExit",r({},l,{get:function(){return h},set:function(t){h=!!t}})),Object.defineProperty(s,"startTime",r({},l,{get:function(){return p},set:function(t){if("number"!=typeof t)throw new TypeError("Start time must be set to a number.");p=t,this.hasBeenReset=!0}})),Object.defineProperty(s,"endTime",r({},l,{get:function(){return d},set:function(t){if("number"!=typeof t)throw new TypeError("End time must be set to a number.");d=t,this.hasBeenReset=!0}})),Object.defineProperty(s,"text",r({},l,{get:function(){return f},set:function(t){f=""+t,this.hasBeenReset=!0}})),Object.defineProperty(s,"region",r({},l,{get:function(){return m},set:function(t){m=t,this.hasBeenReset=!0}})),Object.defineProperty(s,"vertical",r({},l,{get:function(){return v},set:function(t){var e=n(t);if(e===!1)throw new SyntaxError("An invalid or illegal string was specified.");v=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"snapToLines",r({},l,{get:function(){return g},set:function(t){g=!!t,this.hasBeenReset=!0}})),Object.defineProperty(s,"line",r({},l,{get:function(){return y},set:function(t){if("number"!=typeof t&&t!==a)throw new SyntaxError("An invalid number or illegal string was specified.");y=t,this.hasBeenReset=!0}})),Object.defineProperty(s,"lineAlign",r({},l,{get:function(){return E},set:function(t){var e=i(t);if(!e)throw new SyntaxError("An invalid or illegal string was specified.");E=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"position",r({},l,{get:function(){return _},set:function(t){if(t<0||t>100)throw new Error("Position must be between 0 and 100.");_=t,this.hasBeenReset=!0}})),Object.defineProperty(s,"positionAlign",r({},l,{get:function(){return T},set:function(t){var e=i(t);if(!e)throw new SyntaxError("An invalid or illegal string was specified.");T=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"size",r({},l,{get:function(){return b},set:function(t){if(t<0||t>100)throw new Error("Size must be between 0 and 100.");b=t,this.hasBeenReset=!0}})),Object.defineProperty(s,"align",r({},l,{get:function(){return w},set:function(t){var e=i(t);if(!e)throw new SyntaxError("An invalid or illegal string was specified.");w=e,this.hasBeenReset=!0}})),s.displayState=void 0,c)return s}var a="auto",s={"":!0,lr:!0,rl:!0},c={start:!0,middle:!0,end:!0,left:!0,right:!0};o.prototype.getCueAsHTML=function(){return WebVTT.convertCueToDOMTree(window,this.text)},t.VTTCue=t.VTTCue||o,e.VTTCue=o}(this,this.vttjs||{}),function(t,e){function n(t){if("string"!=typeof t)return!1;var e=o[t.toLowerCase()];return!!e&&t.toLowerCase()}function i(t){return"number"==typeof t&&t>=0&&t<=100}function r(){var t=100,e=3,r=0,o=100,a=0,s=100,c="";Object.defineProperties(this,{width:{enumerable:!0,get:function(){return t},set:function(e){if(!i(e))throw new Error("Width must be between 0 and 100.");t=e}},lines:{enumerable:!0,get:function(){return e},set:function(t){if("number"!=typeof t)throw new TypeError("Lines must be set to a number.");e=t}},regionAnchorY:{enumerable:!0,get:function(){return o},set:function(t){if(!i(t))throw new Error("RegionAnchorX must be between 0 and 100.");o=t}},regionAnchorX:{enumerable:!0,get:function(){return r},set:function(t){if(!i(t))throw new Error("RegionAnchorY must be between 0 and 100.");r=t}},viewportAnchorY:{enumerable:!0,get:function(){return s},set:function(t){if(!i(t))throw new Error("ViewportAnchorY must be between 0 and 100.");s=t}},viewportAnchorX:{enumerable:!0,get:function(){return a},set:function(t){if(!i(t))throw new Error("ViewportAnchorX must be between 0 and 100.");a=t}},scroll:{enumerable:!0,get:function(){return c},set:function(t){var e=n(t);if(e===!1)throw new SyntaxError("An invalid or illegal string was specified.");c=e}}})}var o={"":!0,up:!0};t.VTTRegion=t.VTTRegion||r,e.VTTRegion=r}(this,this.vttjs||{}),function(t){function e(t,e){this.name="ParsingError",this.code=t.code,this.message=e||t.message}function n(t){function e(t,e,n,i){return 3600*(0|t)+60*(0|e)+(0|n)+(0|i)/1e3}var n=t.match(/^(\d+):(\d{2})(:\d{2})?\.(\d{3})/);return n?n[3]?e(n[1],n[2],n[3].replace(":",""),n[4]):n[1]>59?e(n[1],n[2],0,n[4]):e(0,n[1],n[2],n[4]):null}function i(){this.values=f(null)}function r(t,e,n,i){var r=i?t.split(i):[t];for(var o in r)if("string"==typeof r[o]){var a=r[o].split(n);if(2===a.length){var s=a[0],c=a[1];e(s,c)}}}function o(t,o,a){function s(){var i=n(t);if(null===i)throw new e(e.Errors.BadTimeStamp,"Malformed timestamp: "+u);return t=t.replace(/^[^\sa-zA-Z-]+/,""),i}function c(t,e){var n=new i;r(t,function(t,e){switch(t){case"region":for(var i=a.length-1;i>=0;i--)if(a[i].id===e){n.set(t,a[i].region);break}break;case"vertical":n.alt(t,e,["rl","lr"]);break;case"line":var r=e.split(","),o=r[0];n.integer(t,o),n.percent(t,o)?n.set("snapToLines",!1):null,n.alt(t,o,["auto"]),2===r.length&&n.alt("lineAlign",r[1],["start","middle","end"]);break;case"position":r=e.split(","),n.percent(t,r[0]),2===r.length&&n.alt("positionAlign",r[1],["start","middle","end"]);break;case"size":n.percent(t,e);break;case"align":n.alt(t,e,["start","middle","end","left","right"])}},/:/,/\s/),e.region=n.get("region",null),e.vertical=n.get("vertical",""),e.line=n.get("line","auto"),e.lineAlign=n.get("lineAlign","start"),e.snapToLines=n.get("snapToLines",!0),e.size=n.get("size",100),e.align=n.get("align","middle"),e.position=n.get("position",{start:0,left:0,middle:50,end:100,right:100},e.align),e.positionAlign=n.get("positionAlign",{start:"start",left:"start",middle:"middle",end:"end",right:"end"},e.align)}function l(){t=t.replace(/^\s+/,"")}var u=t;if(l(),o.startTime=s(),l(),"-->"!==t.substr(0,3))throw new e(e.Errors.BadTimeStamp,"Malformed time stamp (time stamps must be separated by '-->'): "+u);t=t.substr(3),l(),o.endTime=s(),l(),c(t,o)}function a(t,e){function i(){function t(t){return e=e.substr(t.length),t}if(!e)return null;var n=e.match(/^([^<]*)(<[^>]+>?)?/);return t(n[1]?n[1]:n[2])}function r(t){return m[t]}function o(t){for(;f=t.match(/&(amp|lt|gt|lrm|rlm|nbsp);/);)t=t.replace(f[0],r);return t}function a(t,e){return!y[e.localName]||y[e.localName]===t.localName}function s(e,n){var i=v[e];if(!i)return null;var r=t.document.createElement(i);r.localName=i;var o=g[e];return o&&n&&(r[o]=n.trim()),r}for(var c,l=t.document.createElement("div"),u=l,h=[];null!==(c=i());)if("<"!==c[0])u.appendChild(t.document.createTextNode(o(c)));else{if("/"===c[1]){h.length&&h[h.length-1]===c.substr(2).replace(">","")&&(h.pop(),u=u.parentNode);continue}var p,d=n(c.substr(1,c.length-2));if(d){p=t.document.createProcessingInstruction("timestamp",d),u.appendChild(p);continue}var f=c.match(/^<([^.\s\/0-9>]+)(\.[^\s\\>]+)?([^>\\]+)?(\\?)>?$/);if(!f)continue;if(p=s(f[1],f[3]),!p)continue;if(!a(u,p))continue;f[2]&&(p.className=f[2].substr(1).replace("."," ")),h.push(f[1]),u.appendChild(p),u=p}return l}function s(t){function e(t,e){for(var n=e.childNodes.length-1;n>=0;n--)t.push(e.childNodes[n])}function n(t){if(!t||!t.length)return null;var i=t.pop(),r=i.textContent||i.innerText;if(r){var o=r.match(/^.*(\n|\r)/);return o?(t.length=0,o[0]):r}return"ruby"===i.tagName?n(t):i.childNodes?(e(t,i),n(t)):void 0}var i,r=[],o="";if(!t||!t.childNodes)return"ltr";for(e(r,t);o=n(r);)for(var a=0;a<o.length;a++){i=o.charCodeAt(a);for(var s=0;s<E.length;s++)if(E[s]===i)return"rtl"}return"ltr"}function c(t){if("number"==typeof t.line&&(t.snapToLines||t.line>=0&&t.line<=100))return t.line;if(!t.track||!t.track.textTrackList||!t.track.textTrackList.mediaElement)return-1;for(var e=t.track,n=e.textTrackList,i=0,r=0;r<n.length&&n[r]!==e;r++)"showing"===n[r].mode&&i++;return++i*-1}function l(){}function u(t,e,n){var i=/MSIE\s8\.0/.test(navigator.userAgent),r="rgba(255, 255, 255, 1)",o="rgba(0, 0, 0, 0.8)";i&&(r="rgb(255, 255, 255)",o="rgb(0, 0, 0)"),l.call(this),this.cue=e,this.cueDiv=a(t,e.text);var c={color:r,backgroundColor:o,position:"relative",left:0,right:0,top:0,bottom:0,display:"inline"};i||(c.writingMode=""===e.vertical?"horizontal-tb":"lr"===e.vertical?"vertical-lr":"vertical-rl",c.unicodeBidi="plaintext"),this.applyStyles(c,this.cueDiv),this.div=t.document.createElement("div"),c={textAlign:"middle"===e.align?"center":e.align,font:n.font,whiteSpace:"pre-line",position:"absolute"},i||(c.direction=s(this.cueDiv),c.writingMode=""===e.vertical?"horizontal-tb":"lr"===e.vertical?"vertical-lr":"vertical-rl".stylesunicodeBidi="plaintext"),this.applyStyles(c),this.div.appendChild(this.cueDiv);var u=0;switch(e.positionAlign){case"start":u=e.position;break;case"middle":u=e.position-e.size/2;break;case"end":u=e.position-e.size}""===e.vertical?this.applyStyles({left:this.formatStyle(u,"%"),width:this.formatStyle(e.size,"%")}):this.applyStyles({top:this.formatStyle(u,"%"),height:this.formatStyle(e.size,"%")}),this.move=function(t){this.applyStyles({top:this.formatStyle(t.top,"px"),bottom:this.formatStyle(t.bottom,"px"),left:this.formatStyle(t.left,"px"),right:this.formatStyle(t.right,"px"),height:this.formatStyle(t.height,"px"),width:this.formatStyle(t.width,"px")})}}function h(t){var e,n,i,r,o=/MSIE\s8\.0/.test(navigator.userAgent);if(t.div){n=t.div.offsetHeight,i=t.div.offsetWidth,r=t.div.offsetTop;var a=(a=t.div.childNodes)&&(a=a[0])&&a.getClientRects&&a.getClientRects();t=t.div.getBoundingClientRect(),e=a?Math.max(a[0]&&a[0].height||0,t.height/a.length):0}this.left=t.left,this.right=t.right,this.top=t.top||r,this.height=t.height||n,this.bottom=t.bottom||r+(t.height||n),this.width=t.width||i,this.lineHeight=void 0!==e?e:t.lineHeight,o&&!this.lineHeight&&(this.lineHeight=13)}function p(t,e,n,i){function r(t,e){for(var r,o=new h(t),a=1,s=0;s<e.length;s++){for(;t.overlapsOppositeAxis(n,e[s])||t.within(n)&&t.overlapsAny(i);)t.move(e[s]);if(t.within(n))return t;var c=t.intersectPercentage(n);a>c&&(r=new h(t),a=c),t=new h(o)}return r||o}var o=new h(e),a=e.cue,s=c(a),l=[];if(a.snapToLines){var u;switch(a.vertical){case"":l=["+y","-y"],u="height";break;case"rl":
l=["+x","-x"],u="width";break;case"lr":l=["-x","+x"],u="width"}var p=o.lineHeight,d=p*Math.round(s),f=n[u]+p,m=l[0];Math.abs(d)>f&&(d=d<0?-1:1,d*=Math.ceil(f/p)*p),s<0&&(d+=""===a.vertical?n.height:n.width,l=l.reverse()),o.move(m,d)}else{var v=o.lineHeight/n.height*100;switch(a.lineAlign){case"middle":s-=v/2;break;case"end":s-=v}switch(a.vertical){case"":e.applyStyles({top:e.formatStyle(s,"%")});break;case"rl":e.applyStyles({left:e.formatStyle(s,"%")});break;case"lr":e.applyStyles({right:e.formatStyle(s,"%")})}l=["+y","-x","+x","-y"],o=new h(e)}var g=r(o,l);e.move(g.toCSSCompatValues(n))}function d(){}var f=Object.create||function(){function t(){}return function(e){if(1!==arguments.length)throw new Error("Object.create shim only accepts one parameter.");return t.prototype=e,new t}}();e.prototype=f(Error.prototype),e.prototype.constructor=e,e.Errors={BadSignature:{code:0,message:"Malformed WebVTT signature."},BadTimeStamp:{code:1,message:"Malformed time stamp."}},i.prototype={set:function(t,e){this.get(t)||""===e||(this.values[t]=e)},get:function(t,e,n){return n?this.has(t)?this.values[t]:e[n]:this.has(t)?this.values[t]:e},has:function(t){return t in this.values},alt:function(t,e,n){for(var i=0;i<n.length;++i)if(e===n[i]){this.set(t,e);break}},integer:function(t,e){/^-?\d+$/.test(e)&&this.set(t,parseInt(e,10))},percent:function(t,e){var n;return!!((n=e.match(/^([\d]{1,3})(\.[\d]*)?%$/))&&(e=parseFloat(e),e>=0&&e<=100))&&(this.set(t,e),!0)}};var m={"&amp;":"&","&lt;":"<","&gt;":">","&lrm;":"","&rlm;":"","&nbsp;":""},v={c:"span",i:"i",b:"b",u:"u",ruby:"ruby",rt:"rt",v:"span",lang:"span"},g={v:"title",lang:"lang"},y={rt:"ruby"},E=[1470,1472,1475,1478,1488,1489,1490,1491,1492,1493,1494,1495,1496,1497,1498,1499,1500,1501,1502,1503,1504,1505,1506,1507,1508,1509,1510,1511,1512,1513,1514,1520,1521,1522,1523,1524,1544,1547,1549,1563,1566,1567,1568,1569,1570,1571,1572,1573,1574,1575,1576,1577,1578,1579,1580,1581,1582,1583,1584,1585,1586,1587,1588,1589,1590,1591,1592,1593,1594,1595,1596,1597,1598,1599,1600,1601,1602,1603,1604,1605,1606,1607,1608,1609,1610,1645,1646,1647,1649,1650,1651,1652,1653,1654,1655,1656,1657,1658,1659,1660,1661,1662,1663,1664,1665,1666,1667,1668,1669,1670,1671,1672,1673,1674,1675,1676,1677,1678,1679,1680,1681,1682,1683,1684,1685,1686,1687,1688,1689,1690,1691,1692,1693,1694,1695,1696,1697,1698,1699,1700,1701,1702,1703,1704,1705,1706,1707,1708,1709,1710,1711,1712,1713,1714,1715,1716,1717,1718,1719,1720,1721,1722,1723,1724,1725,1726,1727,1728,1729,1730,1731,1732,1733,1734,1735,1736,1737,1738,1739,1740,1741,1742,1743,1744,1745,1746,1747,1748,1749,1765,1766,1774,1775,1786,1787,1788,1789,1790,1791,1792,1793,1794,1795,1796,1797,1798,1799,1800,1801,1802,1803,1804,1805,1807,1808,1810,1811,1812,1813,1814,1815,1816,1817,1818,1819,1820,1821,1822,1823,1824,1825,1826,1827,1828,1829,1830,1831,1832,1833,1834,1835,1836,1837,1838,1839,1869,1870,1871,1872,1873,1874,1875,1876,1877,1878,1879,1880,1881,1882,1883,1884,1885,1886,1887,1888,1889,1890,1891,1892,1893,1894,1895,1896,1897,1898,1899,1900,1901,1902,1903,1904,1905,1906,1907,1908,1909,1910,1911,1912,1913,1914,1915,1916,1917,1918,1919,1920,1921,1922,1923,1924,1925,1926,1927,1928,1929,1930,1931,1932,1933,1934,1935,1936,1937,1938,1939,1940,1941,1942,1943,1944,1945,1946,1947,1948,1949,1950,1951,1952,1953,1954,1955,1956,1957,1969,1984,1985,1986,1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2e3,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022,2023,2024,2025,2026,2036,2037,2042,2048,2049,2050,2051,2052,2053,2054,2055,2056,2057,2058,2059,2060,2061,2062,2063,2064,2065,2066,2067,2068,2069,2074,2084,2088,2096,2097,2098,2099,2100,2101,2102,2103,2104,2105,2106,2107,2108,2109,2110,2112,2113,2114,2115,2116,2117,2118,2119,2120,2121,2122,2123,2124,2125,2126,2127,2128,2129,2130,2131,2132,2133,2134,2135,2136,2142,2208,2210,2211,2212,2213,2214,2215,2216,2217,2218,2219,2220,8207,64285,64287,64288,64289,64290,64291,64292,64293,64294,64295,64296,64298,64299,64300,64301,64302,64303,64304,64305,64306,64307,64308,64309,64310,64312,64313,64314,64315,64316,64318,64320,64321,64323,64324,64326,64327,64328,64329,64330,64331,64332,64333,64334,64335,64336,64337,64338,64339,64340,64341,64342,64343,64344,64345,64346,64347,64348,64349,64350,64351,64352,64353,64354,64355,64356,64357,64358,64359,64360,64361,64362,64363,64364,64365,64366,64367,64368,64369,64370,64371,64372,64373,64374,64375,64376,64377,64378,64379,64380,64381,64382,64383,64384,64385,64386,64387,64388,64389,64390,64391,64392,64393,64394,64395,64396,64397,64398,64399,64400,64401,64402,64403,64404,64405,64406,64407,64408,64409,64410,64411,64412,64413,64414,64415,64416,64417,64418,64419,64420,64421,64422,64423,64424,64425,64426,64427,64428,64429,64430,64431,64432,64433,64434,64435,64436,64437,64438,64439,64440,64441,64442,64443,64444,64445,64446,64447,64448,64449,64467,64468,64469,64470,64471,64472,64473,64474,64475,64476,64477,64478,64479,64480,64481,64482,64483,64484,64485,64486,64487,64488,64489,64490,64491,64492,64493,64494,64495,64496,64497,64498,64499,64500,64501,64502,64503,64504,64505,64506,64507,64508,64509,64510,64511,64512,64513,64514,64515,64516,64517,64518,64519,64520,64521,64522,64523,64524,64525,64526,64527,64528,64529,64530,64531,64532,64533,64534,64535,64536,64537,64538,64539,64540,64541,64542,64543,64544,64545,64546,64547,64548,64549,64550,64551,64552,64553,64554,64555,64556,64557,64558,64559,64560,64561,64562,64563,64564,64565,64566,64567,64568,64569,64570,64571,64572,64573,64574,64575,64576,64577,64578,64579,64580,64581,64582,64583,64584,64585,64586,64587,64588,64589,64590,64591,64592,64593,64594,64595,64596,64597,64598,64599,64600,64601,64602,64603,64604,64605,64606,64607,64608,64609,64610,64611,64612,64613,64614,64615,64616,64617,64618,64619,64620,64621,64622,64623,64624,64625,64626,64627,64628,64629,64630,64631,64632,64633,64634,64635,64636,64637,64638,64639,64640,64641,64642,64643,64644,64645,64646,64647,64648,64649,64650,64651,64652,64653,64654,64655,64656,64657,64658,64659,64660,64661,64662,64663,64664,64665,64666,64667,64668,64669,64670,64671,64672,64673,64674,64675,64676,64677,64678,64679,64680,64681,64682,64683,64684,64685,64686,64687,64688,64689,64690,64691,64692,64693,64694,64695,64696,64697,64698,64699,64700,64701,64702,64703,64704,64705,64706,64707,64708,64709,64710,64711,64712,64713,64714,64715,64716,64717,64718,64719,64720,64721,64722,64723,64724,64725,64726,64727,64728,64729,64730,64731,64732,64733,64734,64735,64736,64737,64738,64739,64740,64741,64742,64743,64744,64745,64746,64747,64748,64749,64750,64751,64752,64753,64754,64755,64756,64757,64758,64759,64760,64761,64762,64763,64764,64765,64766,64767,64768,64769,64770,64771,64772,64773,64774,64775,64776,64777,64778,64779,64780,64781,64782,64783,64784,64785,64786,64787,64788,64789,64790,64791,64792,64793,64794,64795,64796,64797,64798,64799,64800,64801,64802,64803,64804,64805,64806,64807,64808,64809,64810,64811,64812,64813,64814,64815,64816,64817,64818,64819,64820,64821,64822,64823,64824,64825,64826,64827,64828,64829,64848,64849,64850,64851,64852,64853,64854,64855,64856,64857,64858,64859,64860,64861,64862,64863,64864,64865,64866,64867,64868,64869,64870,64871,64872,64873,64874,64875,64876,64877,64878,64879,64880,64881,64882,64883,64884,64885,64886,64887,64888,64889,64890,64891,64892,64893,64894,64895,64896,64897,64898,64899,64900,64901,64902,64903,64904,64905,64906,64907,64908,64909,64910,64911,64914,64915,64916,64917,64918,64919,64920,64921,64922,64923,64924,64925,64926,64927,64928,64929,64930,64931,64932,64933,64934,64935,64936,64937,64938,64939,64940,64941,64942,64943,64944,64945,64946,64947,64948,64949,64950,64951,64952,64953,64954,64955,64956,64957,64958,64959,64960,64961,64962,64963,64964,64965,64966,64967,65008,65009,65010,65011,65012,65013,65014,65015,65016,65017,65018,65019,65020,65136,65137,65138,65139,65140,65142,65143,65144,65145,65146,65147,65148,65149,65150,65151,65152,65153,65154,65155,65156,65157,65158,65159,65160,65161,65162,65163,65164,65165,65166,65167,65168,65169,65170,65171,65172,65173,65174,65175,65176,65177,65178,65179,65180,65181,65182,65183,65184,65185,65186,65187,65188,65189,65190,65191,65192,65193,65194,65195,65196,65197,65198,65199,65200,65201,65202,65203,65204,65205,65206,65207,65208,65209,65210,65211,65212,65213,65214,65215,65216,65217,65218,65219,65220,65221,65222,65223,65224,65225,65226,65227,65228,65229,65230,65231,65232,65233,65234,65235,65236,65237,65238,65239,65240,65241,65242,65243,65244,65245,65246,65247,65248,65249,65250,65251,65252,65253,65254,65255,65256,65257,65258,65259,65260,65261,65262,65263,65264,65265,65266,65267,65268,65269,65270,65271,65272,65273,65274,65275,65276,67584,67585,67586,67587,67588,67589,67592,67594,67595,67596,67597,67598,67599,67600,67601,67602,67603,67604,67605,67606,67607,67608,67609,67610,67611,67612,67613,67614,67615,67616,67617,67618,67619,67620,67621,67622,67623,67624,67625,67626,67627,67628,67629,67630,67631,67632,67633,67634,67635,67636,67637,67639,67640,67644,67647,67648,67649,67650,67651,67652,67653,67654,67655,67656,67657,67658,67659,67660,67661,67662,67663,67664,67665,67666,67667,67668,67669,67671,67672,67673,67674,67675,67676,67677,67678,67679,67840,67841,67842,67843,67844,67845,67846,67847,67848,67849,67850,67851,67852,67853,67854,67855,67856,67857,67858,67859,67860,67861,67862,67863,67864,67865,67866,67867,67872,67873,67874,67875,67876,67877,67878,67879,67880,67881,67882,67883,67884,67885,67886,67887,67888,67889,67890,67891,67892,67893,67894,67895,67896,67897,67903,67968,67969,67970,67971,67972,67973,67974,67975,67976,67977,67978,67979,67980,67981,67982,67983,67984,67985,67986,67987,67988,67989,67990,67991,67992,67993,67994,67995,67996,67997,67998,67999,68e3,68001,68002,68003,68004,68005,68006,68007,68008,68009,68010,68011,68012,68013,68014,68015,68016,68017,68018,68019,68020,68021,68022,68023,68030,68031,68096,68112,68113,68114,68115,68117,68118,68119,68121,68122,68123,68124,68125,68126,68127,68128,68129,68130,68131,68132,68133,68134,68135,68136,68137,68138,68139,68140,68141,68142,68143,68144,68145,68146,68147,68160,68161,68162,68163,68164,68165,68166,68167,68176,68177,68178,68179,68180,68181,68182,68183,68184,68192,68193,68194,68195,68196,68197,68198,68199,68200,68201,68202,68203,68204,68205,68206,68207,68208,68209,68210,68211,68212,68213,68214,68215,68216,68217,68218,68219,68220,68221,68222,68223,68352,68353,68354,68355,68356,68357,68358,68359,68360,68361,68362,68363,68364,68365,68366,68367,68368,68369,68370,68371,68372,68373,68374,68375,68376,68377,68378,68379,68380,68381,68382,68383,68384,68385,68386,68387,68388,68389,68390,68391,68392,68393,68394,68395,68396,68397,68398,68399,68400,68401,68402,68403,68404,68405,68416,68417,68418,68419,68420,68421,68422,68423,68424,68425,68426,68427,68428,68429,68430,68431,68432,68433,68434,68435,68436,68437,68440,68441,68442,68443,68444,68445,68446,68447,68448,68449,68450,68451,68452,68453,68454,68455,68456,68457,68458,68459,68460,68461,68462,68463,68464,68465,68466,68472,68473,68474,68475,68476,68477,68478,68479,68608,68609,68610,68611,68612,68613,68614,68615,68616,68617,68618,68619,68620,68621,68622,68623,68624,68625,68626,68627,68628,68629,68630,68631,68632,68633,68634,68635,68636,68637,68638,68639,68640,68641,68642,68643,68644,68645,68646,68647,68648,68649,68650,68651,68652,68653,68654,68655,68656,68657,68658,68659,68660,68661,68662,68663,68664,68665,68666,68667,68668,68669,68670,68671,68672,68673,68674,68675,68676,68677,68678,68679,68680,126464,126465,126466,126467,126469,126470,126471,126472,126473,126474,126475,126476,126477,126478,126479,126480,126481,126482,126483,126484,126485,126486,126487,126488,126489,126490,126491,126492,126493,126494,126495,126497,126498,126500,126503,126505,126506,126507,126508,126509,126510,126511,126512,126513,126514,126516,126517,126518,126519,126521,126523,126530,126535,126537,126539,126541,126542,126543,126545,126546,126548,126551,126553,126555,126557,126559,126561,126562,126564,126567,126568,126569,126570,126572,126573,126574,126575,126576,126577,126578,126580,126581,126582,126583,126585,126586,126587,126588,126590,126592,126593,126594,126595,126596,126597,126598,126599,126600,126601,126603,126604,126605,126606,126607,126608,126609,126610,126611,126612,126613,126614,126615,126616,126617,126618,126619,126625,126626,126627,126629,126630,126631,126632,126633,126635,126636,126637,126638,126639,126640,126641,126642,126643,126644,126645,126646,126647,126648,126649,126650,126651,1114109];l.prototype.applyStyles=function(t,e){e=e||this.div;for(var n in t)t.hasOwnProperty(n)&&(e.style[n]=t[n])},l.prototype.formatStyle=function(t,e){return 0===t?0:t+e},u.prototype=f(l.prototype),u.prototype.constructor=u,h.prototype.move=function(t,e){switch(e=void 0!==e?e:this.lineHeight,t){case"+x":this.left+=e,this.right+=e;break;case"-x":this.left-=e,this.right-=e;break;case"+y":this.top+=e,this.bottom+=e;break;case"-y":this.top-=e,this.bottom-=e}},h.prototype.overlaps=function(t){return this.left<t.right&&this.right>t.left&&this.top<t.bottom&&this.bottom>t.top},h.prototype.overlapsAny=function(t){for(var e=0;e<t.length;e++)if(this.overlaps(t[e]))return!0;return!1},h.prototype.within=function(t){return this.top>=t.top&&this.bottom<=t.bottom&&this.left>=t.left&&this.right<=t.right},h.prototype.overlapsOppositeAxis=function(t,e){switch(e){case"+x":return this.left<t.left;case"-x":return this.right>t.right;case"+y":return this.top<t.top;case"-y":return this.bottom>t.bottom}},h.prototype.intersectPercentage=function(t){var e=Math.max(0,Math.min(this.right,t.right)-Math.max(this.left,t.left)),n=Math.max(0,Math.min(this.bottom,t.bottom)-Math.max(this.top,t.top)),i=e*n;return i/(this.height*this.width)},h.prototype.toCSSCompatValues=function(t){return{top:this.top-t.top,bottom:t.bottom-this.bottom,left:this.left-t.left,right:t.right-this.right,height:this.height,width:this.width}},h.getSimpleBoxPosition=function(t){var e=t.div?t.div.offsetHeight:t.tagName?t.offsetHeight:0,n=t.div?t.div.offsetWidth:t.tagName?t.offsetWidth:0,i=t.div?t.div.offsetTop:t.tagName?t.offsetTop:0;t=t.div?t.div.getBoundingClientRect():t.tagName?t.getBoundingClientRect():t;var r={left:t.left,right:t.right,top:t.top||i,height:t.height||e,bottom:t.bottom||i+(t.height||e),width:t.width||n};return r},d.StringDecoder=function(){return{decode:function(t){if(!t)return"";if("string"!=typeof t)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(t))}}},d.convertCueToDOMTree=function(t,e){return t&&e?a(t,e):null};var _=.05,T="sans-serif",b="1.5%";d.processCues=function(t,e,n){function i(t){for(var e=0;e<t.length;e++)if(t[e].hasBeenReset||!t[e].displayState)return!0;return!1}if(!t||!e||!n)return null;for(;n.firstChild;)n.removeChild(n.firstChild);var r=t.document.createElement("div");if(r.style.position="absolute",r.style.left="0",r.style.right="0",r.style.top="0",r.style.bottom="0",r.style.margin=b,n.appendChild(r),i(e)){var o=[],a=h.getSimpleBoxPosition(r),s=Math.round(a.height*_*100)/100,c={font:s+"px "+T};!function(){for(var n,i,s=0;s<e.length;s++)i=e[s],n=new u(t,i,c),r.appendChild(n.div),p(t,n,a,o),i.displayState=n.div,o.push(h.getSimpleBoxPosition(n))}()}else for(var l=0;l<e.length;l++)r.appendChild(e[l].displayState)},d.Parser=function(t,e,n){n||(n=e,e={}),e||(e={}),this.window=t,this.vttjs=e,this.state="INITIAL",this.buffer="",this.decoder=n||new TextDecoder("utf8"),this.regionList=[]},d.Parser.prototype={reportOrThrowError:function(t){if(!(t instanceof e))throw t;this.onparsingerror&&this.onparsingerror(t)},parse:function(t){function n(){for(var t=c.buffer,e=0;e<t.length&&"\r"!==t[e]&&"\n"!==t[e];)++e;var n=t.substr(0,e);return"\r"===t[e]&&++e,"\n"===t[e]&&++e,c.buffer=t.substr(e),n}function a(t){var e=new i;if(r(t,function(t,n){switch(t){case"id":e.set(t,n);break;case"width":e.percent(t,n);break;case"lines":e.integer(t,n);break;case"regionanchor":case"viewportanchor":var r=n.split(",");if(2!==r.length)break;var o=new i;if(o.percent("x",r[0]),o.percent("y",r[1]),!o.has("x")||!o.has("y"))break;e.set(t+"X",o.get("x")),e.set(t+"Y",o.get("y"));break;case"scroll":e.alt(t,n,["up"])}},/=/,/\s/),e.has("id")){var n=new(c.vttjs.VTTRegion||c.window.VTTRegion);n.width=e.get("width",100),n.lines=e.get("lines",3),n.regionAnchorX=e.get("regionanchorX",0),n.regionAnchorY=e.get("regionanchorY",100),n.viewportAnchorX=e.get("viewportanchorX",0),n.viewportAnchorY=e.get("viewportanchorY",100),n.scroll=e.get("scroll",""),c.onregion&&c.onregion(n),c.regionList.push({id:e.get("id"),region:n})}}function s(t){r(t,function(t,e){switch(t){case"Region":a(e)}},/:/)}var c=this;t&&(c.buffer+=c.decoder.decode(t,{stream:!0}));try{var l;if("INITIAL"===c.state){if(!/\r\n|\n/.test(c.buffer))return this;l=n();var u=l.match(/^WEBVTT([ \t].*)?$/);if(!u||!u[0])throw new e(e.Errors.BadSignature);c.state="HEADER"}for(var h=!1;c.buffer;){if(!/\r\n|\n/.test(c.buffer))return this;switch(h?h=!1:l=n(),c.state){case"HEADER":/:/.test(l)?s(l):l||(c.state="ID");continue;case"NOTE":l||(c.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(l)){c.state="NOTE";break}if(!l)continue;if(c.cue=new(c.vttjs.VTTCue||c.window.VTTCue)(0,0,""),c.state="CUE",l.indexOf("-->")===-1){c.cue.id=l;continue}case"CUE":try{o(l,c.cue,c.regionList)}catch(t){c.reportOrThrowError(t),c.cue=null,c.state="BADCUE";continue}c.state="CUETEXT";continue;case"CUETEXT":var p=l.indexOf("-->")!==-1;if(!l||p&&(h=!0)){c.oncue&&c.oncue(c.cue),c.cue=null,c.state="ID";continue}c.cue.text&&(c.cue.text+="\n"),c.cue.text+=l;continue;case"BADCUE":l||(c.state="ID");continue}}}catch(t){c.reportOrThrowError(t),"CUETEXT"===c.state&&c.cue&&c.oncue&&c.oncue(c.cue),c.cue=null,c.state="INITIAL"===c.state?"BADWEBVTT":"BADCUE"}return this},flush:function(){var t=this;try{if(t.buffer+=t.decoder.decode(),(t.cue||"HEADER"===t.state)&&(t.buffer+="\n\n",t.parse()),"INITIAL"===t.state)throw new e(e.Errors.BadSignature)}catch(e){t.reportOrThrowError(e)}return t.onflush&&t.onflush(),this}},t.WebVTT=d}(this,this.vttjs||{}),!function(){!function(t){var e=t&&t.videojs;if(e){e.CDN_VERSION="5.9.2";var n="https:"===t.location.protocol?"https://":"http://";e.options.flash.swf=n+"vjs.zencdn.net/swf/5.0.1/video-js.swf"}}(window),function(t,e,n,i,r,o,a){e&&e.HELP_IMPROVE_VIDEOJS!==!1&&(r.random()>.01||(o=e.location,a=e.videojs||{},t.src="//www.google-analytics.com/__utm.gif?utmwv=5.4.2&utmac=UA-16505296-3&utmn=1&utmhn="+i(o.hostname)+"&utmsr="+e.screen.availWidth+"x"+e.screen.availHeight+"&utmul="+(n.language||n.userLanguage||"").toLowerCase()+"&utmr="+i(o.href)+"&utmp="+i(o.hostname+o.pathname)+"&utmcc=__utma%3D1."+r.floor(1e10*r.random())+".1.1.1.1%3B&utme=8(vjsv*cdnv)9("+a.VERSION+"*"+a.CDN_VERSION+")"))}(new Image,window,navigator,encodeURIComponent,Math)}(),/**
 * videojs-contrib-hls
 * @version 2.0.1
 * @copyright 2016 Brightcove, Inc
 * @license Apache-2.0
 */
!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.videojsContribHls=t()}}(function(){return function t(e,n,i){function r(a,s){if(!n[a]){if(!e[a]){var c="function"==typeof require&&require;if(!s&&c)return c(a,!0);if(o)return o(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var u=n[a]={exports:{}};e[a][0].call(u.exports,function(t){var n=e[a][1][t];return r(n?n:t)},u,u.exports,t,e,n,i)}return n[a].exports}for(var o="function"==typeof require&&require,a=0;a<i.length;a++)r(i[a]);return r}({1:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function(t,e){return t.start(e)+"-"+t.end(e)},r=function(t,e){var n=t.toString(16);return"00".substring(0,2-n.length)+n+(e%2?" ":"")},o=function(t){return t>=32&&126>t?String.fromCharCode(t):"."},a={hexDump:function(t){for(var e=Array.prototype.slice.call(t),n=16,i="",a=void 0,s=void 0,c=0;c<e.length/n;c++)a=e.slice(c*n,c*n+n).map(r).join(""),s=e.slice(c*n,c*n+n).map(o).join(""),i+=a+" "+s+"\n";return i},tagDump:function(t){return a.hexDump(t.bytes)},textRanges:function(t){var e="",n=void 0;for(n=0;n<t.length;n++)e+=i(t,n)+" ";return e}};n.default=a,e.exports=n.default},{}],2:[function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=function(){var t=[[[],[],[],[],[]],[[],[],[],[],[]]],e=t[0],n=t[1],i=e[4],r=n[4],o=void 0,a=void 0,s=void 0,c=[],l=[],u=void 0,h=void 0,p=void 0,d=void 0,f=void 0,m=void 0;for(o=0;256>o;o++)l[(c[o]=o<<1^283*(o>>7))^o]=o;for(a=s=0;!i[a];a^=u||1,s=l[s]||1)for(d=s^s<<1^s<<2^s<<3^s<<4,d=d>>8^255&d^99,i[a]=d,r[d]=a,p=c[h=c[u=c[a]]],m=16843009*p^65537*h^257*u^16843008*a,f=257*c[d]^16843008*d,o=0;4>o;o++)e[o][a]=f=f<<24^f>>>8,n[o][d]=m=m<<24^m>>>8;for(o=0;5>o;o++)e[o]=e[o].slice(0),n[o]=n[o].slice(0);return t},a=null,s=function(){function t(e){i(this,t),a||(a=o()),this._tables=[[a[0][0].slice(),a[0][1].slice(),a[0][2].slice(),a[0][3].slice(),a[0][4].slice()],[a[1][0].slice(),a[1][1].slice(),a[1][2].slice(),a[1][3].slice(),a[1][4].slice()]];var n=void 0,r=void 0,s=void 0,c=void 0,l=void 0,u=this._tables[0][4],h=this._tables[1],p=e.length,d=1;if(4!==p&&6!==p&&8!==p)throw new Error("Invalid aes key size");for(c=e.slice(0),l=[],this._key=[c,l],n=p;4*p+28>n;n++)s=c[n-1],(n%p===0||8===p&&n%p===4)&&(s=u[s>>>24]<<24^u[s>>16&255]<<16^u[s>>8&255]<<8^u[255&s],n%p===0&&(s=s<<8^s>>>24^d<<24,d=d<<1^283*(d>>7))),c[n]=c[n-p]^s;for(r=0;n;r++,n--)s=c[3&r?n:n-4],4>=n||4>r?l[r]=s:l[r]=h[0][u[s>>>24]]^h[1][u[s>>16&255]]^h[2][u[s>>8&255]]^h[3][u[255&s]]}return r(t,[{key:"decrypt",value:function(t,e,n,i,r,o){var a=this._key[1],s=t^a[0],c=i^a[1],l=n^a[2],u=e^a[3],h=void 0,p=void 0,d=void 0,f=a.length/4-2,m=void 0,v=4,g=this._tables[1],y=g[0],E=g[1],_=g[2],T=g[3],b=g[4];for(m=0;f>m;m++)h=y[s>>>24]^E[c>>16&255]^_[l>>8&255]^T[255&u]^a[v],p=y[c>>>24]^E[l>>16&255]^_[u>>8&255]^T[255&s]^a[v+1],d=y[l>>>24]^E[u>>16&255]^_[s>>8&255]^T[255&c]^a[v+2],u=y[u>>>24]^E[s>>16&255]^_[c>>8&255]^T[255&l]^a[v+3],v+=4,s=h,c=p,l=d;for(m=0;4>m;m++)r[(3&-m)+o]=b[s>>>24]<<24^b[c>>16&255]<<16^b[l>>8&255]<<8^b[255&u]^a[v++],h=s,s=c,c=l,l=u,u=h}}]),t}();n.default=s,e.exports=n.default},{}],3:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),s=function(t,e,n){for(var i=!0;i;){var r=t,o=e,a=n;i=!1,null===r&&(r=Function.prototype);var s=Object.getOwnPropertyDescriptor(r,o);if(void 0!==s){if("value"in s)return s.value;var c=s.get;if(void 0===c)return;return c.call(a)}var l=Object.getPrototypeOf(r);if(null===l)return;t=l,e=o,n=a,i=!0,s=l=void 0}},c=t("../stream"),l=i(c),u=function(t){function e(){r(this,e),s(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,l.default),this.jobs=[],this.delay=1,this.timeout_=null}return o(e,t),a(e,[{key:"processJob_",value:function(){this.jobs.shift()(),this.jobs.length?this.timeout_=setTimeout(this.processJob_.bind(this),this.delay):this.timeout_=null}},{key:"push",value:function(t){this.jobs.push(t),this.timeout_||(this.timeout_=setTimeout(this.processJob_.bind(this),this.delay))}}]),e}(l.default);n.default=u,e.exports=n.default},{"../stream":13}],4:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=t("./aes"),s=i(a),c=t("./async-stream"),l=i(c),u=t("pkcs7"),h=function(t){return t<<24|(65280&t)<<8|(16711680&t)>>8|t>>>24},p=function(t,e,n){var i=new Int32Array(t.buffer,t.byteOffset,t.byteLength>>2),r=new s.default(Array.prototype.slice.call(e)),o=new Uint8Array(t.byteLength),a=new Int32Array(o.buffer),c=void 0,l=void 0,u=void 0,p=void 0,d=void 0,f=void 0,m=void 0,v=void 0,g=void 0;for(c=n[0],l=n[1],u=n[2],p=n[3],g=0;g<i.length;g+=4)d=h(i[g]),f=h(i[g+1]),m=h(i[g+2]),v=h(i[g+3]),r.decrypt(d,f,m,v,a,g),a[g]=h(a[g]^c),a[g+1]=h(a[g+1]^l),a[g+2]=h(a[g+2]^u),a[g+3]=h(a[g+3]^p),c=d,l=f,u=m,p=v;return o};n.decrypt=p;var d=function(){function t(e,n,i,o){r(this,t);var a=t.STEP,s=new Int32Array(e.buffer),c=new Uint8Array(e.byteLength),p=0;for(this.asyncStream_=new l.default,this.asyncStream_.push(this.decryptChunk_(s.subarray(p,p+a),n,i,c)),p=a;p<s.length;p+=a)i=new Uint32Array([h(s[p-4]),h(s[p-3]),h(s[p-2]),h(s[p-1])]),this.asyncStream_.push(this.decryptChunk_(s.subarray(p,p+a),n,i,c));this.asyncStream_.push(function(){o(null,(0,u.unpad)(c))})}return o(t,[{key:"decryptChunk_",value:function(t,e,n,i){return function(){var r=p(t,e,n);i.set(r,t.byteOffset)}}}]),t}();n.Decrypter=d,d.STEP=32e3,n.default={Decrypter:d,decrypt:p}},{"./aes":2,"./async-stream":3,pkcs7:18}],5:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(n,"__esModule",{value:!0});var r=t("./decrypter"),o=t("./async-stream"),a=i(o);n.default={decrypt:r.decrypt,Decrypter:r.Decrypter,AsyncStream:a.default},e.exports=n.default},{"./async-stream":3,"./decrypter":4}],6:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(n,"__esModule",{value:!0});var r=t("./line-stream"),o=i(r),a=t("./parse-stream"),s=i(a),c=t("./parser"),l=i(c);n.default={LineStream:o.default,ParseStream:s.default,Parser:l.default},e.exports=n.default},{"./line-stream":7,"./parse-stream":8,"./parser":9}],7:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),s=function(t,e,n){for(var i=!0;i;){var r=t,o=e,a=n;i=!1,null===r&&(r=Function.prototype);var s=Object.getOwnPropertyDescriptor(r,o);if(void 0!==s){if("value"in s)return s.value;var c=s.get;if(void 0===c)return;return c.call(a)}var l=Object.getPrototypeOf(r);if(null===l)return;t=l,e=o,n=a,i=!0,s=l=void 0}},c=t("../stream"),l=i(c),u=function(t){function e(){r(this,e),s(Object.getPrototypeOf(e.prototype),"constructor",this).call(this),this.buffer=""}return o(e,t),a(e,[{key:"push",value:function(t){var e=void 0;for(this.buffer+=t,e=this.buffer.indexOf("\n");e>-1;e=this.buffer.indexOf("\n"))this.trigger("data",this.buffer.substring(0,e)),this.buffer=this.buffer.substring(e+1)}}]),e}(l.default);n.default=u,e.exports=n.default},{"../stream":13}],8:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),s=function(t,e,n){for(var i=!0;i;){var r=t,o=e,a=n;i=!1,null===r&&(r=Function.prototype);var s=Object.getOwnPropertyDescriptor(r,o);if(void 0!==s){if("value"in s)return s.value;var c=s.get;if(void 0===c)return;return c.call(a)}var l=Object.getPrototypeOf(r);if(null===l)return;t=l,e=o,n=a,i=!0,s=l=void 0}},c=t("../stream"),l=i(c),u=function(){var t="[^=]*",e='"[^"]*"|[^,]*',n="(?:"+t+")=(?:"+e+")";return new RegExp("(?:^|,)("+n+")")},h=function(t){for(var e=t.split(u()),n=e.length,i={},r=void 0;n--;)""!==e[n]&&(r=/([^=]*)=(.*)/.exec(e[n]).slice(1),r[0]=r[0].replace(/^\s+|\s+$/g,""),r[1]=r[1].replace(/^\s+|\s+$/g,""),r[1]=r[1].replace(/^['"](.*)['"]$/g,"$1"),i[r[0]]=r[1]);return i},p=function(t){function e(){r(this,e),s(Object.getPrototypeOf(e.prototype),"constructor",this).call(this)}return o(e,t),a(e,[{key:"push",value:function(t){var e=void 0,n=void 0;if(t=t.replace(/^[\u0000\s]+|[\u0000\s]+$/g,""),0!==t.length){if("#"!==t[0])return void this.trigger("data",{type:"uri",uri:t});if(0!==t.indexOf("#EXT"))return void this.trigger("data",{type:"comment",text:t.slice(1)});if(t=t.replace("\r",""),e=/^#EXTM3U/.exec(t))return void this.trigger("data",{type:"tag",tagType:"m3u"});if(e=/^#EXTINF:?([0-9\.]*)?,?(.*)?$/.exec(t))return n={type:"tag",tagType:"inf"},e[1]&&(n.duration=parseFloat(e[1])),e[2]&&(n.title=e[2]),void this.trigger("data",n);if(e=/^#EXT-X-TARGETDURATION:?([0-9.]*)?/.exec(t))return n={type:"tag",tagType:"targetduration"},e[1]&&(n.duration=parseInt(e[1],10)),void this.trigger("data",n);if(e=/^#ZEN-TOTAL-DURATION:?([0-9.]*)?/.exec(t))return n={type:"tag",tagType:"totalduration"},e[1]&&(n.duration=parseInt(e[1],10)),void this.trigger("data",n);if(e=/^#EXT-X-VERSION:?([0-9.]*)?/.exec(t))return n={type:"tag",tagType:"version"},e[1]&&(n.version=parseInt(e[1],10)),void this.trigger("data",n);if(e=/^#EXT-X-MEDIA-SEQUENCE:?(\-?[0-9.]*)?/.exec(t))return n={type:"tag",tagType:"media-sequence"},e[1]&&(n.number=parseInt(e[1],10)),void this.trigger("data",n);if(e=/^#EXT-X-DISCONTINUITY-SEQUENCE:?(\-?[0-9.]*)?/.exec(t))return n={type:"tag",tagType:"discontinuity-sequence"},e[1]&&(n.number=parseInt(e[1],10)),void this.trigger("data",n);if(e=/^#EXT-X-PLAYLIST-TYPE:?(.*)?$/.exec(t))return n={type:"tag",tagType:"playlist-type"},e[1]&&(n.playlistType=e[1]),void this.trigger("data",n);if(e=/^#EXT-X-BYTERANGE:?([0-9.]*)?@?([0-9.]*)?/.exec(t))return n={type:"tag",tagType:"byterange"},e[1]&&(n.length=parseInt(e[1],10)),e[2]&&(n.offset=parseInt(e[2],10)),void this.trigger("data",n);if(e=/^#EXT-X-ALLOW-CACHE:?(YES|NO)?/.exec(t))return n={type:"tag",tagType:"allow-cache"},e[1]&&(n.allowed=!/NO/.test(e[1])),void this.trigger("data",n);if(e=/^#EXT-X-STREAM-INF:?(.*)$/.exec(t)){if(n={type:"tag",tagType:"stream-inf"},e[1]){if(n.attributes=h(e[1]),n.attributes.RESOLUTION){var i=n.attributes.RESOLUTION.split("x"),r={};i[0]&&(r.width=parseInt(i[0],10)),i[1]&&(r.height=parseInt(i[1],10)),n.attributes.RESOLUTION=r}n.attributes.BANDWIDTH&&(n.attributes.BANDWIDTH=parseInt(n.attributes.BANDWIDTH,10)),n.attributes["PROGRAM-ID"]&&(n.attributes["PROGRAM-ID"]=parseInt(n.attributes["PROGRAM-ID"],10))}return void this.trigger("data",n)}return(e=/^#EXT-X-ENDLIST/.exec(t))?void this.trigger("data",{type:"tag",tagType:"endlist"}):(e=/^#EXT-X-DISCONTINUITY/.exec(t))?void this.trigger("data",{type:"tag",tagType:"discontinuity"}):(e=/^#EXT-X-KEY:?(.*)$/.exec(t))?(n={type:"tag",tagType:"key"},e[1]&&(n.attributes=h(e[1]),n.attributes.IV&&("0x"===n.attributes.IV.substring(0,2)&&(n.attributes.IV=n.attributes.IV.substring(2)),n.attributes.IV=n.attributes.IV.match(/.{8}/g),n.attributes.IV[0]=parseInt(n.attributes.IV[0],16),n.attributes.IV[1]=parseInt(n.attributes.IV[1],16),n.attributes.IV[2]=parseInt(n.attributes.IV[2],16),n.attributes.IV[3]=parseInt(n.attributes.IV[3],16),n.attributes.IV=new Uint32Array(n.attributes.IV))),void this.trigger("data",n)):void this.trigger("data",{type:"tag",data:t.slice(4,t.length)})}}}]),e}(l.default);n.default=p,e.exports=n.default},{"../stream":13}],9:[function(t,e,n){(function(i){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),c=function(t,e,n){for(var i=!0;i;){var r=t,o=e,a=n;i=!1,null===r&&(r=Function.prototype);var s=Object.getOwnPropertyDescriptor(r,o);if(void 0!==s){if("value"in s)return s.value;var c=s.get;if(void 0===c)return;return c.call(a)}var l=Object.getPrototypeOf(r);if(null===l)return;t=l,e=o,n=a,i=!0,s=l=void 0}},l=t("../stream"),u=r(l),h=t("./line-stream"),p=r(h),d=t("./parse-stream"),f=r(d),m="undefined"!=typeof window?window.videojs:"undefined"!=typeof i?i.videojs:null,v=function(t){function e(){o(this,e),c(Object.getPrototypeOf(e.prototype),"constructor",this).call(this),this.lineStream=new p.default,this.parseStream=new f.default,this.lineStream.pipe(this.parseStream);var t=this,n=[],i={},r=void 0,a=function(){};this.manifest={allowCache:!0,discontinuityStarts:[]},this.parseStream.on("data",function(e){({tag:function(){(({"allow-cache":function(){this.manifest.allowCache=e.allowed,"allowed"in e||(this.trigger("info",{message:"defaulting allowCache to YES"}),this.manifest.allowCache=!0)},byterange:function t(){var t={};"length"in e&&(i.byterange=t,t.length=e.length,"offset"in e||(this.trigger("info",{message:"defaulting offset to zero"}),e.offset=0)),"offset"in e&&(i.byterange=t,t.offset=e.offset)},endlist:function(){this.manifest.endList=!0},inf:function(){"mediaSequence"in this.manifest||(this.manifest.mediaSequence=0,this.trigger("info",{message:"defaulting media sequence to zero"})),"discontinuitySequence"in this.manifest||(this.manifest.discontinuitySequence=0,this.trigger("info",{message:"defaulting discontinuity sequence to zero"})),e.duration>=0&&(i.duration=e.duration),this.manifest.segments=n},key:function(){return e.attributes?"NONE"===e.attributes.METHOD?void(r=null):e.attributes.URI?(e.attributes.METHOD||this.trigger("warn",{message:"defaulting key method to AES-128"}),r={method:e.attributes.METHOD||"AES-128",uri:e.attributes.URI},void("undefined"!=typeof e.attributes.IV&&(r.iv=e.attributes.IV))):void this.trigger("warn",{message:"ignoring key declaration without URI"}):void this.trigger("warn",{message:"ignoring key declaration without attribute list"})},"media-sequence":function(){return isFinite(e.number)?void(this.manifest.mediaSequence=e.number):void this.trigger("warn",{message:"ignoring invalid media sequence: "+e.number})},"discontinuity-sequence":function(){return isFinite(e.number)?void(this.manifest.discontinuitySequence=e.number):void this.trigger("warn",{message:"ignoring invalid discontinuity sequence: "+e.number})},"playlist-type":function(){return/VOD|EVENT/.test(e.playlistType)?void(this.manifest.playlistType=e.playlistType):void this.trigger("warn",{message:"ignoring unknown playlist type: "+e.playlist})},"stream-inf":function(){return this.manifest.playlists=n,e.attributes?(i.attributes||(i.attributes={}),void(i.attributes=(0,m.mergeOptions)(i.attributes,e.attributes))):void this.trigger("warn",{message:"ignoring empty stream-inf attributes"})},discontinuity:function(){i.discontinuity=!0,this.manifest.discontinuityStarts.push(n.length)},targetduration:function(){return!isFinite(e.duration)||e.duration<0?void this.trigger("warn",{message:"ignoring invalid target duration: "+e.duration}):void(this.manifest.targetDuration=e.duration)},totalduration:function(){return!isFinite(e.duration)||e.duration<0?void this.trigger("warn",{message:"ignoring invalid total duration: "+e.duration}):void(this.manifest.totalDuration=e.duration)}})[e.tagType]||a).call(t)},uri:function(){i.uri=e.uri,n.push(i),!this.manifest.targetDuration||"duration"in i||(this.trigger("warn",{message:"defaulting segment duration to the target duration"}),i.duration=this.manifest.targetDuration),r&&(i.key=r),i={}},comment:function(){}})[e.type].call(t)})}return a(e,t),s(e,[{key:"push",value:function(t){this.lineStream.push(t)}},{key:"end",value:function(){this.lineStream.push("\n")}}]),e}(u.default);n.default=v,e.exports=n.default}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../stream":13,"./line-stream":7,"./parse-stream":8}],10:[function(t,e,n){(function(i){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),c=function(t,e,n){for(var i=!0;i;){var r=t,o=e,a=n;i=!1,null===r&&(r=Function.prototype);var s=Object.getOwnPropertyDescriptor(r,o);if(void 0!==s){if("value"in s)return s.value;var c=s.get;if(void 0===c)return;return c.call(a)}var l=Object.getPrototypeOf(r);if(null===l)return;t=l,e=o,n=a,i=!0,s=l=void 0}},l=t("./resolve-url"),u=r(l),h=t("./xhr"),p=r(h),d="undefined"!=typeof window?window.videojs:"undefined"!=typeof i?i.videojs:null,f=t("./stream"),m=r(f),v=t("./m3u8"),g=r(v),y=function(t,e){for(var n=!1,i=(0,d.mergeOptions)(t,{}),r=t.playlists.length,o=void 0;r--;)if(o=i.playlists[r],o.uri===e.uri){if(o.segments&&e.segments&&o.segments.length===e.segments.length&&o.mediaSequence===e.mediaSequence)continue;i.playlists[r]=(0,d.mergeOptions)(o,e),i.playlists[e.uri]=i.playlists[r],o.segments&&(i.playlists[r].segments=E(o.segments,e.segments,e.mediaSequence-o.mediaSequence)),n=!0}return n?i:null},E=function(t,e,n){var i=e.slice(),r=void 0,o=void 0;for(n=n||0,r=Math.min(t.length,e.length+n),o=n;r>o;o++)i[o-n]=(0,d.mergeOptions)(t[o],i[o-n]);return i},_=function(t){function e(t,n){o(this,e),c(Object.getPrototypeOf(e.prototype),"constructor",this).call(this);var i=this,r=void 0,a=void 0,s=void 0,l=void 0,h=void 0;if(this.trackExpiredTime_=!1,!t)throw new Error("A non-empty playlist URL is required");l=function(t,e,n){i.setBandwidth(s||t),s=null,n&&(i.state=n),i.error={playlist:i.master.playlists[e],status:t.status,message:"HLS playlist request error at URL: "+e,responseText:t.responseText,code:t.status>=500?4:2},i.trigger("error")},h=function(t,e){var n=void 0,r=void 0,o=void 0;i.setBandwidth(s||t),s=null,i.state="HAVE_METADATA",n=new g.default.Parser,n.push(t.responseText),n.end(),n.manifest.uri=e,o=y(i.master,n.manifest),r=1e3*(n.manifest.targetDuration||10),o?(i.master=o,i.updateMediaPlaylist_(n.manifest)):r/=2,i.media().endList||(window.clearTimeout(a),a=window.setTimeout(function(){i.trigger("mediaupdatetimeout")},r)),i.trigger("loadedplaylist")},i.state="HAVE_NOTHING",this.expired_=0,r=this.dispose,i.dispose=function(){s&&(s.onreadystatechange=null,s.abort(),s=null),window.clearTimeout(a),r.call(this)},i.media=function(t){var e=i.state,r=void 0;if(!t)return i.media_;if("HAVE_NOTHING"===i.state)throw new Error("Cannot switch media playlist from "+i.state);if("string"==typeof t){if(!i.master.playlists[t])throw new Error("Unknown playlist URI: "+t);t=i.master.playlists[t]}if(r=!i.media_||t.uri!==i.media_.uri,i.master.playlists[t.uri].endList)return s&&(s.onreadystatechange=null,s.abort(),s=null),i.state="HAVE_METADATA",i.media_=t,void(r&&i.trigger("mediachange"));if(r){if(i.state="SWITCHING_MEDIA",s){if((0,u.default)(i.master.uri,t.uri)===s.url)return;s.onreadystatechange=null,s.abort(),s=null}s=(0,p.default)({uri:(0,u.default)(i.master.uri,t.uri),withCredentials:n},function(n,r){return n?l(r,t.uri,e):(h(r,t.uri),void("HAVE_MASTER"===e?i.trigger("loadedmetadata"):i.trigger("mediachange")))})}},i.setBandwidth=function(t){i.bandwidth=t.bandwidth},i.on("firstplay",function(){this.trackExpiredTime_=!0}),i.on("mediaupdatetimeout",function(){"HAVE_METADATA"===i.state&&(i.state="HAVE_CURRENT_METADATA",s=(0,p.default)({uri:(0,u.default)(i.master.uri,i.media().uri),withCredentials:n},function(t,e){return t?l(e,i.media().uri):void h(e,i.media().uri)}))}),s=(0,p.default)({uri:t,withCredentials:n},function(e,n){var r=void 0,o=void 0;if(s=null,e)return i.error={status:n.status,message:"HLS playlist request error at URL: "+t,responseText:n.responseText,code:2},i.trigger("error");if(r=new g.default.Parser,r.push(n.responseText),r.end(),i.state="HAVE_MASTER",r.manifest.uri=t,r.manifest.playlists){for(i.master=r.manifest,o=i.master.playlists.length;o--;)i.master.playlists[i.master.playlists[o].uri]=i.master.playlists[o];return i.trigger("loadedplaylist"),void(s||i.media(r.manifest.playlists[0]))}return i.master={uri:window.location.href,playlists:[{uri:t}]},i.master.playlists[t]=i.master.playlists[0],h(n,t),i.trigger("loadedmetadata")})}return a(e,t),s(e,[{key:"updateMediaPlaylist_",value:function(t){var e=void 0,n=void 0,i=void 0;if(e=this.media_,this.media_=this.master.playlists[t.uri],e&&this.trackExpiredTime_&&t.uri===e.uri){if(t.segments.length){if(void 0!==t.segments[0].start)return void(this.expired_=t.segments[0].start);if(void 0!==t.segments[0].end)return void(this.expired_=t.segments[0].end-t.segments[0].duration)}for(n=t.mediaSequence-e.mediaSequence-1;n>=0;n--)if(i=e.segments[n]){if(void 0!==i.end)return void(this.expired_=i.end);if(void 0!==i.start)return void(this.expired_=i.start+i.duration);this.expired_+=i.duration}else this.expired_+=e.targetDuration||10}}},{key:"getMediaIndexForTime_",value:function(t){var e=void 0,n=void 0,i=t,r=this.media_.segments.length,o=r-1,a=void 0,s=void 0,c=void 0,l=void 0;if(!this.media_)return 0;if(0>t)return 0;for(e=0;r>e;e++)if(n=this.media_.segments[e],n.end){if(n.end>t){l=n.end,s=e;break}c=n.end,a=e+1}if(void 0!==a){for(t-=c,e=a;(s||r)>e;e++)if(n=this.media_.segments[e],t-=n.duration,0>t)return e;return e>=s?a+Math.floor((i-c)/(l-c)*(s-a)):o}if(void 0!==s){for(t=l-t,e=s;e>=0;e--)if(n=this.media_.segments[e],t-=n.duration,0>t)return e;return 0===t?0:-1}if(t-=this.expired_,0>t)return-1;for(e=0;r>e;e++)if(n=this.media_.segments[e],t-=n.duration,0>t)return e;return o}}]),e}(m.default);n.default=_,e.exports=n.default}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./m3u8":6,"./resolve-url":12,"./stream":13,"./xhr":14}],11:[function(t,e,n){(function(t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var e="undefined"!=typeof window?window.videojs:"undefined"!=typeof t?t.videojs:null,i={UNSAFE_LIVE_SEGMENTS:3},r=function(t,e){var n=0,i=e-t.mediaSequence,r=t.segments[i];if(r){if("undefined"!=typeof r.start)return{result:r.start,precise:!0};if("undefined"!=typeof r.end)return{result:r.end-r.duration,precise:!0}}for(;i--;){if(r=t.segments[i],"undefined"!=typeof r.end)return{result:n+r.end,precise:!0};if(n+=r.duration,"undefined"!=typeof r.start)return{result:n+r.start,precise:!0}}return{result:n,precise:!1}},o=function(t,e){for(var n=0,i=void 0,r=e-t.mediaSequence;r<t.segments.length;r++){if(i=t.segments[r],"undefined"!=typeof i.start)return{result:i.start-n,precise:!0};if(n+=i.duration,"undefined"!=typeof i.end)return{result:i.end-n,precise:!0}}return{result:-1,precise:!1}},a=function(t,e){var n=void 0,i=void 0;return"undefined"==typeof e&&(e=t.mediaSequence+t.segments.length),e<t.mediaSequence?0:(n=r(t,e),n.precise?n.result:(i=o(t,e),i.precise?i.result:n.result))},s=function(t,e,n){if(!t)return 0;if("undefined"==typeof n&&(n=!0),"undefined"==typeof e){if(t.totalDuration)return t.totalDuration;if(!t.endList)return window.Infinity}return a(t,e,n)};n.duration=s;var c=function(t){var n=void 0,r=void 0;return t.segments?t.endList?(0,e.createTimeRange)(0,s(t)):(n=a(t,t.mediaSequence),r=a(t,t.mediaSequence+Math.max(0,t.segments.length-i.UNSAFE_LIVE_SEGMENTS)),(0,e.createTimeRange)(n,r)):(0,e.createTimeRange)()};n.seekable=c,i.duration=s,i.seekable=c,n.default=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],12:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(n,"__esModule",{value:!0});var r=t("global/document"),o=i(r),a=function(t,e){var n=o.default.querySelector("base"),i=o.default.querySelector("head"),r=o.default.createElement("a"),a=n,s=void 0,c=void 0;return n?s=n.href:a=i.appendChild(o.default.createElement("base")),a.href=t,r.href=e,c=r.href,n?n.href=s:i.removeChild(a),c};n.default=a,e.exports=n.default},{"global/document":16}],13:[function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=function(){function t(){i(this,t),this.listeners={}}return r(t,[{key:"on",value:function(t,e){this.listeners[t]||(this.listeners[t]=[]),this.listeners[t].push(e)}},{key:"off",value:function(t,e){var n=void 0;return!!this.listeners[t]&&(n=this.listeners[t].indexOf(e),this.listeners[t].splice(n,1),n>-1)}},{key:"trigger",value:function(t){var e=void 0,n=void 0,i=void 0,r=void 0;if(e=this.listeners[t])if(2===arguments.length)for(i=e.length,n=0;i>n;++n)e[n].call(this,arguments[1]);else for(r=Array.prototype.slice.call(arguments,1),i=e.length,n=0;i>n;++n)e[n].apply(this,r)}},{key:"dispose",value:function(){this.listeners={}}},{key:"pipe",value:function(t){this.on("data",function(e){t.push(e)})}}]),t}();n.default=o,e.exports=n.default},{}],14:[function(t,e,n){(function(t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i="undefined"!=typeof window?window.videojs:"undefined"!=typeof t?t.videojs:null,r=function(t,e){t=(0,i.mergeOptions)({timeout:45e3},t);var n=(0,i.xhr)(t,function(t,i){!t&&n.response&&(n.responseTime=(new Date).getTime(),n.roundTripTime=n.responseTime-n.requestTime,n.bytesReceived=n.response.byteLength||n.response.length,n.bandwidth||(n.bandwidth=Math.floor(n.bytesReceived/n.roundTripTime*8*1e3))),t||n.timedout?n.timedout=n.timedout||"ETIMEDOUT"===t.code:n.timedout=!1,t||200===i.statusCode||206===i.statusCode||0===i.statusCode||(t=new Error("XHR Failed with a response of: "+(n&&(n.response||n.responseText)))),e(t,n)});return n.requestTime=(new Date).getTime(),n};n.default=r,e.exports=n.default}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],15:[function(t,e,n){},{}],16:[function(t,e,n){(function(n){var i="undefined"!=typeof n?n:"undefined"!=typeof window?window:{},r=t("min-document");if("undefined"!=typeof document)e.exports=document;else{var o=i["__GLOBAL_DOCUMENT_CACHE@4"];o||(o=i["__GLOBAL_DOCUMENT_CACHE@4"]=r),e.exports=o}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"min-document":15}],17:[function(t,e,n){"use strict";var i;e.exports=function(t){var e=i[t.byteLength%16||0],n=new Uint8Array(t.byteLength+e.length);return n.set(t),n.set(e,t.byteLength),n},i=[[16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16],[15,15,15,15,15,15,15,15,15,15,15,15,15,15,15],[14,14,14,14,14,14,14,14,14,14,14,14,14,14],[13,13,13,13,13,13,13,13,13,13,13,13,13],[12,12,12,12,12,12,12,12,12,12,12,12],[11,11,11,11,11,11,11,11,11,11,11],[10,10,10,10,10,10,10,10,10,10],[9,9,9,9,9,9,9,9,9],[8,8,8,8,8,8,8,8],[7,7,7,7,7,7,7],[6,6,6,6,6,6],[5,5,5,5,5],[4,4,4,4],[3,3,3],[2,2],[1]]},{}],18:[function(t,e,n){"use strict";n.pad=t("./pad.js"),n.unpad=t("./unpad.js")},{"./pad.js":17,"./unpad.js":19}],19:[function(t,e,n){"use strict";e.exports=function(t){return t.subarray(0,t.byteLength-t[t.byteLength-1])}},{}],20:[function(t,e,n){(function(t){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(n,"__esModule",{value:!0});var r="undefined"!=typeof window?window.videojs:"undefined"!=typeof t?t.videojs:null,o=i(r),a=function(t){Object.defineProperties(t.frame,{id:{get:function(){return o.default.log.warn("cue.frame.id is deprecated. Use cue.value.key instead."),t.value.key}},value:{get:function(){return o.default.log.warn("cue.frame.value is deprecated. Use cue.value.data instead."),t.value.data}},privateData:{get:function(){return o.default.log.warn("cue.frame.privateData is deprecated. Use cue.value.data instead."),t.value.data}}})},s=function(t,e,n){var i=window.WebKitDataCue||window.VTTCue;e&&e.forEach(function(t){this.inbandTextTrack_.addCue(new i(t.startTime+this.timestampOffset,t.endTime+this.timestampOffset,t.text))},t),n&&n.forEach(function(t){var e=t.cueTime+this.timestampOffset;t.frames.forEach(function(t){var n=new i(e,e,t.value||t.url||t.data||"");n.frame=t,n.value=t,a(n),this.metadataTrack_.addCue(n)},this)},t)};n.default=s,e.exports=n.default}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});
},{}],21:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function(t,e,n){n.captions&&n.captions.length&&!t.inbandTextTrack_&&(t.inbandTextTrack_=e.player_.addTextTrack("captions","cc1")),n.metadata&&n.metadata.length&&!t.metadataTrack_&&(t.metadataTrack_=e.player_.addTextTrack("metadata","Timed Metadata"),t.metadataTrack_.inBandMetadataTrackDispatchType=n.metadata.dispatchType)};n.default=i,e.exports=n.default},{}],22:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i={TIME_BETWEEN_TICKS:Math.floor(1e3/480),TIME_PER_TICK:Math.floor(1e3/240),BYTES_PER_CHUNK:1024,MIN_CHUNK:1024,MAX_CHUNK:1048576};n.default=i,e.exports=n.default},{}],23:[function(t,e,n){(function(i){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),c=function(t,e,n){for(var i=!0;i;){var r=t,o=e,a=n;i=!1,null===r&&(r=Function.prototype);var s=Object.getOwnPropertyDescriptor(r,o);if(void 0!==s){if("value"in s)return s.value;var c=s.get;if(void 0===c)return;return c.call(a)}var l=Object.getPrototypeOf(r);if(null===l)return;t=l,e=o,n=a,i=!0,s=l=void 0}},l="undefined"!=typeof window?window.videojs:"undefined"!=typeof i?i.videojs:null,u=r(l),h=t("./flash-source-buffer"),p=r(h),d=t("./flash-constants"),f=r(d),m=function(t){function e(){var t=this;o(this,e),c(Object.getPrototypeOf(e.prototype),"constructor",this).call(this),this.sourceBuffers=[],this.readyState="closed",this.on(["sourceopen","webkitsourceopen"],function(e){t.swfObj=document.getElementById(e.swfId),t.player_=(0,u.default)(t.swfObj.parentNode),t.tech_=t.swfObj.tech,t.readyState="open",t.tech_.on("seeking",function(){for(var e=t.sourceBuffers.length;e--;)t.sourceBuffers[e].abort()}),t.swfObj&&t.swfObj.vjs_load()})}return a(e,t),s(e,[{key:"addSeekableRange_",value:function(){}},{key:"addSourceBuffer",value:function(t){var e=void 0;if(0!==t.indexOf("video/mp2t"))throw new Error("NotSupportedError (Video.js)");return e=new p.default(this),this.sourceBuffers.push(e),e}},{key:"endOfStream",value:function(t){"network"===t?this.tech_.error(2):"decode"===t&&this.tech_.error(3),"ended"!==this.readyState&&(this.readyState="ended",this.swfObj.vjs_endOfStream())}}]),e}(u.default.EventTarget);n.default=m;try{Object.defineProperty(m.prototype,"duration",{get:function(){return this.swfObj?this.swfObj.vjs_getProperty("duration"):NaN},set:function(t){var e=void 0,n=this.swfObj.vjs_getProperty("duration");if(this.swfObj.vjs_setProperty("duration",t),n>t)for(e=0;e<this.sourceBuffers.length;e++)this.sourceBuffers[e].remove(t,n);return t}})}catch(t){m.prototype.duration=NaN}for(var v in f.default)m[v]=f.default[v];e.exports=n.default}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./flash-constants":22,"./flash-source-buffer":24}],24:[function(t,e,n){(function(i){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),c=function(t,e,n){for(var i=!0;i;){var r=t,o=e,a=n;i=!1,null===r&&(r=Function.prototype);var s=Object.getOwnPropertyDescriptor(r,o);if(void 0!==s){if("value"in s)return s.value;var c=s.get;if(void 0===c)return;return c.call(a)}var l=Object.getPrototypeOf(r);if(null===l)return;t=l,e=o,n=a,i=!0,s=l=void 0}},l="undefined"!=typeof window?window.videojs:"undefined"!=typeof i?i.videojs:null,u=r(l),h=t("mux.js"),p=r(h),d=t("./remove-cues-from-track"),f=r(d),m=t("./create-text-tracks-if-necessary"),v=r(m),g=t("./add-text-track-data"),y=r(g),E=t("./flash-constants"),_=r(E),T=function(t){window.setTimeout(t,_.default.TIME_BETWEEN_TICKS)},b=function(t){function e(t){var n=this;o(this,e),c(Object.getPrototypeOf(e.prototype),"constructor",this).call(this);var i=void 0;this.chunkSize_=_.default.BYTES_PER_CHUNK,this.buffer_=[],this.bufferSize_=0,this.basePtsOffset_=NaN,this.mediaSource=t,this.updating=!1,this.timestampOffset_=0,this.segmentParser_=new p.default.flv.Transmuxer,this.segmentParser_.on("data",this.receiveBuffer_.bind(this)),i=window.btoa(String.fromCharCode.apply(null,Array.prototype.slice.call(this.segmentParser_.getFlvHeader()))),this.mediaSource.swfObj.vjs_appendBuffer(i),Object.defineProperty(this,"timestampOffset",{get:function(){return this.timestampOffset_},set:function(t){"number"==typeof t&&t>=0&&(this.timestampOffset_=t,this.segmentParser_=new p.default.flv.Transmuxer,this.segmentParser_.on("data",this.receiveBuffer_.bind(this)),this.mediaSource.swfObj.vjs_discontinuity(),this.basePtsOffset_=NaN)}}),Object.defineProperty(this,"buffered",{get:function(){return u.default.createTimeRanges(this.mediaSource.swfObj.vjs_getProperty("buffered"))}}),this.mediaSource.player_.on("seeked",function(){(0,f.default)(0,1/0,n.metadataTrack_),(0,f.default)(0,1/0,n.inbandTextTrack_)})}return a(e,t),s(e,[{key:"appendBuffer",value:function(t){var e=this,n=void 0,i=524288,r=0;if(this.updating)throw n=new Error("SourceBuffer.append() cannot be called while an update is in progress"),n.name="InvalidStateError",n.code=11,n;this.updating=!0,this.mediaSource.readyState="open",this.trigger({type:"update"});var o=function n(){e.segmentParser_.push(t.subarray(r,r+i)),r+=i,T(r<t.byteLength?n:e.segmentParser_.flush.bind(e.segmentParser_))};o()}},{key:"abort",value:function(){this.buffer_=[],this.bufferSize_=0,this.mediaSource.swfObj.vjs_abort(),this.updating&&(this.updating=!1,this.trigger({type:"updateend"}))}},{key:"remove",value:function(t,e){(0,f.default)(t,e,this.metadataTrack_),(0,f.default)(t,e,this.inbandTextTrack_),this.trigger({type:"update"}),this.trigger({type:"updateend"})}},{key:"receiveBuffer_",value:function(t){var e=this;(0,v.default)(this,this.mediaSource,t),(0,y.default)(this,t.captions,t.metadata),T(function(){var n=e.convertTagsToData_(t);0===e.buffer_.length&&T(e.processBuffer_.bind(e)),n&&(e.buffer_.push(n),e.bufferSize_+=n.byteLength)})}},{key:"processBuffer_",value:function(){var t=void 0,e=void 0,n=void 0,i=void 0,r=void 0,o=0,a=0,s=+new Date,c=void 0;if(!this.buffer_.length)return void(this.updating!==!1&&(this.updating=!1,this.trigger({type:"updateend"})));do{for(a++,t=this.buffer_[0].subarray(o,o+this.chunkSize_),t.byteLength<this.chunkSize_||this.buffer_[0].byteLength===o+this.chunkSize_?(o=0,this.buffer_.shift()):o+=this.chunkSize_,this.bufferSize_-=t.byteLength,i="",n=t.byteLength,e=0;n>e;e++)i+=String.fromCharCode(t[e]);r=window.btoa(i),this.mediaSource.swfObj.CallFunction('<invoke name="vjs_appendBuffer"returntype="javascript"><arguments><string>'+r+"</string></arguments></invoke>"),c=new Date-s}while(this.buffer_.length&&c<_.default.TIME_PER_TICK);this.buffer_.length&&o&&(this.buffer_[0]=this.buffer_[0].subarray(o)),c>=_.default.TIME_PER_TICK&&(this.chunkSize_=Math.floor(this.chunkSize_*(a/4))),this.chunkSize_=Math.max(_.default.MIN_CHUNK,Math.min(this.chunkSize_,_.default.MAX_CHUNK)),0!==this.bufferSize_?T(this.processBuffer_.bind(this)):(this.updating=!1,this.trigger({type:"updateend"}))}},{key:"convertTagsToData_",value:function(t){var e=0,n=this.mediaSource.tech_,i=0,r=void 0,o=void 0,a=void 0,s=[],c=this.getOrderedTags_(t);for(isNaN(this.basePtsOffset_)&&c.length&&(this.basePtsOffset_=c[0].pts),n.buffered().length&&(i=n.buffered().end(0)-this.timestampOffset),i=Math.max(i,n.currentTime()-this.timestampOffset),i*=1e3,i+=this.basePtsOffset_,r=0;r<c.length;r++)c[r].pts>=i&&s.push(c[r]);if(0!==s.length){for(r=0;r<s.length;r++)e+=s[r].bytes.byteLength;for(a=new Uint8Array(e),r=0,o=0;r<s.length;r++)a.set(s[r].bytes,o),o+=s[r].bytes.byteLength;return a}}},{key:"getOrderedTags_",value:function(t){for(var e=t.tags.videoTags,n=t.tags.audioTags,i=void 0,r=[];e.length||n.length;)i=e.length?n.length&&n[0].dts<e[0].dts?n.shift():e.shift():n.shift(),r.push(i.finalize());return r}}]),e}(u.default.EventTarget);n.default=b,e.exports=n.default}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./add-text-track-data":20,"./create-text-tracks-if-necessary":21,"./flash-constants":22,"./remove-cues-from-track":26,"mux.js":37}],25:[function(t,e,n){(function(i){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),c=function(t,e,n){for(var i=!0;i;){var r=t,o=e,a=n;i=!1,null===r&&(r=Function.prototype);var s=Object.getOwnPropertyDescriptor(r,o);if(void 0!==s){if("value"in s)return s.value;var c=s.get;if(void 0===c)return;return c.call(a)}var l=Object.getPrototypeOf(r);if(null===l)return;t=l,e=o,n=a,i=!0,s=l=void 0}},l="undefined"!=typeof window?window.videojs:"undefined"!=typeof i?i.videojs:null,u=r(l),h=t("./virtual-source-buffer"),p=r(h),d=function(t){return t.replace(/avc1\.(\d+)\.(\d+)/i,function(t,e,n){var i=("00"+Number(e).toString(16)).slice(-2),r=("00"+Number(n).toString(16)).slice(-2);return"avc1."+i+"00"+r})},f=function(t){function e(){o(this,e),c(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,u.default.EventTarget);var t=this,n=void 0;this.mediaSource_=new window.MediaSource;for(n in this.mediaSource_)n in e.prototype||"function"!=typeof this.mediaSource_[n]||(this[n]=this.mediaSource_[n].bind(this.mediaSource_));this.duration_=NaN,Object.defineProperty(this,"duration",{get:function(){return t.duration_===1/0?t.duration_:t.mediaSource_.duration},set:function(e){return t.duration_=e,e!==1/0?void(t.mediaSource_.duration=e):void 0}}),Object.defineProperty(this,"seekable",{get:function(){return this.duration_===1/0?u.default.createTimeRanges([[0,t.mediaSource_.duration]]):t.mediaSource_.seekable}}),Object.defineProperty(this,"readyState",{get:function(){return t.mediaSource_.readyState}}),this.sourceBuffers=[],["sourceopen","sourceclose","sourceended"].forEach(function(t){this.mediaSource_.addEventListener(t,this.trigger.bind(this))},this),this.on("sourceopen",function(e){var n=document.querySelector('[src="'+t.url_+'"]');n&&(t.player_=(0,u.default)(n.parentNode))}),this.on("sourceclose",function(t){this.sourceBuffers.forEach(function(t){t.transmuxer_&&t.transmuxer_.terminate()}),this.sourceBuffers.length=0})}return a(e,t),s(e,[{key:"addSeekableRange_",value:function(t,e){var n=void 0;if(this.duration!==1/0)throw n=new Error("MediaSource.addSeekableRange() can only be invoked when the duration is Infinity"),n.name="InvalidStateError",n.code=11,n;(e>this.mediaSource_.duration||isNaN(this.mediaSource_.duration))&&(this.mediaSource_.duration=e)}},{key:"addSourceBuffer",value:function(t){var e=void 0,n=void 0,i=void 0,r=void 0,o=/avc1\.[\da-f]+/i,a=/mp4a\.\d+.\d+/i;return/^video\/mp2t/i.test(t)?(n=t.split(";").slice(1).join(";"),n=d(n),i=(n.match(o)||[])[0],r=(n.match(a)||[])[0],i&&i.length||(i="avc1.4d400d"),r&&r.length||(r="mp4a.40.2"),e=new p.default(this,[i,r]),this.sourceBuffers.push(e),e):(e=this.mediaSource_.addSourceBuffer(t),this.sourceBuffers.push(e),e)}}]),e}(u.default.EventTarget);n.default=f,e.exports=n.default}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./virtual-source-buffer":29}],26:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function(t,e,n){var i=void 0,r=void 0;if(n)for(i=n.cues.length;i--;)r=n.cues[i],r.startTime<=e&&r.endTime>=t&&n.removeCue(r)};n.default=i,e.exports=n.default},{}],27:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(n,"__esModule",{value:!0});var r=t("mux.js"),o=i(r),a=void 0,s={},c=function(t){t.on("data",function(t){var e=t.data;t.data=e.buffer,postMessage({action:"data",segment:t,byteOffset:e.byteOffset,byteLength:e.byteLength},[t.data])}),t.captionStream&&t.captionStream.on("data",function(t){postMessage({action:"caption",data:t})}),t.on("done",function(t){postMessage({action:"done"})})},l={init:function(t){s=t&&t.options||{},this.defaultInit()},defaultInit:function(){a&&a.dispose(),a=new o.default.mp4.Transmuxer(s),c(a)},push:function(t){var e=new Uint8Array(t.data,t.byteOffset,t.byteLength);a.push(e)},reset:function(){this.defaultInit()},setTimestampOffset:function(t){var e=t.timestampOffset||0;a.setBaseMediaDecodeTime(Math.round(9e4*e))},flush:function(t){a.flush()}},u=function(t){t.onmessage=function(t){a||"init"===t.data.action||l.defaultInit(),t.data&&t.data.action&&l[t.data.action]&&l[t.data.action](t.data)}};n.default=u,e.exports=n.default},{"mux.js":37}],28:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(n,"__esModule",{value:!0});var r=t("./flash-media-source"),o=i(r),a=t("./html-media-source"),s=i(a),c=window.videojs,l=0,u={mode:"auto"};c.mediaSources={};var h=function(t,e){var n=c.mediaSources[t];if(!n)throw new Error("Media Source not found (Video.js)");n.trigger({type:"sourceopen",swfId:e})},p=function(){return!!window.MediaSource&&window.MediaSource.isTypeSupported('video/mp4;codecs="avc1.4d400d,mp4a.40.2"')},d=function(t){var e=c.mergeOptions(u,t);return this.MediaSource={open:h,supportsNativeMediaSources:p},"html5"===e.mode||"auto"===e.mode&&p()?new s.default:new o.default};n.MediaSource=d,d.open=h,d.supportsNativeMediaSources=p;var f={createObjectURL:function(t){var e="blob:vjs-media-source/",n=void 0;return t instanceof s.default?(n=window.URL.createObjectURL(t.mediaSource_),t.url_=n,n):t instanceof o.default?(n=e+l,l++,c.mediaSources[n]=t,n):(n=window.URL.createObjectURL(t),t.url_=n,n)}};n.URL=f,c.MediaSource=d,c.URL=f},{"./flash-media-source":23,"./html-media-source":25}],29:[function(t,e,n){(function(i){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),c=function(t,e,n){for(var i=!0;i;){var r=t,o=e,a=n;i=!1,null===r&&(r=Function.prototype);var s=Object.getOwnPropertyDescriptor(r,o);if(void 0!==s){if("value"in s)return s.value;var c=s.get;if(void 0===c)return;return c.call(a)}var l=Object.getPrototypeOf(r);if(null===l)return;t=l,e=o,n=a,i=!0,s=l=void 0}},l="undefined"!=typeof window?window.videojs:"undefined"!=typeof i?i.videojs:null,u=r(l),h=t("./create-text-tracks-if-necessary"),p=r(h),d=t("./remove-cues-from-track"),f=r(d),m=t("./add-text-track-data"),v=r(m),g=t("webworkify"),y=r(g),E=t("./transmuxer-worker"),_=r(E),T=function(t,e,n){return function(){return t[e]&&t[e].updating?void 0:t.trigger(n)}},b=function(t){function e(t,n){var i=this;o(this,e),c(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,u.default.EventTarget),this.timestampOffset_=0,this.pendingBuffers_=[],this.bufferUpdating_=!1,this.mediaSource_=t,this.codecs_=n,this.transmuxer_=(0,y.default)(_.default),this.transmuxer_.postMessage({action:"init",options:{remux:!1}}),this.transmuxer_.onmessage=function(t){return"data"===t.data.action?i.data_(t):"done"===t.data.action?i.done_(t):void 0},Object.defineProperty(this,"timestampOffset",{get:function(){return this.timestampOffset_},set:function(t){"number"==typeof t&&t>=0&&(this.timestampOffset_=t,this.transmuxer_.postMessage({action:"setTimestampOffset",timestampOffset:t}))}}),Object.defineProperty(this,"appendWindowStart",{get:function(){return(this.videoBuffer_||this.audioBuffer_).appendWindowStart},set:function(t){this.videoBuffer_&&(this.videoBuffer_.appendWindowStart=t),this.audioBuffer_&&(this.audioBuffer_.appendWindowStart=t)}}),Object.defineProperty(this,"updating",{get:function(){return this.bufferUpdating_||this.audioBuffer_&&this.audioBuffer_.updating||this.videoBuffer_&&this.videoBuffer_.updating}}),Object.defineProperty(this,"buffered",{get:function(){var t=null,e=null,n=0,i=[],r=[];if(!(this.videoBuffer_&&0!==this.videoBuffer_.buffered.length||this.audioBuffer_&&0!==this.audioBuffer_.buffered.length))return u.default.createTimeRange();if(!this.videoBuffer_)return this.audioBuffer_.buffered;if(!this.audioBuffer_)return this.videoBuffer_.buffered;for(var o=this.videoBuffer_.buffered,a=this.audioBuffer_.buffered,s=o.length;s--;)i.push({time:o.start(s),type:"start"}),i.push({time:o.end(s),type:"end"});for(s=a.length;s--;)i.push({time:a.start(s),type:"start"}),i.push({time:a.end(s),type:"end"});for(i.sort(function(t,e){return t.time-e.time}),s=0;s<i.length;s++)"start"===i[s].type?(n++,2===n&&(t=i[s].time)):"end"===i[s].type&&(n--,1===n&&(e=i[s].time)),null!==t&&null!==e&&(r.push([t,e]),t=null,e=null);return u.default.createTimeRanges(r)}})}return a(e,t),s(e,[{key:"data_",value:function(t){var e=t.data.segment,n=this.mediaSource_.mediaSource_;e.data=new Uint8Array(e.data,t.data.byteOffset,t.data.byteLength),"video"===e.type?this.videoBuffer_||(this.videoBuffer_=n.addSourceBuffer('video/mp4;codecs="'+this.codecs_[0]+'"'),this.videoBuffer_.addEventListener("updatestart",T(this,"audioBuffer_","updatestart")),this.videoBuffer_.addEventListener("update",T(this,"audioBuffer_","update")),this.videoBuffer_.addEventListener("updateend",T(this,"audioBuffer_","updateend"))):"audio"===e.type?this.audioBuffer_||(this.audioBuffer_=n.addSourceBuffer('audio/mp4;codecs="'+this.codecs_[1]+'"'),this.audioBuffer_.addEventListener("updatestart",T(this,"videoBuffer_","updatestart")),this.audioBuffer_.addEventListener("update",T(this,"videoBuffer_","update")),this.audioBuffer_.addEventListener("updateend",T(this,"videoBuffer_","updateend"))):"combined"===e.type&&(this.videoBuffer_||(this.videoBuffer_=n.addSourceBuffer('video/mp4;codecs="'+this.codecs_.join(",")+'"'),this.videoBuffer_.addEventListener("updatestart",T(this,"videoBuffer_","updatestart")),this.videoBuffer_.addEventListener("update",T(this,"videoBuffer_","update")),this.videoBuffer_.addEventListener("updateend",T(this,"videoBuffer_","updateend")))),(0,p.default)(this,this.mediaSource_,e),this.pendingBuffers_.push(e)}},{key:"done_",value:function(){this.processPendingSegments_()}},{key:"appendBuffer",value:function(t){this.bufferUpdating_=!0,this.transmuxer_.postMessage({action:"push",data:t.buffer,byteOffset:t.byteOffset,byteLength:t.byteLength},[t.buffer]),this.transmuxer_.postMessage({action:"flush"})}},{key:"remove",value:function(t,e){this.videoBuffer_&&this.videoBuffer_.remove(t,e),this.audioBuffer_&&this.audioBuffer_.remove(t,e),(0,f.default)(t,e,this.metadataTrack_),(0,f.default)(t,e,this.inbandTextTrack_)}},{key:"processPendingSegments_",value:function(){var t={video:{segments:[],bytes:0},audio:{segments:[],bytes:0},captions:[],metadata:[]};t=this.pendingBuffers_.reduce(function(t,e){var n=e.type,i=e.data;return"combined"===n&&(n="video"),t[n].segments.push(i),t[n].bytes+=i.byteLength,e.captions&&(t.captions=t.captions.concat(e.captions)),e.metadata&&(t.metadata=t.metadata.concat(e.metadata)),t},t),(0,v.default)(this,t.captions,t.metadata),this.concatAndAppendSegments_(t.video,this.videoBuffer_),this.concatAndAppendSegments_(t.audio,this.audioBuffer_),this.pendingBuffers_.length=0,this.bufferUpdating_=!1}},{key:"concatAndAppendSegments_",value:function(t,e){var n=0,i=void 0;t.bytes&&(i=new Uint8Array(t.bytes),t.segments.forEach(function(t){i.set(t,n),n+=t.byteLength}),e.appendBuffer(i))}},{key:"abort",value:function(){this.videoBuffer_&&this.videoBuffer_.abort(),this.audioBuffer_&&this.audioBuffer_.abort(),this.transmuxer_&&this.transmuxer_.postMessage({action:"reset"}),this.pendingBuffers_.length=0,this.bufferUpdating_=!1}}]),e}(u.default.EventTarget);n.default=b,e.exports=n.default}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./add-text-track-data":20,"./create-text-tracks-if-necessary":21,"./remove-cues-from-track":26,"./transmuxer-worker":27,webworkify:50}],30:[function(t,e,n){"use strict";var i,r=t("../utils/stream.js");i=function(){var t,e=0;i.prototype.init.call(this),this.setTimestamp=function(t){e=t},this.parseId3TagSize=function(t,e){var n=t[e+6]<<21|t[e+7]<<14|t[e+8]<<7|t[e+9],i=t[e+5],r=(16&i)>>4;return r?n+20:n+10},this.parseAdtsSize=function(t,e){var n=(224&t[e+5])>>5,i=t[e+4]<<3,r=6144&t[e+3];return r|i|n},this.push=function(n){var i,r,o,a=0,s=0;for(void 0!==t&&t.length?(o=t.length,t=new Uint8Array(n.byteLength+o),t.set(t.subarray(0,o)),t.set(n,o)):t=n;t.length-s>=10;)if(t[s]!=="I".charCodeAt(0)||t[s+1]!=="D".charCodeAt(0)||t[s+2]!=="3".charCodeAt(0))if(t[s]&!0&&240===(240&t[s+1])){if(a=this.parseAdtsSize(t,s),a>t.length)break;r={type:"audio",data:t.subarray(s,s+a),pts:e,dts:e},this.trigger("data",r),s+=a}else s++;else{if(a=this.parseId3TagSize(t,s),a>t.length)break;i={type:"timed-metadata",data:t.subarray(s,s+a)},this.trigger("data",i),s+=a}}},i.prototype=new r,e.exports=i},{"../utils/stream.js":49}],31:[function(t,e,n){"use strict";var i,r=t("../utils/stream.js"),o=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];i=function(){var t,e;i.prototype.init.call(this),t=this,this.push=function(t){var n,i,r,a,s,c,l=0,u=0;if("audio"===t.type)for(e?(a=e,e=new Uint8Array(a.byteLength+t.data.byteLength),e.set(a),e.set(t.data,a.byteLength)):e=t.data;l+5<e.length;)if(255===e[l]&&240===(246&e[l+1])){if(i=2*(1&~e[l+1]),n=(3&e[l+3])<<11|e[l+4]<<3|(224&e[l+5])>>5,s=1024*((3&e[l+6])+1),c=9e4*s/o[(60&e[l+2])>>>2],r=l+n,e.byteLength<r)return;if(this.trigger("data",{pts:t.pts+u*c,dts:t.dts+u*c,sampleCount:s,audioobjecttype:(e[l+2]>>>6&3)+1,channelcount:(1&e[l+2])<<3|(192&e[l+3])>>>6,samplerate:o[(60&e[l+2])>>>2],samplingfrequencyindex:(60&e[l+2])>>>2,samplesize:16,data:e.subarray(l+7+i,r)}),e.byteLength===r)return void(e=void 0);u++,e=e.subarray(r)}else l++},this.flush=function(){this.trigger("done")}},i.prototype=new r,e.exports=i},{"../utils/stream.js":49}],32:[function(t,e,n){"use strict";var i,r,o=t("../utils/stream.js"),a=t("../utils/exp-golomb.js");r=function(){var t,e,n=0;r.prototype.init.call(this),this.push=function(i){var r;for(e?(r=new Uint8Array(e.byteLength+i.data.byteLength),r.set(e),r.set(i.data,e.byteLength),e=r):e=i.data;n<e.byteLength-3;n++)if(1===e[n+2]){t=n+5;break}for(;t<e.byteLength;)switch(e[t]){case 0:if(0!==e[t-1]){t+=2;break}if(0!==e[t-2]){t++;break}this.trigger("data",e.subarray(n+3,t-2));do t++;while(1!==e[t]&&t<e.length);n=t-2,t+=3;break;case 1:if(0!==e[t-1]||0!==e[t-2]){t+=3;break}this.trigger("data",e.subarray(n+3,t-2)),n=t-2,t+=3;break;default:t+=3}e=e.subarray(n),t-=n,n=0},this.flush=function(){e&&e.byteLength>3&&this.trigger("data",e.subarray(n+3)),e=null,n=0,this.trigger("done")}},r.prototype=new o,i=function(){var t,e,n,o,s,c,l,u=new r;i.prototype.init.call(this),t=this,this.push=function(t){"video"===t.type&&(e=t.trackId,n=t.pts,o=t.dts,u.push(t))},u.on("data",function(i){var r={trackId:e,pts:n,dts:o,data:i};switch(31&i[0]){case 5:r.nalUnitType="slice_layer_without_partitioning_rbsp_idr";break;case 6:r.nalUnitType="sei_rbsp",r.escapedRBSP=s(i.subarray(1));break;case 7:r.nalUnitType="seq_parameter_set_rbsp",r.escapedRBSP=s(i.subarray(1)),r.config=c(r.escapedRBSP);break;case 8:r.nalUnitType="pic_parameter_set_rbsp";break;case 9:r.nalUnitType="access_unit_delimiter_rbsp"}t.trigger("data",r)}),u.on("done",function(){t.trigger("done")}),this.flush=function(){u.flush()},l=function(t,e){var n,i,r=8,o=8;for(n=0;t>n;n++)0!==o&&(i=e.readExpGolomb(),o=(r+i+256)%256),r=0===o?r:o},s=function(t){for(var e,n,i=t.byteLength,r=[],o=1;i-2>o;)0===t[o]&&0===t[o+1]&&3===t[o+2]?(r.push(o+2),o+=2):o++;if(0===r.length)return t;e=i-r.length,n=new Uint8Array(e);var a=0;for(o=0;e>o;a++,o++)a===r[0]&&(a++,r.shift()),n[o]=t[a];return n},c=function(t){var e,n,i,r,o,s,c,u,h,p,d,f,m=0,v=0,g=0,y=0;if(e=new a(t),n=e.readUnsignedByte(),r=e.readUnsignedByte(),i=e.readUnsignedByte(),e.skipUnsignedExpGolomb(),(100===n||110===n||122===n||244===n||44===n||83===n||86===n||118===n||128===n||138===n||139===n||134===n)&&(o=e.readUnsignedExpGolomb(),3===o&&e.skipBits(1),e.skipUnsignedExpGolomb(),e.skipUnsignedExpGolomb(),e.skipBits(1),e.readBoolean()))for(d=3!==o?8:12,f=0;d>f;f++)e.readBoolean()&&(6>f?l(16,e):l(64,e));if(e.skipUnsignedExpGolomb(),s=e.readUnsignedExpGolomb(),0===s)e.readUnsignedExpGolomb();else if(1===s)for(e.skipBits(1),e.skipExpGolomb(),e.skipExpGolomb(),c=e.readUnsignedExpGolomb(),f=0;c>f;f++)e.skipExpGolomb();return e.skipUnsignedExpGolomb(),e.skipBits(1),u=e.readUnsignedExpGolomb(),h=e.readUnsignedExpGolomb(),p=e.readBits(1),0===p&&e.skipBits(1),e.skipBits(1),e.readBoolean()&&(m=e.readUnsignedExpGolomb(),v=e.readUnsignedExpGolomb(),g=e.readUnsignedExpGolomb(),y=e.readUnsignedExpGolomb()),{profileIdc:n,levelIdc:i,profileCompatibility:r,width:16*(u+1)-2*m-2*v,height:(2-p)*(h+1)*16-2*g-2*y}}},i.prototype=new o,e.exports={H264Stream:i,NalByteStream:r}},{"../utils/exp-golomb.js":48,"../utils/stream.js":49}],33:[function(t,e,n){e.exports={adts:t("./adts"),h264:t("./h264")}},{"./adts":31,"./h264":32}],34:[function(t,e,n){"use strict";var i;i=function(t,e){var n,r=0,o=16384,a=function(t,e){var n,i=t.position+e;i<t.bytes.byteLength||(n=new Uint8Array(2*i),n.set(t.bytes.subarray(0,t.position),0),t.bytes=n,t.view=new DataView(t.bytes.buffer))},s=i.widthBytes||new Uint8Array("width".length),c=i.heightBytes||new Uint8Array("height".length),l=i.videocodecidBytes||new Uint8Array("videocodecid".length);if(!i.widthBytes){for(n=0;n<"width".length;n++)s[n]="width".charCodeAt(n);for(n=0;n<"height".length;n++)c[n]="height".charCodeAt(n);for(n=0;n<"videocodecid".length;n++)l[n]="videocodecid".charCodeAt(n);i.widthBytes=s,i.heightBytes=c,i.videocodecidBytes=l}switch(this.keyFrame=!1,t){case i.VIDEO_TAG:this.length=16,o*=6;break;case i.AUDIO_TAG:this.length=13,this.keyFrame=!0;break;case i.METADATA_TAG:this.length=29,this.keyFrame=!0;break;default:throw"Error Unknown TagType"}this.bytes=new Uint8Array(o),this.view=new DataView(this.bytes.buffer),this.bytes[0]=t,this.position=this.length,this.keyFrame=e,this.pts=0,this.dts=0,this.writeBytes=function(t,e,n){var i,r=e||0;n=n||t.byteLength,i=r+n,a(this,n),this.bytes.set(t.subarray(r,i),this.position),this.position+=n,this.length=Math.max(this.length,this.position)},this.writeByte=function(t){a(this,1),this.bytes[this.position]=t,this.position++,this.length=Math.max(this.length,this.position)},this.writeShort=function(t){a(this,2),this.view.setUint16(this.position,t),this.position+=2,this.length=Math.max(this.length,this.position)},this.negIndex=function(t){return this.bytes[this.length-t]},this.nalUnitSize=function(){return 0===r?0:this.length-(r+4)},this.startNalUnit=function(){if(r>0)throw new Error("Attempted to create new NAL wihout closing the old one");r=this.length,this.length+=4,this.position=this.length},this.endNalUnit=function(t){var e,n;this.length===r+4?this.length-=4:r>0&&(e=r+4,n=this.length-e,this.position=r,this.view.setUint32(this.position,n),this.position=this.length,t&&t.push(this.bytes.subarray(e,e+n))),r=0},this.writeMetaDataDouble=function(t,e){var n;if(a(this,2+t.length+9),this.view.setUint16(this.position,t.length),this.position+=2,"width"===t)this.bytes.set(s,this.position),this.position+=5;else if("height"===t)this.bytes.set(c,this.position),this.position+=6;else if("videocodecid"===t)this.bytes.set(l,this.position),this.position+=12;else for(n=0;n<t.length;n++)this.bytes[this.position]=t.charCodeAt(n),this.position++;this.position++,this.view.setFloat64(this.position,e),this.position+=8,this.length=Math.max(this.length,this.position),++r},this.writeMetaDataBoolean=function(t,e){var n;for(a(this,2),this.view.setUint16(this.position,t.length),this.position+=2,n=0;n<t.length;n++)a(this,1),this.bytes[this.position]=t.charCodeAt(n),this.position++;a(this,2),this.view.setUint8(this.position,1),this.position++,this.view.setUint8(this.position,e?1:0),this.position++,this.length=Math.max(this.length,this.position),++r},this.finalize=function(){var t,n;switch(this.bytes[0]){case i.VIDEO_TAG:this.bytes[11]=7|(this.keyFrame||e?16:32),this.bytes[12]=e?0:1,t=this.pts-this.dts,this.bytes[13]=(16711680&t)>>>16,this.bytes[14]=(65280&t)>>>8,this.bytes[15]=(255&t)>>>0;break;case i.AUDIO_TAG:this.bytes[11]=175,this.bytes[12]=e?0:1;break;case i.METADATA_TAG:this.position=11,this.view.setUint8(this.position,2),this.position++,this.view.setUint16(this.position,10),this.position+=2,this.bytes.set([111,110,77,101,116,97,68,97,116,97],this.position),this.position+=10,this.bytes[this.position]=8,this.position++,this.view.setUint32(this.position,r),this.position=this.length,this.bytes.set([0,0,9],this.position),this.position+=3,this.length=this.position}return n=this.length-11,this.bytes[1]=(16711680&n)>>>16,this.bytes[2]=(65280&n)>>>8,this.bytes[3]=(255&n)>>>0,this.bytes[4]=(16711680&this.dts)>>>16,this.bytes[5]=(65280&this.dts)>>>8,this.bytes[6]=(255&this.dts)>>>0,this.bytes[7]=(4278190080&this.dts)>>>24,this.bytes[8]=0,this.bytes[9]=0,this.bytes[10]=0,a(this,4),this.view.setUint32(this.length,this.length),this.length+=4,this.position+=4,this.bytes=this.bytes.subarray(0,this.length),this.frameTime=i.frameTime(this.bytes),this}},i.AUDIO_TAG=8,i.VIDEO_TAG=9,i.METADATA_TAG=18,i.isAudioFrame=function(t){return i.AUDIO_TAG===t[0]},i.isVideoFrame=function(t){return i.VIDEO_TAG===t[0]},i.isMetaData=function(t){return i.METADATA_TAG===t[0]},i.isKeyFrame=function(t){return i.isVideoFrame(t)?23===t[11]:!!i.isAudioFrame(t)||!!i.isMetaData(t)},i.frameTime=function(t){var e=t[4]<<16;return e|=t[5]<<8,e|=t[6]<<0,e|=t[7]<<24},e.exports=i},{}],35:[function(t,e,n){e.exports={tag:t("./flv-tag"),Transmuxer:t("./transmuxer"),tools:t("../tools/flv-inspector")}},{"../tools/flv-inspector":46,"./flv-tag":34,"./transmuxer":36}],36:[function(t,e,n){"use strict";var i,r,o,a,s,c,l,u=t("../utils/stream.js"),h=t("./flv-tag.js"),p=t("../m2ts/m2ts.js"),d=t("../codecs/adts.js"),f=t("../codecs/h264").H264Stream;
s=function(t,e){"number"==typeof e.pts&&(void 0===t.timelineStartInfo.pts?t.timelineStartInfo.pts=e.pts:t.timelineStartInfo.pts=Math.min(t.timelineStartInfo.pts,e.pts)),"number"==typeof e.dts&&(void 0===t.timelineStartInfo.dts?t.timelineStartInfo.dts=e.dts:t.timelineStartInfo.dts=Math.min(t.timelineStartInfo.dts,e.dts))},c=function(t,e){var n=new h(h.METADATA_TAG);return n.dts=e,n.pts=e,n.writeMetaDataDouble("videocodecid",7),n.writeMetaDataDouble("width",t.width),n.writeMetaDataDouble("height",t.height),n},l=function(t,e){var n,i=new h(h.VIDEO_TAG,(!0));for(i.dts=e,i.pts=e,i.writeByte(1),i.writeByte(t.profileIdc),i.writeByte(t.profileCompatibility),i.writeByte(t.levelIdc),i.writeByte(255),i.writeByte(225),i.writeShort(t.sps[0].length),i.writeBytes(t.sps[0]),i.writeByte(t.pps.length),n=0;n<t.pps.length;++n)i.writeShort(t.pps[n].length),i.writeBytes(t.pps[n]);return i},o=function(t){var e,n=[];o.prototype.init.call(this),this.push=function(e){s(t,e),t&&void 0===t.channelcount&&(t.audioobjecttype=e.audioobjecttype,t.channelcount=e.channelcount,t.samplerate=e.samplerate,t.samplingfrequencyindex=e.samplingfrequencyindex,t.samplesize=e.samplesize,t.extraData=t.audioobjecttype<<11|t.samplingfrequencyindex<<7|t.channelcount<<3),e.pts=Math.round(e.pts/90),e.dts=Math.round(e.dts/90),n.push(e)},this.flush=function(){var i,r,o,a=[];if(0===n.length)return void this.trigger("done");for(o=-(1/0);n.length;)i=n.shift(),(t.extraData!==e||i.pts-o>=1e3)&&(r=new h(h.METADATA_TAG),r.pts=i.pts,r.dts=i.dts,r.writeMetaDataDouble("audiocodecid",10),r.writeMetaDataBoolean("stereo",2===t.channelcount),r.writeMetaDataDouble("audiosamplerate",t.samplerate),r.writeMetaDataDouble("audiosamplesize",16),a.push(r),e=t.extraData,r=new h(h.AUDIO_TAG,(!0)),r.pts=i.pts,r.dts=i.dts,r.view.setUint16(r.position,t.extraData),r.position+=2,r.length=Math.max(r.length,r.position),a.push(r),o=i.pts),r=new h(h.AUDIO_TAG),r.pts=i.pts,r.dts=i.dts,r.writeBytes(i.data),a.push(r);e=null,this.trigger("data",{track:t,tags:a}),this.trigger("done")}},o.prototype=new u,r=function(t){var e,n,i=[];r.prototype.init.call(this),this.finishFrame=function(n,i){i&&(e&&t&&t.newMetadata&&(i.keyFrame||0===n.length)&&(n.push(c(e,i.pts)),n.push(l(t,i.pts)),t.newMetadata=!1),i.endNalUnit(),n.push(i))},this.push=function(e){s(t,e),e.pts=Math.round(e.pts/90),e.dts=Math.round(e.dts/90),i.push(e)},this.flush=function(){for(var r,o=[];i.length&&"access_unit_delimiter_rbsp"!==i[0].nalUnitType;)i.shift();if(0===i.length)return void this.trigger("done");for(;i.length;)r=i.shift(),"seq_parameter_set_rbsp"===r.nalUnitType?(t.newMetadata=!0,e=r.config,t.width=e.width,t.height=e.height,t.sps=[r.data],t.profileIdc=e.profileIdc,t.levelIdc=e.levelIdc,t.profileCompatibility=e.profileCompatibility,n.endNalUnit()):"pic_parameter_set_rbsp"===r.nalUnitType?(t.newMetadata=!0,t.pps=[r.data],n.endNalUnit()):"access_unit_delimiter_rbsp"===r.nalUnitType?(n&&this.finishFrame(o,n),n=new h(h.VIDEO_TAG),n.pts=r.pts,n.dts=r.dts):("slice_layer_without_partitioning_rbsp_idr"===r.nalUnitType&&(n.keyFrame=!0),n.endNalUnit()),n.startNalUnit(),n.writeBytes(r.data);n&&this.finishFrame(o,n),this.trigger("data",{track:t,tags:o}),this.trigger("done")}},r.prototype=new u,a=function(t){this.numberOfTracks=0,this.metadataStream=t.metadataStream,this.videoTags=[],this.audioTags=[],this.videoTrack=null,this.audioTrack=null,this.pendingCaptions=[],this.pendingMetadata=[],this.pendingTracks=0,a.prototype.init.call(this),this.push=function(t){return t.text?this.pendingCaptions.push(t):t.frames?this.pendingMetadata.push(t):("video"===t.track.type&&(this.videoTrack=t.track,this.videoTags=t.tags,this.pendingTracks++),void("audio"===t.track.type&&(this.audioTrack=t.track,this.audioTags=t.tags,this.pendingTracks++)))}},a.prototype=new u,a.prototype.flush=function(){var t,e,n,i,r={tags:{},captions:[],metadata:[]};if(!(this.pendingTracks<this.numberOfTracks)){for(this.videoTrack?i=this.videoTrack.timelineStartInfo.pts:this.audioTrack&&(i=this.audioTrack.timelineStartInfo.pts),r.tags.videoTags=this.videoTags,r.tags.audioTags=this.audioTags,n=0;n<this.pendingCaptions.length;n++)e=this.pendingCaptions[n],e.startTime=e.startPts-i,e.startTime/=9e4,e.endTime=e.endPts-i,e.endTime/=9e4,r.captions.push(e);for(n=0;n<this.pendingMetadata.length;n++)t=this.pendingMetadata[n],t.cueTime=t.pts-i,t.cueTime/=9e4,r.metadata.push(t);r.metadata.dispatchType=this.metadataStream.dispatchType,this.videoTrack=null,this.audioTrack=null,this.videoTags=[],this.audioTags=[],this.pendingCaptions.length=0,this.pendingMetadata.length=0,this.pendingTracks=0,this.trigger("data",r),this.trigger("done")}},i=function(t){var e,n,s,c,l,u,m,v,g,y=this;i.prototype.init.call(this),t=t||{},this.metadataStream=new p.MetadataStream,t.metadataStream=this.metadataStream,e=new p.TransportPacketStream,n=new p.TransportParseStream,s=new p.ElementaryStream,c=new d,l=new f,g=new a(t),e.pipe(n).pipe(s),s.pipe(l),s.pipe(c),s.pipe(this.metadataStream).pipe(g),v=new p.CaptionStream,l.pipe(v).pipe(g),s.on("data",function(t){var e,n,i;if("metadata"===t.type){for(e=t.tracks.length;e--;)"video"===t.tracks[e].type?n=t.tracks[e]:"audio"===t.tracks[e].type&&(i=t.tracks[e]);n&&!u&&(g.numberOfTracks++,u=new r(n),l.pipe(u).pipe(g)),i&&!m&&(g.numberOfTracks++,m=new o(i),c.pipe(m).pipe(g))}}),this.push=function(t){e.push(t)},this.flush=function(){e.flush()},g.on("data",function(t){y.trigger("data",t)}),g.on("done",function(){y.trigger("done")}),this.getFlvHeader=function(t,e,n){var i,r,o,a=new Uint8Array(9),s=new DataView(a.buffer);return t=t||0,e=void 0===e||e,n=void 0===n||n,s.setUint8(0,70),s.setUint8(1,76),s.setUint8(2,86),s.setUint8(3,1),s.setUint8(4,(e?4:0)|(n?1:0)),s.setUint32(5,a.byteLength),0>=t?(r=new Uint8Array(a.byteLength+4),r.set(a),r.set([0,0,0,0],a.byteLength),r):(i=new h(h.METADATA_TAG),i.pts=i.dts=0,i.writeMetaDataDouble("duration",t),o=i.finalize().length,r=new Uint8Array(a.byteLength+o),r.set(a),r.set(s.byteLength,o),r)}},i.prototype=new u,e.exports=i},{"../codecs/adts.js":31,"../codecs/h264":32,"../m2ts/m2ts.js":40,"../utils/stream.js":49,"./flv-tag.js":34}],37:[function(t,e,n){"use strict";var i={codecs:t("./codecs"),mp4:t("./mp4"),flv:t("./flv"),mp2t:t("./m2ts")};e.exports=i},{"./codecs":33,"./flv":35,"./m2ts":39,"./mp4":43}],38:[function(t,e,n){"use strict";var i=4,r=128,o=t("../utils/stream"),a=function(t){for(var e=0,n={payloadType:-1,payloadSize:0},o=0,a=0;e<t.byteLength&&t[e]!==r;){for(;255===t[e];)o+=255,e++;for(o+=t[e++];255===t[e];)a+=255,e++;if(a+=t[e++],!n.payload&&o===i){n.payloadType=o,n.payloadSize=a,n.payload=t.subarray(e,e+a);break}e+=a,o=0,a=0}return n},s=function(t){return 181!==t.payload[0]?null:49!==(t.payload[1]<<8|t.payload[2])?null:"GA94"!==String.fromCharCode(t.payload[3],t.payload[4],t.payload[5],t.payload[6])?null:3!==t.payload[7]?null:t.payload.subarray(8,t.payload.length-1)},c=function(t,e){var n,i,r,o,a=[];if(!(64&e[0]))return a;for(i=31&e[0],n=0;i>n;n++)r=3*n,o={type:3&e[r+2],pts:t},4&e[r+2]&&(o.ccData=e[r+3]<<8|e[r+4],a.push(o));return a},l=function(){l.prototype.init.call(this),this.captionPackets_=[],this.field1_=new R,this.field1_.on("data",this.trigger.bind(this,"data")),this.field1_.on("done",this.trigger.bind(this,"done"))};l.prototype=new o,l.prototype.push=function(t){var e,n;"sei_rbsp"===t.nalUnitType&&(e=a(t.escapedRBSP),e.payloadType===i&&(n=s(e),n&&(this.captionPackets_=this.captionPackets_.concat(c(t.pts,n)))))},l.prototype.flush=function(){return this.captionPackets_.length?(this.captionPackets_.sort(function(t,e){return t.pts-e.pts}),this.captionPackets_.forEach(this.field1_.push,this.field1_),this.captionPackets_.length=0,void this.field1_.flush()):void this.field1_.flush()};var u={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608},h=function(t){return null===t?"":(t=u[t]||t,String.fromCharCode(t))},p=0,d=5152,f=5167,m=5157,v=5158,g=5159,y=5165,E=5153,_=5164,T=5166,b=14,w=function(){for(var t=[],e=b+1;e--;)t.push("");return t},R=function(){R.prototype.init.call(this),this.mode_="popOn",this.topRow_=0,this.startPts_=0,this.displayed_=w(),this.nonDisplayed_=w(),this.lastControlCode_=null,this.push=function(t){if(0===t.type){var e,n,i,r;if(e=32639&t.ccData,e===this.lastControlCode_)return void(this.lastControlCode_=null);switch(4096===(61440&e)?this.lastControlCode_=e:this.lastControlCode_=null,e){case p:break;case d:this.mode_="popOn";break;case f:this.flushDisplayed(t.pts),n=this.displayed_,this.displayed_=this.nonDisplayed_,this.nonDisplayed_=n,this.startPts_=t.pts;break;case m:this.topRow_=b-1,this.mode_="rollUp";break;case v:this.topRow_=b-2,this.mode_="rollUp";break;case g:this.topRow_=b-3,this.mode_="rollUp";break;case y:this.flushDisplayed(t.pts),this.shiftRowsUp_(),this.startPts_=t.pts;break;case E:"popOn"===this.mode_?this.nonDisplayed_[b]=this.nonDisplayed_[b].slice(0,-1):this.displayed_[b]=this.displayed_[b].slice(0,-1);break;case _:this.flushDisplayed(t.pts),this.displayed_=w();break;case T:this.nonDisplayed_=w();break;default:if(i=e>>>8,r=255&e,i>=16&&23>=i&&r>=64&&127>=r&&(16!==i||96>r)&&(i=32,r=null),(17===i||25===i)&&r>=48&&63>=r&&(i=14850474,r=""),16===(240&i))return;this[this.mode_](t.pts,i,r)}}}};R.prototype=new o,R.prototype.flushDisplayed=function(t){var e,n;for(n=0;n<this.displayed_.length;n++)e=this.displayed_[n],e.length&&this.trigger("data",{startPts:this.startPts_,endPts:t,text:e.trim()})},R.prototype.popOn=function(t,e,n){var i=this.nonDisplayed_[b];i+=h(e),i+=h(n),this.nonDisplayed_[b]=i},R.prototype.rollUp=function(t,e,n){var i=this.displayed_[b];""===i&&(this.flushDisplayed(t),this.startPts_=t),i+=h(e),i+=h(n),this.displayed_[b]=i},R.prototype.shiftRowsUp_=function(){var t;for(t=0;t<this.topRow_;t++)this.displayed_[t]="";for(t=this.topRow_;b>t;t++)this.displayed_[t]=this.displayed_[t+1];this.displayed_[b]=""},e.exports={CaptionStream:l,Cea608Stream:R}},{"../utils/stream":49}],39:[function(t,e,n){e.exports=t("./m2ts")},{"./m2ts":40}],40:[function(t,e,n){"use strict";var i,r,o,a=t("../utils/stream.js"),s=t("./caption-stream"),c=t("./stream-types"),a=t("../utils/stream.js"),l=t("./stream-types.js"),u=188,h=71,i=function(){var t=new Uint8Array(u),e=0;i.prototype.init.call(this),this.push=function(n){var i,r=0,o=u;for(e?(i=new Uint8Array(n.byteLength+e),i.set(t.subarray(0,e)),i.set(n,e),e=0):i=n;o<i.byteLength;)i[r]!==h||i[o]!==h?(r++,o++):(this.trigger("data",i.subarray(r,o)),r+=u,o+=u);r<i.byteLength&&(t.set(i.subarray(r),0),e=i.byteLength-r)},this.flush=function(){e===u&&t[0]===h&&(this.trigger("data",t),e=0),this.trigger("done")}};i.prototype=new a,r=function(){var t,e,n,i;r.prototype.init.call(this),i=this,this.packetsWaitingForPmt=[],this.programMapTable=void 0,t=function(t,i){var r=0;i.payloadUnitStartIndicator&&(r+=t[r]+1),"pat"===i.type?e(t.subarray(r),i):n(t.subarray(r),i)},e=function(t,e){e.section_number=t[7],e.last_section_number=t[8],i.pmtPid=(31&t[10])<<8|t[11],e.pmtPid=i.pmtPid},n=function(t,e){var n,r,o,a;if(1&t[5]){for(i.programMapTable={},n=(15&t[1])<<8|t[2],r=3+n-4,o=(15&t[10])<<8|t[11],a=12+o;r>a;)i.programMapTable[(31&t[a+1])<<8|t[a+2]]=t[a],a+=((15&t[a+3])<<8|t[a+4])+5;for(e.programMapTable=i.programMapTable;i.packetsWaitingForPmt.length;)i.processPes_.apply(i,i.packetsWaitingForPmt.shift())}},this.push=function(e){var n={},i=4;n.payloadUnitStartIndicator=!!(64&e[1]),n.pid=31&e[1],n.pid<<=8,n.pid|=e[2],(48&e[3])>>>4>1&&(i+=e[i]+1),0===n.pid?(n.type="pat",t(e.subarray(i),n),this.trigger("data",n)):n.pid===this.pmtPid?(n.type="pmt",t(e.subarray(i),n),this.trigger("data",n)):void 0===this.programMapTable?this.packetsWaitingForPmt.push([e,i,n]):this.processPes_(e,i,n)},this.processPes_=function(t,e,n){n.streamType=this.programMapTable[n.pid],n.type="pes",n.data=t.subarray(e),this.trigger("data",n)}},r.prototype=new a,r.STREAM_TYPES={h264:27,adts:15},o=function(){var t,e={data:[],size:0},n={data:[],size:0},i={data:[],size:0},r=function(t,e){var n;e.dataAlignmentIndicator=0!==(4&t[6]),n=t[7],192&n&&(e.pts=(14&t[9])<<27|(255&t[10])<<20|(254&t[11])<<12|(255&t[12])<<5|(254&t[13])>>>3,e.pts*=4,e.pts+=(6&t[13])>>>1,e.dts=e.pts,64&n&&(e.dts=(14&t[14])<<27|(255&t[15])<<20|(254&t[16])<<12|(255&t[17])<<5|(254&t[18])>>>3,e.dts*=4,e.dts+=(6&t[18])>>>1)),e.data=t.subarray(9+t[8])},a=function(e,n){var i,o=new Uint8Array(e.size),a={type:n},s=0;if(e.data.length){for(a.trackId=e.data[0].pid;e.data.length;)i=e.data.shift(),o.set(i.data,s),s+=i.data.byteLength;r(o,a),e.size=0,t.trigger("data",a)}};o.prototype.init.call(this),t=this,this.push=function(r){({pat:function(){},pes:function(){var t,o;switch(r.streamType){case c.H264_STREAM_TYPE:case l.H264_STREAM_TYPE:t=e,o="video";break;case c.ADTS_STREAM_TYPE:t=n,o="audio";break;case c.METADATA_STREAM_TYPE:t=i,o="timed-metadata";break;default:return}r.payloadUnitStartIndicator&&a(t,o),t.data.push(r),t.size+=r.data.byteLength},pmt:function(){var e,n,i={type:"metadata",tracks:[]},o=r.programMapTable;for(e in o)o.hasOwnProperty(e)&&(n={timelineStartInfo:{baseMediaDecodeTime:0}},n.id=+e,o[e]===l.H264_STREAM_TYPE?(n.codec="avc",n.type="video"):o[e]===l.ADTS_STREAM_TYPE&&(n.codec="adts",n.type="audio"),i.tracks.push(n));t.trigger("data",i)}})[r.type]()},this.flush=function(){a(e,"video"),a(n,"audio"),a(i,"timed-metadata"),this.trigger("done")}},o.prototype=new a;var p={PAT_PID:0,MP2T_PACKET_LENGTH:u,TransportPacketStream:i,TransportParseStream:r,ElementaryStream:o,CaptionStream:s.CaptionStream,Cea608Stream:s.Cea608Stream,MetadataStream:t("./metadata-stream")};for(var d in c)c.hasOwnProperty(d)&&(p[d]=c[d]);e.exports=p},{"../utils/stream.js":49,"./caption-stream":38,"./metadata-stream":41,"./stream-types":42,"./stream-types.js":42}],41:[function(t,e,n){"use strict";var i,r=t("../utils/stream"),o=t("./stream-types"),a=function(t,e,n){var i,r="";for(i=e;n>i;i++)r+="%"+("00"+t[i].toString(16)).slice(-2);return r},s=function(t,e,n){return decodeURIComponent(a(t,e,n))},c=function(t,e,n){return unescape(a(t,e,n))},l=function(t){return t[0]<<21|t[1]<<14|t[2]<<7|t[3]},u={TXXX:function(t){var e;if(3===t.data[0]){for(e=1;e<t.data.length;e++)if(0===t.data[e]){t.description=s(t.data,1,e),t.value=s(t.data,e+1,t.data.length-1);break}t.data=t.value}},WXXX:function(t){var e;if(3===t.data[0])for(e=1;e<t.data.length;e++)if(0===t.data[e]){t.description=s(t.data,1,e),t.url=s(t.data,e+1,t.data.length);break}},PRIV:function(t){var e;for(e=0;e<t.data.length;e++)if(0===t.data[e]){t.owner=c(t.data,0,e);break}t.privateData=t.data.subarray(e+1),t.data=t.privateData}};i=function(t){var e,n={debug:!(!t||!t.debug),descriptor:t&&t.descriptor},r=0,a=[],s=0;if(i.prototype.init.call(this),this.dispatchType=o.METADATA_STREAM_TYPE.toString(16),n.descriptor)for(e=0;e<n.descriptor.length;e++)this.dispatchType+=("00"+n.descriptor[e].toString(16)).slice(-2);this.push=function(t){var e,i,o,c,h,p;if("timed-metadata"===t.type){if(t.dataAlignmentIndicator&&(s=0,a.length=0),0===a.length&&(t.data.length<10||t.data[0]!=="I".charCodeAt(0)||t.data[1]!=="D".charCodeAt(0)||t.data[2]!=="3".charCodeAt(0)))return void(n.debug&&console.log("Skipping unrecognized metadata packet"));if(a.push(t),s+=t.data.byteLength,1===a.length&&(r=l(t.data.subarray(6,10)),r+=10),!(r>s)){for(e={data:new Uint8Array(r),frames:[],pts:a[0].pts,dts:a[0].dts},h=0;r>h;)e.data.set(a[0].data.subarray(0,r-h),h),h+=a[0].data.byteLength,s-=a[0].data.byteLength,a.shift();i=10,64&e.data[5]&&(i+=4,i+=l(e.data.subarray(10,14)),r-=l(e.data.subarray(16,20)));do{if(o=l(e.data.subarray(i+4,i+8)),1>o)return console.log("Malformed ID3 frame encountered. Skipping metadata parsing.");if(p=String.fromCharCode(e.data[i],e.data[i+1],e.data[i+2],e.data[i+3]),c={id:p,data:e.data.subarray(i+10,i+o+10)},c.key=c.id,u[c.id]&&(u[c.id](c),"com.apple.streaming.transportStreamTimestamp"===c.owner)){var d=c.data,f=(1&d[3])<<30|d[4]<<22|d[5]<<14|d[6]<<6|d[7]>>>2;f*=4,f+=3&d[7],c.timeStamp=f,this.trigger("timestamp",c)}e.frames.push(c),i+=10,i+=o}while(r>i);this.trigger("data",e)}}}},i.prototype=new r,e.exports=i},{"../utils/stream":49,"./stream-types":42}],42:[function(t,e,n){"use strict";e.exports={H264_STREAM_TYPE:27,ADTS_STREAM_TYPE:15,METADATA_STREAM_TYPE:21}},{}],43:[function(t,e,n){e.exports={generator:t("./mp4-generator"),Transmuxer:t("./transmuxer").Transmuxer,AudioSegmentStream:t("./transmuxer").AudioSegmentStream,VideoSegmentStream:t("./transmuxer").VideoSegmentStream,tools:t("../tools/mp4-inspector")}},{"../tools/mp4-inspector":47,"./mp4-generator":44,"./transmuxer":45}],44:[function(t,e,n){"use strict";var i,r,o,a,s,c,l,u,h,p,d,f,m,v,g,y,E,_,T,b,w,R,x,H,M,S,C,A,P,L,O,j,k,I,D,B,U;!function(){var t;H={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],smhd:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],styp:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[]};for(t in H)H.hasOwnProperty(t)&&(H[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);M=new Uint8Array(["i".charCodeAt(0),"s".charCodeAt(0),"o".charCodeAt(0),"m".charCodeAt(0)]),C=new Uint8Array(["a".charCodeAt(0),"v".charCodeAt(0),"c".charCodeAt(0),"1".charCodeAt(0)]),S=new Uint8Array([0,0,0,1]),A=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),P=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),L={video:A,audio:P},k=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),j=new Uint8Array([0,0,0,0,0,0,0,0]),I=new Uint8Array([0,0,0,0,0,0,0,0]),D=I,B=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),U=I,O=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])}(),i=function(t){var e,n,i,r=[],o=0;for(e=1;e<arguments.length;e++)r.push(arguments[e]);for(e=r.length;e--;)o+=r[e].byteLength;for(n=new Uint8Array(o+8),i=new DataView(n.buffer,n.byteOffset,n.byteLength),i.setUint32(0,n.byteLength),n.set(t,4),e=0,o=8;e<r.length;e++)n.set(r[e],o),o+=r[e].byteLength;return n},r=function(){return i(H.dinf,i(H.dref,k))},o=function(t){return i(H.esds,new Uint8Array([0,0,0,0,3,25,0,0,0,4,17,64,21,0,6,0,0,0,218,192,0,0,218,192,5,2,t.audioobjecttype<<3|t.samplingfrequencyindex>>>1,t.samplingfrequencyindex<<7|t.channelcount<<3,6,1,2]))},a=function(){return i(H.ftyp,M,S,M,C)},y=function(t){return i(H.hdlr,L[t])},s=function(t){return i(H.mdat,t)},g=function(t){var e=new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,0,1,95,144,t.duration>>>24&255,t.duration>>>16&255,t.duration>>>8&255,255&t.duration,85,196,0,0]);return t.samplerate&&(e[12]=t.samplerate>>>24&255,e[13]=t.samplerate>>>16&255,e[14]=t.samplerate>>>8&255,e[15]=255&t.samplerate),i(H.mdhd,e)},v=function(t){return i(H.mdia,g(t),y(t.type),l(t))},c=function(t){return i(H.mfhd,new Uint8Array([0,0,0,0,(4278190080&t)>>24,(16711680&t)>>16,(65280&t)>>8,255&t]))},l=function(t){return i(H.minf,"video"===t.type?i(H.vmhd,O):i(H.smhd,j),r(),_(t))},u=function(t,e){for(var n=[],r=e.length;r--;)n[r]=w(e[r]);return i.apply(null,[H.moof,c(t)].concat(n))},h=function(t){for(var e=t.length,n=[];e--;)n[e]=f(t[e]);return i.apply(null,[H.moov,d(4294967295)].concat(n).concat(p(t)))},p=function(t){for(var e=t.length,n=[];e--;)n[e]=R(t[e]);return i.apply(null,[H.mvex].concat(n))},d=function(t){var e=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,0,1,95,144,(4278190080&t)>>24,(16711680&t)>>16,(65280&t)>>8,255&t,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return i(H.mvhd,e)},E=function(t){var e,n,r=t.samples||[],o=new Uint8Array(4+r.length);for(n=0;n<r.length;n++)e=r[n].flags,o[n+4]=e.dependsOn<<4|e.isDependedOn<<2|e.hasRedundancy;return i(H.sdtp,o)},_=function(t){return i(H.stbl,T(t),i(H.stts,U),i(H.stsc,D),i(H.stsz,B),i(H.stco,I))},function(){var t,e;T=function(n){return i(H.stsd,new Uint8Array([0,0,0,0,0,0,0,1]),"video"===n.type?t(n):e(n))},t=function(t){var e,n=t.sps||[],r=t.pps||[],o=[],a=[];for(e=0;e<n.length;e++)o.push((65280&n[e].byteLength)>>>8),o.push(255&n[e].byteLength),o=o.concat(Array.prototype.slice.call(n[e]));for(e=0;e<r.length;e++)a.push((65280&r[e].byteLength)>>>8),a.push(255&r[e].byteLength),a=a.concat(Array.prototype.slice.call(r[e]));return i(H.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,(65280&t.width)>>8,255&t.width,(65280&t.height)>>8,255&t.height,0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),i(H.avcC,new Uint8Array([1,t.profileIdc,t.profileCompatibility,t.levelIdc,255].concat([n.length]).concat(o).concat([r.length]).concat(a))),i(H.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])))},e=function(t){return i(H.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,(65280&t.channelcount)>>8,255&t.channelcount,(65280&t.samplesize)>>8,255&t.samplesize,0,0,0,0,(65280&t.samplerate)>>8,255&t.samplerate,0,0]),o(t))}}(),b=function(){return i(H.styp,M,S,M)},m=function(t){var e=new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,(4278190080&t.id)>>24,(16711680&t.id)>>16,(65280&t.id)>>8,255&t.id,0,0,0,0,(4278190080&t.duration)>>24,(16711680&t.duration)>>16,(65280&t.duration)>>8,255&t.duration,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,(65280&t.width)>>8,255&t.width,0,0,(65280&t.height)>>8,255&t.height,0,0]);return i(H.tkhd,e)},w=function(t){var e,n,r,o,a;return e=i(H.tfhd,new Uint8Array([0,0,0,58,(4278190080&t.id)>>24,(16711680&t.id)>>16,(65280&t.id)>>8,255&t.id,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0])),n=i(H.tfdt,new Uint8Array([0,0,0,0,t.baseMediaDecodeTime>>>24&255,t.baseMediaDecodeTime>>>16&255,t.baseMediaDecodeTime>>>8&255,255&t.baseMediaDecodeTime])),a=88,"audio"===t.type?(r=x(t,a),i(H.traf,e,n,r)):(o=E(t),r=x(t,o.length+a),i(H.traf,e,n,r,o))},f=function(t){return t.duration=t.duration||4294967295,i(H.trak,m(t),v(t))},R=function(t){var e=new Uint8Array([0,0,0,0,(4278190080&t.id)>>24,(16711680&t.id)>>16,(65280&t.id)>>8,255&t.id,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return"video"!==t.type&&(e[e.length-1]=0),i(H.trex,e)},function(){var t,e,n;n=function(t,e){var n=0,i=0,r=0,o=0;return t.length&&(void 0!==t[0].duration&&(n=1),void 0!==t[0].size&&(i=2),void 0!==t[0].flags&&(r=4),void 0!==t[0].compositionTimeOffset&&(o=8)),[0,0,n|i|r|o,1,(4278190080&t.length)>>>24,(16711680&t.length)>>>16,(65280&t.length)>>>8,255&t.length,(4278190080&e)>>>24,(16711680&e)>>>16,(65280&e)>>>8,255&e]},e=function(t,e){var r,o,a,s;for(o=t.samples||[],e+=20+16*o.length,r=n(o,e),s=0;s<o.length;s++)a=o[s],r=r.concat([(4278190080&a.duration)>>>24,(16711680&a.duration)>>>16,(65280&a.duration)>>>8,255&a.duration,(4278190080&a.size)>>>24,(16711680&a.size)>>>16,(65280&a.size)>>>8,255&a.size,a.flags.isLeading<<2|a.flags.dependsOn,a.flags.isDependedOn<<6|a.flags.hasRedundancy<<4|a.flags.paddingValue<<1|a.flags.isNonSyncSample,61440&a.flags.degradationPriority,15&a.flags.degradationPriority,(4278190080&a.compositionTimeOffset)>>>24,(16711680&a.compositionTimeOffset)>>>16,(65280&a.compositionTimeOffset)>>>8,255&a.compositionTimeOffset]);return i(H.trun,new Uint8Array(r))},t=function(t,e){var r,o,a,s;for(o=t.samples||[],e+=20+8*o.length,r=n(o,e),s=0;s<o.length;s++)a=o[s],r=r.concat([(4278190080&a.duration)>>>24,(16711680&a.duration)>>>16,(65280&a.duration)>>>8,255&a.duration,(4278190080&a.size)>>>24,(16711680&a.size)>>>16,(65280&a.size)>>>8,255&a.size]);return i(H.trun,new Uint8Array(r))},x=function(n,i){return"audio"===n.type?t(n,i):e(n,i)}}(),e.exports={ftyp:a,mdat:s,moof:u,moov:h,initSegment:function(t){var e,n=a(),i=h(t);return e=new Uint8Array(n.byteLength+i.byteLength),e.set(n),e.set(i,n.byteLength),e}}},{}],45:[function(t,e,n){"use strict";var i,r,o,a,s,c,l,u,h,p,d=t("../utils/stream.js"),f=t("./mp4-generator.js"),m=t("../m2ts/m2ts.js"),v=t("../codecs/adts.js"),g=t("../codecs/h264").H264Stream,y=t("../aac");s={size:0,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0,degradationPriority:0}},h=function(t,e){var n;if(t.length!==e.length)return!1;for(n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0},p=function(t){var e,n,i=0;for(e=0;e<t.length;e++)n=t[e],i+=n.data.byteLength;return i},r=function(t){var e=[],n=0,i=0;r.prototype.init.call(this),this.push=function(n){c(t,n),t&&(t.audioobjecttype=n.audioobjecttype,t.channelcount=n.channelcount,t.samplerate=n.samplerate,t.samplingfrequencyindex=n.samplingfrequencyindex,t.samplesize=n.samplesize),e.push(n)},this.setEarliestDts=function(e){i=e-t.timelineStartInfo.baseMediaDecodeTime},this.flush=function(){var i,r,o,a;return 0===e.length?void this.trigger("done"):(i=this.trimAdtsFramesByEarliestDts_(e),t.samples=this.generateSampleTable_(i),o=f.mdat(this.concatenateFrameData_(i)),e=[],u(t),r=f.moof(n,[t]),a=new Uint8Array(r.byteLength+o.byteLength),n++,a.set(r),a.set(o,r.byteLength),l(t),this.trigger("data",{track:t,boxes:a}),void this.trigger("done"))},this.trimAdtsFramesByEarliestDts_=function(e){return t.minSegmentDts>=i?e:(t.minSegmentDts=1/0,e.filter(function(e){return e.dts>=i&&(t.minSegmentDts=Math.min(t.minSegmentDts,e.dts),t.minSegmentPts=t.minSegmentDts,!0)}))},this.generateSampleTable_=function(t){var e,n,i=[];for(e=0;e<t.length;e++)n=t[e],i.push({size:n.data.byteLength,duration:1024});return i},this.concatenateFrameData_=function(t){var e,n,i=0,r=new Uint8Array(p(t));for(e=0;e<t.length;e++)n=t[e],r.set(n.data,i),i+=n.data.byteLength;return r}},r.prototype=new d,i=function(t){var e,n,r=0,o=[];i.prototype.init.call(this),delete t.minPTS,this.gopCache_=[],this.push=function(i){c(t,i),"seq_parameter_set_rbsp"!==i.nalUnitType||e||(e=i.config,t.width=e.width,t.height=e.height,t.sps=[i.data],t.profileIdc=e.profileIdc,t.levelIdc=e.levelIdc,t.profileCompatibility=e.profileCompatibility),"pic_parameter_set_rbsp"!==i.nalUnitType||n||(n=i.data,t.pps=[i.data]),o.push(i)},this.flush=function(){for(var e,n,i,a,s,l;o.length&&"access_unit_delimiter_rbsp"!==o[0].nalUnitType;)o.shift();return 0===o.length?(this.resetStream_(),void this.trigger("done")):(e=this.groupNalsIntoFrames_(o),i=this.groupFramesIntoGops_(e),i[0][0].keyFrame||(n=this.getGopForFusion_(o[0],t),n?(i.unshift(n),i.byteLength+=n.byteLength,i.nalCount+=n.nalCount,i.pts=n.pts,i.dts=n.dts,i.duration+=n.duration):i=this.extendFirstKeyFrame_(i)),c(t,i),t.samples=this.generateSampleTable_(i),s=f.mdat(this.concatenateNalData_(i)),this.gopCache_.unshift({gop:i.pop(),pps:t.pps,sps:t.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),o=[],u(t),this.trigger("timelineStartInfo",t.timelineStartInfo),a=f.moof(r,[t]),l=new Uint8Array(a.byteLength+s.byteLength),r++,l.set(a),l.set(s,a.byteLength),this.trigger("data",{track:t,boxes:l}),this.resetStream_(),void this.trigger("done"))},this.resetStream_=function(){l(t),e=void 0,n=void 0},this.getGopForFusion_=function(e){var n,i,r,o,a,s=45e3,c=1e4,l=1/0;for(a=0;a<this.gopCache_.length;a++)o=this.gopCache_[a],r=o.gop,t.pps&&h(t.pps[0],o.pps[0])&&t.sps&&h(t.sps[0],o.sps[0])&&(r.dts<t.timelineStartInfo.dts||(n=e.dts-r.dts-r.duration,n>=-c&&s>=n&&(!i||l>n)&&(i=o,l=n)));return i?i.gop:null},this.extendFirstKeyFrame_=function(t){var e;return t[0][0].keyFrame||(e=t.shift(),t.byteLength-=e.byteLength,t.nalCount-=e.nalCount,t[0][0].dts=e.dts,t[0][0].pts=e.pts,t[0][0].duration+=e.duration),t},this.groupNalsIntoFrames_=function(t){var e,n,i=[],r=[];for(i.byteLength=0,e=0;e<t.length;e++)n=t[e],"access_unit_delimiter_rbsp"===n.nalUnitType?(i.length&&(i.duration=n.dts-i.dts,r.push(i)),i=[n],i.byteLength=n.data.byteLength,i.pts=n.pts,i.dts=n.dts):("slice_layer_without_partitioning_rbsp_idr"===n.nalUnitType&&(i.keyFrame=!0),i.duration=n.dts-i.dts,i.byteLength+=n.data.byteLength,i.push(n));return(r.length&&!i.duration||i.duration<=0)&&(i.duration=r[r.length-1].duration),r.push(i),r},this.groupFramesIntoGops_=function(t){var e,n,i=[],r=[];for(i.byteLength=0,i.nalCount=0,i.duration=0,i.pts=t[0].pts,i.dts=t[0].dts,r.byteLength=0,r.nalCount=0,r.duration=0,r.pts=t[0].pts,r.dts=t[0].dts,e=0;e<t.length;e++)n=t[e],n.keyFrame?(i.length&&(r.push(i),r.byteLength+=i.byteLength,r.nalCount+=i.nalCount,r.duration+=i.duration),i=[n],i.nalCount=n.length,i.byteLength=n.byteLength,i.pts=n.pts,i.dts=n.dts,i.duration=n.duration):(i.duration+=n.duration,i.nalCount+=n.length,i.byteLength+=n.byteLength,i.push(n));return r.length&&i.duration<=0&&(i.duration=r[r.length-1].duration),r.byteLength+=i.byteLength,r.nalCount+=i.nalCount,r.duration+=i.duration,r.push(i),r},this.generateSampleTable_=function(t,e){var n,i,r,o,a,c=e||0,l=[];for(n=0;n<t.length;n++)for(o=t[n],i=0;i<o.length;i++)a=o[i],r=Object.create(s),r.dataOffset=c,r.compositionTimeOffset=a.pts-a.dts,r.duration=a.duration,r.size=4*a.length,r.size+=a.byteLength,a.keyFrame&&(r.flags.dependsOn=2),c+=r.size,l.push(r);return l},this.concatenateNalData_=function(t){var e,n,i,r,o,a,s=0,c=t.byteLength,l=t.nalCount,u=c+4*l,h=new Uint8Array(u),p=new DataView(h.buffer);for(e=0;e<t.length;e++)for(r=t[e],n=0;n<r.length;n++)for(o=r[n],i=0;i<o.length;i++)a=o[i],p.setUint32(s,a.data.byteLength),s+=4,h.set(a.data,s),s+=a.data.byteLength;return h}},i.prototype=new d,c=function(t,e){"number"==typeof e.pts&&(void 0===t.timelineStartInfo.pts&&(t.timelineStartInfo.pts=e.pts),void 0===t.minSegmentPts?t.minSegmentPts=e.pts:t.minSegmentPts=Math.min(t.minSegmentPts,e.pts),void 0===t.maxSegmentPts?t.maxSegmentPts=e.pts:t.maxSegmentPts=Math.max(t.maxSegmentPts,e.pts)),"number"==typeof e.dts&&(void 0===t.timelineStartInfo.dts&&(t.timelineStartInfo.dts=e.dts),void 0===t.minSegmentDts?t.minSegmentDts=e.dts:t.minSegmentDts=Math.min(t.minSegmentDts,e.dts),void 0===t.maxSegmentDts?t.maxSegmentDts=e.dts:t.maxSegmentDts=Math.max(t.maxSegmentDts,e.dts))},l=function(t){delete t.minSegmentDts,delete t.maxSegmentDts,delete t.minSegmentPts,delete t.maxSegmentPts},u=function(t){var e,n=9e4,i=t.minSegmentDts-t.timelineStartInfo.dts,r=t.minSegmentPts-t.minSegmentDts;t.baseMediaDecodeTime=t.timelineStartInfo.baseMediaDecodeTime,t.baseMediaDecodeTime+=i,t.baseMediaDecodeTime-=r,t.baseMediaDecodeTime=Math.max(0,t.baseMediaDecodeTime),"audio"===t.type&&(e=t.samplerate/n,t.baseMediaDecodeTime*=e,t.baseMediaDecodeTime=Math.floor(t.baseMediaDecodeTime))},a=function(t){this.numberOfTracks=0,this.metadataStream=t.metadataStream,"undefined"!=typeof t.remux?this.remuxTracks=!!t.remux:this.remuxTracks=!0,this.pendingTracks=[],this.videoTrack=null,this.pendingBoxes=[],this.pendingCaptions=[],this.pendingMetadata=[],this.pendingBytes=0,this.emittedTracks=0,a.prototype.init.call(this),this.push=function(t){return t.text?this.pendingCaptions.push(t):t.frames?this.pendingMetadata.push(t):(this.pendingTracks.push(t.track),this.pendingBoxes.push(t.boxes),this.pendingBytes+=t.boxes.byteLength,"video"===t.track.type&&(this.videoTrack=t.track),void("audio"===t.track.type&&(this.audioTrack=t.track)))}},a.prototype=new d,a.prototype.flush=function(){var t,e,n,i,r=0,o={captions:[],metadata:[]},a=0;if(!(0===this.pendingTracks.length||this.remuxTracks&&this.pendingTracks.length<this.numberOfTracks)){for(this.videoTrack?a=this.videoTrack.timelineStartInfo.pts:this.audioTrack&&(a=this.audioTrack.timelineStartInfo.pts),1===this.pendingTracks.length?o.type=this.pendingTracks[0].type:o.type="combined",this.emittedTracks+=this.pendingTracks.length,n=f.initSegment(this.pendingTracks),o.data=new Uint8Array(n.byteLength+this.pendingBytes),o.data.set(n),r+=n.byteLength,i=0;i<this.pendingBoxes.length;i++)o.data.set(this.pendingBoxes[i],r),r+=this.pendingBoxes[i].byteLength;for(i=0;i<this.pendingCaptions.length;i++)t=this.pendingCaptions[i],t.startTime=t.startPts-a,t.startTime/=9e4,t.endTime=t.endPts-a,t.endTime/=9e4,o.captions.push(t);for(i=0;i<this.pendingMetadata.length;i++)e=this.pendingMetadata[i],e.cueTime=e.pts-a,e.cueTime/=9e4,o.metadata.push(e);o.metadata.dispatchType=this.metadataStream.dispatchType,this.pendingTracks.length=0,this.videoTrack=null,this.pendingBoxes.length=0,this.pendingCaptions.length=0,this.pendingBytes=0,this.pendingMetadata.length=0,
this.trigger("data",o),this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0)}},o=function(t){var e,n,s,c,u,h,p,d,f,E,_,T,b,w=this;this.setupAacPipeline=function(){this.metadataStream=new m.MetadataStream,t.metadataStream=this.metadataStream,d=new y,h=new v,T=new a(t),b=d,d.pipe(h),d.pipe(this.metadataStream),this.metadataStream.pipe(T),this.metadataStream.on("timestamp",function(t){d.setTimestamp(t.timestamp)}),this.addAacListener()},this.addAacListener=function(){d.on("data",function(t){if("timed-metadata"===t.type){var e={timelineStartInfo:{baseMediaDecodeTime:0},codec:"adts",type:"audio"};e&&!E&&(T.numberOfTracks++,E=new r(e),h.pipe(E).pipe(T))}})},this.setupTsPipeline=function(){this.metadataStream=new m.MetadataStream,t.metadataStream=this.metadataStream,s=new m.TransportPacketStream,c=new m.TransportParseStream,u=new m.ElementaryStream,h=new v,p=new g,_=new m.CaptionStream,T=new a(t),b=s,s.pipe(c).pipe(u),u.pipe(p),u.pipe(h),u.pipe(this.metadataStream).pipe(T),p.pipe(_).pipe(T),this.addTsListener()},this.addTsListener=function(){u.on("data",function(t){var o;if("metadata"===t.type){for(o=t.tracks.length;o--;)e||"video"!==t.tracks[o].type?n||"audio"!==t.tracks[o].type||(n=t.tracks[o],n.timelineStartInfo.baseMediaDecodeTime=w.baseMediaDecodeTime):(e=t.tracks[o],e.timelineStartInfo.baseMediaDecodeTime=w.baseMediaDecodeTime);e&&!f&&(T.numberOfTracks++,f=new i(e),f.on("timelineStartInfo",function(t){n&&(n.timelineStartInfo=t,E.setEarliestDts(t.dts))}),p.pipe(f).pipe(T)),n&&!E&&(T.numberOfTracks++,E=new r(n),h.pipe(E).pipe(T))}})},o.prototype.init.call(this),t=t||{},this.baseMediaDecodeTime=t.baseMediaDecodeTime||0,void 0===t.aacfile?this.setupTsPipeline():this.setupAacPipeline(),this.setBaseMediaDecodeTime=function(t){this.baseMediaDecodeTime=t,n&&(n.timelineStartInfo.dts=void 0,n.timelineStartInfo.pts=void 0,l(n),n.timelineStartInfo.baseMediaDecodeTime=t),e&&(f.gopCache_=[],e.timelineStartInfo.dts=void 0,e.timelineStartInfo.pts=void 0,l(e),e.timelineStartInfo.baseMediaDecodeTime=t)},this.push=function(t){b.push(t)},this.flush=function(){b.flush()},T.on("data",function(t){w.trigger("data",t)}),T.on("done",function(){w.trigger("done")})},o.prototype=new d,e.exports={Transmuxer:o,VideoSegmentStream:i,AudioSegmentStream:r}},{"../aac":30,"../codecs/adts.js":31,"../codecs/h264":32,"../m2ts/m2ts.js":40,"../utils/stream.js":49,"./mp4-generator.js":44}],46:[function(t,e,n){"use strict";var i={8:"audio",9:"video",18:"metadata"},r=function(t){return"0x"+("00"+t.toString(16)).slice(-2).toUpperCase()},o=function(t){for(var e,n=[];t.byteLength>0;){switch(e=0,t.byteLength){default:n.push(r(t[e++]));case 7:n.push(r(t[e++]));case 6:n.push(r(t[e++]));case 5:n.push(r(t[e++]));case 4:n.push(r(t[e++]));case 3:n.push(r(t[e++]));case 2:n.push(r(t[e++]));case 1:n.push(r(t[e++]))}t=t.subarray(e)}return n.join(" ")},a=function(t,e){var n=["AVC Sequence Header","AVC NALU","AVC End-of-Sequence"],i=t[1]&parseInt("01111111",2)<<16|t[2]<<8|t[3];return e=e||{},e.avcPacketType=n[t[0]],e.CompositionTime=t[1]&parseInt("10000000",2)?-i:i,1===t[0]?e.nalUnitTypeRaw=o(t.subarray(4,100)):e.data=o(t.subarray(4)),e},s=function(t,e){var n=["Unknown","Keyframe (for AVC, a seekable frame)","Inter frame (for AVC, a nonseekable frame)","Disposable inter frame (H.263 only)","Generated keyframe (reserved for server use only)","Video info/command frame"],i=t[0]&parseInt("00001111",2);return e=e||{},e.frameType=n[(t[0]&parseInt("11110000",2))>>>4],e.codecID=i,7===i?a(t.subarray(1),e):e},c=function(t,e){var n=["AAC Sequence Header","AAC Raw"];return e=e||{},e.aacPacketType=n[t[0]],e.data=o(t.subarray(1)),e},l=function(t,e){var n=["Linear PCM, platform endian","ADPCM","MP3","Linear PCM, little endian","Nellymoser 16-kHz mono","Nellymoser 8-kHz mono","Nellymoser","G.711 A-law logarithmic PCM","G.711 mu-law logarithmic PCM","reserved","AAC","Speex","MP3 8-Khz","Device-specific sound"],i=["5.5-kHz","11-kHz","22-kHz","44-kHz"],r=(t[0]&parseInt("11110000",2))>>>4;return e=e||{},e.soundFormat=n[r],e.soundRate=i[(t[0]&parseInt("00001100",2))>>>2],e.soundSize=(t[0]&parseInt("00000010",2))>>>1?"16-bit":"8-bit",e.soundType=t[0]&parseInt("00000001",2)?"Stereo":"Mono",10===r?c(t.subarray(1),e):e},u=function(t){return{tagType:i[t[0]],dataSize:t[1]<<16|t[2]<<8|t[3],timestamp:t[7]<<24|t[4]<<16|t[5]<<8|t[6],streamID:t[8]<<16|t[9]<<8|t[10]}},h=function(t){var e=u(t);switch(t[0]){case 8:l(t.subarray(11),e);break;case 9:s(t.subarray(11),e);break;case 18:}return e},p=function(t){var e,n,i=9,r=[];for(i+=4;i<t.byteLength;)e=t[i+1]<<16,e|=t[i+2]<<8,e|=t[i+3],e+=11,n=t.subarray(i,i+e),r.push(h(n)),i+=e+4;return r},d=function(t){return JSON.stringify(t,null,2)};e.exports={inspectTag:h,inspect:p,textify:d}},{}],47:[function(t,e,n){(function(t){"use strict";var n,i,r=function(t){var e="";return e+=String.fromCharCode(t[0]),e+=String.fromCharCode(t[1]),e+=String.fromCharCode(t[2]),e+=String.fromCharCode(t[3])},o=function(t){return new Date(1e3*t-20828448e5)},a=function(t){return{isLeading:(12&t[0])>>>2,dependsOn:3&t[0],isDependedOn:(192&t[1])>>>6,hasRedundancy:(48&t[1])>>>4,paddingValue:(14&t[1])>>>1,isNonSyncSample:1&t[1],degradationPriority:t[2]<<8|t[3]}},s=function(t){var e,n,i=new DataView(t.buffer,t.byteOffset,t.byteLength),r=[];for(e=0;e+4<t.length;e+=n){if(n=i.getUint32(e),e+=4,0>=n)return;switch(31&t[e]){case 1:r.push("slice_layer_without_partitioning_rbsp");break;case 5:r.push("slice_layer_without_partitioning_rbsp_idr");break;case 6:r.push("sei_rbsp");break;case 7:r.push("seq_parameter_set_rbsp");break;case 8:r.push("pic_parameter_set_rbsp");break;case 9:r.push("access_unit_delimiter_rbsp");break;default:r.push(31&t[e])}}return r},c={avc1:function(t){var e=new DataView(t.buffer,t.byteOffset,t.byteLength);return{dataReferenceIndex:e.getUint16(6),width:e.getUint16(24),height:e.getUint16(26),horizresolution:e.getUint16(28)+e.getUint16(30)/16,vertresolution:e.getUint16(32)+e.getUint16(34)/16,frameCount:e.getUint16(40),depth:e.getUint16(74),config:n(t.subarray(78,t.byteLength))}},avcC:function(t){var e,n,i,r,o=new DataView(t.buffer,t.byteOffset,t.byteLength),a={configurationVersion:t[0],avcProfileIndication:t[1],profileCompatibility:t[2],avcLevelIndication:t[3],lengthSizeMinusOne:3&t[4],sps:[],pps:[]},s=31&t[5];for(i=6,r=0;s>r;r++)n=o.getUint16(i),i+=2,a.sps.push(new Uint8Array(t.subarray(i,i+n))),i+=n;for(e=t[i],i++,r=0;e>r;r++)n=o.getUint16(i),i+=2,a.pps.push(new Uint8Array(t.subarray(i,i+n))),i+=n;return a},btrt:function(t){var e=new DataView(t.buffer,t.byteOffset,t.byteLength);return{bufferSizeDB:e.getUint32(0),maxBitrate:e.getUint32(4),avgBitrate:e.getUint32(8)}},esds:function(t){return{version:t[0],flags:new Uint8Array(t.subarray(1,4)),esId:t[6]<<8|t[7],streamPriority:31&t[8],decoderConfig:{objectProfileIndication:t[11],streamType:t[12]>>>2&63,bufferSize:t[13]<<16|t[14]<<8|t[15],maxBitrate:t[16]<<24|t[17]<<16|t[18]<<8|t[19],avgBitrate:t[20]<<24|t[21]<<16|t[22]<<8|t[23],decoderConfigDescriptor:{tag:t[24],length:t[25],audioObjectType:t[26]>>>3&31,samplingFrequencyIndex:(7&t[26])<<1|t[27]>>>7&1,channelConfiguration:t[27]>>>3&15}}}},ftyp:function(t){for(var e=new DataView(t.buffer,t.byteOffset,t.byteLength),n={majorBrand:r(t.subarray(0,4)),minorVersion:e.getUint32(4),compatibleBrands:[]},i=8;i<t.byteLength;)n.compatibleBrands.push(r(t.subarray(i,i+4))),i+=4;return n},dinf:function(t){return{boxes:n(t)}},dref:function(t){return{version:t[0],flags:new Uint8Array(t.subarray(1,4)),dataReferences:n(t.subarray(8))}},hdlr:function(e){var n=new DataView(e.buffer,e.byteOffset,e.byteLength),i={version:n.getUint8(0),flags:new Uint8Array(e.subarray(1,4)),handlerType:r(e.subarray(8,12)),name:""},o=8;for(o=24;o<e.byteLength;o++){if(0===e[o]){o++;break}i.name+=String.fromCharCode(e[o])}return i.name=decodeURIComponent(t.escape(i.name)),i},mdat:function(t){return{byteLength:t.byteLength,nals:s(t)}},mdhd:function(t){var e,n=new DataView(t.buffer,t.byteOffset,t.byteLength),i=4,r={version:n.getUint8(0),flags:new Uint8Array(t.subarray(1,4)),language:""};return 1===r.version?(i+=4,r.creationTime=o(n.getUint32(i)),i+=8,r.modificationTime=o(n.getUint32(i)),i+=4,r.timescale=n.getUint32(i),i+=8,r.duration=n.getUint32(i)):(r.creationTime=o(n.getUint32(i)),i+=4,r.modificationTime=o(n.getUint32(i)),i+=4,r.timescale=n.getUint32(i),i+=4,r.duration=n.getUint32(i)),i+=4,e=n.getUint16(i),r.language+=String.fromCharCode((e>>10)+96),r.language+=String.fromCharCode(((960&e)>>5)+96),r.language+=String.fromCharCode((31&e)+96),r},mdia:function(t){return{boxes:n(t)}},mfhd:function(t){return{version:t[0],flags:new Uint8Array(t.subarray(1,4)),sequenceNumber:t[4]<<24|t[5]<<16|t[6]<<8|t[7]}},minf:function(t){return{boxes:n(t)}},mp4a:function(t){var e=new DataView(t.buffer,t.byteOffset,t.byteLength),i={dataReferenceIndex:e.getUint16(6),channelcount:e.getUint16(16),samplesize:e.getUint16(18),samplerate:e.getUint16(24)+e.getUint16(26)/65536};return t.byteLength>28&&(i.streamDescriptor=n(t.subarray(28))[0]),i},moof:function(t){return{boxes:n(t)}},moov:function(t){return{boxes:n(t)}},mvex:function(t){return{boxes:n(t)}},mvhd:function(t){var e=new DataView(t.buffer,t.byteOffset,t.byteLength),n=4,i={version:e.getUint8(0),flags:new Uint8Array(t.subarray(1,4))};return 1===i.version?(n+=4,i.creationTime=o(e.getUint32(n)),n+=8,i.modificationTime=o(e.getUint32(n)),n+=4,i.timescale=e.getUint32(n),n+=8,i.duration=e.getUint32(n)):(i.creationTime=o(e.getUint32(n)),n+=4,i.modificationTime=o(e.getUint32(n)),n+=4,i.timescale=e.getUint32(n),n+=4,i.duration=e.getUint32(n)),n+=4,i.rate=e.getUint16(n)+e.getUint16(n+2)/16,n+=4,i.volume=e.getUint8(n)+e.getUint8(n+1)/8,n+=2,n+=2,n+=8,i.matrix=new Uint32Array(t.subarray(n,n+36)),n+=36,n+=24,i.nextTrackId=e.getUint32(n),i},pdin:function(t){var e=new DataView(t.buffer,t.byteOffset,t.byteLength);return{version:e.getUint8(0),flags:new Uint8Array(t.subarray(1,4)),rate:e.getUint32(4),initialDelay:e.getUint32(8)}},sdtp:function(t){var e,n={version:t[0],flags:new Uint8Array(t.subarray(1,4)),samples:[]};for(e=4;e<t.byteLength;e++)n.samples.push({dependsOn:(48&t[e])>>4,isDependedOn:(12&t[e])>>2,hasRedundancy:3&t[e]});return n},sidx:function(t){var e,n=new DataView(t.buffer,t.byteOffset,t.byteLength),i={version:t[0],flags:new Uint8Array(t.subarray(1,4)),references:[],referenceId:n.getUint32(4),timescale:n.getUint32(8),earliestPresentationTime:n.getUint32(12),firstOffset:n.getUint32(16)},r=n.getUint16(22);for(e=24;r;e+=12,r--)i.references.push({referenceType:(128&t[e])>>>7,referencedSize:2147483647&n.getUint32(e),subsegmentDuration:n.getUint32(e+4),startsWithSap:!!(128&t[e+8]),sapType:(112&t[e+8])>>>4,sapDeltaTime:268435455&n.getUint32(e+8)});return i},smhd:function(t){return{version:t[0],flags:new Uint8Array(t.subarray(1,4)),balance:t[4]+t[5]/256}},stbl:function(t){return{boxes:n(t)}},stco:function(t){var e,n=new DataView(t.buffer,t.byteOffset,t.byteLength),i={version:t[0],flags:new Uint8Array(t.subarray(1,4)),chunkOffsets:[]},r=n.getUint32(4);for(e=8;r;e+=4,r--)i.chunkOffsets.push(n.getUint32(e));return i},stsc:function(t){var e,n=new DataView(t.buffer,t.byteOffset,t.byteLength),i=n.getUint32(4),r={version:t[0],flags:new Uint8Array(t.subarray(1,4)),sampleToChunks:[]};for(e=8;i;e+=12,i--)r.sampleToChunks.push({firstChunk:n.getUint32(e),samplesPerChunk:n.getUint32(e+4),sampleDescriptionIndex:n.getUint32(e+8)});return r},stsd:function(t){return{version:t[0],flags:new Uint8Array(t.subarray(1,4)),sampleDescriptions:n(t.subarray(8))}},stsz:function(t){var e,n=new DataView(t.buffer,t.byteOffset,t.byteLength),i={version:t[0],flags:new Uint8Array(t.subarray(1,4)),sampleSize:n.getUint32(4),entries:[]};for(e=12;e<t.byteLength;e+=4)i.entries.push(n.getUint32(e));return i},stts:function(t){var e,n=new DataView(t.buffer,t.byteOffset,t.byteLength),i={version:t[0],flags:new Uint8Array(t.subarray(1,4)),timeToSamples:[]},r=n.getUint32(4);for(e=8;r;e+=8,r--)i.timeToSamples.push({sampleCount:n.getUint32(e),sampleDelta:n.getUint32(e+4)});return i},styp:function(t){return c.ftyp(t)},tfdt:function(t){return{version:t[0],flags:new Uint8Array(t.subarray(1,4)),baseMediaDecodeTime:t[4]<<24|t[5]<<16|t[6]<<8|t[7]}},tfhd:function(t){var e,n=new DataView(t.buffer,t.byteOffset,t.byteLength),i={version:t[0],flags:new Uint8Array(t.subarray(1,4)),trackId:n.getUint32(4)},r=1&i.flags[2],o=2&i.flags[2],a=8&i.flags[2],s=16&i.flags[2],c=32&i.flags[2];return e=8,r&&(e+=4,i.baseDataOffset=n.getUint32(12),e+=4),o&&(i.sampleDescriptionIndex=n.getUint32(e),e+=4),a&&(i.defaultSampleDuration=n.getUint32(e),e+=4),s&&(i.defaultSampleSize=n.getUint32(e),e+=4),c&&(i.defaultSampleFlags=n.getUint32(e)),i},tkhd:function(t){var e=new DataView(t.buffer,t.byteOffset,t.byteLength),n=4,i={version:e.getUint8(0),flags:new Uint8Array(t.subarray(1,4))};return 1===i.version?(n+=4,i.creationTime=o(e.getUint32(n)),n+=8,i.modificationTime=o(e.getUint32(n)),n+=4,i.trackId=e.getUint32(n),n+=4,n+=8,i.duration=e.getUint32(n)):(i.creationTime=o(e.getUint32(n)),n+=4,i.modificationTime=o(e.getUint32(n)),n+=4,i.trackId=e.getUint32(n),n+=4,n+=4,i.duration=e.getUint32(n)),n+=4,n+=8,i.layer=e.getUint16(n),n+=2,i.alternateGroup=e.getUint16(n),n+=2,i.volume=e.getUint8(n)+e.getUint8(n+1)/8,n+=2,n+=2,i.matrix=new Uint32Array(t.subarray(n,n+36)),n+=36,i.width=e.getUint16(n)+e.getUint16(n+2)/16,n+=4,i.height=e.getUint16(n)+e.getUint16(n+2)/16,i},traf:function(t){return{boxes:n(t)}},trak:function(t){return{boxes:n(t)}},trex:function(t){var e=new DataView(t.buffer,t.byteOffset,t.byteLength);return{version:t[0],flags:new Uint8Array(t.subarray(1,4)),trackId:e.getUint32(4),defaultSampleDescriptionIndex:e.getUint32(8),defaultSampleDuration:e.getUint32(12),defaultSampleSize:e.getUint32(16),sampleDependsOn:3&t[20],sampleIsDependedOn:(192&t[21])>>6,sampleHasRedundancy:(48&t[21])>>4,samplePaddingValue:(14&t[21])>>1,sampleIsDifferenceSample:!!(1&t[21]),sampleDegradationPriority:e.getUint16(22)}},trun:function(t){var e,n={version:t[0],flags:new Uint8Array(t.subarray(1,4)),samples:[]},i=new DataView(t.buffer,t.byteOffset,t.byteLength),r=1&n.flags[2],o=4&n.flags[2],s=1&n.flags[1],c=2&n.flags[1],l=4&n.flags[1],u=8&n.flags[1],h=i.getUint32(4),p=8;for(r&&(n.dataOffset=i.getUint32(p),p+=4),o&&h&&(e={flags:a(t.subarray(p,p+4))},p+=4,s&&(e.duration=i.getUint32(p),p+=4),c&&(e.size=i.getUint32(p),p+=4),u&&(e.compositionTimeOffset=i.getUint32(p),p+=4),n.samples.push(e),h--);h--;)e={},s&&(e.duration=i.getUint32(p),p+=4),c&&(e.size=i.getUint32(p),p+=4),l&&(e.flags=a(t.subarray(p,p+4)),p+=4),u&&(e.compositionTimeOffset=i.getUint32(p),p+=4),n.samples.push(e);return n},"url ":function(t){return{version:t[0],flags:new Uint8Array(t.subarray(1,4))}},vmhd:function(t){var e=new DataView(t.buffer,t.byteOffset,t.byteLength);return{version:t[0],flags:new Uint8Array(t.subarray(1,4)),graphicsmode:e.getUint16(4),opcolor:new Uint16Array([e.getUint16(6),e.getUint16(8),e.getUint16(10)])}}};n=function(t){for(var e,n,i,o,a,s=0,l=[],u=new ArrayBuffer(t.length),h=new Uint8Array(u),p=0;p<t.length;++p)h[p]=t[p];for(e=new DataView(u);s<t.byteLength;)n=e.getUint32(s),i=r(t.subarray(s+4,s+8)),o=n>1?s+n:t.byteLength,a=(c[i]||function(t){return{data:t}})(t.subarray(s+8,o)),a.size=n,a.type=i,l.push(a),s=o;return l},i=function(t,e){var n;return e=e||0,n=new Array(2*e+1).join(" "),t.map(function(t,r){return n+t.type+"\n"+Object.keys(t).filter(function(t){return"type"!==t&&"boxes"!==t}).map(function(e){var i=n+"  "+e+": ",r=t[e];if(r instanceof Uint8Array||r instanceof Uint32Array){var o=Array.prototype.slice.call(new Uint8Array(r.buffer,r.byteOffset,r.byteLength)).map(function(t){return" "+("00"+t.toString(16)).slice(-2)}).join("").match(/.{1,24}/g);return o?1===o.length?i+"<"+o.join("").slice(1)+">":i+"<\n"+o.map(function(t){return n+"  "+t}).join("\n")+"\n"+n+"  >":i+"<>"}return i+JSON.stringify(r,null,2).split("\n").map(function(t,e){return 0===e?t:n+"  "+t}).join("\n")}).join("\n")+(t.boxes?"\n"+i(t.boxes,e+1):"")}).join("\n")},e.exports={inspect:n,textify:i}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],48:[function(t,e,n){"use strict";var i;i=function(t){var e=t.byteLength,n=0,i=0;this.length=function(){return 8*e},this.bitsAvailable=function(){return 8*e+i},this.loadWord=function(){var r=t.byteLength-e,o=new Uint8Array(4),a=Math.min(4,e);if(0===a)throw new Error("no bytes available");o.set(t.subarray(r,r+a)),n=new DataView(o.buffer).getUint32(0),i=8*a,e-=a},this.skipBits=function(t){var r;i>t?(n<<=t,i-=t):(t-=i,r=Math.floor(t/8),t-=8*r,e-=r,this.loadWord(),n<<=t,i-=t)},this.readBits=function(t){var r=Math.min(i,t),o=n>>>32-r;return i-=r,i>0?n<<=r:e>0&&this.loadWord(),r=t-r,r>0?o<<r|this.readBits(r):o},this.skipLeadingZeros=function(){var t;for(t=0;i>t;++t)if(0!==(n&2147483648>>>t))return n<<=t,i-=t,t;return this.loadWord(),t+this.skipLeadingZeros()},this.skipUnsignedExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.skipExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.readUnsignedExpGolomb=function(){var t=this.skipLeadingZeros();return this.readBits(t+1)-1},this.readExpGolomb=function(){var t=this.readUnsignedExpGolomb();return 1&t?1+t>>>1:-1*(t>>>1)},this.readBoolean=function(){return 1===this.readBits(1)},this.readUnsignedByte=function(){return this.readBits(8)},this.loadWord()},e.exports=i},{}],49:[function(t,e,n){"use strict";var i=function(){this.init=function(){var t={};this.on=function(e,n){t[e]||(t[e]=[]),t[e].push(n)},this.off=function(e,n){var i;return!!t[e]&&(i=t[e].indexOf(n),t[e].splice(i,1),i>-1)},this.trigger=function(e){var n,i,r,o;if(n=t[e])if(2===arguments.length)for(r=n.length,i=0;r>i;++i)n[i].call(this,arguments[1]);else{for(o=[],i=arguments.length,i=1;i<arguments.length;++i)o.push(arguments[i]);for(r=n.length,i=0;r>i;++i)n[i].apply(this,o)}},this.dispose=function(){t={}}}};i.prototype.pipe=function(t){return this.on("data",function(e){t.push(e)}),this.on("done",function(){t.flush()}),t},i.prototype.push=function(t){this.trigger("data",t)},i.prototype.flush=function(){this.trigger("done")},e.exports=i},{}],50:[function(t,e,n){var i=arguments[3],r=arguments[4],o=arguments[5],a=JSON.stringify;e.exports=function(t){for(var e,n=Object.keys(o),s=0,c=n.length;c>s;s++){var l=n[s];if(o[l].exports===t){e=l;break}}if(!e){e=Math.floor(Math.pow(16,8)*Math.random()).toString(16);for(var u={},s=0,c=n.length;c>s;s++){var l=n[s];u[l]=l}r[e]=[Function(["require","module","exports"],"("+t+")(self)"),u]}var h=Math.floor(Math.pow(16,8)*Math.random()).toString(16),p={};p[e]=e,r[h]=[Function(["require"],"require("+a(e)+")(self)"),p];var d="("+i+")({"+Object.keys(r).map(function(t){return a(t)+":["+r[t][0]+","+a(r[t][1])+"]"}).join(",")+"},{},["+a(h)+"])",f=window.URL||window.webkitURL||window.mozURL||window.msURL;return new Worker(f.createObjectURL(new Blob([d],{type:"text/javascript"})))}},{}],51:[function(t,e,n){(function(i){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),c=function(t,e,n){for(var i=!0;i;){var r=t,o=e,a=n;i=!1,null===r&&(r=Function.prototype);var s=Object.getOwnPropertyDescriptor(r,o);if(void 0!==s){if("value"in s)return s.value;var c=s.get;if(void 0===c)return;return c.call(a)}var l=Object.getPrototypeOf(r);if(null===l)return;t=l,e=o,n=a,i=!0,s=l=void 0}},l=t("./playlist-loader"),u=r(l),h=t("./playlist"),p=r(h),d=t("./xhr"),f=r(d),m=t("./decrypter"),v=t("./bin-utils"),g=r(v),y=t("videojs-contrib-media-sources"),E=t("./m3u8"),_=r(E),T="undefined"!=typeof window?window.videojs:"undefined"!=typeof i?i.videojs:null,b=r(T),w=t("./resolve-url"),R=r(w),x={PlaylistLoader:u.default,Playlist:p.default,Decrypter:m.Decrypter,AsyncStream:m.AsyncStream,decrypt:m.decrypt,utils:g.default,xhr:f.default};x.GOAL_BUFFER_LENGTH=30,x.canPlaySource=function(){return b.default.log.warn("HLS is no longer a tech. Please remove it from your player's techOrder.")},x.findSoleUncommonTimeRangesEnd_=function(t,e){var n=void 0,i=void 0,r=void 0,o=[],a=[],s=function(t){return t[0]<=r&&t[1]>=r};if(t)for(n=0;n<t.length;n++)i=t.start(n),r=t.end(n),a.push([i,r]);if(e)for(n=0;n<e.length;n++)i=e.start(n),r=e.end(n),a.some(s)||o.push(r);return 1!==o.length?null:o[0]},x.supportsNativeHls=function(){var t=document.createElement("video"),e=void 0,n=void 0;return!!b.default.getComponent("Html5").isSupported()&&(e=t.canPlayType("application/x-mpegURL"),n=t.canPlayType("application/vnd.apple.mpegURL"),/probably|maybe/.test(e)||/probably|maybe/.test(n))}(),x.isSupported=function(){return b.default.log.warn("HLS is no longer a tech. Please remove it from your player's techOrder.")},x.comparePlaylistBandwidth=function(t,e){var n=void 0,i=void 0;return t.attributes&&t.attributes.BANDWIDTH&&(n=t.attributes.BANDWIDTH),n=n||window.Number.MAX_VALUE,e.attributes&&e.attributes.BANDWIDTH&&(i=e.attributes.BANDWIDTH),i=i||window.Number.MAX_VALUE,n-i},x.comparePlaylistResolution=function(t,e){var n=void 0,i=void 0;return t.attributes&&t.attributes.RESOLUTION&&t.attributes.RESOLUTION.width&&(n=t.attributes.RESOLUTION.width),n=n||window.Number.MAX_VALUE,e.attributes&&e.attributes.RESOLUTION&&e.attributes.RESOLUTION.width&&(i=e.attributes.RESOLUTION.width),i=i||window.Number.MAX_VALUE,n===i&&t.attributes.BANDWIDTH&&e.attributes.BANDWIDTH?t.attributes.BANDWIDTH-e.attributes.BANDWIDTH:n-i};var H=1.2,M=3e5,S=1/30,C=b.default.getComponent("Component"),A=500,P=function(t){return t.retries&&t.retries>=2},L=function(t,e){var n=void 0;return t?(n=getComputedStyle(t),n?n[e]:""):""},O=function(t,e,n){if(t){var i=t.segments[e],r=t.segments[e-1];n&&i&&(i.end=n,r?r.end&&(i.duration=i.end-r.end):i.duration=i.end)}},j=function(t,e,n,i){if(!t)return!1;var r=t.segments,o=n===r.length-1,a=i.length&&r[r.length-1].end<=i.end(0);return t.endList&&"open"===e.readyState&&(o||a)},k=function(t){var e={codecCount:0,videoCodec:null,audioProfile:null};return e.codecCount=t.split(",").length,e.codecCount=e.codecCount||2,e.videoCodec=/(^|\s|,)+(avc1)[^ ,]*/i.exec(t),e.videoCodec=e.videoCodec&&e.videoCodec[2],e.audioProfile=/(^|\s|,)+mp4a.\d+\.(\d+)/i.exec(t),e.audioProfile=e.audioProfile&&e.audioProfile[2],e},I=function(t){return function(e){var n=void 0,i=[],r=this.tech_,o=r.buffered();if("undefined"==typeof e&&(e=r.currentTime()),!this.mediaSource||!this.mediaSource.mediaSource_||!this.mediaSource.mediaSource_.sourceBuffers.length)return b.default.createTimeRanges([]);if(o&&o.length)for(n=0;n<o.length;n++)t(o.start(n),o.end(n),e)&&i.push([o.start(n),o.end(n)]);return b.default.createTimeRanges(i)}},D=function(t){function e(t,n){var i=this;o(this,e),c(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t);var r=void 0;t.options_&&t.options_.playerId&&(r=(0,b.default)(t.options_.playerId),r.hls||Object.defineProperty(r,"hls",{get:function(){return b.default.log.warn("player.hls is deprecated. Use player.tech.hls instead."),i}})),this.tech_=t,this.source_=n.source,this.mode_=n.mode,this.pendingSegment_=null,this.bandwidth=n.bandwidth||4194304,this.bytesReceived=0,this.loadingState_="none","none"!==this.tech_.preload()&&(this.loadingState_="meta"),this.startCheckingBuffer_(),this.on(this.tech_,"seeking",function(){this.setCurrentTime(this.tech_.currentTime())}),this.on(this.tech_,"error",function(){this.stopCheckingBuffer_()}),this.on(this.tech_,"play",this.play)}return a(e,t),s(e,[{key:"src",value:function(t){var e=this,n=void 0;t&&(this.mediaSource=new b.default.MediaSource({mode:this.mode_}),this.mediaSource.addEventListener("sourceopen",this.handleSourceOpen.bind(this)),this.options_={},"undefined"!=typeof this.source_.withCredentials?this.options_.withCredentials=this.source_.withCredentials:b.default.options.hls&&(this.options_.withCredentials=b.default.options.hls.withCredentials),this.playlists=new x.PlaylistLoader(this.source_.src,this.options_.withCredentials),this.tech_.one("canplay",this.setupFirstPlay.bind(this)),this.playlists.on("loadedmetadata",function(){n=e.playlists.media(),n.endList&&"metadata"!==e.tech_.preload()&&"none"!==e.tech_.preload()&&(e.loadingState_="segments"),e.setupSourceBuffer_(),e.setupFirstPlay(),e.fillBuffer(),e.tech_.trigger("loadedmetadata")}),this.playlists.on("error",function(){e.blacklistCurrentPlaylist_(e.playlists.error)}),this.playlists.on("loadedplaylist",function(){var t=e.playlists.media(),i=void 0;return t?(e.updateDuration(e.playlists.media()),i=e.seekable(),e.duration()===1/0&&0!==i.length&&e.mediaSource.addSeekableRange_(i.start(0),i.end(0)),void(n=t)):void e.playlists.media(e.selectPlaylist())}),this.playlists.on("mediachange",function(){e.tech_.trigger({type:"mediachange",bubbles:!0})}),this.tech_.el()&&this.tech_.src(b.default.URL.createObjectURL(this.mediaSource)))}},{key:"handleSourceOpen",value:function(){this.sourceBuffer||this.setupSourceBuffer_(),this.tech_.autoplay()&&this.play()}},{key:"excludeIncompatibleVariants_",value:function(t){var e=this.playlists.master,n=2,i=null,r=null,o=void 0;t.attributes&&t.attributes.CODECS&&(o=k(t.attributes.CODECS),i=o.videoCodec,r=o.audioProfile,n=o.codecCount),e.playlists.forEach(function(t){var e={codecCount:2,videoCodec:null,audioProfile:null};t.attributes&&t.attributes.CODECS&&(e=k(t.attributes.CODECS)),e.codecCount!==n&&(t.excludeUntil=1/0),e.videoCodec!==i&&(t.excludeUntil=1/0),("5"===e.audioProfile&&"5"!==r||"5"===r&&"5"!==e.audioProfile)&&(t.excludeUntil=1/0)})}},{key:"setupSourceBuffer_",value:function(){var t=this.playlists.media(),e=void 0;t&&"open"===this.mediaSource.readyState&&(e="video/mp2t",t.attributes&&t.attributes.CODECS&&(e+='; codecs="'+t.attributes.CODECS+'"'),this.sourceBuffer=this.mediaSource.addSourceBuffer(e),this.excludeIncompatibleVariants_(t),this.sourceBuffer.addEventListener("updateend",this.updateEndHandler_.bind(this)))}},{key:"setupFirstPlay",value:function(){var t=void 0,e=this.playlists.media();this.duration()===1/0&&0===this.tech_.played().length&&!this.tech_.paused()&&this.sourceBuffer&&e&&this.tech_.readyState()>=1&&(this.playlists.trigger("firstplay"),t=this.seekable(),t.length&&this.tech_.setCurrentTime(t.end(0)))}},{key:"play",value:function(){return this.loadingState_="segments",this.tech_.ended()&&this.tech_.setCurrentTime(0),0===this.tech_.played().length?this.setupFirstPlay():void(this.duration()===1/0&&this.tech_.currentTime()<this.seekable().start(0)&&this.tech_.setCurrentTime(this.seekable().start(0)))}},{key:"setCurrentTime",value:function(t){var e=this.findBufferedRange_();return this.playlists&&this.playlists.media()&&this.playlists.media().segments?e&&e.length?t:this.pendingSegment_&&this.pendingSegment_.buffered?t:(this.lastSegmentLoaded_=null,this.cancelSegmentXhr(),this.keyXhr_&&(this.keyXhr_.aborted=!0,this.cancelKeyXhr()),void this.fillBuffer(this.playlists.getMediaIndexForTime_(t))):0}},{key:"duration",value:function(){var t=this.playlists;return t?this.mediaSource?this.mediaSource.duration:x.Playlist.duration(t.media()):0}},{key:"seekable",value:function t(){var e=void 0,t=void 0;return this.playlists&&(e=this.playlists.media())?(t=x.Playlist.seekable(e),0===t.length?t:0===t.start(0)?b.default.createTimeRanges([[this.playlists.expired_,this.playlists.expired_+t.end(0)]]):t):b.default.createTimeRanges()}},{key:"updateDuration",value:function(t){var e=this,n=this.mediaSource.duration,i=x.Playlist.duration(t),r=this.tech_.buffered(),o=function t(){e.mediaSource.duration=i,e.tech_.trigger("durationchange"),e.mediaSource.removeEventListener("sourceopen",t)};r.length>0&&(i=Math.max(i,r.end(r.length-1))),n!==i&&("open"!==this.mediaSource.readyState?this.mediaSource.addEventListener("sourceopen",o):this.sourceBuffer&&this.sourceBuffer.updating||(this.mediaSource.duration=i,this.tech_.trigger("durationchange")))}},{key:"resetSrc_",value:function(){this.cancelSegmentXhr(),this.cancelKeyXhr(),this.sourceBuffer&&"open"===this.mediaSource.readyState&&this.sourceBuffer.abort()}},{key:"cancelKeyXhr",value:function(){this.keyXhr_&&(this.keyXhr_.onreadystatechange=null,this.keyXhr_.abort(),this.keyXhr_=null)}},{key:"cancelSegmentXhr",value:function(){this.segmentXhr_&&(this.segmentXhr_.onreadystatechange=null,this.segmentXhr_.abort(),this.segmentXhr_=null),this.pendingSegment_=null}},{key:"dispose",value:function(){this.stopCheckingBuffer_(),this.playlists&&this.playlists.dispose(),this.resetSrc_(),c(Object.getPrototypeOf(e.prototype),"dispose",this).call(this)}},{key:"selectPlaylist",value:function(){var t=void 0,e=this.playlists.master.playlists.slice(),n=[],i=+new Date,r=void 0,o=void 0,a=void 0,s=void 0,c=void 0,l=void 0,u=void 0,h=void 0;for(e.sort(x.comparePlaylistBandwidth),e=e.filter(function(t){return"undefined"==typeof t.excludeUntil||i>=t.excludeUntil}),r=e.length;r--;)o=e[r],o.attributes&&o.attributes.BANDWIDTH&&(t=o.attributes.BANDWIDTH*H,t<this.bandwidth&&(n.push(o),a||(a=o)));for(r=n.length,n.sort(x.comparePlaylistResolution),o=null,u=parseInt(L(this.tech_.el(),"width"),10),h=parseInt(L(this.tech_.el(),"height"),10);r--;)if(o=n[r],o.attributes&&o.attributes.RESOLUTION&&o.attributes.RESOLUTION.width&&o.attributes.RESOLUTION.height){var p=o.attributes.RESOLUTION;if(p.width===u&&p.height===h){s=null,l=o;break}if(p.width<u&&p.height<h)break;(!s||p.width<c.width&&p.height<c.height)&&(s=o,c=s.attributes.RESOLUTION)}return s||l||a||e[0]}},{key:"checkBuffer_",value:function(){this.checkBufferTimeout_&&(window.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=null),this.fillBuffer(),this.drainBuffer(),this.checkBufferTimeout_=window.setTimeout(this.checkBuffer_.bind(this),A)}},{key:"startCheckingBuffer_",value:function(){this.checkBuffer_()}},{key:"stopCheckingBuffer_",value:function(){this.checkBufferTimeout_&&(window.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=null)}},{key:"fillBuffer",value:function(t){var e=this.tech_,n=e.currentTime(),i=0!==this.tech_.buffered().length,r=this.findBufferedRange_(),o=!(r&&r.length),a=0,s=0,c=void 0,l=void 0,u=void 0;if("segments"===this.loadingState_&&e.currentSrc()&&this.playlists&&!this.segmentXhr_&&!this.pendingSegment_&&"HAVE_NOTHING"!==this.playlists.state&&this.playlists.media()&&this.playlists.media().segments&&"SWITCHING_MEDIA"!==this.playlists.state){if("undefined"==typeof t)if(r&&r.length){if(a=r.end(0),t=this.playlists.getMediaIndexForTime_(a),s=Math.max(0,a-n),s>=x.GOAL_BUFFER_LENGTH)return}else t=this.playlists.getMediaIndexForTime_(this.tech_.currentTime());if(c=this.playlists.media().segments[t]){if(this.lastSegmentLoaded_&&this.playlistUriToUrl(this.lastSegmentLoaded_.uri)===this.playlistUriToUrl(c.uri)&&this.lastSegmentLoaded_.byterange===c.byterange)return this.fillBuffer(t+1);l={uri:this.playlistUriToUrl(c.uri),mediaIndex:t,mediaSequence:this.playlists.media().mediaSequence,playlist:this.playlists.media(),currentBufferedEnd:a,bytes:null,encryptedBytes:null,decrypter:null,buffered:null,timestampOffset:null},t>0&&(u=x.Playlist.duration(l.playlist,l.playlist.mediaSequence+t)+this.playlists.expired_),this.tech_.seeking()&&o?l.playlist.discontinuityStarts.length&&(l.timestampOffset=u):c.discontinuity&&r.length?l.timestampOffset=r.end(0):!i&&this.tech_.currentTime()>.05&&(l.timestampOffset=u),this.loadSegment(l)}}}},{key:"playlistUriToUrl",value:function(t){var e=void 0;return e=this.playlists.media().uri===this.source_.src?(0,R.default)(this.source_.src,t):(0,R.default)((0,R.default)(this.source_.src,this.playlists.media().uri||""),t);
}},{key:"byterangeStr_",value:function(t){var e=void 0,n=void 0;return n=t.offset+t.length-1,e=t.offset,"bytes="+e+"-"+n}},{key:"segmentXhrHeaders_",value:function(t){var e={};return"byterange"in t&&(e.Range=this.byterangeStr_(t.byterange)),e}},{key:"setBandwidth",value:function(t){this.segmentXhrTime=t.roundTripTime,this.bandwidth=t.bandwidth,this.bytesReceived+=t.bytesReceived||0,this.tech_.trigger("bandwidthupdate")}},{key:"blacklistCurrentPlaylist_",value:function(t){var e=void 0,n=void 0;return(e=t.playlist||this.playlists.media())?(e.excludeUntil=Date.now()+M,(n=this.selectPlaylist())?(b.default.log.warn("Problem encountered with the current HLS playlist. Switching to another playlist."),this.playlists.media(n)):(b.default.log.warn("Problem encountered with the current HLS playlist. No suitable alternatives found."),this.error=t,this.mediaSource.endOfStream("network"))):(this.error=t,this.mediaSource.endOfStream("network"))}},{key:"loadSegment",value:function(t){var e=this,n=t.playlist.segments[t.mediaIndex],i=0,r=this.seekable(),o=this.tech_.currentTime();this.sourceBuffer&&!this.sourceBuffer.updating&&(i=r.length&&r.start(0)>0&&r.start(0)<o?r.start(0):o-60,i>0&&this.sourceBuffer.remove(0,i)),n.key&&this.fetchKey_(n),this.segmentXhr_=x.xhr({uri:t.uri,responseType:"arraybuffer",withCredentials:this.source_.withCredentials,timeout:1.5*n.duration*1e3,headers:this.segmentXhrHeaders_(n)},function(i,r){return e.segmentXhr_&&r===e.segmentXhr_?(e.segmentXhr_=null,r.timedout?(e.bandwidth=1,e.playlists.media(e.selectPlaylist())):!r.aborted&&i?e.blacklistCurrentPlaylist_({status:r.status,message:"HLS segment request error at URL: "+t.uri,code:r.status>=500?4:2}):void(r.response&&(e.lastSegmentLoaded_=n,e.setBandwidth(r),n.key?t.encryptedBytes=new Uint8Array(r.response):t.bytes=new Uint8Array(r.response),e.pendingSegment_=t,e.tech_.trigger("progress"),e.drainBuffer(),e.playlists.media(e.selectPlaylist())))):void 0})}},{key:"drainBuffer",value:function(){var t=void 0,e=void 0,n=void 0,i=void 0,r=void 0,o=void 0,a=void 0;if(this.pendingSegment_&&this.sourceBuffer&&!this.pendingSegment_.buffered&&!this.sourceBuffer.updating){if(t=this.pendingSegment_,e=t.mediaIndex,n=t.playlist,i=t.bytes,r=n.segments[e],r.key&&!i){if(P(r.key))return this.blacklistCurrentPlaylist_({message:"HLS segment key request error.",code:4});if(!r.key.bytes)return;if(t.decrypter)return;return a=r.key.iv||new Uint32Array([0,0,0,e+n.mediaSequence]),o=new x.Decrypter(t.encryptedBytes,r.key.bytes,a,function(e,n){e&&b.default.log.warn(e),t.bytes=n}),void(t.decrypter=o)}this.pendingSegment_.buffered=this.tech_.buffered(),null!==t.timestampOffset&&(this.sourceBuffer.timestampOffset=t.timestampOffset),this.sourceBuffer.appendBuffer(i)}}},{key:"updateEndHandler_",value:function(){var t=this.pendingSegment_,e=void 0,n=void 0,i=void 0,r=void 0,o=void 0,a=void 0;if(!t)return void(this.pendingSegment_=null);if(t.buffered){if(this.pendingSegment_=null,e=t.playlist,n=t.mediaIndex+(t.mediaSequence-e.mediaSequence),i=this.findBufferedRange_(),a=j(e,this.mediaSource,n,i),t.playlist.uri!==this.playlists.media().uri)return a?this.mediaSource.endOfStream():this.fillBuffer();if(r=this.seekable(),this.tech_.seeking()&&0===i.length&&r.length&&this.tech_.currentTime()<r.start(0)){var s=this.findNextBufferedRange_();s.length&&(b.default.log("tried seeking to",this.tech_.currentTime(),"but that was too early, retrying at",s.start(0)),this.tech_.setCurrentTime(s.start(0)+S))}return o=x.findSoleUncommonTimeRangesEnd_(t.buffered,this.tech_.buffered()),O(e,n,o),a?this.mediaSource.endOfStream():null!==o||t.buffered.length!==this.tech_.buffered().length?(this.updateDuration(e),void this.fillBuffer()):void this.fillBuffer(n+1)}}},{key:"fetchKey_",value:function(t){var e=this,n=void 0,i=void 0,r=void 0;return!this.keyXhr_&&(i=this.options_,r=function(n){return function(i,r){var o=void 0;return e.keyXhr_=null,i||!r.response||16!==r.response.byteLength?(n.retries=n.retries||0,n.retries++,void(r.aborted||e.fetchKey_(t))):(o=new DataView(r.response),n.bytes=new Uint32Array([o.getUint32(0),o.getUint32(4),o.getUint32(8),o.getUint32(12)]),void e.checkBuffer_())}},n=t.key)?n.bytes||P(n)?void 0:void(this.keyXhr_=x.xhr({uri:this.playlistUriToUrl(n.uri),responseType:"arraybuffer",withCredentials:i.withCredentials},r(n))):void 0}}]),e}(C);n.default=D,D.prototype.findBufferedRange_=I(function(t,e,n){return n>=t-S&&e+S>=n}),D.prototype.findNextBufferedRange_=I(function(t,e,n){return t-S>=n});var B=function t(e){return{canHandleSource:function(e){return t.canPlayType(e.type)},handleSource:function(t,n){return"flash"===e&&n.setTimeout(function(){n.trigger("loadstart")},1),n.hls=new D(n,{source:t,mode:e}),n.hls.src(t.src),n.hls},canPlayType:function(e){return t.canPlayType(e)}}};B.canPlayType=function(t){var e=/^application\/(?:x-|vnd\.apple\.)mpegurl/i;return!x.supportsNativeHls&&e.test(t)},"undefined"!=typeof b.default.MediaSource&&"undefined"!=typeof b.default.URL||(b.default.MediaSource=y.MediaSource,b.default.URL=y.URL),y.MediaSource.supportsNativeMediaSources()&&b.default.getComponent("Html5").registerSourceHandler(B("html5")),window.Uint8Array&&b.default.getComponent("Flash").registerSourceHandler(B("flash")),b.default.HlsHandler=D,b.default.HlsSourceHandler=B,b.default.Hls=x,b.default.m3u8=_.default,n.default={Hls:x,HlsHandler:D,HlsSourceHandler:B},e.exports=n.default}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./bin-utils":1,"./decrypter":5,"./m3u8":6,"./playlist":11,"./playlist-loader":10,"./resolve-url":12,"./xhr":14,"videojs-contrib-media-sources":28}]},{},[51])(51)}),THREE.InstavrControls=function(t,e){function n(){return 2*Math.PI/60/60*O.autoRotateSpeed}function i(){return Math.pow(.95,O.zoomSpeed)}function r(t){G-=t}function o(t){V-=t}function a(t){O.object instanceof THREE.PerspectiveCamera?z/=t:O.object instanceof THREE.OrthographicCamera?(O.object.zoom=Math.max(O.minZoom,Math.min(O.maxZoom,O.object.zoom*t)),O.object.updateProjectionMatrix(),X=!0):(console.warn("WARNING: InstavrControls.js encountered an unknown camera type - dolly/zoom disabled."),O.enableZoom=!1)}function s(t){O.object instanceof THREE.PerspectiveCamera?z*=t:O.object instanceof THREE.OrthographicCamera?(O.object.zoom=Math.max(O.minZoom,Math.min(O.maxZoom,O.object.zoom/t)),O.object.updateProjectionMatrix(),X=!0):(console.warn("WARNING: InstavrControls.js encountered an unknown camera type - dolly/zoom disabled."),O.enableZoom=!1)}function c(t){q.set(t.clientX,t.clientY)}function l(t){J.set(t.clientX,t.clientY)}function u(t){K.set(t.clientX,t.clientY)}function h(t){Y.set(t.clientX,t.clientY),Z.subVectors(Y,q);var e=O.domElement===document?O.domElement.body:O.domElement;r(2*Math.PI*Z.x/e.clientWidth*O.rotateSpeed),o(2*Math.PI*Z.y/e.clientHeight*O.rotateSpeed),q.copy(Y),O.update()}function p(t){tt.set(t.clientX,t.clientY),et.subVectors(tt,J),et.y>0?a(i()):et.y<0&&s(i()),J.copy(tt),O.update()}function d(t){Q.set(t.clientX,t.clientY),$.subVectors(Q,K),rt($.x,$.y),K.copy(Q),O.update()}function f(t){}function m(t){O.object.fov-=.01*t.wheelDeltaY,O.object.fov<5?O.object.fov=5:O.object.fov>179&&(O.object.fov=179),O.object.updateProjectionMatrix(),O.update()}function v(t){switch(t.keyCode){case O.keys.UP:rt(0,O.keyPanSpeed),O.update();break;case O.keys.BOTTOM:rt(0,-O.keyPanSpeed),O.update();break;case O.keys.LEFT:rt(O.keyPanSpeed,0),O.update();break;case O.keys.RIGHT:rt(-O.keyPanSpeed,0),O.update()}}function g(t){q.set(t.touches[0].pageX,t.touches[0].pageY)}function y(t){var e=t.touches[0].pageX-t.touches[1].pageX,n=t.touches[0].pageY-t.touches[1].pageY,i=Math.sqrt(e*e+n*n);J.set(0,i)}function E(t){K.set(t.touches[0].pageX,t.touches[0].pageY)}function _(t){console.log("handleTouchMoveRotate"),Y.set(t.touches[0].pageX,t.touches[0].pageY),Z.subVectors(Y,q);var e=O.domElement===document?O.domElement.body:O.domElement;r(2*Math.PI*Z.x/e.clientWidth*O.rotateSpeed),o(2*Math.PI*Z.y/e.clientHeight*O.rotateSpeed),q.copy(Y),O.update()}function T(t){console.log("handleTouchMoveDolly");var e=t.touches[0].pageX-t.touches[1].pageX,n=t.touches[0].pageY-t.touches[1].pageY,i=Math.sqrt(e*e+n*n);tt.set(0,i),et.subVectors(tt,J),J.copy(tt),O.object.fov-=et.y*O.zoomSpeed,O.object.fov<5?O.object.fov=5:O.object.fov>179&&(O.object.fov=179),O.object.updateProjectionMatrix(),O.update()}function b(t){Q.set(t.touches[0].pageX,t.touches[0].pageY),$.subVectors(Q,K),rt($.x,$.y),K.copy(Q),O.update()}function w(t){}function R(t){if(O.enabled!==!1){if(t.preventDefault(),t.button===O.mouseButtons.ORBIT){if(O.enableRotate===!1)return;c(t),B=D.ROTATE}else if(t.button===O.mouseButtons.ZOOM){if(O.enableZoom===!1)return;l(t),B=D.DOLLY}else if(t.button===O.mouseButtons.PAN){if(O.enablePan===!1)return;u(t),B=D.PAN}B!==D.NONE&&(document.addEventListener("mousemove",x,!1),document.addEventListener("mouseup",H,!1),document.addEventListener("mouseout",H,!1),O.dispatchEvent(k))}}function x(t){if(O.enabled!==!1)if(t.preventDefault(),B===D.ROTATE){if(O.enableRotate===!1)return;h(t)}else if(B===D.DOLLY){if(O.enableZoom===!1)return;p(t)}else if(B===D.PAN){if(O.enablePan===!1)return;d(t)}}function H(t){O.enabled!==!1&&(f(t),document.removeEventListener("mousemove",x,!1),document.removeEventListener("mouseup",H,!1),document.removeEventListener("mouseout",H,!1),O.dispatchEvent(I),B=D.NONE)}function M(t){O.enabled!==!1&&O.enableZoom!==!1&&B===D.NONE&&(t.preventDefault(),t.stopPropagation(),m(t),O.dispatchEvent(k),O.dispatchEvent(I))}function S(t){O.enabled!==!1&&O.enableKeys!==!1&&O.enablePan!==!1&&v(t)}function C(t){if(O.enabled!==!1){switch(t.touches.length){case 1:if(O.enableRotate===!1)return;g(t),B=D.TOUCH_ROTATE;break;case 2:if(O.enableZoom===!1)return;y(t),B=D.TOUCH_DOLLY;break;case 3:if(O.enablePan===!1)return;E(t),B=D.TOUCH_PAN;break;default:B=D.NONE}B!==D.NONE&&O.dispatchEvent(k)}}function A(t){if(O.enabled!==!1)switch(t.preventDefault(),t.stopPropagation(),t.touches.length){case 1:if(O.enableRotate===!1)return;if(B!==D.TOUCH_ROTATE)return;_(t);break;case 2:if(O.enableZoom===!1)return;if(B!==D.TOUCH_DOLLY)return;T(t);break;case 3:if(O.enablePan===!1)return;if(B!==D.TOUCH_PAN)return;b(t);break;default:B=D.NONE}}function P(t){O.enabled!==!1&&(w(t),O.dispatchEvent(I),B=D.NONE)}function L(t){t.preventDefault()}this.object=t,this.object.rotation.reorder("YXZ"),this.modes={unknown:0,browser:1,gyro:2},this.mode=this.modes.unknown,this.browser_gyro=!1,this.domElement=void 0!==e?e:document,this.enabled=!0,this.target=new THREE.Vector3,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-(1/0),this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.25,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={ORBIT:THREE.MOUSE.LEFT,ZOOM:THREE.MOUSE.MIDDLE,PAN:THREE.MOUSE.RIGHT},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.deviceOrientation={},this.screenOrientation=0,this.getPolarAngle=function(){return N},this.getAzimuthalAngle=function(){return U},this.isBrowserMode=function(){return O.mode==O.modes.browser},this.isGyroMode=function(){return O.mode==O.modes.gyro},this.isBrowserGryoEnabled=function(){return O.browser_gyro},this.enableBrowserGyro=function(){O.browser_gyro=!0},this.changeToBrowserMode=function(){this.setMode(this.modes.browser)},this.changeToGyroMode=function(){this.setMode(this.modes.gyro)},this.setMode=function(t){for(var e in O.modes)O.modes[e]==t&&(O.mode=t);O.isBrowserMode()?(O.dispose(),O.setupBrowserEvents(),O.setupHeatsetEvents()):O.isGyroMode()?(O.dispose(),O.setupHeatsetEvents()):O.dispose()},this.reset=function(){O.target.copy(O.target0),O.object.position.copy(O.position0),O.object.zoom=O.zoom0,O.object.updateProjectionMatrix(),O.dispatchEvent(j),O.update(),B=D.NONE},this.update=function(){var e=new THREE.Vector3,i=(new THREE.Quaternion).setFromUnitVectors(t.up,new THREE.Vector3(0,1,0)),o=i.clone().inverse(),a=new THREE.Vector3,s=new THREE.Quaternion;new THREE.Quaternion;return function(){if(O.isBrowserMode()){var t=O.object.position;e.copy(t).sub(O.target),e.applyQuaternion(i),U=Math.atan2(e.x,e.z),N=Math.atan2(Math.sqrt(e.x*e.x+e.z*e.z),e.y),O.autoRotate&&B===D.NONE&&!O.isGyroMode()&&r(n()),U+=G,N+=V,U=Math.max(O.minAzimuthAngle,Math.min(O.maxAzimuthAngle,U)),N=Math.max(O.minPolarAngle,Math.min(O.maxPolarAngle,N)),N=Math.max(F,Math.min(Math.PI-F,N));var c=e.length()*z;c=Math.max(O.minDistance,Math.min(O.maxDistance,c)),O.target.add(W),e.x=c*Math.sin(N)*Math.sin(U),e.y=c*Math.cos(N),e.z=c*Math.sin(N)*Math.cos(U),e.applyQuaternion(o);var l=new THREE.Euler,u=O.deviceOrientation.beta?THREE.Math.degToRad(O.deviceOrientation.beta):0,h=O.deviceOrientation.gamma?THREE.Math.degToRad(O.deviceOrientation.gamma):0;l.set(u,h,0,"YXZ");var p=new THREE.Quaternion;if(p.setFromEuler(l),t.copy(O.target).add(e),O.object.lookAt(O.target),O.browser_gyro){var d=O.deviceOrientation.alpha?THREE.Math.degToRad(O.deviceOrientation.alpha):0,u=O.deviceOrientation.beta?THREE.Math.degToRad(O.deviceOrientation.beta):0,h=O.deviceOrientation.gamma?THREE.Math.degToRad(O.deviceOrientation.gamma):0,f=O.screenOrientation?THREE.Math.degToRad(O.screenOrientation):0;st(O.object.quaternion,d,u,h,f)}if(O.enableDamping===!0?(G*=1-O.dampingFactor,V*=1-O.dampingFactor):(G=0,V=0),z=1,W.set(0,0,0),X||a.distanceToSquared(O.object.position)>F||8*(1-s.dot(O.object.quaternion))>F)return O.dispatchEvent(j),a.copy(O.object.position),s.copy(O.object.quaternion),X=!1,!0}else if(O.isGyroMode()){var d=O.deviceOrientation.alpha?THREE.Math.degToRad(O.deviceOrientation.alpha):0,u=O.deviceOrientation.beta?THREE.Math.degToRad(O.deviceOrientation.beta):0,h=O.deviceOrientation.gamma?THREE.Math.degToRad(O.deviceOrientation.gamma):0,f=O.screenOrientation?THREE.Math.degToRad(O.screenOrientation):0;ct(O.object.quaternion,d,u,h,f)}return!1}}(),this.dispose=function(){O.domElement.removeEventListener("contextmenu",L,!1),O.domElement.removeEventListener("mousedown",R,!1),O.domElement.removeEventListener("mousewheel",M,!1),O.domElement.removeEventListener("MozMousePixelScroll",M,!1),O.domElement.removeEventListener("touchstart",C,!1),O.domElement.removeEventListener("touchend",P,!1),O.domElement.removeEventListener("touchmove",A,!1),document.removeEventListener("mousemove",x,!1),document.removeEventListener("mouseup",H,!1),document.removeEventListener("mouseout",H,!1),window.removeEventListener("keydown",S,!1),window.removeEventListener("orientationchange",at,!1),window.removeEventListener("deviceorientation",ot,!1)};var O=this,j={type:"change"},k={type:"start"},I={type:"end"},D={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},B=D.NONE;this.get_state=function(){return B};var U,N,F=1e-6,V=0,G=0,z=1,W=new THREE.Vector3,X=!1,q=new THREE.Vector2,Y=new THREE.Vector2,Z=new THREE.Vector2,K=new THREE.Vector2,Q=new THREE.Vector2,$=new THREE.Vector2,J=new THREE.Vector2,tt=new THREE.Vector2,et=new THREE.Vector2,nt=function(){var t=new THREE.Vector3;return function(e,n){var i=n.elements;t.set(i[0],i[1],i[2]),t.multiplyScalar(-e),W.add(t)}}(),it=function(){var t=new THREE.Vector3;return function(e,n){var i=n.elements;t.set(i[4],i[5],i[6]),t.multiplyScalar(e),W.add(t)}}(),rt=function(){var t=new THREE.Vector3;return function(e,n){var i=O.domElement===document?O.domElement.body:O.domElement;if(O.object instanceof THREE.PerspectiveCamera){var r=O.object.position;t.copy(r).sub(O.target);var o=t.length();o*=Math.tan(O.object.fov/2*Math.PI/180),nt(2*e*o/i.clientHeight,O.object.matrix),it(2*n*o/i.clientHeight,O.object.matrix)}else O.object instanceof THREE.OrthographicCamera?(nt(e*(O.object.right-O.object.left)/i.clientWidth,O.object.matrix),it(n*(O.object.top-O.object.bottom)/i.clientHeight,O.object.matrix)):(console.warn("WARNING: InstavrControls.js encountered an unknown camera type - pan disabled."),O.enablePan=!1)}}(),ot=function(t){O.deviceOrientation=t},at=function(){O.screenOrientation=window.orientation||0},st=function(){var t=new THREE.Vector3(0,0,1),e=new THREE.Euler,n=new THREE.Quaternion,i=new THREE.Quaternion((-Math.sqrt(.5)),0,0,Math.sqrt(.5));return function(r,o,a,s,c){e.set(a,o,-s,"YXZ");var l=new THREE.Quaternion;l.setFromEuler(e),r.multiply(l),r.multiply(i),r.multiply(n.setFromAxisAngle(t,-c))}}(),ct=function(){var t=new THREE.Vector3(0,0,1),e=new THREE.Euler,n=new THREE.Quaternion,i=new THREE.Quaternion((-Math.sqrt(.5)),0,0,Math.sqrt(.5));return function(r,o,a,s,c){e.set(a,o,-s,"YXZ"),r.setFromEuler(e),r.multiply(i),r.multiply(n.setFromAxisAngle(t,-c))}}();this.setupBrowserEvents=function(){O.domElement.addEventListener("contextmenu",L,!1),O.domElement.addEventListener("mousedown",R,!1),O.domElement.addEventListener("mousewheel",M,!1),O.domElement.addEventListener("MozMousePixelScroll",M,!1),O.domElement.addEventListener("touchstart",C,!1),O.domElement.addEventListener("touchend",P,!1),O.domElement.addEventListener("touchmove",A,!1),window.addEventListener("keydown",S,!1)},this.setupHeatsetEvents=function(){at(),window.addEventListener("orientationchange",at,!1),window.addEventListener("deviceorientation",ot,!1)},this.setMode(this.modes.browser),this.update()},THREE.InstavrControls.prototype=Object.create(THREE.EventDispatcher.prototype),THREE.InstavrControls.prototype.constructor=THREE.InstavrControls,Object.defineProperties(THREE.InstavrControls.prototype,{center:{get:function(){return console.warn("THREE.InstavrControls: .center has been renamed to .target"),this.target}},noZoom:{get:function(){return console.warn("THREE.InstavrControls: .noZoom has been deprecated. Use .enableZoom instead."),!this.enableZoom},set:function(t){console.warn("THREE.InstavrControls: .noZoom has been deprecated. Use .enableZoom instead."),this.enableZoom=!t}},noRotate:{get:function(){return console.warn("THREE.InstavrControls: .noRotate has been deprecated. Use .enableRotate instead."),!this.enableRotate},set:function(t){console.warn("THREE.InstavrControls: .noRotate has been deprecated. Use .enableRotate instead."),this.enableRotate=!t}},noPan:{get:function(){return console.warn("THREE.InstavrControls: .noPan has been deprecated. Use .enablePan instead."),!this.enablePan},set:function(t){console.warn("THREE.InstavrControls: .noPan has been deprecated. Use .enablePan instead."),this.enablePan=!t}},noKeys:{get:function(){return console.warn("THREE.InstavrControls: .noKeys has been deprecated. Use .enableKeys instead."),!this.enableKeys},set:function(t){console.warn("THREE.InstavrControls: .noKeys has been deprecated. Use .enableKeys instead."),this.enableKeys=!t}},staticMoving:{get:function(){return console.warn("THREE.InstavrControls: .staticMoving has been deprecated. Use .enableDamping instead."),!this.constraint.enableDamping},set:function(t){console.warn("THREE.InstavrControls: .staticMoving has been deprecated. Use .enableDamping instead."),this.constraint.enableDamping=!t}},dynamicDampingFactor:{get:function(){return console.warn("THREE.InstavrControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.constraint.dampingFactor},set:function(t){console.warn("THREE.InstavrControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.constraint.dampingFactor=t}}}),function(t,e,n){function r(t,e){var n=new THREE.CanvasTexture(t);return n.magFilter=THREE.NearestFilter,n.minFilter=THREE.NearestFilter,e||(e=THREE.MeshBasicMaterial),new e({depthWrite:!1,color:16777215,map:n,transparent:!0})}function o(t,e){var n=new THREE.VideoTexture(t);return n.magFilter=THREE.NearestFilter,n.minFilter=THREE.NearestFilter,e||(e=THREE.MeshBasicMaterial),new e({color:16777215,map:n,transparent:!0})}var a=["Arial, Helvetica, sans-serif","Arial Black, Gadget, sans-serif","Comic Sans MS, cursive, sans-serif","Courier New, Courier, monospace","Georgia, serif","Impact, Charcoal, sans-serif","Tahoma, Geneva, sans-serif","Times New Roman, Times, serif","Trebuchet MS, Helvetica, sans-serif","Verdana, Geneva, sans-serif"],s=function(){};s.prototype={constructor:s,focus_data:null,focus_state:null,icon_sprite:null,icon_material:null,circle_sprite:null,circle_material:null,circle_shown:!1},s.prototype.sync_icon=function(){var t=this,e=500,n=this.parent.viewer.uv_to_spherical(e+1,this.offset_x_ratio/100,this.offset_y_ratio/100),i="";if(this.icon)i=this.viewer.contents_path_to_cdn(this.icon_contents_path);else switch(this.class){case"Link":i=this.viewer.path_to_cdn("/images/ic_action_place.png");break;case"Hotspot":i=this.viewer.path_to_cdn("/images/ic_action_about.png");break;case"Action":i=this.viewer.path_to_cdn("/images/ic_action_call.png");break;case"Input":i=this.viewer.path_to_cdn("/images/ic_action_input.png");break;default:i=this.viewer.path_to_cdn("/images/ic_action_place.png")}var t=this;material_by_texture(i,function(e){t.icon_material=e,null==t.icon_sprite?(t.icon_sprite=f(t.icon_material),t.parent.root_webgl.add(t.icon_sprite),t.icon_sprite.visible=t.visible):t.icon_sprite.material=t.icon_material,t.icon_sprite.position.set(n.x,n.y,n.z);var i=t.icon_size/100,r=e.map.image.width,o=e.map.image.height,a=1,s=1;r>o?s=o/r:a=r/o,t.icon_sprite.scale.set(t.size*i*a,t.size*i*s,t.size*i),t.icon_sprite.lookAt(new THREE.Vector3(0,1,0)),t.parent.viewer.enable_selected_color&&(t.selected?t.icon_sprite.material.color=new THREE.Color(16777215):t.icon_sprite.material.color=new THREE.Color(5592405))},THREE.MeshBasicMaterial)},s.prototype.sync_circle=function(){function t(){var t=500,n=e.parent.viewer.uv_to_spherical(t,e.offset_x_ratio/100,e.offset_y_ratio/100);e.circle_sprite.position.set(n.x,n.y,n.z),e.circle_sprite.scale.set(e.size,e.size,e.size),e.parent.viewer.scene_focus_display_circle?(e.parent.root_webgl.add(e.circle_sprite),e.circle_shown=!0):e.circle_shown=!1,e.opened?e.circle_sprite.visible=!1:e.circle_sprite.visible=!0,e.circle_sprite.lookAt(new THREE.Vector3(0,1,0)),e.parent.viewer.enable_selected_color&&(e.selected?e.circle_sprite.material.color=new THREE.Color(16777215):e.circle_sprite.material.color=new THREE.Color(5592405))}var e=this;if(null==this.circle_sprite){var n=this.viewer.path_to_cdn("/images/icon_circle_arrow.png");material_by_texture(n,function(n){e.circle_material=n,null==e.circle_sprite?e.circle_sprite=f(e.circle_material):e.circle_sprite.material=e.circle_material,e.circle_sprite.material=e.circle_material,t()},THREE.MeshBasicMaterial),this.init_focus()}else t()},s.prototype.init_focus=function(){function t(){r.circle_shown&&(r.parent.root_webgl.remove(r.circle_sprite),r.circle_shown=!1),r.parent.viewer.select_marker(r)}function e(){r.circle_shown||(r.parent.root_webgl.add(r.circle_sprite),r.circle_shown=!0),r.circle_sprite.rotation.z=r.focus_data.current_circle_radius()}function n(){r.circle_shown&&(r.parent.root_webgl.remove(r.circle_sprite),r.circle_shown=!1),r.parent.on_click_none()}function i(){r.circle_shown||(r.parent.root_webgl.add(r.circle_sprite),r.circle_shown=!0),r.circle_sprite.rotation.z=r.focus_data.current_circle_radius()}var r=this;this.focus_data=new R(this,{refocus:!0,on_filled_action:t,on_filling_action:e,on_defilled_action:n,on_defilling_action:i}),this.parent.viewer.focus_data_manager.add_focus(this.focus_data),this.focus_state=new H,this.parent.viewer.focus_update_manager.add_target(this)};var c=function(t){this.viewer=t,this.states=0,this.reset(),this.play()};c.prototype.now=function(){return Date.now()},c.prototype.reset=function(){this.time_initialized=this.now(),this.time_started=this.time_initialized,this.time_current=this.time_started,this.time_current_second=this.time_current},c.prototype.is_video=function(){return this.viewer&&this.viewer.media&&"video"==this.viewer.media.element},c.prototype.on_update=function(){1==this.state&&(this.is_video()?(this.time_current=Math.floor(1e3*this.viewer.video.currentTime),this.time_current_second=Math.floor(this.viewer.video.currentTime)):(this.time_current=this.now()-this.time_started,this.time_current_second=Math.floor(this.time_current/1e3)))},c.prototype.play=function(){this.seek_second(0),this.is_video()&&this.viewer.video.play(),this.state=1},c.prototype.pause=function(){this.is_video()&&this.viewer.video.pause(),this.state=0},c.prototype.seek_second=function(t){this.is_video()&&(this.viewer.video.currentTime=t),this.time_current=1e3*t,this.time_current_second=t};var l=function(t,e){var i=this;this.viewer=t,this.hotspots=[],this.links=[],this.actions=[],this.inputs=[],this.file=null,this.renditions={},this.textures={},this.materials={},this.meshes={},n.each(e,function(t,e,n){i[e]=t}),this.root_webgl=null,this.root_css=null,this.music_instance=null,this.audio_instance=null,this.material_blank=this.add_material(),this.spatial_fl_instace=null,this.spatial_fr_instace=null,this.spatial_bl_instace=null,this.spatial_br_instace=null,this.timeline=new c};l.prototype.url=function(){var t="";return console.log("this.preview_dirty: "+this.preview_dirty),this.is_image_element()?null!=this.preview_path&&""!=this.preview_path&&(t=this.preview_dirty?this.viewer.path_to_cdn("/images/loading/image.jpg"):"2k"==this.viewer.image_quality?this.viewer.contents_path_to_cdn(this.preview_path):"original"==this.viewer.image_quality?this.viewer.contents_path_to_cdn(this.contents_path):"loading"==this.viewer.image_quality?this.viewer.path_to_cdn("/images/loading/image.jpg"):this.viewer.contents_path_to_cdn(this.contents_path)):null!=this.contents_path&&""!=this.contents_path&&(this.preview_dirty?t=this.viewer.path_to_cdn("/images/loading/playlist.m3u8"):(t=this.contents_path.replace("content","movie").replace(/\.mp4/i,"/hls_2M.m3u8"),"2mbps"==this.viewer.video_quality&&(t=this.contents_path.replace("content","movie").replace(/\.mp4/i,"/hls_2M.m3u8")),"4mbps"==this.viewer.video_quality&&(t=this.contents_path.replace("content","movie").replace(/\.mp4/i,"/hls_4M_2048-1536.m3u8")),"8mbps"==this.viewer.video_quality&&(t=this.contents_path.replace("content","movie").replace(/\.mp4/i,"/hls_8M_2048-1536.m3u8")),"12mbps"==this.viewer.video_quality&&(t=this.contents_path.replace("content","movie").replace(/\.mp4/i,"/hls_12M_2048-1536.m3u8")),"safe"==this.viewer.video_quality&&(t=this.contents_path.replace("content","movie").replace(/\.mp4/i,"/mp4_1920_1080_30fps_2mbps.mp4")),"original"==this.viewer.video_quality&&(t=this.contents_path))),t=this.viewer.contents_path_to_cdn(t)},l.prototype.thumbnail_url=function(){var t=this.contents_path;return this.is_video_element()?t=O.contents_path_to_thumbnail(this.contents_path):null!=this.preview_path&&""!=this.preview_path&&(t=this.preview_path),t},l.prototype.is_image_element=function(){return null!=this.element&&"image"==this.element},l.prototype.is_video_element=function(){return null!=this.element&&"video"==this.element},l.prototype.add_material=function(){return new THREE.MeshBasicMaterial({side:THREE.DoubleSide,color:16777215,ambient:16777215})},l.prototype.cleanup_scene=function(){this.viewer.webgl_scene.remove(this.root_webgl),this.viewer.scene.remove(this.root_css),this.viewer.gyro_controls&&(this.viewer.gyro_controls=null),this.object=null},l.prototype.on_update=function(t){n.each(this.hotspots,function(e){e.on_update(t)}),this.timeline.on_update(),this.on_timeout()},l.prototype.on_timeout=function(){this.viewer.is_editor_mode()||this.timeout&&"simple"==this.timeout&&this.timeout_duration&&this.destination&&this.timeline.time_current>this.timeout_duration&&this.on_destination_navigation()},l.prototype.on_destination_navigation=function(){var t=this.viewer.find_media_by_id(this.destination);t&&(n.each(this.viewer.bundle.medias,function(t){t.opened=!1}),t.opened=!0,this.viewer.reset_camera(),this.viewer.sync(),console.log("media change"))},l.prototype.create=function(){this.root_webgl=new THREE.Object3D,this.viewer.webgl_scene.add(this.root_webgl),this.viewer.is_play_mode()&&this.viewer.enable_gyro_by_default,this.root_css=new THREE.Object3D,this.viewer.scene.add(this.root_css),this.presync_object(),this.preview_material=this.add_material(),this.sync_texture(),this.sync_renditions(),this.sync_model(),this.send_tracking()},l.prototype.sync_renditions=function(){var t=this;this.original_rendition=n.find(this.viewer.bundle.files,function(e){return t.file==e._id}),this.renditions={},n.each(this.viewer.bundle.files,function(e){e.parent==t.file&&(t.renditions[e.rendition_id]=e)}),this.renditions=={}&&console.log("missing renditions"),this.is_image_element()&&this.load_image_renditions()},l.prototype.load_image_renditions=function(){if("cubic_3d_sbs"==this.panoramic||"cubic_3d_stack"==this.panoramic)for(i=0;i<12;i++){var t=this.panoramic+"_"+i;this.load_image_rendition(t)}},l.prototype.load_image_rendition=function(t){var e=this,n=new THREE.TextureLoader,i=this.renditions[t];if(i){var r=O.to_cdn(i.contents_path);console.log("start_loading load image renditions"),this.viewer.start_loading(),this.texture=n.load(r,function(n){e.viewer.end_loading(),e.textures[t]=n,e.assign_texture_to_material(t,n)},function(t){},function(t){e.viewer.end_loading(),console.error("loading failed",t)})}},l.prototype.assign_texture_to_material=function(t,e){e&&(console.log("texture loaded:",e),e.magFilter=this.viewer.get_texture_max_filter(),e.minFilter=this.viewer.get_texture_min_filter(),this.materials[t]||(this.materials[t]=this.add_material()),this.materials[t].map=e,this.materials[t].needsUpdate=!0,null!=this.meshes[t]&&(this.meshes[t].material=this.materials[t]),console.log("material updated:",this.materials[t]))},l.prototype.send_tracking=function(){this.viewer.analytics.send_pageview(this.page)},l.prototype.sync_model=function(){console.log("sync_model: "+this.panoramic);var t=!0,e=!1,n="sphere.obj";if("180"==this.panoramic?n="half_sphere.obj":"360_3d"==this.panoramic?n="sphere_top.obj":"cubic_3d_sbs"==this.panoramic||"cubic_3d_stack"==this.panoramic?(n=this.panoramic+".obj",e=!0):"180_sbs"==this.panoramic?n="half_sphere_left.obj":"180_stack"==this.panoramic&&(n="half_sphere_top.obj"),t){var i=new THREE.LoadingManager,r=new THREE.OBJLoader(i),o=this,a=this.viewer.path_to_cdn("/geometries/"+n);console.log("start_loading sync_model",a),this.viewer.start_loading(),r.load(a,function(t){t&&(console.log(t),t.name="geometry",t.traverse(function(t){t instanceof THREE.Mesh&&(t.scale.x=60,t.scale.y=60,t.scale.z=60,console.log("mesh.child:"+t.name),e?(o.meshes[t.name]=t,null!=o.materials[t.name]?(o.meshes[t.name].material=o.materials[t.name],console.log("material is FOUND: "+t.name)):console.log("material is not found: "+t.name)):t.material=o.preview_material)}),console.log(t),o.after_model_created(t))},function(t){},function(t){console.log("load issue"),console.log(t)})}},l.prototype.after_model_created=function(t){null!=this.object?(this.root_webgl.remove(this.object),this.object=null):console.log("cleanup_scene: object is null"),this.object=t,this.root_webgl.add(t),this.viewer.end_loading(),this.sync_object()},l.prototype.sync_texture=function(){console.log("sync_texture"),this.sync_texture_core(this.url())},l.prototype.pre_sync=function(t){var e=this;xhr=new XMLHttpRequest,xhr.open("HEAD",t,!0),xhr.onload=function(n){4===xhr.readyState&&(200===xhr.status?(console.log("PreSync OK: "+t),console.log(n),e.sync_texture_core(t)):e.sync_texture_core(t+"?dirty"))},xhr.onerror=function(n){console.error("onerror"),e.sync_texture_core(t+"?dirty")},xhr.send(null)},l.prototype.on_click_none=function(){var t=!1;n.each(this.hotspots,function(e){e.opened&&(t=!0,e.opened=!1,e.sync())}),t||this.is_video_element()&&(this.viewer.is_smart_phone_play()||this.viewer.video_player.paused()&&this.viewer.video_player.play())},l.prototype.load_image=function(t){var e=this,n=new THREE.TextureLoader;console.log("start_loading load_image"),this.viewer.start_loading(),this.texture=n.load(t,function(t){e.texture=t,e.apply_texture(),
e.viewer.end_loading()},function(t){},function(n){e.viewer.end_loading(),e.sync_texture_core(t+"?dirty"),console.error(n)})},l.prototype.sync_texture_core=function(e){var n=this;if(this.is_image_element())this.load_image(e);else if("video"==this.element){this.preview_material.color=new THREE.Color(0,0,0),this.viewer.is_editor_mode()&&(console.log("start_loading sync_texture_core"),this.viewer.start_loading()),this.viewer.video_player.on("error",function(){console.log("video_player.error"),n.sync_texture_core(e+"?dirty"),n.viewer.end_loading()}),this.viewer.video_player.on("loadeddata",function(){console.log("video_player.loadeddata"),n.preview_material.color=new THREE.Color(1,1,1),n.viewer.end_loading()}),this.viewer.video_player.on("ended",function(){console.log("ended")}),this.viewer.video.onended=function(){console.log("onended"),n.viewer.is_editor_mode()?(n.viewer.currentTime=0,n.viewer.video.play()):"none"==n.transition?(console.log("loop"),n.viewer.currentTime=0,n.viewer.video.play()):"videoend"==n.transition&&(console.log("videoend"),n.on_destination_navigation())},this.viewer.video.onerror=function(){console.log("onerror"),n.viewer.end_loading()},this.viewer.video.onloadeddata=function(){console.log("onloadeddata"),n.preview_material.color=new THREE.Color(1,1,1),n.viewer.end_loading()},this.viewer.video.oncanplaythrough=function(){console.log("oncanplaythrough")},this.viewer.video_player.on("canplay",function(){}),this.viewer.video_player.on("canplaythrough",function(){}),this.viewer.video.onplay=function(){console.log("onplay"),n.play_pressed=Date.now(),n.viewer.hide_tap(),console.log("_this.play_pressed",n.play_pressed)},this.viewer.video.onplaying=function(){if(console.log("onplaying"),!n.viewer.video_played){n.viewer.video_played=!0;var t=Date.now();console.log("_this.playing_time",t);var e=(t-n.play_pressed)/1e3;console.log("elasped",e),n.viewer.is_smart_phone_play()?n.viewer.video.currentTime=e:n.viewer.play_waited_sounds()}};var i=this.viewer.contents_path_to_cdn(this.thumbnail_url());this.viewer.video_player.poster(i),console.log(this.viewer.video_quality,e),"original"==this.viewer.video_quality||"safe"==this.viewer.video_quality?this.viewer.is_smart_phone_play()?this.viewer.video.src=e:this.viewer.video_player.src({type:"video/mp4",src:e}):this.viewer.video_player.src({type:"application/x-mpegURL",src:e}),this.texture=this.viewer.video_texture,this.texture.generateMipmaps=!1,this.texture.magFilter=this.viewer.get_texture_max_filter(),this.texture.minFilter=this.viewer.get_texture_min_filter(),this.texture.format=THREE.RGBFormat}else if("live"==this.element){var r={video:!0},o=function(t){console.log("Video capture error: ",t.code)};navigator.getUserMedia?navigator.getUserMedia(r,function(e){n.viewer.live_video.src=t.URL.createObjectURL(e),n.viewer.live_video.play(),n.preview_material.map=n.viewer.live_video_texture},o):navigator.webkitGetUserMedia?navigator.webkitGetUserMedia(r,function(e){n.viewer.live_video.src=t.URL.createObjectURL(e),n.viewer.live_video.play(),n.preview_material.map=n.viewer.live_video_texture},o):navigator.mozGetUserMedia&&navigator.mozGetUserMedia(r,function(e){n.viewer.live_video.src=t.URL.createObjectURL(e),n.viewer.live_video.play(),n.preview_material.map=n.viewer.live_video_texture},o)}this.apply_texture()},l.prototype.apply_texture=function(){console.log("apply_texture"),this.texture&&(this.texture.magFilter=this.viewer.get_texture_max_filter(),this.texture.minFilter=this.viewer.get_texture_min_filter(),this.texture.flipY=!0,this.preview_material.map=this.texture,this.preview_material.needsUpdate=!0,console.log("applied"),console.log(this.preview_material.map))},l.prototype.presync_object=function(){this.viewer.controls.isGyroMode()?(this.root_webgl.rotation.y=0,this.root_css.rotation.y=0):(this.root_webgl.rotation.y=Math.PI,this.root_css.rotation.y=Math.PI)},l.prototype.sync_object=function(){null!=this.object&&this.object.rotation.setFromVector3(new THREE.Vector3(this.roll/180*Math.PI,this.yaw/180*Math.PI,this.pitch/180*Math.PI),"YZX"),this.viewer.controls.isGyroMode()?(this.root_webgl.rotation.y=this.offset_y/180*Math.PI,this.root_css.rotation.y=this.offset_y/180*Math.PI):(this.root_webgl.rotation.y=Math.PI+this.offset_y/180*Math.PI,this.root_css.rotation.y=Math.PI+this.offset_y/180*Math.PI)},l.prototype.destroy=function(t){console.log("InstavrMedia.prototype.destroy "),null!=this.viewer.video_player&&(console.log("this.viewer.player.pause(); "),this.viewer.video_player.pause()),null!=this.viewer.video&&(console.log("this.viewer.video.pause(); "),this.viewer.video.pause()),this.cleanup_scene(),n.each(this.hotspots,function(t){t.destroy()}),this.hotspots=[],n.each(this.links,function(t){t.destroy()}),this.links=[],n.each(this.actions,function(t){t.destroy()}),this.actions=[],n.each(this.inputs,function(t){t.destroy()}),this.inputs=[],null!=this.music_instance&&(null!=t&&null!=t.music_contents_path&&t.music_contents_path==this.music_contents_path&&(t.music_instance=this.music_instance),null==t.music_instance&&(this.music_instance.destroy(),this.music_instance=null)),null!=this.audio_instance&&(this.audio_instance.destroy(),this.audio_instance=null),null!=this.spatial_fl_instance&&(this.spatial_fl_instance.destroy(),this.spatial_fl_instance=null),null!=this.spatial_fr_instance&&(this.spatial_fr_instance.destroy(),this.spatial_fr_instance=null),null!=this.spatial_bl_instance&&(this.spatial_bl_instance.destroy(),this.spatial_bl_instance=null),null!=this.spatial_br_instance&&(this.spatial_br_instance.destroy(),this.spatial_br_instance=null)},l.prototype.sync=function(t){var e=this,i=[];n.each(t,function(t,n,r){e[n]!=t&&i.push(n),e[n]=t}),n.contains(i,"panoramic")&&e.sync_model(),(n.contains(i,"preview_path")||n.contains(i,"preview_dirty"))&&(e.sync_files(),e.sync_texture()),this.presync_object(),n.each(this.hotspots,function(t){t.touch=!1}),n.each(this.viewer.bundle.hotspots,function(t){if(t.media==e._id){var i=n.find(e.hotspots,function(e){return e._id==t._id});null==i?(i=new v(e,t),i.touch=!0,e.hotspots.push(i)):(i.sync(t),i.touch=!0)}}),n.each(this.hotspots,function(t){t.touch||t.destroy()}),n.each(this.links,function(t){t.touch=!1}),n.each(this.viewer.bundle.links,function(t){if(t.media==e._id){var i=n.find(e.links,function(e){return e._id==t._id});null==i?(i=new p(e,t),e.links.push(i),i.touch=!0):(i.sync(t),i.touch=!0)}}),n.each(this.links,function(t){t.touch||t.destroy()}),n.each(this.inputs,function(t){t.touch=!1}),n.each(this.viewer.bundle.inputs,function(t){if(t.media==e._id){var i=n.find(e.inputs,function(e){return e._id==t._id});null==i?(i=new u(e,t),e.inputs.push(i),i.touch=!0):(i.sync(t),i.touch=!0)}}),n.each(this.inputs,function(t){t.touch||t.destroy()}),n.each(this.actions,function(t){t.touch=!1}),n.each(this.viewer.bundle.actions,function(t){if(t.media==e._id){var i=n.find(e.actions,function(e){return e._id==t._id});null==i?(i=new h(e,t),e.actions.push(i),i.touch=!0):(i.sync(t),i.touch=!0)}}),n.each(this.actions,function(t){t.touch||t.destroy()}),this.sync_object(),this.viewer.is_play_mode()&&(null==this.music_instance?this.music_instance=new _(this,"music"):this.music_instance.sync(this,"music"),null==this.audio_instance?this.audio_instance=new _(this,"audio",{loop:!1}):this.audio_instance.sync(this,"audio"),null==this.spatial_fl_instance?this.spatial_fl_instance=new _(this,"spatial_fl"):this.spatial_fl_instance.sync(this,"spatial_fl"),null==this.spatial_fr_instance?this.spatial_fr_instance=new _(this,"spatial_fr"):this.spatial_fr_instance.sync(this,"spatial_fl"),null==this.spatial_bl_instance?this.spatial_bl_instance=new _(this,"spatial_bl"):this.spatial_bl_instance.sync(this,"spatial_bl"),null==this.spatial_br_instance?this.spatial_br_instance=new _(this,"spatial_br"):this.spatial_br_instance.sync(this,"spatial_br"))},material_by_texture=function(t,e,n){var i=THREE.ImageUtils.loadTexture(t,null,function(t){i.magFilter=THREE.NearestFilter,i.minFilter=THREE.NearestFilter,n||(n=THREE.SpriteMaterial);var r=new n({depthWrite:!1,color:16777215,map:i,transparent:!0});e&&e(r)});return i.magFilter=THREE.NearestFilter,i.minFilter=THREE.NearestFilter,new THREE.SpriteMaterial({color:16777215,map:i,transparent:!0})};var u=function(t,e){s.call(this),this.parent=t,this.viewer=t.viewer,this.size=80,this.icon_sprite_overlay=null,this.parent_hotspot=e.parent_hotspot,this.visible=!0,null!=this.parent_hotspot&&(this.add_to_parent_hotspot(),this.visible=!1),this.sync(e)};u.prototype=Object.create(s.prototype),u.prototype.constructor=u,u.prototype.set_visible=function(t){this.visible=t,this.sync(this),this.circle_sprite.visible=t,this.icon_sprite.visible=t},u.prototype.add_to_parent_hotspot=function(){var t=this.parent_hotspot,e=n.find(this.parent.hotspots,function(e){return console.log("add_to_parent_hotspot"),console.log(e._id,t),e._id==t});e&&e.children_add(this)},u.prototype.sync=function(t){var i=this,r=[],o=500;n.each(t,function(t,e,n){i[e]!=t&&r.push(e),i[e]=t}),console.log("dirty_keys",r);var a=this.parent.viewer.uv_to_spherical(o+1,this.offset_x_ratio/100,this.offset_y_ratio/100);this.sync_icon(),this.sync_circle(),null!=this.parent_hotspot&&(this.visible&&(null==this.icon_sprite_overlay||n.contains(r,"icon"))&&(null!=this.icon_sprite_overlay&&(this.parent.root_css.remove(this.icon_sprite_overlay),this.icon_sprite_overlay=null),img=e.createElement("img"),img.style.height="100px",img.style.border="0px",img.src=path,this.icon_sprite_overlay=new THREE.CSS3DSprite(img),console.log("this.icon_sprite",this.icon_sprite_overlay),this.parent.root_css.add(this.icon_sprite_overlay)),this.visible||null==this.icon_sprite_overlay||(this.parent.root_css.remove(this.icon_sprite_overlay),this.icon_sprite_overlay=null)),this.update_icons(r),null!=this.icon_sprite_overlay&&(this.icon_sprite_overlay.position.set(a.x,a.y,a.z),gain*=.01,this.icon_sprite_overlay.scale.set(this.size*gain,this.size*gain,this.size*gain))},u.prototype.update_icons=function(t){var i="input_value";this.parent.viewer.is_editor_mode()&&(i="input_default");var r=this[i],o="icon"+r,a=this[o];if(a){var s=this.viewer.find_file_by_id(a);if(s){var c=this.viewer.contents_path_to_cdn(s.contents_path);console.log("icon_path",c),this.icon_material=material_by_texture(c),null!=this.parent_hotspot&&(this.visible&&(null!=this.icon_sprite_overlay&&(this.parent.root_css.remove(this.icon_sprite_overlay),this.icon_sprite_overlay=null),img=e.createElement("img"),img.style.height="100px",img.style.border="0px",img.src=c,this.icon_sprite_overlay=new THREE.CSS3DSprite(img),console.log("this.icon_sprite",this.icon_sprite_overlay),this.parent.root_css.add(this.icon_sprite_overlay)),this.visible||null==this.icon_sprite_overlay||(this.parent.root_css.remove(this.icon_sprite_overlay),this.icon_sprite_overlay=null)),n.contains(t,i)&&(this.icon_sprite.material=this.icon_material)}}},u.prototype.destroy=function(){this.parent.root_webgl.remove(this.icon_sprite),this.parent.root_webgl.remove(this.circle_sprite)},u.prototype.on_click=function(){console.log("InstavrInput.prototype.on_click"),this.send_tracking()},u.prototype.send_tracking=function(){this.viewer.analytics.send_event("input",this.page)};var h=function(t,e){s.call(this),this.parent=t,this.viewer=t.viewer,this.size=80,this.label_instance=null,this.sync(e)};h.prototype=Object.create(s.prototype),h.prototype.constructor=h,h.prototype.sync=function(t){var e=this,i=[];n.each(t,function(t,n,r){e[n]!=t&&i.push(n),e[n]=t});var r=this.parent.viewer.uv_to_spherical(401,this.offset_x_ratio/100,this.offset_y_ratio/100);this.sync_icon(),this.sync_circle();var r=this.parent.viewer.uv_to_spherical(400,this.offset_x_ratio/100,this.offset_y_ratio/100);null==this.label_instance?this.label_instance=new E(this,"label",r):this.label_instance.sync(this,"label",r)},h.prototype.destroy=function(){this.parent.root_webgl.remove(this.icon_sprite),this.parent.root_webgl.remove(this.circle_sprite),null!=this.label_instance&&(this.label_instance.destroy(),this.label_instance=null)},h.prototype.on_click=function(){this.send_tracking(),"phonecall"==this.method?t.open("tel://"+this.phone_number):"webopen"==this.method&&t.open(this.url,"_blank")},h.prototype.send_tracking=function(){this.viewer.analytics.send_event("action",this.page)};var p=function(t,e){s.call(this);this.parent=t,this.viewer=t.viewer,this.size=80,this.icon_sprite_overlay=null,this.destination_media=null,this.label_instance=null,this.parent_hotspot=e.parent_hotspot,this.visible=!0,null!=this.parent_hotspot&&(this.add_to_parent_hotspot(),this.visible=!1),this.sync(e)};p.prototype=Object.create(s.prototype),p.prototype.constructor=p,p.prototype.set_visible=function(t){this.visible=t,this.sync(this),this.circle_sprite.visible=t,this.icon_sprite.visible=t},p.prototype.add_to_parent_hotspot=function(){var t=this.parent_hotspot,e=n.find(this.parent.hotspots,function(e){return console.log("add_to_parent_hotspot"),console.log(e._id,t),e._id==t});e&&e.children_add(this)};var d=function(t,e,n){var i=new THREE.PlaneGeometry(t,e),r=new THREE.Mesh(i,n);return r},f=function(t){var e=d(1,1,t);return e};p.prototype.sync=function(t){var i=this,r=[],o=500;n.each(t,function(t,e,n){i[e]!=t&&r.push(e),i[e]=t});var a=this.parent.viewer.uv_to_spherical(o+1,this.offset_x_ratio/100,this.offset_y_ratio/100);this.sync_icon(),this.sync_circle(),null!=this.parent_hotspot&&(this.visible&&(null==this.icon_sprite_overlay||n.contains(r,"icon"))&&(null!=this.icon_sprite_overlay&&(this.parent.root_css.remove(this.icon_sprite_overlay),this.icon_sprite_overlay=null),img=e.createElement("img"),img.style.height="100px",img.style.border="0px",img.src=path,this.icon_sprite_overlay=new THREE.CSS3DSprite(img),console.log("this.icon_sprite",this.icon_sprite_overlay),this.parent.root_css.add(this.icon_sprite_overlay)),this.visible||null==this.icon_sprite_overlay||(this.parent.root_css.remove(this.icon_sprite_overlay),this.icon_sprite_overlay=null)),null!=this.icon_sprite_overlay&&(this.icon_sprite_overlay.position.set(a.x,a.y,a.z),gain*=.01,this.icon_sprite_overlay.scale.set(this.size*gain,this.size*gain,this.size*gain)),this.destination_media=this.viewer.find_media_by_id(this.destination),this.label_override||(this.label=this.destination_media&&!n.isEmpty(this.destination_media.label)?this.destination_media.label:""),null==this.label_instance?this.label_instance=new E(this,"label",a):this.label_instance.sync(this,"label",a)},p.prototype.destroy=function(){this.parent.root_webgl.remove(this.icon_sprite),this.parent.root_webgl.remove(this.circle_sprite),null!=this.label_instance&&(this.label_instance.destroy(),this.label_instance=null)},p.prototype.on_click=function(){console.log("InstavrLink.prototype.on_click"),n.each(this.parent.viewer.bundle.medias,function(t){t.opened=!1}),this.destination_media&&(this.destination_media.opened=!0),this.send_tracking(),this.parent.viewer.reset_camera(),this.parent.viewer.sync()},p.prototype.send_tracking=function(){this.viewer.analytics.send_event("link",this.page)};var m=function(t){this.current_key=-1,this.next_key=-1,this.sorted_keys=[],this.keyframes={}};m.prototype.evaluate=function(t){var e=t.time_current,n=this.find_current_key(e),i=this.find_next_key(n),r=this.keyframes[n];this.keyframes[i];return r?new THREE.Vector3(r.x,r.y,r.z):null},m.prototype.find_current_key=function(t){var e=-1;if(e=Math.floor(t/1e3),0==e)return this.sorted_keys[e];for(var n=0,i=0;i<this.sorted_keys.length;i++)if(this.sorted_keys[i]>=e)return n=this.sorted_keys[i-1];return n||(n=this.sorted_keys[this.sorted_keys.length-1]),n},m.prototype.find_next_key=function(t){var e=this.sorted_keys.indexOf(t)+1;return e>=this.sorted_keys.length&&(e=this.sorted_keys.length-1),this.sorted_keys[e]},m.prototype.sync=function(t,e){this.sorted_keys=t,this.keyframes=e};var v=function(t,e){s.call(this),this.parent=t,this.viewer=t.viewer,this.size=80,this.label_instance=null,this.parent_instance=null,this.image_instance=null,this.text_instance=null,this.audio_instance=null,this.position=null,this.children=[],this.animcurves={},this.sync(e)};v.prototype=Object.create(s.prototype),v.prototype.constructor=v,v.prototype.on_update=function(t){this.animatable&&this.audio_instance&&this.audio_positional&&this.evaluate(t,"pos")},v.prototype.evaluate=function(t,e){if(n.has(this.animcurves,e)){var i=this.animcurves[e].evaluate(t);i&&this.icon_sprite.position.set(i.x,i.y,i.z)}},v.prototype.bake=function(t){if(console.log("InstavrHotspot.prototype.bake"),this.keyframes&&n.has(this.keyframes,t)){var e=[];n.each(n.allKeys(this.keyframes[t]),function(t){e.push(parseInt(t))}),e=e.sort(),this.animcurves[t]=new m,this.animcurves[t].sync(e,this.keyframes[t])}},v.prototype.bake_all=function(){this.bake("pos")},v.prototype.sync_keyframes=function(){this.bake_all()},v.prototype.has_video_content=function(){return this.image_contents_path&&/(\.mp4|\.mov)$/i.test(this.image_contents_path)},v.prototype.sync=function(t){var e=this,i=[];t&&n.each(t,function(t,n,r){e[n]!=t&&i.push(n),e[n]=t}),this.sync_keyframes();var r=this.parent.viewer.uv_to_spherical(401,this.offset_x_ratio/100,this.offset_y_ratio/100);this.sync_keyframes(),this.position=r;this.sync_icon(),this.sync_circle();var r=this.parent.viewer.uv_to_spherical(450,this.offset_x_ratio/100,this.offset_y_ratio/100);null==this.label_instance?this.label_instance=new E(this,"label",r):this.label_instance.sync(this,"label",r),this.opened?(this.label_instance.destroy(),this.label_instance=null,this.sync_opened(!0,i)):this.sync_opened(!1,i)},v.prototype.children_add=function(t){var e=n.find(this.children,function(e){return t==e});null==e&&(this.children.push(t),console.log("children added"))},v.prototype.children_visible=function(t){console.log("children_visible",t),n.each(this.children,function(e){e.set_visible(t)})},v.prototype.play_audio=function(){null==this.audio_instance?(this.audio_instance=new _(this,"audio",{loop:this.audio_loop,positional:this.audio_positional}),console.log("this.audio_instance",this.audio_instance)):this.audio_instance.sync(this,"audio"),this.audio_positional&&null!=this.audio_instance.sound&&(this.audio_instance.sound.setRefDistance(20),this.icon_sprite.add(this.audio_instance.sound))},v.prototype.sync_opened=function(t,e){this.parent.viewer.uv_to_spherical(400,this.offset_x_ratio/100,this.offset_y_ratio/100);t?(this.children_visible(!0),null==this.parent_instance?this.parent_instance=new g(this):this.parent_instance.sync(this),null==this.image_instance?this.image_instance=new y(this):this.image_instance.sync(this),null==this.text_instance?this.text_instance=new E(this,"text"):this.text_instance.sync(this,"text"),this.play_audio()):this.destroy_opened()},v.prototype.destroy_opened=function(){this.children_visible(!1),null!=this.image_instance&&(this.image_instance.destroy(),this.image_instance=null),null!=this.text_instance&&(this.text_instance.destroy(),this.text_instance=null),null!=this.audio_instance&&(this.audio_positional||(this.audio_instance.destroy(),this.audio_instance=null)),null!=this.parent_instance&&(this.parent_instance.destroy(),this.parent_instance=null)},v.prototype.destroy=function(){this.parent.root_webgl.remove(this.icon_sprite),this.parent.root_webgl.remove(this.circle_sprite),null!=this.label_instance&&(this.label_instance.destroy(),this.label_instance=null),this.destroy_opened()},v.prototype.on_click=function(){this.opened?this.opened=!1:(this.opened=!0,this.send_tracking()),this.sync()},v.prototype.send_tracking=function(){this.viewer.analytics.send_event("hotspot",this.page)},v.prototype.play_video=function(){this.image_instance&&this.image_instance.video_displayed&&this.image_instance.video&&this.image_instance.video.play()};var g=function(t){this.parent=t,this.object=null,this.sync(this.parent)};g.prototype.sync=function(t){if(null==this.object&&(this.object=new THREE.Object3D),this.parent.stick){this.parent.parent.viewer.camera.remove(this.object),this.parent.parent.root_webgl.add(this.object);var e=this.parent.parent.viewer.uv_to_spherical(401,this.parent.offset_x_ratio/100,this.parent.offset_y_ratio/100);this.object.position.set(e.x,e.y,e.z),this.object.lookAt(new THREE.Vector3(0,0,0))}else this.parent.parent.root_webgl.remove(this.object),this.parent.parent.viewer.camera.add(this.object),this.object.position.set(0,0,0),this.object.rotation.set(0,0,0)},g.prototype.add=function(t){this.object.add(t)},g.prototype.remove=function(t){this.object.remove(t)},g.prototype.destroy=function(){this.parent.stick?this.parent.parent.root_webgl.remove(this.object):this.parent.parent.viewer.camera.remove(this.object),this.object=null};var y=function(t){this.sprite=null,this.play_sprite=null,this.parent=t,this.viewer=t.parent.viewer,this.video=null,this.video_displayed=!1,this.sync(this.parent)};y.prototype.sync=function(t){function n(){if(r.sprite){var t=400;r.parent.stick&&(t=0);var e=0,n=0;r.parent.has_video_content()?(e=r.video.videoHeight,n=r.video.videoWidth):(e=r.sprite.material.map.image.height,n=r.sprite.material.map.image.width);var i="fullscreen"==r.parent.layout?400:200,o=i/e,a=n*o,s=r.parent.image_size/100;r.parent.viewer.is_smart_phone_play()?r.sprite.scale.set(a,i,1):(s=r.parent.image_size/10,r.sprite.scale.set(.1*a,.1*i,.1)),"fullscreen"==r.parent.layout?r.sprite.position.set(0,0,-t):r.sprite.position.set(0,68,-t)}}function i(){if(r.play_sprite){var t=r.parent.stick?0:400,e=r.play_sprite.material.map.image.height,n=r.play_sprite.material.map.image.width,i="fullscreen"==r.parent.layout?200:100,o=i/e,a=n*o;r.play_sprite.scale.set(.1*a,.1*i,.1),"fullscreen"==r.parent.layout?r.play_sprite.position.set(0,0,-(t-1)):r.play_sprite.position.set(0,68,-(t-1))}}var r=this;if(this.parent=t,null==this.sprite){var a=this.viewer.contents_path_to_cdn(t.image_contents_path);if(this.parent.has_video_content()){if(this.video_displayed=!0,this.video=e.createElement("video"),this.video.autoplay=!0,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.viewer.user_agent.is_android()&&(this.video.autoplay=!1,this.video.preload="none",this.video.controls=!0,this.video.poster=this.viewer.contents_path_to_cdn(O.contents_path_to_thumbnail(a))),this.video.addEventListener("loadedmetadata",function(t){var e=o(r.video);e.needsUpdate=!0;var i=r.parent.viewer.is_smart_phone_play()?r.parent.image_size/100:r.parent.image_size/10;r.sprite=d(i,i,e),n(),r.parent.parent_instance.add(r.sprite)}),this.video.addEventListener("error",function(t){console.log("video.error",t)}),this.video.addEventListener("emptied",function(t){console.log("video.emptied",t)}),this.video.addEventListener("stalled",function(t){console.log("video.stalled",t)}),this.video.addEventListener("playing",function(t){r.play_sprite&&r.play_sprite.visible&&(r.play_sprite.visible=!1)}),this.video.setAttribute("crossorigin","anonymous"),this.video.src=a,this.parent.viewer.is_smart_phone_play()){var s=this.viewer.path_to_cdn("/images/icon_play.png");material_by_texture(s,function(t){r.play_sprite=d(10,10,t),r.parent.parent_instance.add(r.play_sprite),i()},THREE.MeshBasicMaterial)}}else material_by_texture(a,function(t){var e=r.parent.viewer.is_smart_phone_play()?r.parent.image_size/100:r.parent.image_size/10;r.sprite=d(e,e,t),n(),r.parent.parent_instance.add(r.sprite)},THREE.MeshBasicMaterial)}n(),i(),null==this.parent.image&&this.destroy()},y.prototype.destroy=function(){this.video&&this.video.pause(),this.parent.parent_instance&&this.play_sprite&&this.parent.parent_instance.remove(this.play_sprite),null!=this.parent.parent_instance&&this.parent.parent_instance.remove(this.sprite),this.video=null,this.play_sprite=null,this.sprite=null};var E=function(t,e,n){this.sprite=null,this.parent=t,this.div=null,this.key=e,this.sync(this.parent,e,n)};E.prototype.sync=function(t,e,i){function o(){if(a.sprite)if("label"==e)a.sprite.position.set(i.x,i.y-55,i.z),a.sprite.lookAt(new THREE.Vector3(0,1,0));else{var t=a.parent.stick?0:400;a.parent.image?"fullscreen"==a.parent.layout?a.sprite.position.set(0,-375,-t):a.sprite.position.set(0,-200,-t):a.sprite.position.set(0,-100,-t)}}var a=this;if(this.parent=t,null==this.sprite){if(n.isEmpty(this.parent[e]))return;var s=2;if("label"==e){var c=this.create_canvas(e,{scale:s}),l=r(c);this.sprite=d(c.width/s,c.height/s,l),o(),this.parent.parent.root_webgl.add(this.sprite)}else{var c=this.create_canvas(e,{width:300,height:300,align:"left",multi_lines:!0,scale:s}),l=r(c);this.sprite=d(c.width/s,c.height/s,l),o(),this.parent.parent_instance.add(this.sprite)}}o()},E.prototype.create_canvas=function(t,i){function r(t){for(var e=new Array,n=0;n<t.length;n++)e.push(t.charAt(n));return e}function o(t,e,n){for(var i=[],o=/ /.test(e),a=o?e.split(" "):r(e),s=o?" ":"",c="",l=0;l<a.length;l++){var u=c+a[l]+s,h=t.measureText(u),p=h.width;p>n&&l>0?(i.push(c),c=a[l]+s):c=u}return i.push(c),i}function s(t,e,i,r,o){n.each(e,function(e){t.fillText(e,i,r),r+=o})}i||(i={});var c=i.scale?i.scale:1,l=i.margin_top?i.margin_top:5,u=this.parent[t],h=this.parent[t+"_size"]*c,p=a[this.parent[t+"_font"]],d=i.width?i.width*c:2*u.length*h*c,f=i.line_height?i.line_height:1.5*h,m=i.height?(i.height+l)*c:f+l,v=e.createElement("canvas");v.width=d,v.height=m;var g=v.getContext("2d");g.font=h+"px "+p,g.fillStyle=i.color?i.color:"white",g.textAlign=i.align?i.align:"center",g.textBaseline=i.base_line?i.base_line:"top";var y="center"==g.textAlign?d/2:0,E=l;if(i.multi_lines){var _=o(g,u,d,f);1==_.length&&(g.textAlign="center",y=d/2),s(g,_,y,E,f)}else g.fillText(u,y,E);return v},E.prototype.destroy=function(){"label"==this.key?this.parent.parent.root_webgl.remove(this.sprite):this.parent.parent_instance.remove(this.sprite),this.sprite=null};var _=function(t,e,i){console.log("new InstavrAudio"),i||(i={}),this.options=i,this.sound=null,this.parent=t,this.viewer=t.viewer||t.parent.viewer,this.key=e,this.loop=!0,n.has(i,"loop")&&(this.loop=i.loop),n.has(this.parent,this.key+"_loop")&&(this.loop=this.parent[this.key+"_loop"]),this.positional=!1,n.has(i,"positional")&&(this.positional=i.positional),this.sync(this.parent,e)};_.prototype.sync=function(t,e){if(this.parent=t,this.parent[e]&&null==this.sound)if("audio"==this.key){var n=this.viewer.contents_path_to_cdn(this.parent.audio_contents_path);this.sound=this.viewer.add_sound(n,this.loop,!1,this.positional)}else if("music"==this.key){var n=this.viewer.contents_path_to_cdn(this.parent.music_contents_path);this.sound=this.viewer.add_sound(n,this.loop,!1,this.positional)}else{var i=this.parent[e];if(i){var r=this.viewer.find_file_by_id(i);if(r){var n=this.viewer.contents_path_to_cdn(r.contents_path);this.sound=this.viewer.add_sound(n,this.loop,e)}}}},_.prototype.destroy=function(){if("audio"==this.key&&null!=this.sound){var t=this.viewer.contents_path_to_cdn(this.parent.audio_contents_path);this.viewer.remove_sound(t)}else if("music"==this.key&&null!=this.sound){var t=this.viewer.contents_path_to_cdn(this.parent.music_contents_path);this.viewer.remove_sound(t)}this.sound=null};var T=function(t){this.viewer=t,this.sprite=null};T.prototype={constructor:T,init:function(){var t=new THREE.MeshBasicMaterial({color:"rgba(236,236,236,0.8)"});this.sprite=d(1,1,t)},update:function(){if(this.sprite&&(this.viewer.webgl_scene.remove(this.sprite),this.viewer.controls.isGyroMode())){this.viewer.camera.matrixWorld.decompose(this.sprite.position,this.sprite.quaternion,this.sprite.scale);var t=new THREE.Vector4(0,0,1,0);t.applyMatrix4(this.viewer.camera.matrix).normalize(),t.multiplyScalar(-100),this.sprite.position.add(t),this.viewer.webgl_scene.add(this.sprite)}},destroy:function(){this.sprite&&(this.viewer.webgl_scene.remove(this.sprite),this.sprite=null)}};var b=function(t){this.viewer=t,this.container=null,this.gyro_option=!1,this.gyro_button=null,this.gyro_enabled=!1,this.touch_button=null,this.touch_enabled=!1,this.google_button=null,this.google_enabled=!1,this.apple_button=null,this.apple_enabled=!1,this.gyro_close_button_selector=".instavr-gyro-close-button",this.gyro_close_button=null,this.gyro_close_button_enabled=!1};b.prototype={constructor:b,init:function(t){function n(){c.viewer.to_gyro()}function i(){c.viewer.to_touch()}this.container=e.createElement("div"),this.container.style.position="absolute",this.container.style.right="5px",this.container.style.top="5px";var r="ontouchend"in e,o=r?"touchstart":"mousedown";(O.find_branding_tap_screen(t)||O.find_branding_gyro_option(t))&&(this.gyro_option=!0);var a=this.viewer.path_to_cdn("/images/icon_vrgoggle.svg");this.gyro_button=this._create_image_element(a),this.gyro_button.addEventListener(o,n,!1);var s=this.viewer.path_to_cdn("/images/icon_touch.svg");this.touch_button=this._create_image_element(s),this.touch_button.addEventListener(o,i,!1),this.viewer.container.appendChild(this.container);var c=this;this.gyro_close_button=this._find_tag_by_selector(this.gyro_close_button_selector),this.gyro_close_button&&this.gyro_close_button.addEventListener(o,i,!1)},show:function(){this.google_enabled&&this.google_button&&this.container.appendChild(this.google_button),this.apple_enabled&&this.apple_button&&this.container.appendChild(this.apple_button),this.gyro_option&&this.gyro_enabled&&this.gyro_button&&this.container.appendChild(this.gyro_button),this.gyro_option&&this.touch_enabled&&this.touch_button&&this.container.appendChild(this.touch_button),this.gyro_option&&this.gyro_close_button_enabled&&this.gyro_close_button&&(this.gyro_close_button.style.display="inline")},show_gyro:function(){this.viewer.user_agent.is_smart_phone()&&(this.gyro_enabled=!0),this.touch_enabled=!1,this.gyro_close_button_enabled=!1,this.remove_all(),this.show()},show_touch:function(){this.gyro_enabled=!1,this.viewer.fullscreen?this.touch_enabled=!1:this.touch_enabled=!0,this.viewer.fullscreen&&this.viewer.enable_dualview&&this.viewer.user_agent.is_smart_phone()&&(this.gyro_close_button_enabled=!0),this.remove_all(),this.show()},remove_all:function(){for(;this.container.firstChild;)this.container.removeChild(this.container.firstChild);this.gyro_close_button&&(this.gyro_close_button.style.display="none")},_create_image_element:function(t){var n=e.createElement("img");return n.style.height="32px",n.style.width="32px",n.style.background="rgba(236,236,236,0.8)",n.style.borderRadius="3px",n.style.mozBorderRadius="3px",n.style.webkitBorderRadius="3px",n.style.padding="10px 10px",n.style.marginLeft="3px",n.style.display="inline",n.src=t,n},_create_link_element:function(t,e){var n=this._create_image_element(t);if(e){var i=this._create_anchor_element(e);i.appendChild(n),n=i}return n},_create_anchor_element:function(t){var n=e.createElement("a");return n.href=t,n.target="_blank",n},_find_tag_by_selector:function(t){return this.viewer.container?this.viewer.container.querySelector(t):null}},InstavrScreenBranding=function(t){this.viewer=t,this.banner=null},InstavrScreenBranding.prototype={constructor:InstavrScreenBranding,init:function(t){function e(){var t=i.viewer.path_to_cdn("/images/banner_instavr.png"),e="http://instavr.co/";null!=i.viewer.bundle.referral&&(e=i.viewer.bundle.console+"/signup?referral_code="+i.viewer.bundle.referral.code),i.banner=i._create_banner_element(t,e)}var i=this;if(this.container=this._create_container_element(),n.isEmpty(t))e();else{var r=this._find_branding_banner(t),o=this._find_branding_banner_link(t),a=this._find_branding_default_enabled(t);if(a&&!a.enable&&r&&!n.isEmpty(r.contents_path)){var s=o?s=o.text:null,c=this.viewer.contents_path_to_cdn(r.contents_path);this.banner=this._create_banner_element(c,s)}else a&&!a.enable?this.banner=null:e()}this.banner&&this.viewer.container.appendChild(this.container)},show:function(){this.remove_all(),this.banner&&this.container.appendChild(this.banner)},hide:function(){this.remove_all()},remove_all:function(){if(this.container)for(;this.container.firstChild;)this.container.removeChild(this.container.firstChild)},_create_container_element:function(){var t=e.createElement("div");return t.id="instavr_scene_branding_container",t.className="instavr-scene-branding-container",
t.style.position="absolute",t.style.right="0px",t.style.left="0px",t.style.bottom="0px",t.style.textAlign="center",t.style.margin="auto",t},_create_banner_element:function(t,e){var n=this._create_image_element(t);if(e){var i=this._create_anchor_element(e);i.appendChild(n),n=i}return n},_create_anchor_element:function(t){var n=e.createElement("a");return n.href=t,n.target="_blank",n},_create_image_element:function(t){var n=e.createElement("img");return n.style.maxHeight="50px",n.style.maxWidth="300px",n.style.background="rgba(236,236,236,0.8)",n.style.display="inline",n.style.borderRadius="10px 10px 0px 0px",n.src=t,n},_find_branding_banner:function(t){return n.find(t,function(t){return 90==t.branding_level_id})},_find_branding_banner_link:function(t){return n.find(t,function(t){return 91==t.branding_level_id})},_find_branding_default_enabled:function(t){return n.find(t,function(t){return 92==t.branding_level_id})}},InstavrWatermarkManager=function(t){this.viewer=t,this.watermark_list=[],this.position_list=[{offset_x_ratio:0,offset_y_ratio:50},{offset_x_ratio:25,offset_y_ratio:50},{offset_x_ratio:50,offset_y_ratio:50},{offset_x_ratio:75,offset_y_ratio:50}]},InstavrWatermarkManager.prototype={constructor:InstavrWatermarkManager,init:function(){var t=this;this.viewer.is_watermark_disabled()||n.map(this.position_list,function(e){var n=new InstavrWatermark(t.viewer,t.viewer.webgl_scene),i=500,r=t.viewer.uv_to_spherical(i,e.offset_x_ratio/100,e.offset_y_ratio/100),o=t.viewer.path_to_cdn("/images/app_watermark.png");return n.sync(r,o),n})},destroy:function(){this.watermark_list&&n.each(this.watermark_list,function(t){t.destroy()})}},InstavrWatermark=function(t,e){this.viewer=t,this.parent_obj=e,this.sprite=null},InstavrWatermark.prototype={constructor:InstavrWatermark,sync:function(t,e){var n=this;this.sprite||material_by_texture(e,function(e){var i=e.map.image.height,r=e.map.image.width,o=n.viewer.is_smart_phone_play()?.6:.8;n.sprite=d(r*o,i*o,e),n.sprite.position.set(t.x,t.y,t.z),n.sprite.lookAt(new THREE.Vector3(0,1,0)),n.parent_obj.add(n.sprite)},THREE.MeshBasicMaterial)},destroy:function(){this.sprite&&(this.parent_obj.remove(this.sprite),this.sprite=null)}};var w=function(t,e){this.focuses=[],this.raycaster=null};w.prototype={constructor:w,init:function(t){this.raycaster=t},add_focus:function(t){this.focuses.push(t)},clear_focuses:function(){this.focuses=[]},update:function(){this.raycast()},raycast:function(){if(this.raycaster){var t=this.raycaster.raycast();n.each(this.focuses,function(t){t.hitted=!1}),n.each(t,function(t){this.apply_hit(t)},this),n.each(this.focuses,function(t){t.update_active()})}},apply_hit:function(t){n.each(this.focuses,function(e){e.parent.icon_sprite==t.object&&(e.hitted=!0)})}};var R=function(t,e){e||(e={}),this.parent=t,this.active=!1,this.filling=0,this.filling_start=0,this.activate_time=0,this.deactivate_time=0,this.min=e.min||0,this.max=e.min||1500,this.refocus=e.refocus||!1,this.hitted=!1,this.circle_interval=e.circle_interval||this.max,this.on_filled_action=e.on_filled_action,this.on_filling_action=e.on_filling_action,this.on_defilling_action=e.on_defilling_action,this.on_defilled_action=e.on_defilled_action};R.prototype={constructor:R,update_active:function(){var t=this.is_active();this.hitted&&!t?this.set_active(!0):!this.hitted&&t&&this.set_active(!1)},is_active:function(){return this.active},set_active:function(t){this.active=t,this.active?(this.filling_start=this.current_filling(),this.activate_time=(new Date).getTime()):(this.filling_start=this.current_filling(),this.deactivate_time=(new Date).getTime())},increase:function(){this.filling=this.filling_start+((new Date).getTime()-this.activate_time),this.filling>this.max?this.filling=this.max:null!=this.on_filling_action&&this.on_filling_action(this)},decrease:function(){this.filling=this.filling_start-((new Date).getTime()-this.deactivate_time),this.filling<this.min&&(this.filling=this.min),null!=this.on_defilling_action&&this.on_defilling_action(this)},current_circle_radius:function(){var t=this.filling%this.circle_interval/this.circle_interval;return 2*Math.PI*t*-1},current_filling:function(){return this.filling},is_filled:function(){return this.filling>=this.max},is_unfilled:function(){return this.filling<=this.min},do_on_filled_action:function(){null!=this.on_filled_action&&this.on_filled_action()},do_on_defilled_action:function(){null!=this.on_defilled_action&&this.on_defilled_action()}};var x=function(){this.next=null};x.prototype={execute:function(t){return null!=this.next?next:this}};var H=function(){x.call(this)};H.prototype=Object.assign(Object.create(x.prototype),{constructor:H,execute:function(t){return t.is_active()?new M:x.prototype.execute.call(this,t)}});var M=function(){x.call(this)};M.prototype=Object.assign(Object.create(x.prototype),{constructor:M,execute:function(t){return t.is_active()?new S:(t.decrease(),t.is_unfilled()?(t.do_on_defilled_action(),new H):x.prototype.execute.call(this,t))}});var S=function(){x.call(this)};S.prototype=Object.assign(Object.create(x.prototype),{constructor:S,execute:function(t){return t.is_active()?(t.increase(),t.is_filled()?(t.do_on_filled_action(),new C):x.prototype.execute.call(this,t)):new M}});var C=function(){x.call(this)};C.prototype=Object.assign(Object.create(x.prototype),{constructor:C,execute:function(t){return t.refocus&&!t.is_active()?new M:x.prototype.execute.call(this,t)}});var A=function(){this.targets=[]};A.prototype={constructor:A,add_target:function(t){this.targets.push(t)},clear_targets:function(){this.targets=[]},update:function(){n.each(this.targets,function(t){t.focus_state&&t.focus_data&&(t.focus_state=t.focus_state.execute(t.focus_data))})}};var P=function(t){this.viewer=t};P.prototype={constructor:P,raycast:function(){var t=this.viewer.camera,e=new THREE.Raycaster(t.position,t.getWorldDirection());return e.intersectObjects(this.viewer.webgl_scene.children,!0)}};var L=function(t){this.viewer=t,this.ga=null,this.tracking_list=[],this.tracking_id="UA-80915128-2",this.tracking_name="instavr",this.page_prefix="/instavr/",this.category_prefix="instavr."};L.prototype={constructor:L,init:function(e){if(this.ga=t.ga,!this.ga)return console.error("Not found google analytics instance."),!1;this._init_ga(this.tracking_id,this.tracking_name),this.ga(this.tracking_name+".send","pageview");var i=O.find_branding_tracking_id(e);if(!n.isEmpty(i)){var r=this._create_new_name();this._init_ga(i,r)}return!0},send_pageview:function(t){if(this.ga&&!n.isEmpty(t)){var e=this.page_prefix+t;n.each(this.tracking_list,function(t){this.ga(t.name+".send","pageview",e)})}},send_event:function(t,e){if(this.ga&&!n.isEmpty(e)){var i=this.category_prefix+t;n.each(this.tracking_list,function(t){this.ga(t.name+".send","event",i,"view",e)})}},_init_ga:function(t,e){this.ga("create",t,{name:e}),this.tracking_list.push({id:t,name:e})},_create_new_name:function(){return O.create_random_string(10)}};var O={brandings:null,to_cdn:function(t,e){return t?(e?(t=t.replace("https://s3.amazonaws.com/dev.com.candlify.vrbuilder",e),t=t.replace("https://s3.amazonaws.com/com.candlify.vrbuilder",e)):(t=t.replace("https://s3.amazonaws.com/dev.com.candlify.vrbuilder","https://dev-cdn.instavr.co"),t=t.replace("https://s3.amazonaws.com/com.candlify.vrbuilder","https://cdn.instavr.co")),t):t},extract_domain:function(t){var e="";if(t.indexOf("://")>-1){var n=t.split("/");e=n[0]+"//"+n[2]}return e},get_cdn_base_url:function(){var t=e.getElementById("instavr_src").src;return t?t.replace("/instavrviewer.js","").replace("/instavr.min.js",""):""},THUMBNAIL_FILE_NAME:"hls_4M_2048-1536_00001.png",contents_path_to_thumbnail:function(t){return t.replace(/content/i,"movie").replace(/\.mp4/i,"/"+O.THUMBNAIL_FILE_NAME)},find_branding_text:function(t,e){if(n.isEmpty(t))return null;var i=n.find(t,function(t){return t.branding_level_id==e});return i?i.text:null},find_branding_enable:function(t,e,i){if(n.isEmpty(t))return i;var r=n.find(t,function(t){return t.branding_level_id==e});return r?r.enable:i},find_branding_number:function(t,e,n){var i=O.find_branding_text(t,e);return null!=i?Number(i):n},find_branding_google_link_url:function(t){return O.find_branding_text(t,93)},find_branding_apple_link_url:function(t){return O.find_branding_text(t,94)},find_branding_gyro_option:function(t){return O.find_branding_enable(t,99,!0)},find_branding_tap_screen:function(t){return O.find_branding_enable(t,104)},find_branding_tracking_id:function(t){return O.find_branding_text(t,83)},find_branding_head_reset_on_scene_change:function(){return O.find_branding_enable(O.brandings,101)},find_branding_focus_duration:function(t){return O.find_branding_number(O.brandings,105,t)},find_branding_focus_display_circle:function(){return O.find_branding_enable(O.brandings,106)},create_random_string:function(t){for(var e="abcdefghijklmnopqrstuvwxyz0123456789",n=e.length,i="",r=0;r<t;r++)i+=e[Math.floor(Math.random()*n)];return i}},j=function(e){this.user_agent=e||t.navigator.userAgent};j.prototype={constructor:j,is_ios:function(){return null!=this.user_agent.match(/iPhone|iPad|iPod/i)},is_android:function(){return null!=this.user_agent.match(/Android/i)},is_smart_phone:function(){return this.is_ios()||this.is_android()},is_ie:function(){return null!=this.user_agent.match(/MSIE|Trident/i)}};var k=function(){this.bundle={},this.media=null,this.container=null,this.camera=null,this.scene=null,this.renderer=null,this.webgl_scene=null,this.webgl_renderer=null,this.controls=null,this.gyro_controls=null,this.audio_listener=null,this.audio_loader=null,this.clicked=!1,this.loading=null,this.loading_count=0,this.screen_branding=new InstavrScreenBranding(this),this.buttons=new b(this),this.focus_data_manager=new w,this.focus_update_manager=new A,this.viewpoint=null,this.watermark=new InstavrWatermarkManager(this),this.hotspot_video_displayed=!1,this.hotspot_video_instance=null,this.sprites={},this.sounds={},this.spatial_sounds={},this.waited_sounds=[],this.on_click_hotspot_callbacks=[],this.on_click_link_callbacks=[],this.on_click_action_callbacks=[],this.on_click_input_callbacks=[],this.on_click_none_callbacks=[],this.cdn_enabled=!1,this.cdn="",this.bundle_cdn="",this.mode="editor",this.container_id="instavr_container",this.image_key="preview_path",this.global_fov=80,this.x_mousedown=0,this.y_mousedown=0,this.x_click=1,this.y_click=2,this.image_quality="original",this.video_quality="original",this.user_agent=new j,this.analytics=new L(this),this.debug=!1,this.fullscreen=!1,this.position_style="relative",this.use_parent=!1,this.width_style=null,this.height_style=null,this.width=0,this.height=0,this.allow_tap_screen=!1,this.enable_dualview=!1,this.enable_gyro_by_default=!1,this.to_gyro_at=null,this.enable_mobile_video_quality=!1,this.tap_icon_displayed=!1,this.audio_context=null,this.video_played=!1,this.audio_played=!1,this.play_pressed=0,this.has_spatial=!1};k.modes={play:"play",editor:"editor"},k.prototype.is_play_mode=function(){return this.mode==k.modes.play},k.prototype.is_editor_mode=function(){return this.mode==k.modes.editor},k.prototype.is_smart_phone_play=function(){return this.user_agent.is_smart_phone()&&this.is_play_mode()},k.prototype.init=function(i,r,o){function a(){l.timeline.on_update(),l.media&&l.media.on_update(l.timeline),l.on_resize(),requestAnimationFrame(a),l.controls.update(),l.gyro_controls&&l.gyro_controls.update(),l.controls.isGyroMode()&&(l.focus_data_manager.update(),l.focus_update_manager.update()),l.viewpoint.update(),l.fullscreen&&l.enable_dualview?l.cardboard_effect.render(l.webgl_scene,l.camera):l.webgl_renderer.render(l.webgl_scene,l.camera),l.renderer.render(l.scene,l.camera),"editor"==l.mode&&l.live_video.readyState===l.live_video.HAVE_ENOUGH_DATA&&l.live_video_texture&&(l.live_video_texture.needsUpdate=!0),l.sync_sounds(),l.update_loading()}o||(o={}),console.log("options",o),this.mode=i,this.container_id=r;for(key in o)this[key]=o[key];this.texture_min_filter=o.texture_min_filter||"NearestFilter",this.texture_max_filter=o.texture_max_filter||"NearestFilter",this.use_parent=o.use_parent|!1,this.user_parent?this.position_style="static":this.position_style="relative";var s=o.cdn;s?(this.cdn_enabled=!0,this.cdn=s,delete o.cdn):this.cdn=O.get_cdn_base_url(),console.log("this.cdn:",this.cdn),o.bundle_cdn?(this.bundle_cdn=o.bundle_cdn,delete o.bundle_cdn):s?this.bundle_cdn=s:this.bundle_cdn=O.extract_domain(this.cdn),console.log("this.bundle_cdn:",this.bundle_cdn);var l=this;n.each(o,function(t,e){l[e]=t}),console.log("_this.debug:"+l.debug),this.is_smart_phone_play()&&D.create(this.path_to_cdn("/images/icon_play.png"),"image"),this.container=e.getElementById(r),this.container.style.position=this.position_style,this.width_style=this.container.style.width,this.height_style=this.container.style.height,this.use_parent&&this.container.parentNode?(this.width=this.container.parentNode.clientWidth,this.height=this.container.parentNode.clientHeight):(this.width=this.container.clientWidth,this.height=this.container.clientHeight),this.camera=new THREE.PerspectiveCamera(this.global_fov,this.width/this.height,1,5e3),this.scene=new THREE.Scene,this.camera_parent=new THREE.Object3D,this.scene.add(this.camera_parent),this.camera_parent.add(this.camera),this.user_agent.is_ie()||(this.audio_listener=new THREE.AudioListener,this.camera.add(this.audio_listener)),this.audio_loader=new THREE.AudioLoader;var u=r+"_video";if(this.video=e.getElementById(u),null==this.video){var h=e.createElement("div");h.style.height="0px",this.debug&&(h.style.height="200px"),this.container.appendChild(h),this.video=e.createElement("video"),this.video.setAttribute("id",u),this.is_editor_mode()?(this.video.autoplay=!0,this.video.className="video-js vjs-default-skin"):(this.video.setAttribute("playsinline",""),this.video.setAttribute("autoplay","")),this.video.style.width="0%",this.video.style.minHeight="0%",this.debug&&(this.video.style.width="100px",this.video.mute=!0),h.appendChild(this.video)}if(this.init_loading(),this.enable_mobile_video_quality&&this.is_smart_phone_play()&&(this.video_quality="safe"),this.video.crossOrigin="",this.video_player=videojs(u,{controlBar:{fullscreenToggle:!1}}),this.video_texture=new THREE.VideoTexture(this.video),this.is_editor_mode()){var p=e.querySelector("#"+u+" > .vjs-control-bar");e.getElementById("placeholder").appendChild(p),p.style.width="100%;"}"editor"==this.mode&&(this.live_video=e.getElementById("live_video"),this.live_video_texture=new THREE.VideoTexture(this.live_video)),this.renderer=new THREE.CSS3DRenderer,this.renderer.setSize(this.width,this.height),this.renderer.domElement.style.position="absolute",this.renderer.domElement.childNodes[0].style.pointerEvents="none",this.container.appendChild(this.renderer.domElement),this.webgl_renderer=new THREE.WebGLRenderer,this.webgl_renderer.setPixelRatio(t.devicePixelRatio),this.webgl_renderer.setSize(this.width,this.height),this.webgl_scene=new THREE.Scene,this.container.appendChild(this.webgl_renderer.domElement),this.webgl_scene.add(this.camera_parent),this.viewpoint=new T(this),this.viewpoint.init(),this.camera.position.x=.01,this.controls=new THREE.InstavrControls(this.camera,this.renderer.domElement),this.controls.enableDamping=!0,this.controls.dampingFactor=.25,this.controls.enableZoom=!1,this.controls.zoomSpeed=5,this.controls.autoRotate=!0,this.controls.autoRotateSpeed=.1,this.user_agent.is_smart_phone()&&(this.controls.zoomSpeed/=10,this.controls.rotateSpeed/=10),o.direction_reversing&&(this.controls.rotateSpeed*=-1);var d=new P(this);this.focus_data_manager.init(d),t.addEventListener("resize",function(t){l.on_resize(t)},!1),this.container.addEventListener("mousedown",function(t){l.on_mousedown(t)},!1),this.container.addEventListener("click",function(t){l.on_click(t),l.has_spatial&&l.waited_sounds.length<4||(console.log("_this.media",l.media),l.media&&"video"==l.media.element&&0==l.video.currentTime&&(l.hide_tap(),l.reset_loading(),l.start_loading(),l.video.load(),l.video.play(),l.is_smart_phone_play()&&l.play_waited_sounds()))},!1),e.onwebkitfullscreenchange=function(t){l.on_change_fullscreen(t)},e.onmozfullscreenchange=function(t){l.on_change_fullscreen(t)},e.onmsfullscreenchange=function(t){l.on_change_fullscreen(t)},e.onfullscreenchange=function(t){l.on_change_fullscreen(t)},this.cardboard_effect=new THREE.CardboardEffect(this.webgl_renderer),this.timeline=new c(this),a(),this.is_play_mode()&&this.enable_gyro_by_default&&this.controls.enableBrowserGyro()},k.prototype.is_watermark_enabled=function(){return!this.is_watermark_disabled()},k.prototype.is_watermark_disabled=function(){return!(!this.bundle.viewer_options||1!=this.bundle.viewer_options.watermark_disabled)},k.prototype.play_waited_sounds=function(){if(this.waited_sounds.length>0){console.log("play_waited_sounds ");for(var t=0;t<this.waited_sounds.length;t++)this.waited_sounds[t].play();waited_sounds=[]}},k.prototype.sync_sounds=function(){if(!this.tap_icon_displayed&&this.has_spatial&&4==this.waited_sounds.length&&(console.log("waited_sounds.length == 4. clear"),this.reset_loading(),this.show_tap()),this.media&&"video"==this.media.element&&this.video&&this.video.currentTime>0&&null!=this.media.root_webgl&&null!=this.camera){var t=this.media.root_webgl.rotation.y,e=this.camera.rotation.y,n=t-e;this.spatial_sounds.spatial_fl&&this.spatial_sounds.spatial_fl.setVolume(Math.cos(n)),this.spatial_sounds.spatial_fr&&this.spatial_sounds.spatial_fr.setVolume(-Math.sin(n)),this.spatial_sounds.spatial_bl&&this.spatial_sounds.spatial_bl.setVolume(-Math.cos(n)),this.spatial_sounds.spatial_br&&this.spatial_sounds.spatial_br.setVolume(Math.sin(n)),this.spatial_sounds.spatial_fl&&this.spatial_sounds.spatial_fr&&this.spatial_sounds.spatial_bl&&this.spatial_sounds.spatial_br}},k.prototype.init_loading=function(){var t=this.container_id+"_instavr_loading_container",n=e.createElement("div");n.setAttribute("id",t),n.style.position="absolute",n.style.top="50%",n.style.left="50%",n.style.marginTop="-20px",n.style.marginLeft="-20px",this.container.appendChild(n),this.loading=new CanvasLoader(t),this.loading.setColor("#c2c2c2")},k.prototype.update_loading=function(){this.loading&&(this.loading_count>0?this.loading.show():this.loading.hide())},k.prototype.reset_loading=function(){this.loading_count=0},k.prototype.start_loading=function(){this.loading_count+=1},k.prototype.end_loading=function(){this.loading_count-=1},k.prototype.show_tap=function(){if(!this.tap_icon_displayed){this.tap_icon_displayed=!0;var t=this.container_id+"_instavr_tap_container",n=e.createElement("div");n.setAttribute("id",t),n.style.position="absolute",n.style.top="50%",n.style.left="50%",n.style.marginTop="-64px",n.style.marginLeft="-64px",this.container.appendChild(n);var i=e.createElement("img");i.style.height="128px",i.style.width="128px",i.src=this.path_to_cdn("/images/icon_play.png"),n.appendChild(i)}},k.prototype.hide_tap=function(){var t=this.container_id+"_instavr_tap_container",n=e.getElementById(t);n&&n.parentNode.removeChild(n)},k.prototype.on_resize=function(e){var n=this.container.clientWidth,i=this.container.clientHeight;this.fullscreen?(this.container.style.position="absolute",this.container.style.left=0,this.container.style.top=0,this.container.style.width=t.innerWidth,this.container.style.height=t.innerHeight,n=t.innerWidth,i=t.innerHeight):(this.container.style.position=this.position_style,this.use_parent&&this.container.parentNode?(n=this.container.parentNode.clientWidth,i=this.container.parentNode.clientHeight):(n=this.container.clientWidth,i=this.container.clientHeight)),this.camera.aspect=n/i,this.camera.updateProjectionMatrix(),this.renderer.setSize(n,i),this.webgl_renderer.setSize(n,i)},k.prototype.set_zoom=function(t){this.enable_zoom&&(this.controls.enableZoom=!0);var e=n.find(t,function(t){return 98==t.branding_level_id});e&&1==e.enable?this.controls.enableZoom=!0:this.controls.enableZoom=!1},k.prototype.update_files=function(t){this.bundle.files=t},k.prototype.update=function(t,e,i){var r=this;i&&n.each(i,function(t,e,n){r[e]=t}),this.bundle=t,O.brandings=t.brandings,this.is_play_mode()&&(this.analytics.init(t.brandings),this.set_zoom(t.brandings),this.buttons.init(t.brandings),this.buttons.show_gyro(),this.screen_branding.init(t.brandings),this.screen_branding.show(),O.find_branding_tap_screen(t.brandings)&&(this.allow_tap_screen=!0),this.watermark.init()),this.sync(e)},k.prototype.sync=function(t){this.is_editor_mode()||(this.camera.fov=this.global_fov);var e=n.find(this.bundle.medias,function(t){return t.opened});if(console.log("force update"),null==this.media||null!=e&&this.media._id!=e._id||t){this.reset_loading();var i=new l(this,e);null!=this.media&&this.media.destroy(i),this.focus_data_manager.clear_focuses(),this.focus_update_manager.clear_targets(),this.media=i,this.media.create(),this.media.sync(e)}else this.media.sync(e)},k.prototype.on_mousedown=function(t){this.x_mousedown=t.offsetX,this.y_mousedown=t.offsetY},k.prototype.on_click=function(t){if(this.controls.autoRotate=!1,console.log("this.controls.get_state():"+this.controls.get_state()),this.controls.get_state()==-1){if(this.user_agent.is_smart_phone()&&this.hotspot_video_displayed)return this.hotspot_video_displayed=!1,void this.hotspot_video_instance.play_video();var e=t.offsetX,n=t.offsetY;this.x_click=e,this.y_click=n;var i=this.container.clientWidth,r=this.container.clientHeight,o=new THREE.Vector2;o.x=e/i*2-1,o.y=2*-(n/r)+1,this.raycast(o)}},k.prototype.raycast=function(t){var e=new THREE.Raycaster;e.setFromCamera(t,this.camera);for(var n=e.intersectObjects(this.webgl_scene.children,!0),i=0;i<n.length;i++)this.select(n[i],n.length)},k.prototype.on_click_hotspot=function(t){this.is_play_mode()&&(this.media.on_click_none(),this.user_agent.is_smart_phone()&&t.has_video_content()&&!this.hotspot_video_displayed&&(this.hotspot_video_displayed=!0,this.hotspot_video_instance=t),t.on_click()),n.each(this.on_click_hotspot_callbacks,function(e){e(t)})},k.prototype.on_click_link=function(t){console.log("InstavrViewer.prototype.on_click_link"),console.log(this),"play"==this.mode&&(console.log("play"),t.on_click()),n.each(this.on_click_link_callbacks,function(e){e(t)})},k.prototype.on_click_input=function(t){console.log("InstavrViewer.prototype.on_click_input"),console.log(this),"play"==this.mode&&(console.log("play"),t.on_click()),n.each(this.on_click_input_callbacks,function(e){e(t)})},k.prototype.on_click_action=function(t){console.log("on_click_action"),"play"==this.mode&&t.on_click(),n.each(this.on_click_action_callbacks,function(e){e(t)})},k.prototype.on_click_none=function(t){console.log("on_click_none"),this.is_play_mode()&&this.x_mousedown==this.x_click&&this.y_mousedown==this.y_click&&(console.log("on_click_none play"),this.media.on_click_none(),this.hotspot_video_instance=null,this.allow_tap_screen?this.fullscreen?this.to_touch():this.to_gyro():this.fullscreen&&this.controls.isGyroMode()&&(this.to_gyro_at&&(new Date).getTime())-this.to_gyro_at.getTime()>500&&this.to_touch()),n.each(this.on_click_none_callbacks,function(e){e(t)})},k.prototype.select=function(t,e){var n=this.object_to_instance(t);if(null!=n)this.select_marker(n);else{var i=this.spherical_to_uv(600,t.point);i.x+=this.media.offset_y/360,1==e&&this.on_click_none(i)}},k.prototype.select_marker=function(t){switch(t.class){case"Hotspot":this.on_click_hotspot(t);break;case"Link":this.on_click_link(t);break;case"Action":this.on_click_action(t);break;case"Input":this.on_click_input(t)}},k.prototype.change_scene=function(t){if(!n.isEmpty(this.bundle.medias)){var e=n.find(this.bundle.medias,function(e){return e.hash==t});if(!e)return void console.log("Scene is not found.",t);n.each(this.bundle.medias,function(t){t.opened=!1}),e.opened=!0,this.reset_camera(),this.sync()}},k.prototype.object_to_instance=function(t){var e="";n.each(this.sprites,function(n,i){n==t.object&&(e=i)});var i=null;return i=n.find(this.media.hotspots,function(e){if(e.icon_sprite==t.object)return!0}),null!=i?i:(i=n.find(this.media.links,function(e){if(e.icon_sprite==t.object)return!0}),null!=i?i:(i=n.find(this.media.actions,function(e){if(e.icon_sprite==t.object)return!0}),null!=i?i:i=n.find(this.media.inputs,function(e){if(e.icon_sprite==t.object)return!0})))},k.prototype.uv_to_spherical=function(t,e,n){var i=-360*e*(Math.PI/180)+Math.PI,r=90*(.5-n)*2*(Math.PI/180),o=t*Math.cos(i)*Math.cos(r),a=t*Math.sin(r),s=-(t*Math.sin(i)*Math.cos(r));return new THREE.Vector3(o,a,s)},k.prototype.spherical_to_uv=function(t,e){var n=new THREE.Vector3(e.x,e.y,e.z);n.normalize();var i=-Math.atan2(n.x,n.z)/(2*Math.PI)+.25;i<0?i=1+i:i>1&&(i-=1);var r=-Math.asin(n.y)/Math.PI+.5;return new THREE.Vector2(i,r)},k.prototype.add_sound=function(e,i,r,o){if(console.log("add_sound"),!this.audio_listener)return null;var a=this,s=null;try{null==this.audio_context&&(t.AudioContext=t.AudioContext||t.webkitAudioContext,this.audio_context=new AudioContext)}catch(t){return console.log("Web Audio API is not supported in this browser",t),s}n.has(this.sounds,e)&&(s=this.sounds[e]);try{null==s?(s=o?new THREE.PositionalAudio(this.audio_listener):new THREE.Audio(this.audio_listener),this.has_spatial||r&&(console.log("has spatial"),this.has_spatial=!0,this.start_loading()),this.audio_loader.load(e,function(t){s.setBuffer(t),1==i&&s.setLoop(i),r||o?a.media&&"video"==a.media.element&&(console.log("spatial_sounds ",r),console.log("positional ",o),a.spatial_sounds[r]=s,a.video.currentTime>0?s.play():(console.log("Warning! Video is not played yet"),a.waited_sounds.push(s))):s.play()}),o?this.camera_parent.add(s):this.camera.add(s),this.sounds[e]=s):(console.log("add_sound exist pplay()"),s.play())}catch(t){console.log(t),n.has(this.sounds,e)&&delete this.sounds[e],s=null}return s},k.prototype.remove_sound=function(t){this.sounds[t]&&this.sounds[t].stop(),delete this.sounds[t]},k.prototype.reset_camera=function(){O.find_branding_head_reset_on_scene_change()&&this.controls.reset()},k.prototype.sync_key_value=function(t,e){this[t]=e,this.sync(!0)},k.prototype.sync_video_quality=function(t){this.video_quality=t,this.sync(!0)},k.prototype.sync_image_quality=function(t){this.image_quality=t,this.sync(!0)},k.prototype.sync_texture_min_filter=function(t){this.texture_min_filter=t,this.sync(!0)},k.prototype.sync_texture_max_filter=function(t){this.texture_max_filter=t,this.sync(!0)},k.prototype.string_to_filter=function(t){switch(t){case"NearestFilter":return THREE.NearestFilter;case"NearestMipMapNearestFilter":return THREE.NearestMipMapNearestFilter;case"NearestMipMapLinearFilter":return THREE.NearestMipMapLinearFilter;case"LinearFilter":return THREE.LinearFilter;case"LinearMipMapNearestFilter":return THREE.LinearMipMapNearestFilter;case"LinearMipMapLinearFilter":return THREE.LinearMipMapLinearFilter}return THREE.NearestFilter},k.prototype.get_texture_min_filter=function(){return this.string_to_filter(this.texture_min_filter)},k.prototype.get_texture_max_filter=function(){return this.string_to_filter(this.texture_max_filter)},k.prototype.find_media_by_id=function(t){return n.isEmpty(t)?null:n.isEmpty(this.bundle.medias)?null:n.find(this.bundle.medias,function(e){return t==e._id})},k.prototype.find_hotspot_by_id=function(t){return n.isEmpty(t)?null:n.isEmpty(this.bundle.hotspots)?null:n.find(this.bundle.hotspots,function(e){return t==e._id})},k.prototype.find_file_by_id=function(t){return n.isEmpty(t)?null:n.isEmpty(this.bundle.files)?null:n.find(this.bundle.files,function(e){return t==e._id})},k.prototype.path_to_cdn=function(t){return t&&this.cdn?this.cdn+t:t},k.prototype.contents_path_to_cdn=function(t){if(!t)return t;if(!this.cdn_enabled)return O.to_cdn(t);t=decodeURIComponent(t),t=t.replace("/content/","/contents/"),t=t.replace("/movie/","/contents/");var e=O.to_cdn(t,this.cdn);return e},k.prototype.enable_fullscreen=function(){this.container.webkitRequestFullscreen?this.container.webkitRequestFullscreen():this.container.mozRequestFullScreen?this.container.mozRequestFullScreen():this.container.msRequestFullscreen?this.container.msRequestFullscreen():this.container.requestFullscreen&&this.container.requestFullscreen(),this.container.style.width=t.innerWidth,this.container.style.height=t.innerHeight,this.fullscreen=!0,this.enable_zoom&&this.controls.isGyroMode()&&this.user_agent.is_ios()&&(this.controls.enableZoom=!1)},k.prototype.disable_fullscreen=function(){this.enable_zoom&&(this.controls.enableZoom=!0),this.fullscreen=!1,e.webkitCancelFullScreen?e.webkitCancelFullScreen():e.mozCancelFullScreen?e.mozCancelFullScreen():e.msExitFullscreen?e.msExitFullscreen():e.cancelFullScreen?e.cancelFullScreen():e.exitFullscreen&&e.exitFullscreen(),this.container.style.width=/^\d*%$/.test(this.width_style)?this.width_style:this.width,this.container.style.height=/^\d*%$/.test(this.height_style)?this.height_style:this.height,this.controls.changeToBrowserMode(),this.buttons.show_gyro(),this.sync()},k.prototype.on_change_fullscreen=function(t){console.log("on_change_fullscreen"),console.log(this),void 0!==e.webkitFullscreenElement&&null==e.webkitFullscreenElement?this.disable_fullscreen():void 0!==e.mozFullScreenElement&&null==e.mozFullScreenElement?this.disable_fullscreen():void 0!==e.msFullscreenElement&&null==e.msFullscreenElement?this.disable_fullscreen():void 0!==e.fullscreenElement&&null==e.fullscreenElement&&this.disable_fullscreen()},k.prototype.to_gyro=function(){this.to_gyro_at=new Date,this.controls.changeToGyroMode(),this.sync(),this.enable_fullscreen(),this.screen_branding.hide(),this.buttons.show_touch()},k.prototype.to_touch=function(){this.to_gyro_at=null,this.controls.changeToBrowserMode(),this.sync(),this.disable_fullscreen(),this.screen_branding.show(),this.buttons.show_gyro()},k.prototype.embed=function(t,e){e||(e={});var i=this,r=e.container_id||"instavr_container";delete e.container_id;var o=e.scene;delete e.scene,this.init("play",r,e),loader=new THREE.XHRLoader,loader.load(this.bundle_cdn+"/bundles/"+t,function(t){var e=JSON.parse(t),r=e.data;r.medias=n.sortBy(r.medias,"order"),n.each(r.medias,function(t){t.opened=!1});var a;o&&(a=n.find(r.medias,function(t){return t.hash==o})),a?a.opened=!0:r.medias[0].opened=!0,i.update(r)},function(t){console.log("progress"),console.log(t)},function(t){console.error("error"),console.error(t)})},k.embed=function(t,e){var n=new k;return n.embed(t,e),n},t.InstavrViewer=k;var I=function(){this.loaded_list=[]};I.prototype={constructor:I,create:function(e,n){var i=this;this.is_cached(e)||t.setTimeout(function(){"image"==n?i.load_image(e):console.log("Unsupported type.",n,e)},1)},load_image:function(t){var n=this,i=e.createElement("img");i.onload=function(e){n.loaded_list.push(t)},i.src=t},is_cached:function(t){var e=n.find(this.loaded_list,function(e){return e==t});return null!=e}};var D=new I,B="instavr_videojs_css";if(!e.getElementById(B)){var U=O.get_cdn_base_url(),N=e.getElementsByTagName("head")[0],F=e.createElement("link");F.id=B,F.rel="stylesheet",F.type="text/css",F.href=U+"/stylesheets/video-js.css",F.media="all",N.appendChild(F)}}(window,document,window._),function(t,e,n,i,r,o,a){t.GoogleAnalyticsObject=r,t[r]=t[r]||function(){(t[r].q=t[r].q||[]).push(arguments)},t[r].l=1*new Date,o=e.createElement(n),a=e.getElementsByTagName(n)[0],o.async=1,o.src=i,a.parentNode.insertBefore(o,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga");